//>>built
define("dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom dojo/on dojo/touch dojo/has ../main".split(" "),function(q,r,k,g,t,f,l,u,v){q.experimental("dojox.gesture.Base");g.getObject("gesture",!0,v);return r(null,{defaultEvent:" ",subEvents:[],touchOnly:!1,_elements:null,constructor:function(a){g.mixin(this,a);this.init()},init:function(){this._elements=[];if(!u("touch")&&this.touchOnly)console.warn("Gestures:[",this.defaultEvent,"] is only supported on touch devices!");
else{var a=this.defaultEvent;this.call=this._handle(a);this._events=[a];k.forEach(this.subEvents,function(b){this[b]=this._handle(a+"."+b);this._events.push(a+"."+b)},this)}},_handle:function(a){var b=this;return function(c,d){var h=arguments;2<h.length&&(c=h[1],d=h[2]);if(c&&(c.nodeType||c.attachEvent||c.addEventListener)){var m=b._add(c,a,d);return{remove:function(){m.remove();b._remove(c,a)}}}return f(c,a,d)}},_add:function(a,b,c){var d=this._getGestureElement(a);if(!d){d={target:a,data:{},handles:{}};
var h=g.hitch(this,"_process",d,"press"),m=g.hitch(this,"_process",d,"move"),n=g.hitch(this,"_process",d,"release"),p=g.hitch(this,"_process",d,"cancel"),e=d.handles;this.touchOnly?(e.press=f(a,"touchstart",h),e.move=f(a,"touchmove",m),e.release=f(a,"touchend",n),e.cancel=f(a,"touchcancel",p)):(e.press=l.press(a,h),e.move=l.move(a,m),e.release=l.release(a,n),e.cancel=l.cancel(a,p));this._elements.push(d)}d.handles[b]=d.handles[b]?++d.handles[b]:1;return f(a,b,c)},_getGestureElement:function(a){for(var b=
0,c;b<this._elements.length;b++)if(c=this._elements[b],c.target===a)return c},_process:function(a,b,c){c._locking=c._locking||{};c._locking[this.defaultEvent]||this.isLocked(c.currentTarget)||("INPUT"==c.target.tagName&&"radio"!=c.target.type&&"checkbox"!=c.target.type||"TEXTAREA"==c.target.tagName||c.preventDefault(),c._locking[this.defaultEvent]=!0,this[b](a.data,c))},press:function(a,b){},move:function(a,b){},release:function(a,b){},cancel:function(a,b){},fire:function(a,b){a&&b&&(b.bubbles=!0,
b.cancelable=!0,f.emit(a,b.type,b))},_remove:function(a,b){if((a=this._getGestureElement(a))&&a.handles){a.handles[b]--;var c=a.handles;k.some(this._events,function(d){return 0<c[d]})||(this._cleanHandles(c),b=k.indexOf(this._elements,a),0<=b&&this._elements.splice(b,1))}},_cleanHandles:function(a){for(var b in a)a[b].remove&&a[b].remove(),delete a[b]},lock:function(a){this._lock=a},unLock:function(){this._lock=null},isLocked:function(a){return this._lock&&a?this._lock!==a&&t.isDescendant(a,this._lock):
!1},destroy:function(){k.forEach(this._elements,function(a){this._cleanHandles(a.handles)},this);this._elements=null}})});