//>>built
define("dojo/_base/lang dojo/_base/array dojo/_base/sniff dojo/_base/declare dojo/_base/connect dojo/dom-geometry ./Invisible ../scaler/common ../scaler/linear ../scaler/log ./common dojox/gfx dojox/lang/utils dojox/lang/functional".split(" "),function(M,N,da,ja,ea,ka,la,pa,ma,na,Z,y,fa,ha){return ja("dojox.charting.axis2d.Log",la,{defaultParams:{vertical:!1,fixUpper:"none",fixLower:"none",natural:!1,leftBottom:!0,includeZero:!1,fixed:!0,majorLabels:!0,minorTicks:!0,minorLabels:!0,microTicks:!1,rotation:0,
htmlLabels:!0,enableCache:!1,dropLabels:!0,labelSizeChange:!1,log:10},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null,stroke:{},majorTick:{},minorTick:{},microTick:{},tick:{},font:"",fontColor:"",title:"",titleGap:0,titleFont:"",titleFontColor:"",titleOrientation:""},constructor:function(a,e){this.opt=M.clone(this.defaultParams);fa.updateWithObject(this.opt,e);fa.updateWithPattern(this.opt,
e,this.optionalParams);this.opt.enableCache&&(this._textFreePool=[],this._lineFreePool=[],this._textUsePool=[],this._lineUsePool=[]);this._invalidMaxLabelSize=!0;1<this.opt.log?(this.scalerType=na,this.scalerType.setBase(this.opt.log)):this.scalerType=ma},setWindow:function(a,e){a!=this.scale&&(this._invalidMaxLabelSize=!0);return this.inherited(arguments)},_groupLabelWidth:function(a,e,g){if(!a.length)return 0;50<a.length&&(a.length=50);M.isObject(a[0])&&(a=ha.map(a,function(d){return d.text}));
g&&(a=ha.map(a,function(d){return 0==M.trim(d).length?"":d.substring(0,g)+this.trailingSymbol},this));a=a.join("\x3cbr\x3e");return y._base._getTextBox(a,{font:e}).w||0},_getMaxLabelSize:function(a,e,g,d,c,k){if(null==this._maxLabelSize&&6==arguments.length){var f=this.opt;this.scaler.minMinorStep=this._prevMinMinorStep=0;var b=M.clone(f);delete b.to;delete b.from;var h=this.scalerType.buildScaler(a,e,g,b,f.to-f.from);h.minMinorStep=0;this._majorStart=h.major.start;f=this.scalerType.buildTicks(h,
f);if(k&&f){var l=h=0,p=function(n){n.label&&this.push(n.label)},q=[];this.opt.majorLabels&&(N.forEach(f.major,p,q),h=this._groupLabelWidth(q,c,b.maxLabelCharCount),b.maxLabelSize&&(h=Math.min(b.maxLabelSize,h)));q=[];this.opt.dropLabels&&this.opt.minorLabels&&(N.forEach(f.minor,p,q),l=this._groupLabelWidth(q,c,b.maxLabelCharCount),b.maxLabelSize&&(l=Math.min(b.maxLabelSize,l)));this._maxLabelSize={majLabelW:h,minLabelW:l,majLabelH:k,minLabelH:k}}else this._maxLabelSize=null}return this._maxLabelSize},
calculate:function(a,e,g){this.inherited(arguments,[a,e,g,this.scalerType]);this.scaler.minMinorStep=this._prevMinMinorStep;if((this._invalidMaxLabelSize||g!=this._oldSpan)&&Infinity!=a&&-Infinity!=e){this._invalidMaxLabelSize=!1;this.opt.labelSizeChange&&(this._maxLabelSize=null);this._oldSpan=g;var d=this.opt,c=this.chart.theme.axis,k=d.rotation%360,f=this.chart.theme.axis.tick.labelGap,b=d.font||c.majorTick&&c.majorTick.font||c.tick&&c.tick.font;c=b?y.normalizedLength(y.splitFontString(b).size):
0;b=this._getMaxLabelSize(a,e,g,k,b,c);"number"!=typeof f&&(f=4);if(b&&d.dropLabels){d=Math.abs(Math.cos(k*Math.PI/180));var h=Math.abs(Math.sin(k*Math.PI/180));0>k&&(k+=360);switch(k){case 0:case 180:this.vertical?k=c:(k=b.majLabelW,c=b.minLabelW);break;case 90:case 270:this.vertical?(k=b.majLabelW,c=b.minLabelW):k=c;break;default:k=this.vertical?Math.min(b.majLabelW,c/d):Math.min(b.majLabelW,c/h),c=Math.min(Math.sqrt(b.minLabelW*b.minLabelW+c*c),this.vertical?c*d+b.minLabelW*h:b.minLabelW*d+c*h)}this.scaler.minMinorStep=
this._prevMinMinorStep=Math.max(k,c)+f;this._skipInterval=this.scaler.minMinorStep<=this.scaler.minor.tick*this.scaler.bounds.scale?0:Math.floor((k+f)/(this.scaler.major.tick*this.scaler.bounds.scale))}else this._skipInterval=0}this.ticks=this.scalerType.buildTicks(this.scaler,this.opt);return this},getOffsets:function(){var a={l:0,r:0,t:0,b:0};if(!this.scaler)return a;var e=this.opt,g=this.chart.theme.axis,d=this.chart.theme.axis.tick.labelGap,c=e.titleFont||g.title&&g.title.font;g=0==e.titleGap?
0:e.titleGap||g.title&&g.title.gap;var k=this.chart.theme.getTick("major",e),f=this.chart.theme.getTick("minor",e);c=c?y.normalizedLength(y.splitFontString(c).size):0;var b=e.rotation%360,h=e.leftBottom,l=Math.abs(Math.cos(b*Math.PI/180)),p=Math.abs(Math.sin(b*Math.PI/180));this.trailingSymbol=void 0===e.trailingSymbol||null===e.trailingSymbol?this.trailingSymbol:e.trailingSymbol;"number"!=typeof d&&(d=4);0>b&&(b+=360);var q=this._getMaxLabelSize();if(q){var n=Math.ceil(Math.max(q.majLabelW,q.minLabelW))+
1,m=Math.ceil(Math.max(q.majLabelH,q.minLabelH))+1;if(this.vertical)switch(q=h?"l":"r",b){case 0:case 180:a[q]=n;a.t=a.b=m/2;break;case 90:case 270:a[q]=m;a.t=a.b=n/2;break;default:45>=b||180<b&&225>=b?(a[q]=m*p/2+n*l,a[h?"t":"b"]=m*l/2+n*p,a[h?"b":"t"]=m*l/2):315<b||180>b&&135<b?(a[q]=m*p/2+n*l,a[h?"b":"t"]=m*l/2+n*p,a[h?"t":"b"]=m*l/2):90>b||180<b&&270>b?(a[q]=m*p+n*l,a[h?"t":"b"]=m*l+n*p):(a[q]=m*p+n*l,a[h?"b":"t"]=m*l+n*p)}else switch(q=h?"b":"t",b){case 0:case 180:a[q]=m;a.l=a.r=n/2;break;case 90:case 270:a[q]=
n;a.l=a.r=m/2;break;default:45<=b&&90>=b||225<=b&&270>=b?(a[q]=m*l/2+n*p,a[h?"r":"l"]=m*p/2+n*l,a[h?"l":"r"]=m*p/2):90<=b&&135>=b||270<=b&&315>=b?(a[q]=m*l/2+n*p,a[h?"l":"r"]=m*p/2+n*l,a[h?"r":"l"]=m*p/2):45>b||180<b&&225>b?(a[q]=m*l+n*p,a[h?"r":"l"]=m*p+n*l):(a[q]=m*l+n*p,a[h?"l":"r"]=m*p+n*l)}a[q]+=d+Math.max(k.length,f.length)+(e.title?c+g:0)}return a},cleanGroup:function(a){this.opt.enableCache&&this.group&&(this._lineFreePool=this._lineFreePool.concat(this._lineUsePool),this._lineUsePool=[],
this._textFreePool=this._textFreePool.concat(this._textUsePool),this._textUsePool=[]);this.inherited(arguments)},createText:function(a,e,g,d,c,k,f,b,h){if(!this.opt.enableCache||"html"==a)return Z.createText[a](this.chart,e,g,d,c,k,f,b,h);0<this._textFreePool.length?(a=this._textFreePool.pop(),a.setShape({x:g,y:d,text:k,align:c}),e.add(a)):a=Z.createText[a](this.chart,e,g,d,c,k,f,b);this._textUsePool.push(a);return a},createLine:function(a,e){if(this.opt.enableCache&&0<this._lineFreePool.length){var g=
this._lineFreePool.pop();g.setShape(e);a.add(g)}else g=a.createLine(e);this.opt.enableCache&&this._lineUsePool.push(g);return g},render:function(a,e){var g;if(!this.dirty||!this.scaler)return this;var d=this.opt;var c=this.chart.theme.axis;var k=d.leftBottom,f=d.rotation%360,b=0;b=this.chart.theme.axis.tick.labelGap;var h=d.font||c.majorTick&&c.majorTick.font||c.tick&&c.tick.font,l=d.titleFont||c.title&&c.title.font,p=d.fontColor||c.majorTick&&c.majorTick.fontColor||c.tick&&c.tick.fontColor||"black",
q=d.titleFontColor||c.title&&c.title.fontColor||"black";var n=0==d.titleGap?0:d.titleGap||c.title&&c.title.gap||15;var m=d.titleOrientation||c.title&&c.title.orientation||"axis",P=this.chart.theme.getTick("major",d),Q=this.chart.theme.getTick("minor",d),aa=this.chart.theme.getTick("micro",d),oa="stroke"in d?d.stroke:c.stroke,v=h?y.normalizedLength(y.splitFontString(h).size):0;var E=Math.abs(Math.cos(f*Math.PI/180));var F=Math.abs(Math.sin(f*Math.PI/180));var O=l?y.normalizedLength(y.splitFontString(l).size):
0;"number"!=typeof b&&(b=4);0>f&&(f+=360);var R=this._getMaxLabelSize();R=R&&R.majLabelW;if(this.vertical){var G=a.height-e.b;var H=void 0;var U=e.t;var V=void 0;c=(a.height-e.b+e.t)/2;var S=void 0;F=v*F+(R||0)*E+b+Math.max(P.length,Q.length)+O+n;var W=0;var X=-1;var w=g=0;n=1;E=0;var I=b;var J=0;switch(f){case 0:var r="end";w=.4*v;break;case 90:r="middle";g=-v;break;case 180:r="start";w=.4*-v;break;case 270:r="middle";break;default:45>f?(r="end",w=.4*v):90>f?(r="end",w=.4*v):135>f?r="start":225>
f?(r="start",w=.4*-v):270>f?(r="start",g=k?0:.4*v):315>f?(r="end",g=k?0:.4*v):(r="end",w=.4*v)}if(k)H=V=e.l,b=m&&"away"==m?90:270,S=e.l-F+(270==b?O:0),n=-1,I=-I;else switch(H=V=a.width-e.r,b=m&&"axis"==m?90:270,S=a.width-e.r+F-(270==b?0:O),r){case "start":r="end";break;case "end":r="start";break;case "middle":g+=v}}else{H=e.l;G=void 0;V=a.width-e.r;U=void 0;S=(a.width-e.r+e.l)/2;c=void 0;F=v*E+(R||0)*F+b+Math.max(P.length,Q.length)+O+n;W=1;n=w=g=X=0;E=1;I=0;J=b;switch(f){case 0:r="middle";w=v;break;
case 90:r="start";g=.4*-v;break;case 180:r="middle";break;case 270:r="end";g=.4*v;break;default:45>f?(r="start",w=k?v:0):135>f?(r="start",g=.4*-v):180>f?(r="start",w=k?0:-v):225>f?(r="end",w=k?0:-v):315>f?(r="end",w=k?.4*v:0):(r="end",w=k?v:0)}if(k)G=U=a.height-e.b,b=m&&"axis"==m?180:0,c=a.height-e.b+F-(b?O:0);else switch(G=U=e.t,b=m&&"away"==m?180:0,c=e.t-F+(b?0:O),E=-1,J=-J,r){case "start":r="end";break;case "end":r="start";break;case "middle":w-=v}}this.cleanGroup();var K=this.group;a=this.scaler;
var L=this.ticks,ba=this.scalerType.getTransformerFromModel(this.scaler),A=d.title&&b||f||!this.opt.htmlLabels||da("ie")||da("opera")?"gfx":"html",B=n*P.length,C=E*P.length,Y=this._skipInterval;K.createLine({x1:H,y1:G,x2:V,y2:U}).setStroke(oa);d.title&&(l=Z.createText[A](this.chart,K,S,c,"middle",d.title,l,q),"html"==A?this.htmlElements.push(l):l.setTransform(y.matrix.rotategAt(b,S,c)));if(null==L)return this.dirty=!1,this;var ca=this.opt.majorLabels;N.forEach(L.major,function(t,u){var z=ba(t.value),
D=H+W*z;z=G+X*z;this.createLine(K,{x1:D,y1:z,x2:D+B,y2:z+C}).setStroke(P);if(t.label&&(!Y||0==(u-(1+Y))%(1+Y))){var x=d.maxLabelCharCount?this.getTextWithLimitCharCount(t.label,h,d.maxLabelCharCount):{text:t.label,truncated:!1};x=d.maxLabelSize?this.getTextWithLimitLength(x.text,h,d.maxLabelSize,x.truncated):x;u=this.createText(A,K,D+B+I+(f?0:g),z+C+J+(f?0:w),r,x.text,h,p);this.chart.truncateBidi&&x.truncated&&this.chart.truncateBidi(u,t.label,A);x.truncated&&this.labelTooltip(u,this.chart,t.label,
x.text,h,A);"html"==A?this.htmlElements.push(u):f&&u.setTransform([{dx:g,dy:w},y.matrix.rotategAt(f,D+B+I,z+C+J)])}},this);B=n*Q.length;C=E*Q.length;if(ca=this.opt.minorLabels&&!Y&&10===this.opt.log&&L.minor.length){var T=1,ia=Math.log(10);N.forEach(L.minor,function(t,u){t=Math.log(t.value)/ia;T=Math.min(T,t-Math.floor(t),Math.ceil(t)-t);u&&(T=Math.min(T,t-Math.log(L.minor[u-1].value)/ia))});ca=a.minMinorStep<=T*a.bounds.scale}N.forEach(L.minor,function(t){var u=ba(t.value),z=H+W*u,D=G+X*u;this.createLine(K,
{x1:z,y1:D,x2:z+B,y2:D+C}).setStroke(Q);if(ca&&t.label){var x=d.maxLabelCharCount?this.getTextWithLimitCharCount(t.label,h,d.maxLabelCharCount):{text:t.label,truncated:!1};x=d.maxLabelSize?this.getTextWithLimitLength(x.text,h,d.maxLabelSize,x.truncated):x;u=this.createText(A,K,z+B+I+(f?0:g),D+C+J+(f?0:w),r,x.text,h,p);this.chart.getTextDir&&x.truncated&&this.chart.truncateBidi(u,t.label,A);x.truncated&&this.labelTooltip(u,this.chart,t.label,x.text,h,A);"html"==A?this.htmlElements.push(u):f&&u.setTransform([{dx:g,
dy:w},y.matrix.rotategAt(f,z+B+I,D+C+J)])}},this);B=n*aa.length;C=E*aa.length;N.forEach(L.micro,function(t){var u=ba(t.value);t=H+W*u;u=G+X*u;this.createLine(K,{x1:t,y1:u,x2:t+B,y2:u+C}).setStroke(aa)},this);this.dirty=!1;return this},labelTooltip:function(a,e,g,d,c,k){var f=["dijit/Tooltip"],b={type:"rect"},h=["above","below"];d=y._base._getTextBox(d,{font:c}).w||0;c=c?y.normalizedLength(y.splitFontString(c).size):0;"html"==k?(M.mixin(b,ka.position(a.firstChild,!0)),b.width=Math.ceil(d),b.height=
Math.ceil(c),this._events.push({shape:dojo,handle:ea.connect(a.firstChild,"onmouseover",this,function(l){require(f,function(p){p.show(g,b,h)})})}),this._events.push({shape:dojo,handle:ea.connect(a.firstChild,"onmouseout",this,function(l){require(f,function(p){p.hide(b)})})})):(k=a.getShape(),e=e.getCoords(),b=M.mixin(b,{x:k.x-d/2,y:k.y}),b.x+=e.x,b.y+=e.y,b.x=Math.round(b.x),b.y=Math.round(b.y),b.width=Math.ceil(d),b.height=Math.ceil(c),this._events.push({shape:a,handle:a.connect("onmouseenter",this,
function(l){require(f,function(p){p.show(g,b,h)})})}),this._events.push({shape:a,handle:a.connect("onmouseleave",this,function(l){require(f,function(p){p.hide(b)})})}))},isNullValue:function(a){return 0>=a},naturalBaseline:1})});