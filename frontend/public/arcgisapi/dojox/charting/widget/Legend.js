//>>built
define("dojo/_base/declare dijit/_WidgetBase dojox/gfx dojo/_base/array dojo/has dojo/has!dojo-bidi?../bidi/widget/Legend dojox/lang/functional dojo/dom dojo/dom-construct dojo/dom-class dijit/registry".split(" "),function(n,h,q,g,k,r,l,t,e,m,p){h=n(k("dojo-bidi")?"dojox.charting.widget.NonBidiLegend":"dojox.charting.widget.Legend",h,{chartRef:"",horizontal:!0,swatchSize:18,legendBody:null,postCreate:function(){!this.chart&&this.chartRef&&((this.chart=p.byId(this.chartRef)||p.byNode(t.byId(this.chartRef)))||
console.log("Could not find chart instance with id: "+this.chartRef));this.chart=this.chart.chart||this.chart;this.refresh()},buildRendering:function(){this.domNode=e.create("table",{role:"group","aria-label":"chart legend","class":"dojoxLegendNode"});this.legendBody=e.create("tbody",null,this.domNode);this.inherited(arguments)},destroy:function(){this._surfaces&&g.forEach(this._surfaces,function(b){b.destroy()});this.inherited(arguments)},refresh:function(){this._surfaces&&g.forEach(this._surfaces,
function(a){a.destroy()});for(this._surfaces=[];this.legendBody.lastChild;)e.destroy(this.legendBody.lastChild);this.horizontal&&(m.add(this.domNode,"dojoxLegendHorizontal"),this._tr=e.create("tr",null,this.legendBody),this._inrow=0);var b=this.series||this.chart.series;if(0!=b.length)if("dojox.charting.plot2d.Pie"==b[0].chart.stack[0].declaredClass){var c=b[0].chart.stack[0];"number"==typeof c.run.data[0]?(b=l.map(c.run.data,"Math.max(x, 0)"),b=l.map(b,"/this",l.foldl(b,"+",0)),g.forEach(b,function(a,
d){this._addLabel(c.dyn[d],c._getLabel(100*a)+"%")},this)):g.forEach(c.run.data,function(a,d){this._addLabel(c.dyn[d],a.legend||a.text||a.y)},this)}else g.forEach(b,function(a){this._addLabel(a.dyn,a.legend||a.name)},this)},_addLabel:function(b,c){var a=e.create("td"),d=e.create("div",null,a),f=e.create("label",null,a),u=e.create("div",{style:{width:this.swatchSize+"px",height:this.swatchSize+"px","float":"left"}},d);m.add(d,"dojoxLegendIcon dijitInline");m.add(f,"dojoxLegendText");this._tr?(this._tr.appendChild(a),
++this._inrow===this.horizontal&&(this._tr=e.create("tr",null,this.legendBody),this._inrow=0)):e.create("tr",null,this.legendBody).appendChild(a);this._makeIcon(u,b);f.innerHTML=String(c);k("dojo-bidi")&&(f.dir=this.getTextDir(c,f.dir))},_makeIcon:function(b,c){var a=this.swatchSize,d=this.swatchSize;b=q.createSurface(b,d,a);this._surfaces.push(b);if(c.fill)b.createRect({x:2,y:2,width:d-4,height:a-4}).setFill(c.fill).setStroke(c.stroke);else if(c.stroke||c.marker){var f={x1:0,y1:a/2,x2:d,y2:a/2};
c.stroke&&b.createLine(f).setStroke(c.stroke);c.marker&&b.createPath({path:"M"+d/2+" "+a/2+" "+c.marker}).setFill(c.markerFill).setStroke(c.markerStroke)}else b.createRect({x:2,y:2,width:d-4,height:a-4}).setStroke("black"),b.createLine({x1:2,y1:2,x2:d-2,y2:a-2}).setStroke("black"),b.createLine({x1:2,y1:a-2,x2:d-2,y2:2}).setStroke("black")}});return k("dojo-bidi")?n("dojox.charting.widget.Legend",[h,r]):h});