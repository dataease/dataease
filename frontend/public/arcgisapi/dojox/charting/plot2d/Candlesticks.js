//>>built
define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/utils dojox/gfx/fx".split(" "),function(w,H,C,I,J,K,x,L,D,M){return H("dojox.charting.plot2d.Candlesticks",[J,K],{defaultParams:{gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(b,a){this.opt=w.clone(this.defaultParams);D.updateWithObject(this.opt,a);D.updateWithPattern(this.opt,
a,this.optionalParams);this.animate=this.opt.animate},collectStats:function(b){for(var a=w.delegate(x.defaultStats),h=0;h<b.length;h++){var f=b[h];if(f.data.length){var y=a.vmin,p=a.vmax;"ymin"in f&&"ymax"in f||C.forEach(f.data,function(g,d){this.isNullValue(g)||(d=g.x||d+1,a.hmin=Math.min(a.hmin,d),a.hmax=Math.max(a.hmax,d),a.vmin=Math.min(a.vmin,g.open,g.close,g.high,g.low),a.vmax=Math.max(a.vmax,g.open,g.close,g.high,g.low))},this);"ymin"in f&&(a.vmin=Math.min(y,f.ymin));"ymax"in f&&(a.vmax=Math.max(p,
f.ymax))}}return a},getSeriesStats:function(){var b=this.collectStats(this.series);b.hmin-=.5;b.hmax+=.5;return b},render:function(b,a){if(this.zoom&&!this.isDataDirty())return this.performZoom(b,a);this.resetEvents();this.dirty=this.isDirty();if(this.dirty){C.forEach(this.series,x.purgeGroup);this._eventSeries={};this.cleanGroup();var h=this.getGroup();L.forEachRev(this.series,function(N){N.cleanGroup(h)})}var f=this.chart.theme,y=this._hScaler.scaler.getTransformerFromModel(this._hScaler),p=this._vScaler.scaler.getTransformerFromModel(this._vScaler),
g=this.events();var d=x.calculateBarSize(this._hScaler.bounds.scale,this.opt);var O=d.gap;d=d.size;for(var z=this.series.length-1;0<=z;--z){var c=this.series[z];if(this.dirty||c.dirty){c.cleanGroup();var A=f.next("candlestick",[this.opt,c]),E=Array(c.data.length);if(c.hidden)c.dyn.fill=A.series.fill,c.dyn.stroke=A.series.stroke;else{h=c.group;for(var r=0;r<c.data.length;++r){var e=c.data[r];if(!this.isNullValue(e)){var k=f.addMixin(A,"candlestick",e,!0),F=y(e.x||r+.5)+a.l+O,n=b.height-a.b,l=p(e.open),
m=p(e.close),u=p(e.high),t=p(e.low);if("mid"in e)var G=p(e.mid);if(t>u){var q=u;u=t;t=q}if(1<=d){q=l>m;var P={x1:d/2,x2:d/2,y1:n-u,y2:n-t},Q={x:0,y:n-Math.max(l,m),width:d,height:Math.max(q?l-m:m-l,1)},B=h.createGroup();B.setTransform({dx:F,dy:0});var v=B.createGroup();v.createLine(P).setStroke(k.series.stroke);v.createRect(Q).setStroke(k.series.stroke).setFill(q?k.series.fill:"white");"mid"in e&&v.createLine({x1:k.series.stroke?k.series.stroke.width||1:1,x2:d-(k.series.stroke?k.series.stroke.width||
1:1),y1:n-G,y2:n-G}).setStroke(q?"white":k.series.stroke);c.dyn.fill=k.series.fill;c.dyn.stroke=k.series.stroke;g&&(e={element:"candlestick",index:r,run:c,shape:v,x:F,y:n-Math.max(l,m),cx:d/2,cy:n-Math.max(l,m)+Math.max(q?l-m:m-l,1)/2,width:d,height:Math.max(q?l-m:m-l,1),data:e},this._connectEvents(e),E[r]=e)}this.animate&&this._animateCandlesticks(B,n-t,u-t)}}this._eventSeries[c.name]=E;c.dirty=!1}}else f.skip(),this._reconnectEvents(c.name)}this.dirty=!1;I("dojo-bidi")&&this._checkOrientation(this.group,
b,a);return this},tooltipFunc:function(b){return'\x3ctable cellpadding\x3d"1" cellspacing\x3d"0" border\x3d"0" style\x3d"font-size:0.9em;"\x3e\x3ctr\x3e\x3ctd\x3eOpen:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+b.data.open+'\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3eHigh:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+b.data.high+'\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3eLow:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+b.data.low+'\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3eClose:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+
b.data.close+"\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e"+(void 0!==b.data.mid?'\x3ctr\x3e\x3ctd\x3eMid:\x3c/td\x3e\x3ctd align\x3d"right"\x3e\x3cstrong\x3e'+b.data.mid+"\x3c/strong\x3e\x3c/td\x3e\x3c/tr\x3e":"")+"\x3c/table\x3e"},_animateCandlesticks:function(b,a,h){M.animateTransform(w.delegate({shape:b,duration:1200,transform:[{name:"translate",start:[0,a-a/h],end:[0,0]},{name:"scale",start:[1,1/h],end:[1,1]},{name:"original"}]},this.animate)).play()}})});