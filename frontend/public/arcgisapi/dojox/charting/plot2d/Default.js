//>>built
define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/has ./CartesianBase ./_PlotEvents ./common dojox/lang/functional dojox/lang/utils dojox/gfx/fx".split(" "),function(A,N,q,O,P,Q,y,R,K,S){return N("dojox.charting.plot2d.Default",[P,Q],{defaultParams:{lines:!0,areas:!1,markers:!1,tension:"",animate:!1,enableCache:!1,interpolate:!1},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},filter:{},styleFunc:null,font:"",fontColor:"",marker:"",markerStroke:{},markerOutline:{},markerShadow:{},
markerFill:{},markerFont:"",markerFontColor:"",zeroLine:0},constructor:function(d,c){this.opt=A.clone(A.mixin(this.opt,this.defaultParams));K.updateWithObject(this.opt,c);K.updateWithPattern(this.opt,c,this.optionalParams);this.animate=this.opt.animate},createPath:function(d,c,h){if(this.opt.enableCache&&0<d._pathFreePool.length){var k=d._pathFreePool.pop();k.setShape(h);c.add(k)}else k=c.createPath(h);this.opt.enableCache&&d._pathUsePool.push(k);return k},buildSegments:function(d,c){d=this.series[d];
for(var h=c?Math.min(d.data.length,Math.ceil(this._hScaler.bounds.to)):d.data.length,k=null,p=[],f=c?Math.max(0,Math.floor(this._hScaler.bounds.from-1)):0;f<h;f++)if(!this.isNullValue(d.data[f]))k||(k=[],p.push({index:f,rseg:k})),k.push(c&&d.data[f].hasOwnProperty("y")?d.data[f].y:d.data[f]);else if(!this.opt.interpolate||c)k=null;return p},render:function(d,c){if(this.zoom&&!this.isDataDirty())return this.performZoom(d,c);this.resetEvents();this.dirty=this.isDirty();if(this.dirty){q.forEach(this.series,
y.purgeGroup);this._eventSeries={};this.cleanGroup();this.getGroup().setTransform(null);var h=this.getGroup();R.forEachRev(this.series,function(a){a.cleanGroup(h)})}for(var k=this.chart.theme,p,f,T=this.events(),B=0;B<this.series.length;B++){var b=this.series[B];if(this.dirty||b.dirty)if(b.cleanGroup(),this.opt.enableCache&&(b._pathFreePool=(b._pathFreePool?b._pathFreePool:[]).concat(b._pathUsePool?b._pathUsePool:[]),b._pathUsePool=[]),b.data.length){var e=k.next(this.opt.areas?"area":"line",[this.opt,
b],!0),H=this._hScaler.scaler.getTransformerFromModel(this._hScaler),C=this._vScaler.scaler.getTransformerFromModel(this._vScaler),U=this._eventSeries[b.name]=Array(b.data.length);h=b.group;if(b.hidden){this.opt.lines&&(b.dyn.stroke=e.series.stroke);if(b.markers||void 0===b.markers&&this.opt.markers)b.dyn.markerFill=e.marker.fill,b.dyn.markerStroke=e.marker.stroke,b.dyn.marker=e.symbol;this.opt.areas&&(b.dyn.fill=e.series.fill)}else{for(var D=q.some(b.data,function(a){return"number"==typeof a||a&&
!a.hasOwnProperty("x")}),E=this.buildSegments(B,D),v=0;v<E.length;v++){var n=E[v];var g=D?q.map(n.rseg,function(a,l){return{x:H(l+n.index+1)+c.l,y:d.height-c.b-C(a),data:a}},this):q.map(n.rseg,function(a){return{x:H(a.x)+c.l,y:d.height-c.b-C(a.y),data:a}},this);if(D&&this.opt.interpolate)for(;v<E.length;)v++,(n=E[v])&&(g=g.concat(q.map(n.rseg,function(a,l){return{x:H(l+n.index+1)+c.l,y:d.height-c.b-C(a),data:a}},this)));var r=this.opt.tension?y.curve(g,this.opt.tension):"";if(this.opt.areas&&1<g.length){var w=
this._plotFill(e.series.fill,d,c),t=A.clone(g),x=d.height-c.b;isNaN(this.opt.zeroLine)||(x=Math.max(c.t,Math.min(d.height-c.b-C(this.opt.zeroLine),x)));this.opt.tension?b.dyn.fill=h.createPath(r+" L"+(t[t.length-1].x+","+x+" L"+t[0].x+","+x+" L"+t[0].x+","+t[0].y)).setFill(w).getFill():(t.push({x:g[g.length-1].x,y:x}),t.push({x:g[0].x,y:x}),t.push(g[0]),b.dyn.fill=h.createPolyline(t).setFill(w).getFill())}if(this.opt.lines||this.opt.markers)p=e.series.stroke,e.series.outline&&(f=b.dyn.outline=y.makeStroke(e.series.outline),
f.width=2*f.width+(p&&p.width||0));this.opt.markers&&(b.dyn.marker=e.symbol);var F=null,I=null,J=null;if(p&&e.series.shadow&&1<g.length){var u=e.series.shadow;w=q.map(g,function(a){return{x:a.x+u.dx,y:a.y+u.dy}});this.opt.lines&&(b.dyn.shadow=this.opt.tension?h.createPath(y.curve(w,this.opt.tension)).setStroke(u).getStroke():h.createPolyline(w).setStroke(u).getStroke());this.opt.markers&&e.marker.shadow&&(u=e.marker.shadow,J=q.map(w,function(a){return this.createPath(b,h,"M"+a.x+" "+a.y+" "+e.symbol).setStroke(u).setFill(u.color)},
this))}if(this.opt.lines&&1<g.length){var G;f&&(b.dyn.outline=this.opt.tension?h.createPath(r).setStroke(f).getStroke():h.createPolyline(g).setStroke(f).getStroke());b.dyn.stroke=this.opt.tension?(G=h.createPath(r)).setStroke(p).getStroke():(G=h.createPolyline(g)).setStroke(p).getStroke();G.setFilter&&e.series.filter&&G.setFilter(e.series.filter)}r=null;if(this.opt.markers){var m=e;F=Array(g.length);I=Array(g.length);f=null;m.marker.outline&&(f=y.makeStroke(m.marker.outline),f.width=2*f.width+(m.marker.stroke?
m.marker.stroke.width:0));q.forEach(g,function(a,l){if(this.opt.styleFunc||"number"!=typeof a.data){var z="number"!=typeof a.data?[a.data]:[];this.opt.styleFunc&&z.push(this.opt.styleFunc(a.data));m=k.addMixin(e,"marker",z,!0)}else m=k.post(e,"marker");a="M"+a.x+" "+a.y+" "+m.symbol;f&&(I[l]=this.createPath(b,h,a).setStroke(f));F[l]=this.createPath(b,h,a).setStroke(m.marker.stroke).setFill(m.marker.fill)},this);b.dyn.markerFill=m.marker.fill;b.dyn.markerStroke=m.marker.stroke;!r&&this.opt.labels&&
(r=F[0].getBoundingBox());T?q.forEach(F,function(a,l){a={element:"marker",index:l+n.index,run:b,shape:a,outline:I[l]||null,shadow:J&&J[l]||null,cx:g[l].x,cy:g[l].y};D?(a.x=l+n.index+1,a.y=b.data[l+n.index]):(a.x=n.rseg[l].x,a.y=b.data[l+n.index].y);this._connectEvents(a);U[l+n.index]=a},this):delete this._eventSeries[b.name]}if(this.opt.labels){var L=r?r.width:2,M=r?r.height:2;q.forEach(g,function(a,l){if(this.opt.styleFunc||"number"!=typeof a.data){var z="number"!=typeof a.data?[a.data]:[];this.opt.styleFunc&&
z.push(this.opt.styleFunc(a.data));m=k.addMixin(e,"marker",z,!0)}else m=k.post(e,"marker");this.createLabel(h,n.rseg[l],{x:a.x-L/2,y:a.y-M/2,width:L,height:M},m)},this)}}b.dirty=!1}}else b.dirty=!1,k.skip();else k.skip(),this._reconnectEvents(b.name)}O("dojo-bidi")&&this._checkOrientation(this.group,d,c);this.animate&&(p=this.getGroup(),S.animateTransform(A.delegate({shape:p,duration:1200,transform:[{name:"translate",start:[0,d.height-c.b],end:[0,0]},{name:"scale",start:[1,0],end:[1,1]},{name:"original"}]},
this.animate)).play());this.dirty=!1;return this}})});