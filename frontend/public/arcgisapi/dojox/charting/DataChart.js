//>>built
define("dojo/_base/kernel dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/_base/connect dojo/_base/array ./Chart2D ./themes/PlotKit/blue dojo/dom".split(" "),function(n,e,p,l,k,g,q,r,t){n.experimental("dojox.charting.DataChart");var u={vertical:!0,min:0,max:10,majorTickStep:5,minorTickStep:1,natural:!1,stroke:"black",majorTick:{stroke:"black",length:8},minorTick:{stroke:"gray",length:2},majorLabels:!0},v={natural:!0,majorLabels:!0,includeZero:!1,majorTickStep:1,majorTick:{stroke:"black",length:8},
fixUpper:"major",stroke:"black",htmlLabels:!0,from:1},m={markers:!0,tension:2,gap:2};return p("dojox.charting.DataChart",q,{scroll:!0,comparative:!1,query:"*",queryOptions:"",fieldName:"value",chartTheme:r,displayRange:0,stretchToFit:!0,minWidth:200,minHeight:100,showing:!0,label:"name",constructor:function(b,a){this.domNode=t.byId(b);e.mixin(this,a);this.xaxis=e.mixin(e.mixin({},v),a.xaxis);"seriesLabels"==this.xaxis.labelFunc&&(this.xaxis.labelFunc=e.hitch(this,"seriesLabels"));this.yaxis=e.mixin(e.mixin({},
u),a.yaxis);"seriesLabels"==this.yaxis.labelFunc&&(this.yaxis.labelFunc=e.hitch(this,"seriesLabels"));this._events=[];this.convertLabels(this.yaxis);this.convertLabels(this.xaxis);this.onSetItems={};this.dataLength=this.onSetInterval=0;this.seriesData={};this.seriesDataBk={};this.firstRun=!0;this.dataOffset=0;this.chartTheme.plotarea.stroke={color:"gray",width:3};this.setTheme(this.chartTheme);this.displayRange&&(this.stretchToFit=!1);this.stretchToFit||(this.xaxis.to=this.displayRange);if(b=a.type&&
"Pie"!=a.type&&"dojox.charting.plot2d.Pie"!=a.type.prototype.declaredClass)this.addAxis("x",this.xaxis),this.addAxis("y",this.yaxis);m.type=a.type||"Markers";this.addPlot("default",e.mixin(m,a.chartPlot));b&&this.addPlot("grid",e.mixin(a.grid||{},{type:"Grid",hMinorLines:!0}));this.showing&&this.render();a.store&&this.setStore(a.store,a.query,a.fieldName,a.queryOptions)},destroy:function(){g.forEach(this._events,k.disconnect);this.inherited(arguments)},setStore:function(b,a,c,d){this.firstRun=!0;
this.store=b||this.store;this.query=a||this.query;this.fieldName=c||this.fieldName;this.label=this.store.getLabelAttributes();this.queryOptions=d||d;g.forEach(this._events,k.disconnect);this._events=[k.connect(this.store,"onSet",this,"onSet"),k.connect(this.store,"onError",this,"onError")];this.fetch()},show:function(){this.showing||(l.style(this.domNode,"display",""),this.showing=!0,this.render())},hide:function(){this.showing&&(l.style(this.domNode,"display","none"),this.showing=!1)},onSet:function(b){var a=
this.getProperty(b,this.label);if(a in this.runs||this.comparative)clearTimeout(this.onSetInterval),this.onSetItems[a]||(this.onSetItems[a]=b),this.onSetInterval=setTimeout(e.hitch(this,function(){clearTimeout(this.onSetInterval);var c=[],d;for(d in this.onSetItems)c.push(this.onSetItems[d]);this.onData(c);this.onSetItems={}}),200)},onError:function(b){console.error("DataChart Error:",b)},onDataReceived:function(b){},getProperty:function(b,a){if(a==this.label)return this.store.getLabel(b);if("id"==
a)return this.store.getIdentity(b);var c=this.store.getValues(b,a);2>c.length&&(c=this.store.getValue(b,a));return c},onData:function(b){if(b&&b.length){this.items&&this.items.length!=b.length&&(g.forEach(b,function(d){var h=this.getProperty(d,"id");g.forEach(this.items,function(f,w){this.getProperty(f,"id")==h&&(this.items[w]=f)},this)},this),b=this.items);this.stretchToFit&&(this.displayRange=b.length);this.onDataReceived(b);this.items=b;if(this.comparative){var a="default";this.seriesData[a]=[];
this.seriesDataBk[a]=[];g.forEach(b,function(d){d=this.getProperty(d,this.fieldName);this.seriesData[a].push(d)},this)}else g.forEach(b,function(d,h){var f=this.store.getLabel(d);this.seriesData[f]||(this.seriesData[f]=[],this.seriesDataBk[f]=[]);d=this.getProperty(d,this.fieldName);e.isArray(d)?this.seriesData[f]=d:(this.scroll?(this.seriesDataBk[f].length>this.seriesData[f].length&&(this.seriesData[f]=this.seriesDataBk[f]),this.seriesData[f].push(Number(d))):(h=g.map(Array(h+1),function(){return 0}),
h.push(Number(d)),this.seriesData[f]=h),this.seriesDataBk[f].push(Number(d)))},this);if(this.firstRun)for(a in this.firstRun=!1,this.seriesData){this.addSeries(a,this.seriesData[a]);var c=this.seriesData[a]}else for(a in this.seriesData)c=this.seriesData[a],this.scroll&&c.length>this.displayRange&&(this.dataOffset=c.length-this.displayRange-1,c=c.slice(c.length-this.displayRange,c.length)),this.updateSeries(a,c);this.dataLength=c.length;this.showing&&this.render()}},fetch:function(){this.store&&this.store.fetch({query:this.query,
queryOptions:this.queryOptions,start:this.start,count:this.count,sort:this.sort,onComplete:e.hitch(this,function(b){setTimeout(e.hitch(this,function(){this.onData(b)}),0)}),onError:e.hitch(this,"onError")})},convertLabels:function(b){if(!b.labels||e.isObject(b.labels[0]))return null;b.labels=g.map(b.labels,function(a,c){return{value:c,text:a}});return null},seriesLabels:function(b){b--;if(1>this.series.length||!this.comparative&&b>this.series.length)return"-";if(this.comparative)return this.store.getLabel(this.items[b]);
for(var a=0;a<this.series.length;a++)if(0<this.series[a].data[b])return this.series[a].name;return"-"},resizeChart:function(b){this.resize(Math.max(b.w,this.minWidth),Math.max(b.h,this.minHeight))}})});