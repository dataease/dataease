//>>built
define(["dojo","dijit","dojox"],function(c,n,h){c.provide("dojox.drawing.plugins.drawing.Silverlight");h.drawing.plugins.drawing.Silverlight=h.drawing.util.oo.declare(function(g){"silverlight"==h.gfx.renderer&&(this.mouse=g.mouse,this.stencils=g.stencils,this.anchors=g.anchors,this.canvas=g.canvas,this.util=g.util,c.connect(this.stencils,"register",this,function(a){var b,d=this;(function(){b=a.container.connect("onmousedown",function(l){l.superTarget=a;d.mouse.down(l)})})();var e=c.connect(a,"setTransform",
this,function(){});var f=c.connect(a,"onBeforeRender",function(){});var k=c.connect(a,"onRender",this,function(){});var m=c.connect(a,"destroy",this,function(){c.forEach([b,e,f,k,m],c.disconnect,c)})}),c.connect(this.anchors,"onAddAnchor",this,function(a){var b=a.shape.connect("onmousedown",this.mouse,function(e){e.superTarget=a;this.down(e)}),d=c.connect(a,"disconnectMouse",this,function(){c.disconnect(b);c.disconnect(d)})}),this.mouse._down=function(a){var b=this._getXY(a),d=b.x-this.origin.x,e=
b.y-this.origin.y;d*=this.zoom;e*=this.zoom;this.origin.startx=d;this.origin.starty=e;this._lastx=d;this._lasty=e;this.drawingType=this.util.attr(a,"drawingType")||"";b=this._getId(a);d={x:d,y:e,id:b};console.log(" \x3e \x3e \x3e id:",b,"drawingType:",this.drawingType,"evt:",a);this.onDown(d);this._clickTime=(new Date).getTime();this._lastClickTime&&this._clickTime-this._lastClickTime<this.doublClickSpeed&&(a=this.eventName("doubleClick"),console.warn("DOUBLE CLICK",a,d),this._broadcastEvent(a,d));
this._lastClickTime=this._clickTime},this.mouse.down=function(a){clearTimeout(this.__downInv);"surface"==this.util.attr(a,"drawingType")?this.__downInv=setTimeout(c.hitch(this,function(){this._down(a)}),500):this._down(a)},this.mouse._getXY=function(a){if(a.pageX)return{x:a.pageX,y:a.pageY,cancelBubble:!0};console.log("EVT",a);for(var b in a);console.log("EVTX",a.x);return void 0!==a.x?{x:a.x+this.origin.x,y:a.y+this.origin.y}:{x:a.pageX,y:a.pageY}},this.mouse._getId=function(a){return this.util.attr(a,
"id")},this.util.attr=function(a,b,d,e){if(!a)return!1;try{var f=a.superTarget?a.superTarget:a.superClass?a.superClass:a.target?a.target:a;if(void 0!==d)return a[b]=d;if(f.tagName){if("drawingType"==b&&"object"==f.tagName.toLowerCase())return"surface";var k=c.attr(f,b)}return k=f[b]}catch(m){return!1}})},{})});