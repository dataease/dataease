//>>built
require({cache:{"url:dojox/calendar/templates/ColumnView.html":'\x3cdiv data-dojo-attach-events\x3d"keydown:_onKeyDown"\x3e\r\n\t\r\n\t\x3cdiv data-dojo-attach-point\x3d"header" class\x3d"dojoxCalendarHeader"\x3e\r\n\t\t\x3cdiv class\x3d"dojoxCalendarYearColumnHeader" data-dojo-attach-point\x3d"yearColumnHeader"\x3e\r\n\t\t\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr\x3e\x3ctd\x3e\x3cspan data-dojo-attach-point\x3d"yearColumnHeaderContent"\x3e\x3c/span\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\t\t\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"columnHeader" class\x3d"dojoxCalendarColumnHeader"\x3e\r\n\t\t\t\x3ctable data-dojo-attach-point\x3d"columnHeaderTable" class\x3d"dojoxCalendarColumnHeaderTable" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\r\n\t\x3cdiv data-dojo-attach-point\x3d"secondarySheetNode"\x3e\x3c/div\x3e\r\n\t\r\n\t\x3cdiv data-dojo-attach-point\x3d"subHeader" class\x3d"dojoxCalendarSubHeader"\x3e\r\n\t\t\x3cdiv class\x3d"dojoxCalendarSubRowHeader"\x3e\r\n\t\t\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\t\t\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"subColumnHeader" class\x3d"dojoxCalendarSubColumnHeader"\x3e\r\n\t\t\t\x3ctable data-dojo-attach-point\x3d"subColumnHeaderTable" class\x3d"dojoxCalendarSubColumnHeaderTable" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\r\n\t\x3cdiv data-dojo-attach-point\x3d"scrollContainer" class\x3d"dojoxCalendarScrollContainer"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"sheetContainer" style\x3d"position:relative;left:0;right:0;margin:0;padding:0"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"rowHeader" class\x3d"dojoxCalendarRowHeader"\x3e\r\n\t\t\t\t\x3ctable data-dojo-attach-point\x3d"rowHeaderTable" class\x3d"dojoxCalendarRowHeaderTable" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3c/table\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"grid" class\x3d"dojoxCalendarGrid"\x3e\r\n\t\t\t\t\x3ctable data-dojo-attach-point\x3d"gridTable" class\x3d"dojoxCalendarGridTable" cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%"\x3e\x3c/table\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"itemContainer" class\x3d"dojoxCalendarContainer" data-dojo-attach-event\x3d"mousedown:_onGridMouseDown,mouseup:_onGridMouseUp,ondblclick:_onGridDoubleClick,touchstart:_onGridTouchStart,touchmove:_onGridTouchMove,touchend:_onGridTouchEnd"\x3e\r\n\t\t\t\t\x3ctable data-dojo-attach-point\x3d"itemContainerTable" class\x3d"dojoxCalendarContainerTable" cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%"\x3e\x3c/table\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e \r\n\t\x3c/div\x3e\r\n\t\r\n\t\x3cdiv data-dojo-attach-point\x3d"vScrollBar" class\x3d"dojoxCalendarVScrollBar"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"vScrollBarContent" style\x3d"visibility:hidden;position:relative;width:1px;height:1px;" \x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\r\n\t\x3cdiv data-dojo-attach-point\x3d"hScrollBar" class\x3d"dojoxCalendarHScrollBar"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"hScrollBarContent" style\x3d"visibility:hidden;position:relative;width:1px;height:1px;" \x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\r\n\x3c/div\x3e\r\n'}});
define("./ViewBase dijit/_TemplatedMixin ./_ScrollBarBase dojo/text!./templates/ColumnView.html dojo/_base/declare dojo/_base/event dojo/_base/lang dojo/_base/array dojo/_base/sniff dojo/_base/fx dojo/_base/html dojo/on dojo/dom dojo/dom-class dojo/dom-style dojo/dom-geometry dojo/dom-construct dojo/mouse dojo/query dojox/html/metrics".split(" "),function(G,H,E,I,J,z,x,C,D,K,F,A,O,p,q,B,r,L,t,M){return J("dojox.calendar.SimpleColumnView",[G,H],{baseClass:"dojoxCalendarColumnView",templateString:I,
viewKind:"columns",_setTabIndexAttr:"domNode",renderData:null,startDate:null,columnCount:7,subColumns:null,minHours:8,maxHours:18,hourSize:100,timeSlotDuration:15,rowHeaderGridSlotDuration:60,rowHeaderLabelSlotDuration:60,rowHeaderLabelOffset:2,rowHeaderFirstLabelOffset:2,verticalRenderer:null,verticalDecorationRenderer:null,minColumnWidth:-1,percentOverlap:70,horizontalGap:4,_showSecondarySheet:!1,_columnHeaderHandlers:null,constructor:function(){this.invalidatingProperties="columnCount startDate minHours maxHours hourSize verticalRenderer verticalDecorationRenderer rowHeaderTimePattern columnHeaderDatePattern timeSlotDuration rowHeaderGridSlotDuration rowHeaderLabelSlotDuration rowHeaderLabelOffset rowHeaderFirstLabelOffset percentOverlap horizontalGap scrollBarRTLPosition itemToRendererKindFunc layoutPriorityFunction formatItemTimeFunc textDir items subColumns minColumnWidth".split(" ");
this._columnHeaderHandlers=[]},destroy:function(a){this._cleanupColumnHeader();this.scrollBar&&this.scrollBar.destroy(a);this.inherited(arguments)},_scrollBar_onScroll:function(a){this._setScrollPosition(a)},_hscrollBar_onScroll:function(a){this._setHScrollPosition(a)},buildRendering:function(){this.inherited(arguments);this.vScrollBar&&(this.scrollBar=new E({content:this.vScrollBarContent},this.vScrollBar),this.scrollBar.on("scroll",x.hitch(this,this._scrollBar_onScroll)));this.hScrollBar&&(this.hScrollBarW=
new E({content:this.hScrollBarContent,direction:"horizontal",value:0},this.hScrollBar),this.hScrollBarW.on("scroll",x.hitch(this,this._hscrollBar_onScroll)),this._hScrollNodes=[this.columnHeaderTable,this.subColumnHeaderTable,this.gridTable,this.itemContainerTable]);this._viewHandles.push(A(this.scrollContainer,L.wheel,dojo.hitch(this,this._mouseWheelScrollHander)))},postscript:function(){this.inherited(arguments);this._initialized=!0;this.invalidRendering||this.refreshRendering()},_setVerticalRendererAttr:function(a){this._destroyRenderersByKind("vertical");
this._set("verticalRenderer",a)},_createRenderData:function(){var a={};a.minHours=this.get("minHours");a.maxHours=this.get("maxHours");a.hourSize=this.get("hourSize");a.hourCount=a.maxHours-a.minHours;a.slotDuration=this.get("timeSlotDuration");a.rowHeaderGridSlotDuration=this.get("rowHeaderGridSlotDuration");a.slotSize=Math.ceil(a.hourSize/(60/a.slotDuration));a.hourSize=60/a.slotDuration*a.slotSize;a.sheetHeight=a.hourSize*a.hourCount;this._rowHeaderWidth||(this._rowHeaderWidth=B.getMarginBox(this.rowHeader).w);
a.rowHeaderWidth=this._rowHeaderWidth;var b=M.getScrollbar();a.scrollbarWidth=b.w+1;a.scrollbarHeight=b.h+1;a.dateLocaleModule=this.dateLocaleModule;a.dateClassObj=this.dateClassObj;a.dateModule=this.dateModule;a.dates=[];a.columnCount=this.get("columnCount");a.subColumns=this.get("subColumns");a.subColumnCount=a.subColumns?a.subColumns.length:1;a.hScrollPaneWidth=B.getMarginBox(this.grid).w;a.minSheetWidth=0>this.minColumnWidth?-1:this.minColumnWidth*a.subColumnCount*a.columnCount;a.hScrollBarEnabled=
0<this.minColumnWidth&&a.hScrollPaneWidth<a.minSheetWidth;b=this.get("startDate");null==b&&(b=new a.dateClassObj);this.startDate=b=this.floorToDay(b,!1,a);for(var c=0;c<a.columnCount;c++)a.dates.push(b),b=this.addAndFloor(b,"day",1);a.startTime=new a.dateClassObj(a.dates[0]);a.startTime.setHours(a.minHours);a.endTime=new a.dateClassObj(a.dates[a.columnCount-1]);a.endTime.setHours(a.maxHours);this.displayedItemsInvalidated&&!this._isEditing?a.items=this.storeManager._computeVisibleItems(a):this.renderData&&
(a.items=this.renderData.items);this.displayedDecorationItemsInvalidated?a.decorationItems=this.decorationStoreManager._computeVisibleItems(a):this.renderData&&(a.decorationItems=this.renderData.decorationItems);return a},_validateProperties:function(){this.inherited(arguments);var a=this.minHours;if(0>a||23<a||isNaN(a))this.minHours=0;a=this.maxHours;if(1>a||36<a||isNaN(a))this.minHours=36;this.minHours>this.maxHours&&(a=this.maxHours,this.maxHours=this.minHours,this.minHours=a);1>this.maxHours-
this.minHours&&(this.minHours=0,this.maxHours=24);if(1>this.columnCount||isNaN(this.columnCount))this.columnCount=1;a=this.percentOverlap;if(0>a||100<a||isNaN(a))this.percentOverlap=70;if(5>this.hourSize||isNaN(this.hourSize))this.hourSize=10;a=this.timeSlotDuration;if(1>a||60<a||isNaN(a))this.timeSlotDuration=15},_setStartDateAttr:function(a){this.displayedItemsInvalidated=!0;this._set("startDate",a)},_setColumnCountAttr:function(a){this.displayedItemsInvalidated=!0;this._set("columnCount",a)},__fixEvt:function(a){a.sheet=
"primary";a.source=this;return a},rowHeaderTimePattern:null,_formatRowHeaderLabel:function(a){return this.renderData.dateLocaleModule.format(a,{selector:"time",timePattern:this.rowHeaderTimePattern})},columnHeaderDatePattern:null,_formatColumnHeaderLabel:function(a){return this.renderData.dateLocaleModule.format(a,{selector:"date",datePattern:this.columnHeaderDatePattern,formatLength:"medium"})},scrollBarRTLPosition:"left",_getStartTimeOfDay:function(){var a=(this.get("maxHours")-this.get("minHours"))*
this._getScrollPosition()/this.renderData.sheetHeight;return{hours:this.renderData.minHours+Math.floor(a),minutes:60*(a-Math.floor(a))}},_getEndTimeOfDay:function(){var a=(this.get("maxHours")-this.get("minHours"))*(this._getScrollPosition()+this.scrollContainer.offsetHeight)/this.renderData.sheetHeight;return{hours:this.renderData.minHours+Math.floor(a),minutes:60*(a-Math.floor(a))}},startTimeOfDay:0,_setStartTimeOfDayAttr:function(a){this.renderData?this._setStartTimeOfDay(a.hours,a.minutes,a.duration,
a.easing):this._startTimeOfDayInvalidated=!0;this._set("startTimeOfDay",a)},_getStartTimeOfDayAttr:function(){return this.renderData?this._getStartTimeOfDay():this._get("startTimeOfDay")},_setStartTimeOfDay:function(a,b,c,d){var e=this.renderData;a=a||e.minHours;b=b||0;0>b?b=0:59<b&&(b=59);0>a?a=0:a>e.maxHours&&(a=e.maxHours);a=60*a+b;b=60*e.minHours;var g=60*e.maxHours;a<b?a=b:a>g&&(a=g);a=(a-b)*e.sheetHeight/(g-b);a=Math.min(e.sheetHeight-this.scrollContainer.offsetHeight,a);this._scrollToPosition(a,
c||0,d)},_scrollToPosition:function(a,b,c){if(b){this._scrollAnimation&&this._scrollAnimation.stop();var d=this._getScrollPosition();this._scrollAnimation=new K.Animation({curve:[d,a],duration:Math.abs((a-d)*b/this.renderData.sheetHeight),easing:c,onAnimate:x.hitch(this,function(e){this._setScrollImpl(e)})});this._scrollAnimation.play()}else this._setScrollImpl(a)},_setScrollImpl:function(a){this._setScrollPosition(a);this.scrollBar&&this.scrollBar.set("value",a)},ensureVisibility:function(a,b,c,
d,e){d=void 0==d?this.renderData.slotDuration:d;if(this.scrollable&&this.autoScroll){a=60*a.getHours()+a.getMinutes()-d;b=60*b.getHours()+b.getMinutes()+d;d=this._getStartTimeOfDay();var g=this._getEndTimeOfDay();d=60*d.hours+d.minutes;g=60*g.hours+g.minutes;var h=!1,f=null;switch(c){case "start":h=a>=d&&a<=g;f=a;break;case "end":h=b>=d&&b<=g;f=b-(g-d);break;case "both":h=a>=d&&b<=g,f=a}h||this._setStartTimeOfDay(Math.floor(f/60),f%60,e)}},scrollView:function(a){var b=this._getStartTimeOfDay();b=
60*b.hours+b.minutes+a*this.timeSlotDuration;this._setStartTimeOfDay(Math.floor(b/60),b%60)},scrollViewHorizontal:function(a){this._setHScrollPosition(this._getHScrollPosition()+a*this.minColumnWidth);this.hScrollBarW&&this.hScrollBarW.set("value",this._getHScrollPosition())},_hScrollNodes:null,_setHScrollPositionImpl:function(a,b,c){var d=b?null:"translateX(-"+a+"px)";C.forEach([this.columnHeaderTable,this.subColumnHeaderTable,this.gridTable,this.itemContainerTable],function(e){b?(e.scrollLeft=a,
q.set(e,"left",-a+"px")):q.set(e,c,d)},this)},_mouseWheelScrollHander:function(a){this.renderData.hScrollBarEnabled&&a.altKey?this.scrollViewHorizontal(0<a.wheelDelta?-1:1):this.scrollView(0<a.wheelDelta?-1:1);z.stop(a)},refreshRendering:function(){if(this._initialized){this._validateProperties();var a=this.renderData,b=this._createRenderData();this.renderData=b;this._createRendering(b,a);this._layoutDecorationRenderers(b);this._layoutRenderers(b)}},_createRendering:function(a,b){q.set(this.sheetContainer,
"height",a.sheetHeight+"px");this._configureVisibleParts(a);this._configureScrollBar(a);this._buildColumnHeader(a,b);this._buildSubColumnHeader(a,b);this._buildRowHeader(a,b);this._buildGrid(a,b);this._buildItemContainer(a,b);this._layoutTimeIndicator(a);this._commitProperties(a)},_configureVisibleParts:function(a){this.secondarySheetNode&&q.set(this.secondarySheetNode,"display",this._showSecondarySheet?"block":"none");p[null==this.subColumns?"remove":"add"](this.domNode,"subColumns");p[this._showSecondarySheet?
"add":"remove"](this.domNode,"secondarySheet")},_commitProperties:function(a){this._startTimeOfDayInvalidated&&(this._startTimeOfDayInvalidated=!1,a=this.startTimeOfDay,null!=a&&this._setStartTimeOfDay(a.hours,void 0==a.minutes?0:a.minutes))},_configureScrollBar:function(a){D("ie")&&this.scrollBar&&q.set(this.vScrollBar,"width",a.scrollbarWidth+1+"px");var b=this.isLeftToRight()?!0:"right"==this.scrollBarRTLPosition,c=b?"right":"left",d=b?"left":"right";this.scrollBar&&(this.scrollBar.set("maximum",
a.sheetHeight),q.set(this.vScrollBar,c,0),q.set(this.vScrollBar,b?"left":"right","auto"),q.set(this.vScrollBar,"bottom",a.hScrollBarEnabled?a.scrollbarHeight+"px":"0"));q.set(this.scrollContainer,c,a.scrollbarWidth+"px");q.set(this.scrollContainer,d,"0");q.set(this.header,c,a.scrollbarWidth+"px");q.set(this.header,d,"0");q.set(this.subHeader,c,a.scrollbarWidth+"px");q.set(this.subHeader,d,"0");this.buttonContainer&&null!=this.owner&&this.owner.currentView==this&&(q.set(this.buttonContainer,c,a.scrollbarWidth+
"px"),q.set(this.buttonContainer,d,"0"));this.hScrollBar&&(C.forEach(this._hScrollNodes,function(e){p[a.hScrollBarEnabled?"add":"remove"](e.parentNode,"dojoxCalendarHorizontalScroll")},this),a.hScrollBarEnabled||(this._setHScrollPosition(0),this.hScrollBarW.set("value",0)),q.set(this.hScrollBar,{display:a.hScrollBarEnabled?"block":"none",height:a.scrollbarHeight+"px",left:(b?a.rowHeaderWidth:a.scrollbarWidth)+"px",right:(b?a.scrollbarWidth:a.rowHeaderWidth)+"px"}),q.set(this.scrollContainer,"bottom",
a.hScrollBarEnabled?a.scrollbarHeight+1+"px":"0"),this._configureHScrollDomNodes(a.hScrollBarEnabled?a.minSheetWidth+"px":"100%"),this.hScrollBarW.set("maximum",a.minSheetWidth),this.hScrollBarW.set("containerSize",a.hScrollPaneWidth))},_configureHScrollDomNodes:function(a){C.forEach(this._hScrollNodes,function(b){q.set(b,"width",a)},this)},resize:function(a){this._resizeHandler(a)},_resizeHandler:function(a,b){var c=this.renderData;null!=c&&(b?(b=B.getMarginBox(this.grid).w,c.hScrollPaneWidth!=b&&
(c.hScrollPaneWidth=b,c.minSheetWidth=0>this.minColumnWidth?-1:this.minColumnWidth*c.subColumnCount*c.columnCount,c.hScrollBarEnabled=0<this.minColumnWidth&&B.getMarginBox(this.grid).w<c.minSheetWidth),this._configureScrollBar(c)):(void 0!=this._resizeTimer&&clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(x.hitch(this,function(){this._resizeHandler(a,!0)}),100)))},_columnHeaderClick:function(a){z.stop(a);var b=t("td",this.columnHeaderTable).indexOf(a.currentTarget);this._onColumnHeaderClick({index:b,
date:this.renderData.dates[b],triggerEvent:a})},_buildColumnHeader:function(a,b){var c=this.columnHeaderTable;if(c){b=a.columnCount-(b?b.columnCount:0);8==D("ie")&&(null==this._colTableSave?this._colTableSave=x.clone(c):0>b&&(this._cleanupColumnHeader(),this.columnHeader.removeChild(c),r.destroy(c),this.columnHeaderTable=c=x.clone(this._colTableSave),this.columnHeader.appendChild(c),b=a.columnCount));var d=t("tbody",c),e=t("tr",c);d=1==d.length?d[0]:F.create("tbody",null,c);e=1==e.length?e[0]:r.create("tr",
null,d);if(0<b)for(d=0;d<b;d++){var g=r.create("td",null,e);var h=[];h.push(A(g,"click",x.hitch(this,this._columnHeaderClick)));D("touch-events")?(h.push(A(g,"touchstart",function(f){z.stop(f);p.add(f.currentTarget,"Active")})),h.push(A(g,"touchend",function(f){z.stop(f);p.remove(f.currentTarget,"Active")}))):(h.push(A(g,"mousedown",function(f){z.stop(f);p.add(f.currentTarget,"Active")})),h.push(A(g,"mouseup",function(f){z.stop(f);p.remove(f.currentTarget,"Active")})),h.push(A(g,"mouseover",function(f){z.stop(f);
p.add(f.currentTarget,"Hover")})),h.push(A(g,"mouseout",function(f){z.stop(f);p.remove(f.currentTarget,"Hover")})));this._columnHeaderHandlers.push(h)}else for(b=-b,d=0;d<b;d++)for(g=e.lastChild,e.removeChild(g),r.destroy(g),g=this._columnHeaderHandlers.pop();0<g.length;)g.pop().remove();t("td",c).forEach(function(f,k){f.className="";0==k?p.add(f,"first-child"):k==this.renderData.columnCount-1&&p.add(f,"last-child");k=a.dates[k];this._setText(f,this._formatColumnHeaderLabel(k));this.styleColumnHeaderCell(f,
k,a)},this);this.yearColumnHeaderContent&&this._setText(this.yearColumnHeaderContent,a.dateLocaleModule.format(a.dates[0],{selector:"date",datePattern:"yyyy"}))}},_cleanupColumnHeader:function(){for(;0<this._columnHeaderHandlers.length;)for(var a=this._columnHeaderHandlers.pop();0<a.length;)a.pop().remove()},styleColumnHeaderCell:function(a,b,c){p.add(a,this._cssDays[b.getDay()]);this.isToday(b)?p.add(a,"dojoxCalendarToday"):this.isWeekEnd(b)&&p.add(a,"dojoxCalendarWeekend")},_buildSubColumnHeader:function(a,
b){if((b=this.subColumnHeaderTable)&&null!=this.subColumns){var c=a.columnCount-t("td",b).length;8==D("ie")&&(null==this._colSubTableSave?this._colSubTableSave=x.clone(b):0>c&&(this.subColumnHeader.removeChild(b),r.destroy(b),this.subColumnHeaderTable=b=x.clone(this._colSubTableSave),this.subColumnHeader.appendChild(b),c=a.columnCount));var d=t("\x3etbody",b);d=1==d.length?d[0]:F.create("tbody",null,b);var e=t("\x3etr",d);d=1==e.length?e[0]:r.create("tr",null,d);var g=a.subColumnCount;if(0<c)for(var h=
0;h<c;h++)e=r.create("td",null,d),r.create("div",{className:"dojoxCalendarSubHeaderContainer"},e);else for(c=-c,h=0;h<c;h++)e=d.lastChild,d.removeChild(e),r.destroy(e);t("td",b).forEach(function(f,k){f.className="";0==k?p.add(f,"first-child"):k==this.renderData.columnCount-1&&p.add(f,"last-child");t(".dojoxCalendarSubHeaderContainer",f).forEach(function(n,m){if(0!=t(".dojoxCalendarSubHeaderContainer",n).length-g){var l=n.childNodes.length;for(m=0;m<l;m++)n.removeChild(n.lastChild);for(m=0;m<g;m++)r.create("div",
{className:"dojoxCalendarSubHeaderCell dojoxCalendarSubHeaderLabel"},n)}var v=100/g+"%";t(".dojoxCalendarSubHeaderCell",n).forEach(function(u,w){u.className="dojoxCalendarSubHeaderCell dojoxCalendarSubHeaderLabel";var y=1==g?w:Math.floor(w/g);subColIdx=1==g?0:w-y*g;q.set(u,{width:v,left:100*subColIdx/g+"%"});p[subColIdx<g-1&&1!==g?"add":"remove"](u,"subColumn");p.add(u,this.subColumns[subColIdx]);this._setText(u,this.subColumnLabelFunc(this.subColumns[subColIdx]))},this)},this);this.styleSubColumnHeaderCell(f,
a.dates[k],a)},this)}},subColumnLabelFunc:function(a){return a},styleSubColumnHeaderCell:function(a,b,c){p.add(a,this._cssDays[b.getDay()]);this.isToday(b)?p.add(a,"dojoxCalendarToday"):this.isWeekEnd(b)&&p.add(a,"dojoxCalendarWeekend")},_addMinutesClasses:function(a,b){switch(b){case 0:p.add(a,"hour");break;case 30:p.add(a,"halfhour");break;case 15:case 45:p.add(a,"quarterhour")}},_buildRowHeader:function(a,b){var c=this.rowHeaderTable;if(c){null==this._rowHeaderLabelContainer&&(this._rowHeaderLabelContainer=
r.create("div",{"class":"dojoxCalendarRowHeaderLabelContainer"},this.rowHeader));q.set(c,"height",a.sheetHeight+"px");var d=t("tbody",c);var e=1==d.length?d[0]:r.create("tbody",null,c);b=Math.floor(60/a.rowHeaderGridSlotDuration)*a.hourCount-(b?Math.floor(60/b.rowHeaderGridSlotDuration)*b.hourCount:0);if(0<b)for(d=0;d<b;d++){var g=r.create("tr",null,e);r.create("td",null,g)}else for(b=-b,d=0;d<b;d++)e.removeChild(e.lastChild);var h=this.renderData,f=Math.ceil(a.hourSize/(60/a.rowHeaderGridSlotDuration)),
k=new Date(2E3,0,1,0,0,0);t("tr",c).forEach(function(n,m){var l=t("td",n)[0];l.className="";q.set(n,"height",7==D("ie")?f-60/a.rowHeaderGridSlotDuration*2:f+"px");n=m*this.renderData.rowHeaderGridSlotDuration%60;this.styleRowHeaderCell(l,a.minHours+m*this.renderData.rowHeaderGridSlotDuration/60,n,h);this._addMinutesClasses(l,n)},this);c=this._rowHeaderLabelContainer;b=Math.floor(60/this.rowHeaderLabelSlotDuration)*a.hourCount-c.childNodes.length;if(0<b)for(d=0;d<b;d++)e=r.create("span",null,c),p.add(e,
"dojoxCalendarRowHeaderLabel");else for(b=-b,d=0;d<b;d++)c.removeChild(c.lastChild);f=Math.ceil(a.hourSize/(60/this.rowHeaderLabelSlotDuration));t("\x3espan",c).forEach(function(n,m){k.setHours(0);k.setMinutes(60*a.minHours+m*this.rowHeaderLabelSlotDuration);this._configureRowHeaderLabel(n,k,m,f*m,h)},this)}},_configureRowHeaderLabel:function(a,b,c,d,e){this._setText(a,this._formatRowHeaderLabel(b));q.set(a,"top",d+(0==c?this.rowHeaderFirstLabelOffset:this.rowHeaderLabelOffset)+"px");b=e.minHours+
c*this.rowHeaderLabelSlotDuration/60;c=c*this.rowHeaderLabelSlotDuration%60;p.remove(a,["hour","halfhour","quarterhour"]);this._addMinutesClasses(a,c);this.styleRowHeaderCell(a,b,c,e)},styleRowHeaderCell:function(a,b,c,d){},_buildGrid:function(a,b){var c=this.gridTable;if(c){q.set(c,"height",a.sheetHeight+"px");var d=Math.floor(60/a.slotDuration)*a.hourCount,e=d-(b?Math.floor(60/b.slotDuration)*b.hourCount:0),g=0<e,h=a.columnCount-(b?b.columnCount:0);8==D("ie")&&(null==this._gridTableSave?this._gridTableSave=
x.clone(c):0>h&&(this.grid.removeChild(c),r.destroy(c),this.gridTable=c=x.clone(this._gridTableSave),this.grid.appendChild(c),h=a.columnCount,e=d,g=!0));b=t("tbody",c);b=1==b.length?b[0]:r.create("tbody",null,c);if(g)for(var f=0;f<e;f++)r.create("tr",null,b);else for(e=-e,f=0;f<e;f++)b.removeChild(b.lastChild);var k=Math.floor(60/a.slotDuration)*a.hourCount-e,n=g||0<h;h=n?h:-h;t("tr",c).forEach(function(m,l){if(n){var v=l>=k?a.columnCount:h;for(l=0;l<v;l++)r.create("td",null,m)}else for(l=0;l<h;l++)m.removeChild(m.lastChild)});
t("tr",c).forEach(function(m,l){q.set(m,"height",a.slotSize+"px");0==l?p.add(m,"first-child"):l==d-1&&p.add(m,"last-child");var v=l*this.renderData.slotDuration%60,u=this.minHours+Math.floor(l*this.renderData.slotDuration/60);t("td",m).forEach(function(w,y){w.className="";0==y?p.add(w,"first-child"):y==this.renderData.columnCount-1&&p.add(w,"last-child");this.styleGridCell(w,a.dates[y],u,v,a);this._addMinutesClasses(w,v)},this)},this)}},styleGridCellFunc:null,defaultStyleGridCell:function(a,b,c,d,
e){p.add(a,[this._cssDays[b.getDay()],"H"+c,"M"+d]);if(this.isToday(b))return p.add(a,"dojoxCalendarToday");if(this.isWeekEnd(b))return p.add(a,"dojoxCalendarWeekend")},styleGridCell:function(a,b,c,d,e){this.styleGridCellFunc?this.styleGridCellFunc(a,b,c,d,e):this.defaultStyleGridCell(a,b,c,d,e)},_buildItemContainer:function(a,b){var c=this.itemContainerTable;if(c){var d=[],e=[];q.set(c,"height",a.sheetHeight+"px");b=a.columnCount-(b?b.columnCount:0);8==D("ie")&&(null==this._itemTableSave?this._itemTableSave=
x.clone(c):0>b&&(this.itemContainer.removeChild(c),this._recycleItemRenderers(!0),r.destroy(c),this.itemContainerTable=c=x.clone(this._itemTableSave),this.itemContainer.appendChild(c),b=a.columnCount));var g=t("tbody",c),h=t("tr",c);g=1==g.length?g[0]:r.create("tbody",null,c);h=1==h.length?h[0]:r.create("tr",null,g);var f=a.subColumnCount;if(0<b)for(var k=0;k<b;k++)g=r.create("td",null,h),r.create("div",{className:"dojoxCalendarContainerColumn"},g);else for(b=-b,k=0;k<b;k++)h.removeChild(h.lastChild);
t("td",c).forEach(function(n,m){t(".dojoxCalendarContainerColumn",n).forEach(function(v,u){q.set(v,"height",a.sheetHeight+"px");if(0!=t(".dojoxCalendarSubContainerColumn",n).length-f){var w=v.childNodes.length;for(u=0;u<w;u++)v.removeChild(v.lastChild);for(u=0;u<f;u++)w=r.create("div",{className:"dojoxCalendarSubContainerColumn"},v),r.create("div",{className:"dojoxCalendarDecorationContainerColumn"},w),r.create("div",{className:"dojoxCalendarEventContainerColumn"},w)}},this);var l=100/f+"%";t(".dojoxCalendarSubContainerColumn",
n).forEach(function(v,u){var w=1==f?u:Math.floor(u/f);subColIdx=1==f?0:u-w*f;q.set(v,{width:l,left:100*subColIdx/f+"%"});p[subColIdx<f-1&&1!==f?"add":"remove"](v,"subColumn");t(".dojoxCalendarEventContainerColumn",v).forEach(function(y,N){d.push(y)},this);t(".dojoxCalendarDecorationContainerColumn",v).forEach(function(y,N){e.push(y)},this)},this)},this);a.cells=d;a.decorationCells=e}},showTimeIndicator:!0,timeIndicatorRefreshInterval:6E4,_setShowTimeIndicatorAttr:function(a){this._set("showTimeIndicator",
a);this._layoutTimeIndicator(this.renderData)},_layoutTimeIndicator:function(a){if(a){if(this.showTimeIndicator){var b=new a.dateClassObj;if(this.isOverlapping(a,a.startTime,a.endTime,b,b)&&b.getHours()>=this.get("minHours")&&60*b.getHours()+b.getMinutes()<60*this.get("maxHours")){this._timeIndicator||(this._timeIndicator=r.create("div",{className:"dojoxCalendarTimeIndicator"}));for(var c=this._timeIndicator,d=0;d<this.renderData.columnCount&&!this.isSameDay(b,this.renderData.dates[d]);d++);b=this.computeProjectionOnDate(a,
this.floorToDay(b),b,a.sheetHeight);if(b!=a.sheetHeight){q.set(c,{top:b+"px",display:"block"});a=a.cells[d*a.subColumnCount].parentNode.parentNode;a!=c.parentNode&&(null!=c.parentNode&&c.parentNode.removeChild(c),a.appendChild(c));null==this._timeIndicatorTimer&&(this._timeIndicatorTimer=setInterval(x.hitch(this,function(){this._layoutTimeIndicator(this.renderData)}),this.timeIndicatorRefreshInterval));return}}}this._timeIndicatorTimer&&(clearInterval(this._timeIndicatorTimer),this._timeIndicatorTimer=
null);this._timeIndicator&&q.set(this._timeIndicator,"display","none")}},beforeDeactivate:function(){this._timeIndicatorTimer&&(clearInterval(this._timeIndicatorTimer),this._timeIndicatorTimer=null)},_overlapLayoutPass2:function(a){var b,c;var d=a[a.length-1];for(c=0;c<d.length;c++)d[c].extent=1;for(b=0;b<a.length-1;b++)for(d=a[b],c=0;c<d.length;c++){var e=d[c];if(-1==e.extent){e.extent=1;for(var g=0,h=!1,f=b+1;f<a.length&&!h;f++){for(var k=a[f],n=0;n<k.length&&!h;n++){var m=k[n];e.start<m.end&&m.start<
e.end&&(h=!0)}h||g++}e.extent+=g}}},_defaultItemToRendererKindFunc:function(a){return"vertical"},_layoutInterval:function(a,b,c,d,e,g){var h=[];a.colW=this.itemContainer.offsetWidth/a.columnCount;if("dataItems"===g){for(var f=0;f<e.length;f++){var k=e[f];"vertical"===this._itemToRendererKind(k)&&h.push(k)}this._layoutRendererWithSubColumns(a,"vertical",!0,b,c,d,h,g)}else this._layoutRendererWithSubColumns(a,"decoration",!1,b,c,d,e,g)},_layoutRendererWithSubColumns:function(a,b,c,d,e,g,h,f){if(0<h.length)if(1<
a.subColumnCount){var k={},n=this.subColumns;C.forEach(n,function(l){k[l]=[]});C.forEach(h,function(l){"decorationItems"===f?l.subColumn?k[l.subColumn]&&k[l.subColumn].push(l):C.forEach(n,function(v){var u=x.mixin({},l);u.subColumn=v;k[v].push(u)}):l.subColumn&&k[l.subColumn]&&k[l.subColumn].push(l)});var m=0;C.forEach(this.subColumns,function(l){this._layoutVerticalItems(a,b,c,d,m++,e,g,k[l],f)},this)}else this._layoutVerticalItems(a,b,c,d,0,e,g,h,f)},_getColumn:function(a,b,c,d){return("dataItems"===
d?a.cells:a.decorationCells)[b*a.subColumnCount+c]},_layoutVerticalItems:function(a,b,c,d,e,g,h,f,k){if(!("dataItems"===k&&null==this.verticalRenderer||"decorationItems"===k&&null==this.verticalDecorationRenderer)){b=this._getColumn(a,d,e,k);c=[];for(d=0;d<f.length;d++){e=f[d];var n=this.computeRangeOverlap(a,e.startTime,e.endTime,g,h),m=this.computeProjectionOnDate(a,g,n[0],a.sheetHeight),l=this.computeProjectionOnDate(a,g,n[1],a.sheetHeight);l>m&&(e=x.mixin({start:m,end:l,range:n,item:e},e),c.push(e))}g=
"dataItems"===k?this.computeOverlapping(c,this._overlapLayoutPass2).numLanes:1;h=this.percentOverlap/100;for(d=0;d<c.length;d++){e=c[d];if("dataItems"===k){n=e.lane;m=e.extent;0==h?(f=1==g?a.colW:(a.colW-(g-1)*this.horizontalGap)/g,n*=f+this.horizontalGap,f=1==m?f:f*m+(m-1)*this.horizontalGap,f=100*f/a.colW,n=100*n/a.colW):(f=1==g?100:100/(g-(g-1)*h),n*=f-h*f,f=1==m?f:f*(m-(m-1)*h));m=this._createRenderer(e,"vertical",this.verticalRenderer,"dojoxCalendarVertical");var v=this.isItemBeingEdited(e),
u=this.isItemSelected(e),w=this.isItemHovered(e),y=this.isItemFocused(e);l=m.renderer;l.set("hovered",w);l.set("selected",u);l.set("edited",v);l.set("focused",this.showFocus?y:!1);l.set("storeState",this.getItemStoreState(e));l.set("moveEnabled",this.isItemMoveEnabled(e._item,"vertical"));l.set("resizeEnabled",this.isItemResizeEnabled(e._item,"vertical"));this.applyRendererZIndex(e,m,w,u,v,y)}else f=100,n=0,m=this.decorationRendererManager.createRenderer(e,"vertical",this.verticalDecorationRenderer,
"dojoxCalendarDecoration"),l=m.renderer;q.set(m.container,{top:e.start+"px",left:n+"%",width:f+"%",height:e.end-e.start+1+"px"});l.updateRendering&&l.updateRendering(f,e.end-e.start+1);r.place(m.container,b);q.set(m.container,"display","block")}}},_sortItemsFunction:function(a,b){var c=this.dateModule.compare(a.startTime,b.startTime);0==c&&(c=-1*this.dateModule.compare(a.endTime,b.endTime));return this.isLeftToRight()?c:-c},_getNormalizedCoords:function(a,b,c,d){null!=a&&(c=B.position(this.itemContainer,
!0),a.touches?(d=void 0==d?0:d,b=a.touches[d].pageX-c.x,c=a.touches[d].pageY-c.y):(b=a.pageX-c.x,c=a.pageY-c.y));a=B.getContentBox(this.itemContainer);this.isLeftToRight()||(b=a.w-b);0>b?b=0:b>a.w&&(b=a.w-1);0>c?c=0:c>a.h&&(c=a.h-1);return{x:b,y:c}},getTime:function(a,b,c,d){b=this._getNormalizedCoords(a,b,c,d);a=this.getTimeOfDay(b.y,this.renderData);c=B.getMarginBox(this.itemContainer).w/this.renderData.columnCount;b=Math.floor(b.x/c);c=null;b<this.renderData.dates.length&&(c=this.newDate(this.renderData.dates[b]),
c=this.floorToDay(c,!0),c.setHours(a.hours),c.setMinutes(a.minutes));return c},getSubColumn:function(a,b,c,d){if(null==this.subColumns||1==this.subColumns.length)return null;a=this._getNormalizedCoords(a,b,c,d);b=this.renderData;c=B.getMarginBox(this.itemContainer).w/this.renderData.columnCount;return this.subColumns[Math.floor((a.x-Math.floor(a.x/c)*c)/(c/b.subColumnCount))]},_onGridMouseUp:function(a){this.inherited(arguments);this._gridMouseDown&&(this._gridMouseDown=!1,this._onGridClick({date:this.getTime(a),
triggerEvent:a}))},_onGridTouchStart:function(a){this.inherited(arguments);var b=this._gridProps;b.moved=!1;b.start=a.touches[0].screenY;b.scrollTop=this._getScrollPosition()},_onGridTouchMove:function(a){this.inherited(arguments);if(1<a.touches.length&&!this._isEditing)z.stop(a);else if(this._gridProps&&!this._isEditing){var b=a.touches[0].screenX,c=a.touches[0].screenY,d=this._edProps;if(!d||d&&(25<Math.abs(b-d.start.x)||25<Math.abs(c-d.start.y)))this._gridProps.moved=!0,b=this._gridProps.scrollTop-
(a.touches[0].screenY-this._gridProps.start),c=this.itemContainer.offsetHeight-this.scrollContainer.offsetHeight,0>b?(this._gridProps.start=a.touches[0].screenY,this._setScrollImpl(0),this._gridProps.scrollTop=0):b>c?(this._gridProps.start=a.touches[0].screenY,this._setScrollImpl(c),this._gridProps.scrollTop=c):this._setScrollImpl(b)}},_onGridTouchEnd:function(a){this.inherited(arguments);var b=this._gridProps;b&&(this._isEditing||b.moved||(b.fromItem||b.editingOnStart||this.selectFromEvent(a,null,
null,!0),b.fromItem||(this._pendingDoubleTap&&this._pendingDoubleTap.grid?(this._onGridDoubleClick({date:this.getTime(this._gridProps.event),triggerEvent:this._gridProps.event}),clearTimeout(this._pendingDoubleTap.timer),delete this._pendingDoubleTap):(this._onGridClick({date:this.getTime(this._gridProps.event),triggerEvent:this._gridProps.event}),this._pendingDoubleTap={grid:!0,timer:setTimeout(x.hitch(this,function(){delete this._pendingDoubleTap}),this.doubleTapDelay)}))),this._gridProps=null)},
_onColumnHeaderClick:function(a){this._dispatchCalendarEvt(a,"onColumnHeaderClick")},onColumnHeaderClick:function(a){},getTimeOfDay:function(a,b){var c=60*b.minHours;a=c+a*(60*b.maxHours-c)/b.sheetHeight;return{hours:Math.floor(a/60),minutes:Math.floor(a%60)}},_isItemInView:function(a){var b=this.inherited(arguments);if(b){var c=this.renderData;if(c.dateModule.difference(a.startTime,a.endTime,"millisecond")>36E5*(24-c.maxHours+c.minHours))return!0;var d=60*a.startTime.getHours()+a.startTime.getMinutes(),
e=60*a.endTime.getHours()+a.endTime.getMinutes(),g=60*c.minHours;c=60*c.maxHours;if(0<d&&d<g||d>c&&1440>=d||0<e&&e<g||e>c&&1440>=e)return!1}return b},_ensureItemInView:function(a){var b=a.startTime,c=a.endTime,d=this.renderData,e=d.dateModule,g=Math.abs(e.difference(a.startTime,a.endTime,"millisecond"));if(g>36E5*(24-d.maxHours+d.minHours))return!1;b=60*b.getHours()+b.getMinutes();c=60*c.getHours()+c.getMinutes();var h=60*d.minHours,f=60*d.maxHours;if(0<b&&b<h){this.floorToDay(a.startTime,!0,d);a.startTime.setHours(d.minHours);
a.endTime=e.add(a.startTime,"millisecond",g);var k=!0}else b>f&&1440>=b&&(this.floorToDay(a.startTime,!0,d),a.startTime=e.add(a.startTime,"day",1),a.startTime.setHours(d.minHours),a.endTime=e.add(a.startTime,"millisecond",g),k=!0);0<c&&c<h?(this.floorToDay(a.endTime,!0,d),a.endTime=e.add(a.endTime,"day",-1),a.endTime.setHours(d.maxHours),a.startTime=e.add(a.endTime,"millisecond",-g),k=!0):c>f&&1440>=c&&(this.floorToDay(a.endTime,!0,d),a.endTime.setHours(d.maxHours),a.startTime=e.add(a.endTime,"millisecond",
-g),k=!0);return k=k||this.inherited(arguments)},_onScrollTimer_tick:function(){this._scrollToPosition(this._getScrollPosition()+this._scrollProps.scrollStep)},snapUnit:"minute",snapSteps:15,minDurationUnit:"minute",minDurationSteps:15,liveLayout:!1,stayInView:!0,allowStartEndSwap:!0,allowResizeLessThan24H:!0})});