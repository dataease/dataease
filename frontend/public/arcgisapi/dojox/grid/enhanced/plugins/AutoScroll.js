//>>built
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/_base/window ../_Plugin ../../_RowSelector ../../EnhancedGrid".split(" "),function(l,q,r,k,t,u,v,w){l=l("dojox.grid.enhanced.plugins.AutoScroll",u,{name:"autoScroll",autoScrollInterval:1E3,autoScrollMargin:30,constructor:function(b,a){this.grid=b;this._scrolling=this.readyForAutoScroll=!1;a=r.isObject(a)?a:{};"interval"in a&&(this.autoScrollInterval=a.interval);"margin"in a&&(this.autoScrollMargin=a.margin);this._initEvents();
this._mixinGrid()},_initEvents:function(){var b=this.grid;this.connect(b,"onCellMouseDown",function(){this.readyForAutoScroll=!0});this.connect(b,"onHeaderCellMouseDown",function(){this.readyForAutoScroll=!0});this.connect(b,"onRowSelectorMouseDown",function(){this.readyForAutoScroll=!0});this.connect(t.doc,"onmouseup",function(a){this._manageAutoScroll(!0);this.readyForAutoScroll=!1});this.connect(t.doc,"onmousemove",function(a){if(this.readyForAutoScroll){this._event=a;var c=k.position(b.domNode),
g=b._getHeaderHeight(),f=this.autoScrollMargin,d=a.clientY,e=a.clientX;a=c.y;var m=c.x,p=c.h;c=c.w;if(e>=m&&e<=m+c){if(d>=a+g&&d<a+g+f){this._manageAutoScroll(!1,!0,!1);return}if(d>a+p-f&&d<=a+p){this._manageAutoScroll(!1,!0,!0);return}if(d>=a&&d<=a+p&&q.some(b.views.views,function(n,h){if(n instanceof v)return!1;h=k.position(n.domNode);return e<h.x+f&&e>=h.x?(this._manageAutoScroll(!1,!1,!1,n),!0):e>h.x+h.w-f&&e<h.x+h.w?(this._manageAutoScroll(!1,!1,!0,n),!0):!1},this))return}this._manageAutoScroll(!0)}})},
_mixinGrid:function(){var b=this.grid;b.onStartAutoScroll=function(){};b.onEndAutoScroll=function(){}},_fireEvent:function(b,a){var c=this.grid;switch(b){case "start":c.onStartAutoScroll.apply(c,a);break;case "end":c.onEndAutoScroll.apply(c,a)}},_manageAutoScroll:function(b,a,c,g){b?(this._scrolling=!1,clearInterval(this._handler)):this._scrolling||(this._scrolling=!0,this._fireEvent("start",[a,c,g]),this._autoScroll(a,c,g),this._handler=setInterval(r.hitch(this,"_autoScroll",a,c,g),this.autoScrollInterval))},
_autoScroll:function(b,a,c){var g=this.grid,f=null;if(b){var d=g.scroller.firstVisibleRow+(a?1:-1);0<=d&&d<g.rowCount&&(g.scrollToRow(d),f=d)}else f=this._scrollColumn(a,c);null!==f&&this._fireEvent("end",[b,a,c,f,this._event])},_scrollColumn:function(b,a){var c=a.scrollboxNode,g=null;if(c.clientWidth<c.scrollWidth){var f=q.filter(this.grid.layout.cells,function(m){return!m.hidden});a=k.position(a.domNode);var d;if(b)for(b=c.clientWidth,d=0;d<f.length;++d){var e=k.position(f[d].getHeaderNode());e=
e.x-a.x+e.w;if(e>b){g=f[d].index;c.scrollLeft+=e-b+10;break}}else for(b=0,d=f.length-1;0<=d;--d)if(e=k.position(f[d].getHeaderNode()),e=e.x-a.x,e<b){g=f[d].index;c.scrollLeft+=e-b-10;break}}return g}});w.registerPlugin(l);return l});