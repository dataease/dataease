//>>built
define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./getStateful","./ModelRefController"],function(k,f,g,h,l){return k("dojox.mvc.StoreRefController",l,{store:null,getStatefulOptions:null,_refSourceModelProp:"model",queryStore:function(a,b){if((this.store||{}).query){this._queryObserveHandle&&this._queryObserveHandle.cancel();var d=this;a=this.store.query(a,b);b=g(a,function(e){if(!d._beingDestroyed)return e=h(e,d.getStatefulOptions),d.set(d._refSourceModelProp,e),e});b.then&&(b=f.delegate(b));
for(var c in a)isNaN(c)&&a.hasOwnProperty(c)&&f.isFunction(a[c])&&(b[c]=a[c]);return b}},getStore:function(a,b){if((this.store||{}).get){this._queryObserveHandle&&this._queryObserveHandle.cancel();var d=this;return result=g(this.store.get(a,b),function(c){if(!d._beingDestroyed)return c=h(c,d.getStatefulOptions),d.set(d._refSourceModelProp,c),c})}},putStore:function(a,b){if((this.store||{}).put)return this.store.put(a,b)},addStore:function(a,b){if((this.store||{}).add)return this.store.add(a,b)},removeStore:function(a,
b){if((this.store||{}).remove)return this.store.remove(a,b)}})});