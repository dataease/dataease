/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import"../chunks/ArrayPool.js";import"../chunks/object.js";import"../chunks/deprecate.js";import"../core/lang.js";import"../config.js";import{L as r,i as e,b as o,g as s}from"../chunks/Logger.js";import"../chunks/string.js";import"../chunks/metadata.js";import{property as a}from"../core/accessorSupport/decorators/property.js";import p from"../core/Accessor.js";import"../chunks/PropertyOrigin.js";import"../core/scheduling.js";import"../core/promiseUtils.js";import"../chunks/Message.js";import i from"../core/Error.js";import"../chunks/ensureType.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import{isAbsolute as c,makeRelative as n}from"../core/urlUtils.js";import{cast as m}from"../core/accessorSupport/decorators/cast.js";import"../chunks/resourceExtension.js";const u=r.getLogger("esri.portal.PortalItemResource");let h=class extends p{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t&&t.portalItem&&t.path?{...t,path:this.normalizePath(t.path,t.portalItem)}:t}set path(t){e(t)&&c(t)?u.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return this.normalizePath(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",r){const e=this.url;if(o(e))throw new i("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(e,{responseType:t,signal:s(r,"signal")})}async update(t,r){return(await import("../chunks/resourceUtils.js")).addOrUpdateResource(this,"update",t,r)}hasPath(){return e(this.path)}normalizePath(t,r){return o(t)?t:(t=t.replace(/^\/+/,""),e(r)&&c(t)&&(t=n(t,r.itemUrl)),t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};t([a()],h.prototype,"portalItem",void 0),t([a({type:String,value:null})],h.prototype,"path",null),t([m("path")],h.prototype,"_castPath",null),t([a({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],h.prototype,"url",null),t([a({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],h.prototype,"itemRelativeUrl",null),h=t([l("esri.portal.PortalItemResource")],h);var j=h;export default j;
