// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../core/Logger ../../../chunks/vec3f64 ../../../chunks/vec3 ../../projectionEllipsoid ../../../chunks/mat4 ../../projection ../../../chunks/mat3f64 ../../../chunks/mat4f64 ../../../chunks/quatf64 ../../../chunks/vec4f64 ../../../chunks/mat3 ./projection ../../../chunks/quat".split(" "),function(q,E,w,x,F,A,r,G,H,B,I,J,h,t){function k(a,d,b,e=w.ZEROS){if(a)for(A.identity(l),A.rotate(l,l,d[3],d),d=0;d<a.length;d+=b){for(var c=0;3>c;c++)u[c]=a[d+c]-e[c];x.transformMat4(u,u,l);for(c=
0;3>c;c++)a[d+c]=u[c]+e[c]}}const K=E.getLogger("esri.geometry.support.meshUtils.rotate"),u=w.create(),p=I.create(),v=B.create(),C=B.create(),l=H.create(),D=G.create(),f=w.create();q.axisAngleFrom=function(a,d,b){x.copy(b,a);b[3]=d;return b};q.axisAngleMultiply=function(a,d,b){t.setAxisAngle(v,a,a[3]);t.setAxisAngle(C,d,d[3]);t.multiply(v,C,v);b[3]=t.getAxisAngle(b,v);return b};q.rotate=function(a,d,b){if(a.vertexAttributes&&a.vertexAttributes.position&&0!==d[3]){var e=a.spatialReference,c=b&&b.origin||
a.extent.center;if(e.isWGS84||e.isWebMercator&&(!b||!1!==b.geographic)){{b=a.spatialReference;e=F.getSphericalPCPF(b);r.projectPointToVector(c,f,e)||r.projectPointToVector(a.extent.center,f,e);c=a.vertexAttributes.position;const m=a.vertexAttributes.normal,n=a.vertexAttributes.tangent,g=new Float64Array(c.length),y=new Float32Array(m?m.length:0),z=new Float32Array(n?n.length:0);r.computeLinearTransformation(e,f,l,e);J.fromMat4(D,l);x.transformMat3(p,d,D);p[3]=d[3];h.projectToECEF(c,b,g);m&&h.projectNormalToECEF(m,
c,g,b,y);n&&h.projectTangentToECEF(n,c,g,b,z);k(g,p,3,f);h.projectFromECEF(g,c,b);m&&(k(y,p,3),h.projectNormalFromECEF(y,c,g,b,m));n&&(k(z,p,4),h.projectTangentFromECEF(z,c,g,b,n));a.clearCache()}}else r.projectPointToVector(c,f,a.spatialReference)||(b=a.extent.center,f[0]=b.x,f[1]=b.y,f[2]=b.z,K.error(`Failed to project specified origin (wkid:${c.spatialReference.wkid}) to mesh spatial reference (wkid:${a.spatialReference.wkid}). Using mesh extent.center instead`)),k(a.vertexAttributes.position,
d,3,f),k(a.vertexAttributes.normal,d,3),k(a.vertexAttributes.tangent,d,4),a.clearCache()}};Object.defineProperty(q,"__esModule",{value:!0})});