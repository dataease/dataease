// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["exports","./coordsUtils","../../core/libs/earcut/earcut","./meshUtils/deduplicate"],function(u,y,z,A){function B(a,g,e){if(1===a.length)return a[0];g=new Float64Array(g);e=new Uint32Array(e);let c=0,b=0,l=0;for(const h of a){for(a=0;a<h.position.length;a++)g[c++]=h.position[a];for(a=0;a<h.faces.length;a++)e[b++]=h.faces[a]+l;l=c/3}return{position:g,faces:e}}function x(a,g,e){const c=a.length,b=Array(c),l=Array(c),h=Array(c);let k=0,m=0,r=0;var n=0;for(var f=0;f<c;++f)n+=a[f].length;n=new Float64Array(3*
n);f=0;for(let v=c-1;0<=v;v--){var d=a[v],p=1===e?!y.isClockwise(d,!1,!1):!1;if(p&&1!==c)b[k++]=d;else{var q=d.length;for(let w=0;w<k;++w)q+=b[w].length;q={index:f,pathLengths:Array(k+1),count:q,holeIndices:Array(k)};q.pathLengths[0]=d.length;0<d.length&&(h[r++]={index:f,count:d.length});f=p?t(d,d.length-1,-1,n,f,d.length,g):t(d,0,1,n,f,d.length,g);for(d=0;d<k;++d)p=b[d],q.holeIndices[d]=f,q.pathLengths[d+1]=p.length,0<p.length&&(h[r++]={index:f,count:p.length}),f=t(p,0,1,n,f,p.length,g);k=0;0<q.count&&
(l[m++]=q)}}for(a=0;a<k;++a)e=b[a],0<e.length&&(h[r++]={index:f,count:e.length}),f=t(e,0,1,n,f,e.length,g);m<c&&(l.length=m);r<c&&(h.length=r);return{position:n,polygons:l,outlines:h}}function t(a,g,e,c,b,l,h){b*=3;for(let k=0;k<l;++k){const m=a[g];c[b++]=m[0];c[b++]=m[1];c[b++]=h?m[2]:0;g+=e}return b/3}u.pathsToTriangulationInfo=x;u.triangulate=function(a){a=x(a.rings,a.hasZ,1);const g=[];let e=0,c=0;for(var b of a.polygons){const h=b.index,k=new Float64Array(a.position.buffer,3*h*a.position.BYTES_PER_ELEMENT,
3*b.count);var l=b.holeIndices.map(m=>m-h);l=new Uint32Array(z.earcut(k,l,3));g.push({position:k,faces:l});e+=k.length;c+=l.length}b=B(g,e,c);a=A.deduplicate(b.position.buffer,6,{originalIndices:b.faces});b.position=new Float64Array(a.buffer);b.faces=a.indices;return b};Object.defineProperty(u,"__esModule",{value:!0})});