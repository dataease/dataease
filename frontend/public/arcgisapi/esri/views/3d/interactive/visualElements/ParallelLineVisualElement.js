// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../core/Handles ../../../../chunks/mat4f64 ../../../../chunks/vec2 ../../../../chunks/vec4 ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Geometry ../../webgl-engine/shaders/RibbonLineTechnique ../../webgl-engine/materials/RibbonLineMaterial ../../../../chunks/vec4f32 ./Object3DVisualElement".split(" "),function(x,
y,q,n,f,g,G,z,c,A,B,C,H,I,J,w){w=function(D){function r(a){var b=D.call(this,a)||this;b._handles=new G;b._location=f.create();b._direction=f.fromValues(1,0,0);b._width=1;b._offset=1;b._length=18;b._color=J.fromValues(1,0,1,1);b._renderOccluded=4;b.applyProps(a);return b}y._inheritsLoose(r,D);var e=r.prototype;e.setDirectionFromPoints=function(a,b){g.normalize(this._direction,g.subtract(this._direction,b,a));this.updateGeometry()};e.createExternalResources=function(){const a=new I.RibbonLineMaterial(this.materialParameters,
"parallelLineVisualElement");this._handles.add(this.view.state.watch("camera",()=>{this.updateGeometry()}));this._externalResources={material:a}};e.destroyExternalResources=function(){this._handles.removeAll();this._externalResources=null};e.createGeometries=function(a){const b=new C(B.createPolylineGeometry([f.create(),f.create()]),"parallelLineVisualElement"),t=new C(B.createPolylineGeometry([f.create(),f.create()]),"parallelLineVisualElement"),h=q.unwrap(this._externalResources).material;a.addGeometry(b,
h,z.IDENTITY);a.addGeometry(t,h,z.IDENTITY);this.updateVertices(a)};e.forEachExternalResource=function(a){q.isSome(this._externalResources)&&a(this._externalResources.material)};e.updateMaterial=function(){q.isNone(this._externalResources)||this._externalResources.material.setParameterValues(this.materialParameters)};e.updateGeometry=function(){const a=this.object;q.isNone(a)||this.updateVertices(a)};e.updateVertices=function(a){const b=this.view.state.camera;b.projectToScreen(this.location,u);g.add(d,
this.location,this.direction);b.projectToScreen(d,k);c.normalize(k,c.subtract(k,k,u));this.updateVertexAttributes(b,a,0,u,k,1);this.updateVertexAttributes(b,a,1,u,k,-1)};e.updateVertexAttributes=function(a,b,t,h,l,p){const m=b.geometryRecords[t].geometry.data.getVertexAttr()[H.RibbonVertexAttributeConstants.POSITION].data;p=c.scale(E,c.set(E,l[1]*p,l[0]*-p),this.offset+this.width/2);h=c.add(v,c.add(v,c.add(v,h,c.scale(v,l,this.length/2)),p),p);l=c.add(F,h,c.scale(F,l,-this.length));a.unprojectFromScreen(h,
d);m[0]=d[0];m[1]=d[1];m[2]=d[2];a.unprojectFromScreen(l,d);m[3]=d[0];m[4]=d[1];m[5]=d[2];b.geometryVertexAttrsUpdated(t)};y._createClass(r,[{key:"location",get:function(){return this._location},set:function(a){g.exactEquals(this._location,a)||(g.copy(this._location,a),this.updateGeometry())}},{key:"direction",get:function(){return this._direction},set:function(a){g.exactEquals(this._direction,a)||(g.copy(this._direction,a),this.updateGeometry())}},{key:"width",get:function(){return this._width},
set:function(a){a!==this._width&&(this._width=a,this.updateMaterial())}},{key:"offset",get:function(){return this._offset},set:function(a){a!==this._offset&&(this._offset=a,this.updateGeometry())}},{key:"length",get:function(){return this._length},set:function(a){a!==this._length&&(this._length=a,this.updateGeometry())}},{key:"color",get:function(){return this._color},set:function(a){A.exactEquals(a,this._color)||(A.copy(this._color,a),this.updateMaterial())}},{key:"renderOccluded",get:function(){return this._renderOccluded},
set:function(a){a!==this._renderOccluded&&(this._renderOccluded=a,this.updateMaterial())}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}}]);return r}(w.Object3DVisualElement);const d=f.create(),u=n.createScreenPointArray(),k=n.createScreenPointArray(),E=n.createScreenPointArray(),v=n.createScreenPointArray(),F=n.createScreenPointArray();x.ParallelLineVisualElement=w;Object.defineProperty(x,"__esModule",{value:!0})});