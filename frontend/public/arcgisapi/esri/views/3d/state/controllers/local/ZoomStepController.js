// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/property ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/urlUtils ../../../../../core/uuid ../../../../../portal/support/resourceExtension ../../../../../chunks/vec3f64 ../../../../../chunks/vec3 ../../../../../support/featureFlags ../../../webgl-engine/lib/Intersector ../../../../animation/easing ../../../camera/constraintUtils ../../../webgl-engine/lib/Camera ../PointToPointAnimationController".split(" "),
function(f,p,q,y,z,A,B,C,r,D,E,F,g,d,t,u,v,w,m,x){f.ZoomStepController=function(n){function k(){var b=n.apply(this,arguments)||this;b.zoomLocation=g.create();b.tmpCamera=new m;b.tmpRayDir=g.create();b.tmpCenter=g.create();b.constraintOptions={selection:15,interactionType:1,interactionFactor:null,interactionStartCamera:new m,interactionDirection:null,tiltMode:0};return b}p._inheritsLoose(k,n);var l=k.prototype;l.zoomStep=function(b,c){if(this.active){var a=this.view.state,{interactionStartCamera:e}=
this.constraintOptions;this.animation.finished?e.copyFrom(a.camera):this.animation.cameraAt(1,e);this.tmpCamera.copyFrom(a.camera);a=new u.Intersector(this.view.state.mode);0<b?(this.intersectionHelper.intersectScreenFreePointFallback(c,this.zoomLocation),this.intersectionHelper.intersectRay(this.tmpCamera.ray,a,this.tmpCenter)&&(this.tmpCamera.center=this.tmpCenter)):this.intersectionHelper.intersectRay(this.tmpCamera.ray,a,this.zoomLocation)?this.tmpCamera.center=this.zoomLocation:d.copy(this.zoomLocation,
this.tmpCamera.center);b=Math.pow(.6,b);!t.disableContextNavigation()&&this.view._stage.getCamera()._contextNavigation&&(c=this.view._stage.renderView.getMinimalDepthForArea(c[0],c[1],this.view._stage.getCamera(),60),a=Math.max(14*Math.abs(this.view.camera.position.z),20),c=c?Math.min(c,a):a)&&(a=g.create(),d.subtract(a,this.zoomLocation,this.tmpCamera.eye),c<d.length(a)&&(d.normalize(a,a),d.add(this.zoomLocation,this.tmpCamera.eye,d.scale(a,a,c))));this.updateCamera(this.tmpCamera,b,this.zoomLocation);
this.begin(this.tmpCamera)}};l.animationSettings=function(){return{apex:null,duration:.6,easing:v.outExpo}};l.updateCamera=function(b,c,a){d.subtract(this.tmpRayDir,a,b.eye);const e=d.length(this.tmpRayDir);let h=e*c;1>=c&&4>h&&(h=4,c=h/e);1E-6>Math.abs(e-h)||(d.scale(this.tmpRayDir,this.tmpRayDir,c),d.subtract(b.eye,a,this.tmpRayDir),d.lerp(b.center,b.center,a,1-c),w.applyAll(this.view,b,this.constraintOptions))};return k}(x.PointToPointAnimationController);f.ZoomStepController=q.__decorate([r.subclass("esri.views.3d.state.controllers.local.ZoomStepController")],
f.ZoomStepController);Object.defineProperty(f,"__esModule",{value:!0})});