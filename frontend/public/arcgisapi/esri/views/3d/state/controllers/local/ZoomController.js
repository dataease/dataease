// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/property ../../../../../core/jsonMap ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/urlUtils ../../../../../core/uuid ../../../../../portal/support/resourceExtension ../../../../../core/mathUtils ../../../../../core/screenUtils ../../../../../chunks/vec3f64 ../../../../../chunks/vec3 ../../../../../chunks/vec2f64 ../../../../../chunks/vec2 ../../../support/geometryUtils ../../../camera/constraintUtils ../../utils/navigationUtils ../InteractiveController".split(" "),
function(e,m,n,B,C,D,w,E,x,F,G,H,y,z,d,b,p,q,r,t,k,A){e.ZoomController=function(u){function g(a){a=u.call(this,a)||this;a.view=null;a.tmpP=d.create();a.tmpDir=d.create();a.tmpN=d.create();a.tmpP0=p.create();a.tmpPoi=d.create();a.tmpRayDir=d.create();a.dragBeginPoint=z.createScreenPointArray();a.normalizedAnchorPoint=p.create();a.constraintOptions={selection:15,interactionType:1,interactionFactor:0,interactionStartCamera:null,interactionDirection:d.create(),tiltMode:0};a.plane=r.plane.create();return a}
m._inheritsLoose(g,u);var l=g.prototype;l.begin=function(a){if(this.active){q.copy(this.dragBeginPoint,a);k.normalizeCoordinate(this.beginCamera,a,this.normalizedAnchorPoint);this.intersectionHelper.intersectScreenFreePointFallback(a,this.tmpP);b.subtract(this.tmpDir,this.tmpP,this.beginCamera.eye);b.normalize(this.tmpDir,this.tmpDir);var c;this.view.camera.position.hasZ&&(c=Math.abs(this.view.camera.position.z));c*=30;a=this.view._stage.renderView.getMinimalDepthForArea(a[0],a[1],this.view._stage.getCamera(),
70);b.scale(this.tmpDir,this.tmpDir,c>a?a:c);b.add(this.tmpP,this.beginCamera.eye,this.tmpDir);b.subtract(this.tmpN,this.beginCamera.eye,this.beginCamera.center);b.normalize(this.tmpN,this.tmpN);0>this.tmpN[1]&&b.negate(this.tmpN,this.tmpN);r.plane.fromPositionAndNormal(this.tmpP,this.tmpN,this.plane);this.constraintOptions.interactionStartCamera=this.beginCamera}};l.update=function(a){if(this.active){k.intersectPlaneFromScreenPoint(this.plane,this.currentCamera,this.dragBeginPoint,this.tmpPoi)||
b.copy(this.tmpPoi,this.currentCamera.center);k.normalizeCoordinate(this.currentCamera,a,this.tmpP0);var c=4*(this.tmpP0[1]-this.normalizedAnchorPoint[1]);q.copy(this.normalizedAnchorPoint,this.tmpP0);b.subtract(this.tmpRayDir,this.tmpPoi,this.currentCamera.eye);var f=b.length(this.tmpRayDir),h=f*(1-c);b.copy(this.constraintOptions.interactionDirection,this.tmpRayDir);b.scale(this.constraintOptions.interactionDirection,this.constraintOptions.interactionDirection,y.sign(c)/f);var v=this.view.state.constraints.minimumPoiDistance;
0<=c&&h<v&&(h=v,c=-(h-f)/f);1E-6>Math.abs(f-h)||(b.scale(this.tmpRayDir,this.tmpRayDir,c),b.add(this.currentCamera.eye,this.currentCamera.eye,this.tmpRayDir),b.lerp(this.currentCamera.center,this.currentCamera.center,this.tmpPoi,c),this.currentCamera.center[2]=this.tmpPoi[2]>this.beginCamera.center[2]?Math.max(this.beginCamera.center[2],this.currentCamera.center[2]):Math.min(this.beginCamera.center[2],this.currentCamera.center[2]),this.currentCamera.markViewDirty(),this.constraintOptions.interactionFactor=
t.pixelDistanceToInteractionFactor(this.dragBeginPoint,a),t.applyAll(this.view,this.currentCamera,this.constraintOptions))}};l.end=function(){this.active&&this.finishController()};m._createClass(g,[{key:"intersectionHelper",get:function(){return this.view.sceneIntersectionHelper}}]);return g}(A.InteractiveController);n.__decorate([w.property({constructOnly:!0})],e.ZoomController.prototype,"view",void 0);e.ZoomController=n.__decorate([x.subclass("esri.views.3d.state.controllers.local.ZoomController")],
e.ZoomController);Object.defineProperty(e,"__esModule",{value:!0})});