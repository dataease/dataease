// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../core/PooledArray"],function(f,k,p,l){function m(a){return a?a[0]+"/"+a[1]+"/"+a[2]:"null"}function h(a,b){b(a);if(!a.isLeaf)for(const c of a.children)h(c,b)}function n(a,b,c){a=a.screenDepth;b=b.screenDepth;return a<b?-c:a>b?c:0}let q=function(){function a(){this.q=new l;this._last=null}var b=a.prototype;b.resetOne=function(c){this.q.clear();this.q.push(c);this._last=null};b.reset=function(c){this.q.clear();
c&&this.q.pushArray(c);this._last=null};b.skipSubtree=function(){this._last=null};b.next=function(){this._last&&!this._last.isLeaf&&this.q.pushArray(this._last.children);return this._last=this.q.pop()};k._createClass(a,[{key:"done",get:function(){return 0===this.q.length&&(!this._last||this._last.isLeaf)}}]);return a}(),r=function(){function a(){this.q=new l}var b=a.prototype;b.reset=function(c){this.q.clear();if(c)for(this.q.pushArray(c),c=0;c<this.q.length;++c){const d=this.q.data[c];d.isLeaf||
this.q.pushArray(d.children)}};b.next=function(){return this.q.pop()};k._createClass(a,[{key:"done",get:function(){return 0===this.q.length}}]);return a}();f.IteratorPostorder=r;f.IteratorPreorder=q;f.compareTiles=n;f.computeUpsampleInfo=function(a,b,c){let d=1,e=0,g=0;for(;a!==b;)if(d*=.5,e*=.5,g*=.5,a.lij[2]&1&&(e+=.5),0===(a.lij[1]&1)&&(g+=.5),a=a.parent,null==a)throw Error("tile was not a descendant of upsampleTile");c.init(b,e,g,d)};f.fallsWithinLayer=function(a,b,c){if(p.isNone(b))return!1;
const d=b.fullExtent,e=a.extent;if(c){if(e[0]<d.xmin||e[1]<d.ymin||e[2]>d.xmax||e[3]>d.ymax)return!1}else if(d.xmin>e[2]||d.ymin>e[3]||d.xmax<e[0]||d.ymax<e[1])return!1;a=a.surface.tilingScheme.levels[a.lij[0]].scale;return 0<b.minScale&&a>1.00000001*b.minScale||0<b.maxScale&&a<.99999999*b.maxScale?!1:!0};f.hasVisibleSiblings=function(a){for(let b=0;b<a.length;b++){const c=a[b],d=c.parent;if(d)for(let e=0;4>e;e++){const g=d.children[e];if(g&&g!==c&&g.visible)return!0}}return!1};f.lij2str=m;f.sortTiles=
function(a,b){b.sort((c,d)=>n(c,d,a))};f.sortTilesByPOI=function(a,b){const c=new Map;a.forAll(d=>c.set(d,d.distanceToSquared(b)));a.sort((d,e)=>c.get(d)-c.get(e))};f.tile2str=function(a){return a?m(a.lij):"null"};f.tilesAreRelated=function(a,b){if(!a||!b||a[0]===b[0])return!1;const c=a[0]<b[0],d=c?a:b;a=c?b:a;b=1<<a[0]-d[0];return Math.floor(a[1]/b)===d[1]&&Math.floor(a[2]/b)===d[2]};f.traverseTilesPreorder=function(a,b){if(Array.isArray(a))for(let c=0;c<a.length;c++)h(a[c],b);else h(a,b)};Object.defineProperty(f,
"__esModule",{value:!0})});