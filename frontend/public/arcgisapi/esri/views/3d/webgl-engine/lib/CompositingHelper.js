// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["../../../../core/maybe","../../../webgl/Util","./glUtil3D","../shaders/CompositingTechnique"],function(k,l,n,h){let p=function(){function m(a,b){this._rctx=a;this._techniqueRepository=b;this._techniques=new Set}var f=m.prototype;f.dispose=function(){this._techniques.forEach(a=>this._techniqueRepository.release(a));this._techniques.clear();k.isSome(this._vao)&&(this._vao.dispose(),this._vao=null)};f.composite=function(a,b=0,g=1){this.compositeInternal(a,b,g,0)};f.compositeTransparent=function(a,
b,g,d=1){const c=this._rctx;e.alphaMode=1;e.function=3;e.hasOpacityFactor=1!==d;d=this._techniqueRepository.acquire(h.CompositingTechnique,e);c.bindProgram(d.program);d.bindPipelineState(c);d.program.setUniform1i("colorTexture",1);c.bindTexture(a,1);d.program.setUniform1i("alphaTexture",2);c.bindTexture(b,2);d.program.setUniform1i("frontFaceTexture",3);c.bindTexture(g,3);a=this.ensureVAO();c.bindVAO(a);c.drawArrays(5,0,l.vertexCount(a,"geometry"));this._techniqueRepository.release(d)};f.compositeSpecial=
function(a,b){this.compositeInternal(a,0,1,b)};f.compositeInternal=function(a,b,g,d){const c=this._rctx;e.alphaMode=b;e.function=d;e.hasOpacityFactor=1!==g;b=this._techniqueRepository.acquire(h.CompositingTechnique,e);c.bindProgram(b.program);b.bindPipelineState(c);b.program.setUniform1i("tex",1);e.hasOpacityFactor&&b.program.setUniform1f("opacity",g);c.bindTexture(a,1);a=this.ensureVAO();c.bindVAO(a);c.drawArrays(5,0,l.vertexCount(a,"geometry"));this._techniqueRepository.release(b)};f.ensureVAO=
function(){k.isNone(this._vao)&&(this._vao=n.createQuadVAO(this._rctx));return this._vao};return m}();const e=new h.CompositingTechniqueConfiguration;return p});