// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/maybe ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../Graphic ../../../geometry/support/aaBoundingRect ../../../chunks/vec4f64 ./LayerView3D ./support/layerViewUpdatingProperties ../../layers/LayerView ./I3SMeshView3D".split(" "),
function(m,c,b,k,B,C,d,D,r,E,F,G,t,g,n,u,v,w,x){b=function(l){function h(){var a=l.apply(this,arguments)||this;a.lodFactor=1;a._elevationContext="im";a._isIntegratedMesh=!0;a._supportsLabeling=!1;a.drapeTargetType=1;a._overlayTexOffset=n.fromValues(-1,-1,-1,-1);a._overlayTexScale=n.create();a._overlayTextures=[null,null];a._overlayHighlights=[null,null];a._overlayNormals=[null,null];return a}m._inheritsLoose(h,l);var e=h.prototype;e.setDrapingTextures=function(a,f,p,y,z){k.isSome(p)&&0<g.area(f)?
(this._overlayTextures[a]=p,this._overlayHighlights[a]=y,this._overlayNormals[a]=z,this._overlayTexOffset[2*a]=-f[0]/g.width(f),this._overlayTexOffset[2*a+1]=-f[1]/g.height(f),this._overlayTexScale[2*a]=1/g.width(f),this._overlayTexScale[2*a+1]=1/g.height(f)):(this._overlayTextures[a]=null,this._overlayHighlights[a]=null,this._overlayNormals[a]=null,this._overlayTexOffset[2*a]=-1,this._overlayTexOffset[2*a+1]=-1,this._overlayTexScale[2*a]=0,this._overlayTexScale[2*a+1]=0);this._forAllNodes(q=>k.isSome(q)&&
this._collection.updateMaterial(q.objectHandle,A=>this._updateMaterialOverlay(A)))};e._updateMaterialOverlay=function(a){a.overlayColorInner=this._overlayTextures[0];a.overlayColorOuter=this._overlayTextures[1];a.overlayHighlightInner=this._overlayHighlights[0];a.overlayHighlightOuter=this._overlayHighlights[1];a.overlayNormalInner=this._overlayNormals[0];a.overlayNormalOuter=this._overlayNormals[1];a.overlayTexOffset=this._overlayTexOffset;a.overlayTexScale=this._overlayTexScale};e.initialize=function(){this.updatingHandles.add(this.layer,
"modifications",()=>this._loadModifications(),2)};e.destroy=function(){};e._createLayerGraphic=function(){const a=new t;a.layer=this.layer;a.sourceLayer=this.layer;return a};e.canResume=function(){return l.prototype.canResume.call(this)&&(!this._controller||this._controller.rootNodeVisible)};e._loadModifications=function(){this.handles.remove("modifications");if(k.isNone(this.layer.modifications))this._modifications=[];else{var a=this.layer.modifications;this.handles.add(this.updatingHandles.addOnCollectionChange(a,
()=>this._modifications=a.toArray(),2),"modifications")}};m._createClass(h,[{key:"progressiveLoadFactor",get:function(){return 1<=this.lodFactor?.2:1}}]);return h}(x.I3SMeshView3D(u.LayerView3D(w)));c.__decorate([d.property()],b.prototype,"layer",void 0);c.__decorate([d.property({aliasOf:"layer"})],b.prototype,"i3slayer",void 0);c.__decorate([d.property({dependsOn:["_controller.rootNodeVisible"]})],b.prototype,"suspended",void 0);c.__decorate([d.property(v.updatingProgress)],b.prototype,"updatingProgress",
void 0);c.__decorate([d.property({readOnly:!0,aliasOf:"_controller.updatingProgress"})],b.prototype,"updatingProgressValue",void 0);c.__decorate([d.property({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.integratedMesh.lodFactor"})],b.prototype,"lodFactor",void 0);c.__decorate([d.property({readOnly:!0,dependsOn:["lodFactor"]})],b.prototype,"progressiveLoadFactor",null);return b=c.__decorate([r.subclass("esri.views.3d.layers.SceneLayerView3D")],b)});