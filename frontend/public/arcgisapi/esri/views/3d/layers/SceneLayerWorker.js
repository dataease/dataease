// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
require({cache:{"esri/libs/i3s/I3SWorker":function(){define(["require","exports","../../core/promiseUtils","../../assets"],function(q,r,F,L){function I(B){return L.getAssetUrl(`esri/libs/i3s/${B}`)}let p;r.getWorkerModule=function(){p||(p=F.create(B=>(new Promise(function(h,w){q(["../../chunks/i3s"],h,w)})).then(function(h){return h.i3s}).then(({default:h})=>{const w=h({locateFile:I,onRuntimeInitialized:()=>B(w)});delete w.then})).catch(B=>F.reject(B)));return p};Object.defineProperty(r,"__esModule",
{value:!0})})},"esri/assets":function(){define(["exports","./config","./core/urlUtils","./request"],function(q,r,F,L){function I(p){return F.join(r.assetsPath,p)}q.fetchAsset=function(p,B){return L(I(p),B)};q.getAssetUrl=I;Object.defineProperty(q,"__esModule",{value:!0})})},"esri/request":function(){define("require ./core/global ./core/has ./core/lang ./config ./core/maybe ./core/Error ./core/urlUtils ./core/promiseUtils ./kernel ./support/requestUtils".split(" "),function(q,r,F,L,I,p,B,h,w,v,J){async function x(a,
b){var c=h.isDataProtocol(a);const f=h.isBlobProtocol(a);f||c||(a=h.normalize(a));const e={url:a,requestOptions:{...p.unwrap(b)}};let g=h.getInterceptor(a);if(g){a=await Q(g,e);if(null!=a)return{data:a,getHeader:R,requestOptions:e.requestOptions,url:e.url};g.after||g.error||(g=null)}a=e.url;b=e.requestOptions;if("image"===b.responseType){if(F("host-webworker")||F("host-node"))throw d("request:invalid-parameters",Error("responseType 'image' is not supported in Web Workers or Node environment"),e);
}else if(c)throw d("request:invalid-parameters",Error("Data URLs are not supported for responseType \x3d "+b.responseType),e);if("head"===b.method){if(b.body)throw d("request:invalid-parameters",Error("body parameter cannot be set when method is 'head'"),e);if(c||f)throw d("request:invalid-parameters",Error("data and blob URLs are not supported for method 'head'"),e);}await l();if(K)return K.execute(a,b);const C=w.createAbortController();w.onAbort(b,()=>C.abort());c=await V({controller:C,credential:null,
credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:g,params:e,redoRequest:!1,useIdentity:D.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1});g&&g.after&&g.after(c);return c}function m(a){h.isBlobProtocol(a)||h.isDataProtocol(a)||(a=h.getOrigin(a))&&-1===x._corsServers.indexOf(a)&&x._corsServers.push(a)}function O(a){a=h.getOrigin(a);return!a||a.endsWith(".arcgis.com")||-1!==x._corsServers.indexOf(a)||h.isTrustedServer(a)}function d(a,b,c,f){let e="Error";const g={url:c.url,requestOptions:c.requestOptions,
getHeader:R,ssl:!1};if(b instanceof B)return b.details?(b.details=L.clone(b.details),b.details.url=c.url,b.details.requestOptions=c.requestOptions):b.details=g,b;if(b){c=f&&(k=>f.headers.get(k));const C=f&&f.status,t=b.message;t&&(e=t);c&&(g.getHeader=c);g.httpStatus=(null!=b.httpCode?b.httpCode:b.code)||C||0;g.subCode=b.subcode;g.messageCode=b.messageCode;g.messages="string"===typeof b.details?[b.details]:b.details}return w.isAbortError(b)?w.createAbortError():new B(a,e,g)}async function l(){F("host-webworker")?
K||(K=await new Promise(function(a,b){q(["./core/workers/request"],a,b)})):x._abortableFetch||(x._abortableFetch=r.fetch.bind(r))}async function u(){v.id||await new Promise(function(a,b){q(["./identity/IdentityManager"],function(c){a(Object.freeze({__proto__:null,"default":c}))},b)})}async function E(a){const b=a.params.url,c=a.params.requestOptions,f=a.controller.signal;var e=c.body;let g=null,C=null,t=null;n&&"HTMLFormElement"in r&&(e instanceof FormData?g=e:e instanceof HTMLFormElement&&(C=e,g=
new FormData(C)));"string"===typeof e&&(t=e);a.fetchOptions={cache:c.cacheBust&&!x._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:c.headers||{},method:"head"===c.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:f};if(g||t)a.fetchOptions.body=g||t;"anonymous"===c.authMode&&(a.useIdentity=!1);a.hasToken=!!(/token=/i.test(b)||c.query&&c.query.token||g&&g.get&&g.get("token")||C&&C.elements.token);(e=h.getOrigin(b,!0))&&!a.hasToken&&I.apiKey&&e.endsWith(".arcgis.com")&&
"elevation3d.arcgis.com"!==e&&"js.arcgis.com"!==e&&"jsdev.arcgis.com"!==e&&"jsqa.arcgis.com"!==e&&(c.query||(c.query={}),c.query.token=I.apiKey,a.hasToken=!0);if(a.useIdentity&&!a.hasToken&&!a.credentialToken&&!A(b)&&!w.isAborted(f)){let k;"immediate"===c.authMode?(await u(),k=await v.id.getCredential(b,{signal:f}),a.credential=k):"no-prompt"===c.authMode?(await u(),k=await v.id.getCredential(b,{prompt:!1,signal:f}).catch(()=>{}),a.credential=k):v.id&&(k=v.id.findCredential(b));k&&(a.credentialToken=
k.token,a.useSSL=!!k.ssl)}}function A(a){return G.some(b=>b.test(a))}async function S(a){let b=a.params.url;const c=a.params.requestOptions,f=a.fetchOptions,e=h.isBlobProtocol(b)||h.isDataProtocol(b),g=c.responseType||"json",C=e?0:null!=c.timeout?c.timeout:D.timeout;var t=!1;if(!e){a.useSSL&&(b=h.toHTTPS(b));c.cacheBust&&"default"===f.cache&&(b=h.addQueryParameter(b,"request.preventCache",Date.now()));var k={...c.query};a.credentialToken&&(k.token=a.credentialToken);t=h.objectToQuery(k);F("esri-url-encodes-apostrophe")&&
(t=t.replace(/'/g,"%27"));const M=b.length+1+t.length;t="post"===c.method||!!c.body||M>D.maxUrlLength;const P=c.useProxy||!!h.getProxyRule(b);if(P){const X=h.getProxyUrl(b);var T=X.path;!t&&T.length+1+M>D.maxUrlLength&&(t=!0);X.query&&(k={...X.query,...k})}if("HEAD"===f.method&&(t||P)){if(t){if(M>D.maxUrlLength)throw d("request:invalid-parameters",Error("URL exceeds maximum length"),a.params);throw d("request:invalid-parameters",Error("cannot use POST request when method is 'head'"),a.params);}if(P)throw d("request:invalid-parameters",
Error("cannot use proxy when method is 'head'"),a.params);}t?(f.method="POST",c.body?b=h.addQueryParameters(b,k):(f.body=h.objectToQuery(k),f.headers["Content-Type"]="application/x-www-form-urlencoded")):b=h.addQueryParameters(b,k);P&&(a.useProxy=!0,b=`${T}?${b}`);k.token&&n&&f.body instanceof FormData&&(T=f.body,T.set?T.set("token",k.token):T.append("token",k.token));c.hasOwnProperty("withCredentials")?a.withCredentials=c.withCredentials:h.isTrustedServer(b)?a.withCredentials=!0:v.id&&(k=v.id.findServerInfo(b))&&
k.webTierAuth&&(a.withCredentials=!0);a.withCredentials&&(f.credentials="include")}k=0;let aa=!1;0<C&&(k=setTimeout(()=>{aa=!0;a.controller.abort()},C));let N,y;try{if("image"!==c.responseType||"default"!==f.cache||"GET"!==f.method||t||Y(c.headers)||!e&&!a.useProxy&&D.proxyUrl&&!O(b)){if(N=await x._abortableFetch(b,f),a.useProxy||m(b),N.ok&&"HEAD"!==f.method){switch(g){case "array-buffer":y=await N.arrayBuffer();break;case "blob":case "image":y=await N.blob();break;default:y=await N.text()}k&&(clearTimeout(k),
k=0);if("json"===g||"xml"===g||"document"===g)if(y)switch(g){case "json":y=JSON.parse(y);break;case "xml":y=U(y,"application/xml");break;case "document":y=U(y,"text/html")}else y=null;if(y){if("array-buffer"===g||"blob"===g){const M=N.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(M)&&750>=y["blob"===g?"size":"byteLength"])try{const P=await (new Response(y)).json();P.error&&(y=P)}catch{}}"image"===g&&y instanceof Blob&&(y=await W(URL.createObjectURL(y),a,!0))}}}else y=await W(b,
a)}catch(M){if("AbortError"===M.name){if(aa)throw Error("Timeout exceeded");throw w.createAbortError("Request canceled");}if(!N&&M instanceof TypeError&&D.proxyUrl&&!c.body&&"post"!==c.method&&"head"!==c.method&&!a.useProxy)a.redoRequest=!0,h.addProxyRule({proxyUrl:D.proxyUrl,urlPrefix:h.removeFile(h.urlToObject(b).path)});else throw M;}finally{k&&clearTimeout(k)}return[N,y]}async function Q(a,b){if(null!=a.responseData)return a.responseData;a.headers&&(b.requestOptions.headers={...b.requestOptions.headers,
...a.headers});a.query&&(b.requestOptions.query={...b.requestOptions.query,...a.query});if(a.before){let c,f;try{f=await a.before(b)}catch(e){c=d("request:interceptor",e,b)}if(f instanceof Error||f instanceof B)c=d("request:interceptor",f,b);if(c)throw a.error&&a.error(c),c;return f}}function Y(a){if(a)for(const b of Object.getOwnPropertyNames(a))if(a[b])return!0;return!1}function U(a,b){let c;try{c=(new DOMParser).parseFromString(a,b)}catch{}if(!c||c.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");
return c}async function V(a){await E(a);let b;try{do[b,c]=await S(a);while(!await Z(a,b,c))}catch(g){var c=d("request:server",g,a.params,b);c.details.ssl=a.useSSL;a.interceptor&&a.interceptor.error&&a.interceptor.error(c);throw c;}var f=a.params.url;/\/sharing\/rest\/(accounts|portals)\/self/i.test(f)&&!a.hasToken&&!a.credentialToken&&c&&c.user&&c.user.username&&!h.isTrustedServer(f)&&(f=h.getOrigin(f,!0))&&D.trustedServers.push(f);if((f=a.credential)&&v.id){var e=v.id.findServerInfo(f.server);if(e=
e&&e.owningSystemUrl)e=e.replace(/\/?$/,"/sharing"),(f=v.id.findCredential(e,f.userId))&&-1===v.id._getIdenticalSvcIdx(e,f)&&f.resources.unshift(e)}return{data:c,getHeader:b?g=>b.headers.get(g):R,requestOptions:a.params.requestOptions,ssl:a.useSSL,url:a.params.url}}async function Z(a,b,c){var f;if(a.redoRequest)return a.redoRequest=!1;if(!b)return!0;if(!b.ok)throw Error(`Unable to load ${b.url} status: ${b.status}`);let e;c&&c.error&&(e=L.mixin(Error(),c.error));let g,C,t;e&&(g=Number(e.code),C=e.hasOwnProperty("subcode")?
Number(e.subcode):null,t=(t=e.messageCode)&&t.toUpperCase());b=a.params.requestOptions.authMode;c=String(null==(f=a.params.requestOptions.query)?void 0:f.token);if(403===g&&(4===C||e.message&&-1<e.message.toLowerCase().indexOf("ssl")&&-1===e.message.toLowerCase().indexOf("permission"))){if(!a.useSSL)return a.useSSL=!0,!1}else if(a.useIdentity&&("no-prompt"!==b||498===g)&&-1!==z.indexOf(g)&&!A(a.params.url)&&!c.startsWith("AAPK")&&(403!==g||-1===H.indexOf(t)&&(null==C||2===C&&a.credentialToken))){await u();
try{const k=await v.id.getCredential(a.params.url,{error:d("request:server",e,a.params),prompt:"no-prompt"!==b,signal:a.controller.signal,token:a.credentialToken});a.credential=k;a.credentialToken=k.token;a.useSSL=a.useSSL||k.ssl;return!1}catch(k){if("no-prompt"===b)return a.credential=null,a.credentialToken=null,!1;e=k}}if(e)throw e;return!0}function W(a,b,c=!1){const f=b.controller.signal,e=new Image;e.crossOrigin=b.withCredentials?"use-credentials":"anonymous";e.alt="";e.src=a;return J.loadImageAsync(e,
a,c,f)}let K;const D=I.request,n="FormData"in r,z=[499,498,403,401],H=["COM_0056","COM_0057","SB_0008"],G=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],R=()=>null;x._abortableFetch=null;x._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];return x})},"esri/support/requestUtils":function(){define(["exports","../core/has","../core/maybe","../core/promiseUtils"],function(q,r,F,L){function I(){try{return new DOMException("Aborted","AbortError")}catch{const p=
Error();p.name="AbortError";return p}}q.loadImageAsync=function(p,B,h=!1,w){return L.create((v,J)=>{if(L.isAborted(w))J(I());else{var x=()=>{d();J(Error(`Unable to load ${B}`))},m=()=>{const l=p;d();v(l)},O=()=>{if(p){var l=p;d();l.src="";J(I())}},d=()=>{r("esri-image-decode")||(p.removeEventListener("error",x),p.removeEventListener("load",m));p=m=x=null;F.isSome(w)&&w.removeEventListener("abort",O);O=null;h&&URL.revokeObjectURL(B)};F.isSome(w)&&w.addEventListener("abort",O);r("esri-image-decode")?
p.decode().then(m,x):(p.addEventListener("error",x),p.addEventListener("load",m))}})};Object.defineProperty(q,"__esModule",{value:!0})})},"*noref":1}});
define(["exports","../../../core/typedArrayUtil","../../../core/maybe","../../../core/promiseUtils","../../../libs/i3s/I3SWorker"],function(q,r,F,L,I){function p(d){const l=d.modifications,u=m._malloc(8*l.length),E=new Float64Array(m.HEAPU8.buffer,u,l.length);for(let A=0;A<l.length;++A)E[A]=l[A];m.setModifications(d.context,u,l.length,d.isGeodetic);m._free(u)}function B(d,l){if(!m)return null;const {context:u,localOrigin:E,globalTrafo:A,mbs:S,obb:Q,elevationOffset:Y,geometryBuffer:U,geometryDescriptor:V,
indexToVertexProjector:Z,vertexToRenderProjector:W}=d;var K=m._malloc(U.byteLength),D=m._malloc(33*Float64Array.BYTES_PER_ELEMENT),n=new Uint8Array(m.HEAPU8.buffer,K,U.byteLength);n.set(new Uint8Array(U));var z=new Float64Array(m.HEAPU8.buffer,D,33);v(z,E);var H=z.byteOffset+3*z.BYTES_PER_ELEMENT,G=new Float64Array(z.buffer,H);v(G,A);H+=16*z.BYTES_PER_ELEMENT;G=new Float64Array(z.buffer,H);v(G,S);H+=4*z.BYTES_PER_ELEMENT;F.isSome(Q)&&(G=new Float64Array(z.buffer,H),v(G,Q.center),H+=3*z.BYTES_PER_ELEMENT,
G=new Float64Array(z.buffer,H),v(G,Q.halfSize),H+=3*z.BYTES_PER_ELEMENT,G=new Float64Array(z.buffer,H),v(G,Q.quaternion));z={isDraco:!1,isLegacy:!1,color:d.layouts.some(a=>a.some(b=>"color"===b.name)),normal:d.needNormals&&d.layouts.some(a=>a.some(b=>"normalCompressed"===b.name)),uv0:d.layouts.some(a=>a.some(b=>"uv0"===b.name)),uvRegion:d.layouts.some(a=>a.some(b=>"uvRegion"===b.name)),featureIndex:V.featureIndex};n=m.process(u,!!d.obb,K,n.byteLength,V,z,D,Y,Z,W,d.normalReferenceFrame);m._free(D);
m._free(K);if(0<n.error.length)throw`i3s.wasm: ${n.error}`;if(n.discarded)return null;K=0<n.componentOffsets.length?r.slice(n.componentOffsets):null;D=0<n.featureIds.length?r.slice(n.featureIds):null;z=r.slice(n.interleavedVertedData).buffer;H=1===n.indicesType?r.slice(new Uint16Array(n.indices.buffer,n.indices.byteOffset,n.indices.byteLength/2)):r.slice(new Uint32Array(n.indices.buffer,n.indices.byteOffset,n.indices.byteLength/4));G=r.slice(n.positions);const R=1===n.positionIndicesType?r.slice(new Uint16Array(n.positionIndices.buffer,
n.positionIndices.byteOffset,n.positionIndices.byteLength/2)):r.slice(new Uint32Array(n.positionIndices.buffer,n.positionIndices.byteOffset,n.positionIndices.byteLength/4));d={layout:d.layouts[0],interleavedVertexData:z,indices:H,hasColors:n.hasColors,hasModifications:n.hasModifications,positionData:{data:G,indices:R}};D&&l.push(D.buffer);K&&l.push(K.buffer);l.push(z);l.push(H.buffer);l.push(G.buffer);l.push(R.buffer);return{componentOffsets:K,featureIds:D,transformedGeometry:d,obb:n.obb}}function h(d){const {context:l,
buffer:u}=d;d=m._malloc(u.byteLength);const E=u.byteLength/Float64Array.BYTES_PER_ELEMENT,A=new Float64Array(m.HEAPU8.buffer,d,E),S=new Float64Array(u);A.set(S);m.filterOBBs(l,d,E);S.set(A);m._free(d)}function w(d){m&&m.destroy(d)}function v(d,l){for(let u=0;u<l.length;++u)d[u]=l[u]}function J(){if(m)return L.resolve();x||(x=I.getWorkerModule().then(d=>{m=d;x=null}));return x}let x,m;const O={transform:B,destroy:w};q.destroyContext=function(d){w(d)};q.dracoDecompressPointCloudData=async function(d){var l;
await J();const u=[d.geometryBuffer];var {geometryBuffer:E}=d,A=E.byteLength;d=m._malloc(A);A=new Uint8Array(m.HEAPU8.buffer,d,A);A.set(new Uint8Array(E));E=m.dracoDecompressPointCloudData(d,A.byteLength);m._free(d);if(0<E.error.length)throw`i3s.wasm: ${E.error}`;d=0<(null==(l=E.featureIds)?void 0:l.length)?r.slice(E.featureIds):null;l=r.slice(E.positions);d&&u.push(d.buffer);u.push(l.buffer);return{result:{positions:l,featureIds:d},transferList:u}};q.filterObbsForModifications=async function(d){await J();
h(d);d={buffer:d.buffer};return{result:d,transferList:[d.buffer]}};q.filterObbsForModificationsSync=h;q.initialize=J;q.interpretObbModificationResults=function(d){return 0===d?0:1===d?1:2===d?2:3};q.process=async function(d){await J();const l=[d.geometryBuffer];return{result:B(d,l),transferList:l}};q.setLegacySchema=async function(d){await J();m.setLegacySchema(d.context,d.jsonSchema)};q.setModifications=async function(d){await J();p(d)};q.setModificationsSync=p;q.test=O;Object.defineProperty(q,"__esModule",
{value:!0})});