// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","./FeatureTileFetcher3D","./featureTileQuery3D"],function(e,g,f,h,k){let l=function(){function c(a){this._capabilities=this.memoryCache=null;const b=a.layerView.layer;this.layerView=a.layerView;this.objectIdField=b.objectIdField;this.returnZ=a.returnZ;this.returnM=a.returnM;a=this.layerView.view.resourceController;this.query=k.createFeatureTileQuery3D(b,a.scheduler);a&&this.memoryCacheEnabled&&(this.memoryCache=
a.memoryController.getMemCache(b.uid))}var d=c.prototype;d.destroy=function(){f.destroyMaybe(this.memoryCache);this.query.destroy()};d.createQuery=function(){const a=this.layerView.layer.createQuery();a.outFields=this.layerView.availableFields;a.returnZ=this.returnZ;a.returnM=this.returnM;a.outSpatialReference=this.tilingScheme.spatialReference;return a};d.logFetchError=function(a,b){a.error("#fetchTile()",this.layerView.layer,b&&b.message?b.message:b)};g._createClass(c,[{key:"memoryCacheEnabled",
get:function(){switch(this.layerView.layer.source.type){case "feature-layer":case "ogc-feature":return!0;case "csv":case "geojson":case "memory":case "stream-layer":return!1}}},{key:"viewingMode",get:function(){return this.layerView.view.state.mode}},{key:"tilingScheme",get:function(){return this.layerView.view.featureTiles.tilingScheme}},{key:"scheduler",get:function(){const a=this.layerView.view.resourceController;return a?a.scheduler:null}},{key:"geometryType",get:function(){return this.layerView.layer.geometryType}},
{key:"fullExtent",get:function(){return this.layerView.layer.fullExtent}},{key:"tileMaxRecordCount",get:function(){return this.layerView.layer.capabilities.query.tileMaxRecordCount}},{key:"maxRecordCount",get:function(){return this.layerView.layer.capabilities.query.maxRecordCount}},{key:"capabilities",get:function(){return f.isSome(this._capabilities)?this._capabilities:this._capabilities=h.contextCapabilitiesFromLayer(this.layerView.layer)}}]);return c}();e.FeatureTileFetcher3DLayerViewContext=
l;Object.defineProperty(e,"__esModule",{value:!0})});