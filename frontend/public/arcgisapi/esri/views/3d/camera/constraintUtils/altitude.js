// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/mathUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../support/geometryUtils ./common ../../support/intersectionUtils".split(" "),function(h,m,k,n,r,f,t){function l(b,c,d=f.defaultApplyOptions){var a=b.state.constraints.altitude;a=b.state.isGlobal&&a?2===d.interactionType&&f.hasConstraintType(d.selection,1)?!1:!0:!1;if(!a)return 0;var e=b.state.constraints.altitude;a=u;a.min=e.min;a.max=e.max;e=d.interactionType;if(0!==e){var {min:g,max:v}=a,{interactionStartCamera:p,
interactionFactor:w}=d;d=2===e||1===e;e=l(b,p);var q=0===e?0:b.renderCoordsHelper.getAltitude(p.eye);a.min=g;a.max=v;f.adjustRangeForInteraction(e,q,d,w,.05*q,a)}b=b.renderCoordsHelper.getAltitude(c.eye);b=m.clamp(b,a.min,a.max)-b;return 1E-6>=Math.abs(b)?0:b}function x(b,c,d,a){b.renderCoordsHelper.worldUpAtPosition(c.eye,a);n.scale(a,a,d);return a}const u={min:0,max:0},y=k.create(),z=k.create(),A=k.create();h.applyAltitudeConstraint=function(b,c,d=f.defaultApplyOptions){const a=l(b,c,d);if(0===
a)return!1;const e=b.renderCoordsHelper,g=e.getAltitude(c.eye)+a;b=f.interactionDirectionTowardsConstraintMinimization(c,d.interactionDirection,x(b,c,m.sign(a),z),y);d=n.copy(A,c.viewForward);e.intersectInfiniteManifold(r.ray.wrap(c.eye,b),g,c.eye)||e.setAltitude(g,c.eye);t.closestPointOnRay(c.eye,d,c.center,c.center);c.markViewDirty();return!0};h.getAltitudeConstraintError=l;Object.defineProperty(h,"__esModule",{value:!0})});