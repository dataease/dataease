// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ../../VertexStream".split(" "),function(m,n,x,y,z,A,t,B,C,D,u){const v=[1,0],w=[0,1];n=function(){function p(){this._blurFBO=null;this._size=[0,0];this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",
fsPath:"post-processing/blur/gaussianBlur",attributes:{a_position:0}},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:{a_position:0}},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:{a_position:0}}}}var h=p.prototype;h.dispose=function(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)};h.draw=function(a,e,b){const {context:c}=a,{type:d,radius:f}=b;0!==f&&(this._createOrResizeResources(a),this._quad||(this._quad=new u(c,
[-1,-1,1,-1,-1,1,1,1])),b=this._quad,b.bind(),"blur"===d?this._gaussianBlur(a,e,f):this._radialBlur(a,e),b.unbind())};h._gaussianBlur=function(a,e,b){const {context:c,state:d,painter:f,pixelRatio:k}=a;var {size:g}=d;const {materialManager:l}=f,q=this._quad;g=[Math.round(k*g[0]),Math.round(k*g[1])];const r=this._blurFBO;a=l.getProgram(a,this._programDesc.gaussianBlur,[{name:"radius",value:Math.ceil(b)}]);c.bindProgram(a);c.setBlendingEnabled(!1);c.bindFramebuffer(r);c.bindTexture(e.colorTexture,4);
a.setUniform1i("u_colorTexture",4);a.setUniform2fv("u_texSize",g);a.setUniform2fv("u_direction",v);a.setUniform1f("u_sigma",b);q.draw();c.bindFramebuffer(e);c.setStencilWriteMask(0);c.setStencilTestEnabled(!1);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.bindTexture(r.colorTexture,5);a.setUniform1i("u_colorTexture",5);a.setUniform2fv("u_direction",w);q.draw();c.setBlendingEnabled(!0);c.setBlendFunction(1,771);c.setStencilTestEnabled(!0)};h._radialBlur=function(a,e){const {context:b,painter:c}=
a,{materialManager:d}=c,f=this._programDesc,k=this._quad,g=this._blurFBO;b.bindFramebuffer(g);const l=d.getProgram(a,f.radialBlur);b.bindProgram(l);b.setBlendingEnabled(!1);b.bindTexture(e.colorTexture,4);l.setUniform1i("u_colorTexture",4);k.draw();b.bindFramebuffer(e);b.setStencilWriteMask(0);b.setStencilTestEnabled(!1);b.setDepthWriteEnabled(!1);b.setDepthTestEnabled(!1);b.setBlendingEnabled(!0);a=d.getProgram(a,f.blit);b.bindProgram(a);b.bindTexture(g.colorTexture,5);a.setUniform1i("u_texture",
5);b.setBlendFunction(1,771);k.draw()};h._createOrResizeResources=function(a){const {context:e,state:b,pixelRatio:c}=a;var {size:d}=b;a=Math.round(c*d[0]);d=Math.round(c*d[1]);this._blurFBO&&this._size[0]===a&&this._size[1]===d||(this._size[0]=a,this._size[1]=d,this._blurFBO?this._blurFBO.resize(a,d):this._blurFBO=new t(e,{colorTarget:0,depthStencilTarget:0,width:a,height:d},{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:a,height:d}))};
return p}();m.Blur=n;Object.defineProperty(m,"__esModule",{value:!0})});