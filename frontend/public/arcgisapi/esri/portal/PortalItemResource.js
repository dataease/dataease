// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/maybe ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/Error ../core/urlUtils ../core/uuid ./support/resourceExtension ../core/Accessor".split(" "),function(p,m,c,b,d,q,g,r,y,t,u,l,z,A,v){const w=q.getLogger("esri.portal.PortalItemResource");b=function(n){function h(a){a=n.call(this,a)||this;
a.portalItem=null;return a}m._inheritsLoose(h,n);var e=h.prototype;e.normalizeCtorArgs=function(a){return a&&a.portalItem&&a.path?{...a,path:this.normalizePath(a.path,a.portalItem)}:a};e._castPath=function(a){return this.normalizePath(a,this.portalItem)};e.fetch=function(a="json",f){const k=this.url;if(d.isNone(k))throw new u("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(k,{responseType:a,signal:d.get(f,"signal")})};
e.update=async function(a,f){return(await new Promise(function(k,x){p(["./support/resourceUtils"],k,x)})).addOrUpdateResource(this,"update",a,f)};e.hasPath=function(){return d.isSome(this.path)};e.normalizePath=function(a,f){if(d.isNone(a))return a;a=a.replace(/^\/+/,"");d.isSome(f)&&l.isAbsolute(a)&&(a=l.makeRelative(a,f.itemUrl));return a.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")};m._createClass(h,[{key:"path",set:function(a){d.isSome(a)&&l.isAbsolute(a)?w.error("portalitemresource:invalid-path",
"A portal item resource path must be relative"):this._set("path",a)}},{key:"url",get:function(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}},{key:"itemRelativeUrl",get:function(){return this.portalItem&&this.path?`./resources/${this.path}`:null}}]);return h}(v);c.__decorate([g.property()],b.prototype,"portalItem",void 0);c.__decorate([g.property({type:String,value:null})],b.prototype,"path",null);c.__decorate([r.cast("path")],b.prototype,"_castPath",
null);c.__decorate([g.property({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],b.prototype,"url",null);c.__decorate([g.property({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],b.prototype,"itemRelativeUrl",null);return b=c.__decorate([t.subclass("esri.portal.PortalItemResource")],b)});