// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../core/maybe ../../core/Error ../../Color ../../renderers/Renderer ../../renderers/ClassBreaksRenderer ../../renderers/UniqueValueRenderer ../../renderers/DictionaryRenderer ../../renderers/DotDensityRenderer ../../renderers/support/HeatmapColorStop ../../renderers/HeatmapRenderer ../../renderers/SimpleRenderer ../../renderers/support/jsonUtils ../support/utils ../support/adapters/support/layerUtils ./support/utils ../statistics/heatmapStatistics ../../chunks/heatmap".split(" "),
function(q,m,r,t,O,P,Q,R,S,k,z,T,U,A,u,n,B,p){async function C(a){if(!(a&&a.layer&&a.view))throw new r("heatmap-renderer:missing-parameters","'layer' and 'view' parameters are required");const {blurRadius:c,minRatio:d,maxRatio:b,fadeToTransparent:l}=a;a={...a};a.blurRadius=null==c?10:c;a.minRatio=null==d?.01:d;a.maxRatio=null==b?1:b;a.fadeToTransparent=null==l?!0:l;var f=[0,2,1],e=u.createLayerAdapter(a.layer,f);a.layer=e;if(!e)throw new r("heatmap-renderer:invalid-parameters","'layer' must be one of these types: "+
u.getLayerTypeLabels(f).join(", "));f=m.isSome(a.signal)?{signal:a.signal}:null;await e.load(f);f=await A.getFieldsList({field:a.field});if(e=n.verifyBasicFieldValidity(e,f,"heatmap-renderer:invalid-parameters"))throw e;return a}async function D(a){let c=a.scheme,d=null;var b=null;b=await n.getBasemapInfo(a.basemap,a.view);d=m.isSome(b.basemapId)?b.basemapId:null;b=m.isSome(b.basemapTheme)?b.basemapTheme:null;if(c)return{scheme:p.cloneScheme(c),basemapId:d,basemapTheme:b};if(a=p.getSchemes({basemap:d,
basemapTheme:b}))c=a.primaryScheme,d=a.basemapId,b=a.basemapTheme;return{scheme:c,basemapId:d,basemapTheme:b}}async function E(a,c){const {fieldOffset:d}=a,{field:b,basemap:l,blurRadius:f,minRatio:e,maxRatio:F,fadeToTransparent:G,heatmapScheme:H,view:I}=c,{scheme:v,basemapId:J,basemapTheme:K}=await D({basemap:l,scheme:H,view:I});var h=v.colors;const w=h.length,x=(c=!a.count)?[0,100]:[a.min,a.max],L=(F-e)/(w-1),g=h[0],y=[new k({ratio:0,color:new t([g.r,g.g,g.b,0])}),new k({ratio:.01,color:new t([g.r,
g.g,g.b,0])}),new k({ratio:G?e:.01,color:g})];n.createColors(h,w).forEach((M,N)=>{y.push(new k({ratio:e+L*N,color:M}))});h=new z({blurRadius:f,colorStops:y,field:b,minPixelIntensity:x[0],maxPixelIntensity:x[1]});null!=d&&(h.fieldOffset=d);return{renderer:h,statistics:a,defaultValuesUsed:c,scheme:p.cloneScheme(v),basemapId:J,basemapTheme:K}}q.createRenderer=async function(a){a=await C(a);const c=a.statistics?a.statistics:await B({layer:a.layer,field:a.field,fieldOffset:a.fieldOffset,blurRadius:a.blurRadius,
view:a.view,signal:a.signal});return E(c,a)};Object.defineProperty(q,"__esModule",{value:!0})});