// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../core/maybe ../../core/Error ../../layers/support/fieldUtils ../support/utils ./support/utils ../support/adapters/support/layerUtils".split(" "),function(n,e,h,k,l,m){async function p(a){if(!(a&&a.layer&&(a.field||a.valueExpression||a.sqlExpression)))throw new e("summary-statistics:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(a.valueExpression&&!a.sqlExpression&&!a.view)throw new e("summary-statistics:missing-parameters",
"View is required when 'valueExpression' is specified");var b=[0,2,1,3,4];const {layer:f,...q}=a;var c=m.createLayerAdapter(f,b);a={layerAdapter:c,...q};a.normalizationType=k.getNormalizationType(a);if(!c)throw new e("summary-statistics:invalid-parameters","'layer' must be one of these types: "+m.getLayerTypeLabels(b).join(", "));b=n.isSome(a.signal)?{signal:a.signal}:null;await c.load(b);var d=a.field;b=a.normalizationType;const r=a.valueExpression||a.sqlExpression;d=d?c.getField(d):null;var g=await k.getFieldsList({field:a.field,
normalizationField:a.normalizationField,valueExpression:a.valueExpression});if(g=l.verifyBasicFieldValidity(c,g,"summary-statistics:invalid-parameters"))throw g;if(d){if(c=l.verifyFieldType(c,d,"summary-statistics:invalid-parameters",t))throw c;if(h.isDateField(d)&&b)throw new e("summary-statistics:invalid-parameters","Normalization is not allowed for date fields");}else if(r&&b)throw new e("summary-statistics:invalid-parameters","Normalization is not allowed when 'valueExpression' or 'sqlExpression' is specified");
return a}const t=[...h.numericTypes,"date"];return async function(a){const {layerAdapter:b,...f}=await p(a);return b.summaryStatistics(f)}});