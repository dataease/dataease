// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Evented ../../core/Collection ../../core/Handles ../../core/watchUtils ../LayerList/support/layerListUtils ./ListItem".split(" "),function(m,g,f,x,y,k,z,r,A,B,C,
t,u,v,h,w,n){const p=u.ofType(n);f=function(q){function l(a){a=q.call(this,a)||this;a._handles=new v;a.listItemCreatedFunction=null;a.tableItems=new p;a.map=null;return a}m._inheritsLoose(l,q);var d=l.prototype;d.initialize=function(){this._handles.add([h.init(this,["map","map.loaded"],()=>this._mapHandles())],"map")};d.destroy=function(){this._handles.destroy();this.map=this._handles=null;this.tableItems.removeAll()};d.triggerAction=function(a,b){a&&!a.disabled&&this.emit("trigger-action",{action:a,
item:b})};d._mapHandles=function(){const {_handles:a,map:b}=this;a.remove("tables");this._compileList();b&&a.add([h.on(this,"map.tables","change",()=>this._compileList()),h.init(this,"map.tables",()=>this._compileList()),h.init(this,"listItemCreatedFunction",()=>this._compileList())],"tables")};d._modifyListItem=function(a){"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:a})};d._removeAllItems=function(){this.tableItems.removeAll()};d._getViewableTables=
function(a){if(a)return a.filter(b=>"hide"!==w.findLayerListMode(b))};d._watchTablesListMode=function(a){const {_handles:b}=this;b.remove("layer-list-mode");a&&a.forEach(c=>{b.add(h.watch(c,"listMode",()=>this._compileList()),"layer-list-mode")})};d._compileList=function(){var a;const b=null==(a=this.map)?void 0:a.tables;this._watchTablesListMode(b);(a=this._getViewableTables(b))&&a.length?(this._createNewItems(a),this._modifyOrRemoveItems(a),this._sortItems(a)):this._removeAllItems()};d._createNewItems=
function(a){const {tableItems:b}=this;a.forEach(c=>{b.find(e=>e.layer===c)||b.add(new n({layer:c}))})};d._modifyOrRemoveItems=function(a){const {tableItems:b}=this;b.forEach(c=>{c&&(a&&a.find(e=>c.layer===e)?this._modifyListItem(c):b.remove(c))})};d._sortItems=function(a){const {tableItems:b}=this;b.sort((c,e)=>{c=a.indexOf(c.layer);e=a.indexOf(e.layer);return c>e?-1:c<e?1:0})};m._createClass(l,[{key:"state",get:function(){var a;const b=null==(a=this.map)?void 0:a.loadStatus;return"string"===typeof b?
"loaded"===b?"ready":"loading"===b?"loading":"disabled":"ready"}}]);return l}(t.EventedAccessor);g.__decorate([k.property()],f.prototype,"listItemCreatedFunction",void 0);g.__decorate([k.property({type:p})],f.prototype,"tableItems",void 0);g.__decorate([k.property()],f.prototype,"map",void 0);g.__decorate([k.property({dependsOn:["map","map.loadStatus"],readOnly:!0})],f.prototype,"state",null);return f=g.__decorate([r.subclass("esri.widgets.TableList.TableListViewModel")],f)});