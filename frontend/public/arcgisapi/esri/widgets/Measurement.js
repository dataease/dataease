// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/promiseUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/renderable ../chunks/index ./Widget ./Measurement/MeasurementViewModel".split(" "),
function(n,w,e,b,C,D,l,p,E,x,F,G,H,y,I,z,q,A,B,v){function r(t){return Object.freeze({__proto__:null,"default":t})}b=function(t){function u(a,d){a=t.call(this,a,d)||this;a._widgets=new Map;a.activeTool=null;a.activeWidget=null;a.areaUnit=null;a.iconClass="esri-icon-measure";a.label=void 0;a.linearUnit=null;a.messages=null;a.view=null;a.viewModel=new v;return a}w._inheritsLoose(u,t);var f=u.prototype;f.initialize=function(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel);
this.view&&this.activeTool&&this._getActiveWidget().then(a=>{this._set("activeWidget",a)});this.own([this.watch(["view","activeTool"],()=>{this._getActiveWidget().then(a=>{this._set("activeWidget",a)})}),this.watch("activeWidget",(a,d)=>{this.viewModel.set("activeViewModel",a?a.viewModel:null);d&&(d.visible=!1)}),this.watch(["areaUnit","linearUnit"],()=>this._updateWidgetUnits())])};f.destroy=function(){this._destroyWidgets()};f.render=function(){var {activeWidget:a}=this;a=a&&!a.destroyed?a.render():
null;return A.jsx("div",{class:"esri-measurement"},a)};f.clear=function(){this.activeTool=null;this._destroyWidgets()};f.startMeasurement=function(){const {activeViewModel:a}=this.viewModel;a&&y.ignoreAbortErrors(a.start())};f._createWidget=async function(a){const {areaUnit:d,linearUnit:c,view:m}=this;switch(a){case "area":switch({type:a}=m,a){case "2d":return new (await new Promise(function(g,h){n(["./AreaMeasurement2D"],function(k){g(r(k))},h)})).default({view:m,unit:d});case "3d":return new (await new Promise(function(g,
h){n(["./AreaMeasurement3D"],function(k){g(r(k))},h)})).default({view:m,unit:d});default:return null}case "distance":return new (await new Promise(function(g,h){n(["./DistanceMeasurement2D"],function(k){g(r(k))},h)})).default({view:m,unit:c});case "direct-line":return new (await new Promise(function(g,h){n(["./DirectLineMeasurement3D"],function(k){g(r(k))},h)})).default({view:m,unit:c});default:return null}};f._destroyWidgets=function(){this._widgets.forEach(a=>a.destroy());this._widgets.clear()};
f._getActiveWidget=async function(){const {activeTool:a,view:d}=this;if(!d||!a)return null;let c=null;if(this._widgets.has(a))c=this._widgets.get(a),c.visible=!0;else{c=await this._createWidget(a);if(!c)return null;await c.viewModel.start();this._widgets.set(a,c)}return c};f._updateWidgetUnits=function(){this._widgets.forEach(a=>{const {areaUnit:d,linearUnit:c}=this;a.unit=!a||"esri.widgets.AreaMeasurement2D"!==a.declaredClass&&"esri.widgets.AreaMeasurement3D"!==a.declaredClass?c:d})};return u}(B);
e.__decorate([p.aliasOf("viewModel.activeTool")],b.prototype,"activeTool",void 0);e.__decorate([l.property({readOnly:!0}),q.renderable()],b.prototype,"activeWidget",void 0);e.__decorate([p.aliasOf("viewModel.areaUnit")],b.prototype,"areaUnit",void 0);e.__decorate([l.property()],b.prototype,"iconClass",void 0);e.__decorate([l.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],b.prototype,"label",void 0);e.__decorate([p.aliasOf("viewModel.linearUnit")],b.prototype,"linearUnit",void 0);
e.__decorate([l.property(),q.renderable(),z.messageBundle("esri/widgets/Measurement/t9n/Measurement")],b.prototype,"messages",void 0);e.__decorate([p.aliasOf("viewModel.view"),q.renderable()],b.prototype,"view",void 0);e.__decorate([l.property({type:v}),q.renderable(["viewModel.state"])],b.prototype,"viewModel",void 0);return b=e.__decorate([x.subclass("esri.widgets.Measurement")],b)});