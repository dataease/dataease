// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/maybe ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../intl/substitute ../intl ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/renderable ../chunks/index ./Widget ./Histogram/HistogramViewModel".split(" "),
function(y,k,h,B,M,N,n,r,O,C,P,Q,R,D,S,E,F,t,l,G,H){var x;h=x=function(z){function u(a,b){a=z.call(this,a,b)||this;a._containerNode=null;a._defaultBarColor="#d8d8d8";a.average=null;a.barCreatedFunction=null;a.bins=null;a.dataLines=null;a.dataLineCreatedFunction=null;a.dataLineUpdatedFunction=null;a.label=void 0;a.labelFormatFunction=null;a.max=null;a.messages=null;a.min=null;a.state=null;a.viewModel=new H;return a}y._inheritsLoose(u,z);u.fromHistogramResult=function(a){const {bins:b,maxValue:c,minValue:e}=
a;return new x({bins:b,max:c,min:e})};var f=u.prototype;f.render=function(){const {label:a,layout:b,state:c}=this,e=this.classes("esri-histogram","esri-widget","horizontal"===b?"esri-histogram--horizontal":"esri-histogram--vertical","disabled"===c?"esri-disabled":null);return l.jsx("div",{"aria-label":a,afterCreate:E.storeNode,bind:this,class:e,"data-node-ref":"_containerNode"},"ready"===c?this.renderContent():null)};f.renderContent=function(){if(this._containerNode)return l.jsx("div",{class:"esri-histogram__content"},
l.jsx("svg",{class:"esri-histogram__svg",xmlns:"http://www.w3.org/2000/svg"},this.renderBarsGroup(),this.renderLinesGroup()))};f.renderBarsGroup=function(){return l.jsx("g",{class:this.classes("esri-histogram__bars")},this.renderBars())};f.renderBars=function(){const {layout:a,viewModel:{binRange:b,range:c}}=this;if(b&&c){var e=b/c,[d,g]=this._getContainerDimensions();if(0!==d||0!==g)if(0===d&&0!==g)this.scheduleRender();else{var [m,q]="vertical"===a?[d*e,g]:[d,g*e];return this._getBarDimensions(m,
q).map(([v,w],p)=>this.renderBar(p,v,w))}}};f.renderBar=function(a,b,c){const {bins:e,layout:d,max:g,messages:m,viewModel:{range:q}}=this,[v,w]=this._getContainerDimensions();var p=e.slice()[a];const {count:I,maxValue:A,minValue:J}=p;p=g-A;const [K,L]="vertical"===d?[0,v/q*p]:[w-c-w/q*p,v-b];p=D.substitute(m.barLabel,{count:I,maxValue:A,minValue:J});return l.jsx("rect",{"aria-label":p,afterCreate:this._afterBarCreate,bind:this,class:"esri-histogram__bar","data-index":a,fill:this._defaultBarColor,
height:b,role:"img","shape-rendering":"crispEdges","stroke-width":"0",width:c,x:K,y:L})};f.renderLinesGroup=function(){return l.jsx("g",{class:this.classes("esri-histogram__data-lines")},this.renderAverageLine(),this.renderCustomLines())};f.renderAverageLine=function(){const {average:a}=this;if(B.isSome(a)){var b=[l.jsx("tspan",{class:this.classes("esri-histogram__average-symbol")},"x\u0304 "),l.jsx("tspan",{class:this.classes("esri-histogram__average-label")},this.labelFormatFunction?this.labelFormatFunction(a,
"average"):a)];return l.jsx("g",{afterCreate:this._afterLinesSubgroupCreate,afterUpdate:this._afterLinesSubgroupUpdate,bind:this,class:this.classes("esri-histogram__data-lines-subgroup")},this.renderLine(a,this.classes("esri-histogram__average-data-line")),this.renderLabel(a,b))}};f.renderCustomLines=function(){if(this.dataLines&&this.dataLines.length)return this.dataLines.map(({value:a,label:b},c)=>this.renderLineSubgroup(c,a,b))};f.renderLineSubgroup=function(a,b,c){return l.jsx("g",{afterCreate:this._afterLinesSubgroupCreate,
afterUpdate:this._afterLinesSubgroupUpdate,bind:this,class:this.classes("esri-histogram__data-lines-subgroup"),"data-index":a},this.renderLine(b),this.renderLabel(b,c))};f.renderLine=function(a,b){const [c,e,d,g]=this._getLinePosition(a);return l.jsx("line",{class:this.classes("esri-histogram__data-line",b),x1:c,x2:e,y1:d,y2:g,"shape-rendering":"crispEdges"})};f.renderLabel=function(a,b,c){const [e,d]=this._getLabelPosition(a);return l.jsx("text",{class:this.classes("esri-histogram__label",c),"text-anchor":"end",
transform:"horizontal"===this.layout?"rotate(270)":null,x:e,y:d-2},b)};f._afterBarCreate=function(a){if(this.barCreatedFunction){const b=a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.barCreatedFunction(isNaN(b)?null:b,a)}};f._afterLinesSubgroupCreate=function(a){if(this.dataLineCreatedFunction){const b=a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.dataLineCreatedFunction(a.childNodes[0],
a.childNodes[1]?a.childNodes[1]:null,isNaN(b)?null:b)}};f._afterLinesSubgroupUpdate=function(a){if(this.dataLineUpdatedFunction){const b=a.dataset?parseInt(a.dataset.index,10):a.getAttribute("data-index")?parseInt(a.getAttribute("data-index"),10):null;this.dataLineUpdatedFunction(a.childNodes[0],a.childNodes[1]?a.childNodes[1]:null,isNaN(b)?null:b)}};f._getContainerDimensions=function(){const {_containerNode:a}=this;return a?[a.offsetHeight,a.offsetWidth]:[0,0]};f._getBarDimensions=function(a,b){const {bins:c,
layout:e}=this,d=c?c.map(m=>m.count):[],g=Math.max.apply(Math,d);return d.map(m=>"vertical"===e?[a/d.length,0!==g?m/g*b:0]:[0!==g?m/g*a:0,b/d.length])};f._getLinePosition=function(a){const {layout:b,min:c,viewModel:{range:e}}=this;a=Math.round((a-c)/e*100)/100;const [d,g]=this._getContainerDimensions(),[m,q]=[a*g||1,d-a*d||1];return"vertical"===b?[0,"100%",q,q]:[m,m,"100%",0]};f._getLabelPosition=function(a){const {layout:b,min:c,viewModel:{range:e}}=this;a=Math.round((a-c)/e*100)/100;const [d,g]=
this._getContainerDimensions();return"vertical"===b?[g,d-a*d]:[0,a*g]};y._createClass(u,[{key:"layout",set:function(a){"vertical"!==a&&(a="horizontal");this._set("layout",a)}}]);return u}(G);k.__decorate([r.aliasOf("viewModel.average")],h.prototype,"average",void 0);k.__decorate([n.property(),t.renderable()],h.prototype,"barCreatedFunction",void 0);k.__decorate([r.aliasOf("viewModel.bins")],h.prototype,"bins",void 0);k.__decorate([n.property(),t.renderable()],h.prototype,"dataLines",void 0);k.__decorate([n.property(),
t.renderable()],h.prototype,"dataLineCreatedFunction",void 0);k.__decorate([n.property(),t.renderable()],h.prototype,"dataLineUpdatedFunction",void 0);k.__decorate([n.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],h.prototype,"label",void 0);k.__decorate([r.aliasOf("viewModel.labelFormatFunction")],h.prototype,"labelFormatFunction",void 0);k.__decorate([n.property({value:"horizontal"})],h.prototype,"layout",null);k.__decorate([r.aliasOf("viewModel.max")],h.prototype,"max",void 0);
k.__decorate([n.property(),t.renderable(),F.messageBundle("esri/widgets/Histogram/t9n/Histogram")],h.prototype,"messages",void 0);k.__decorate([r.aliasOf("viewModel.min")],h.prototype,"min",void 0);k.__decorate([r.aliasOf("viewModel.state")],h.prototype,"state",void 0);k.__decorate([n.property(),t.renderable("viewModel.average viewModel.bins viewModel.labelFormatFunction viewModel.max viewModel.min viewModel.state".split(" "))],h.prototype,"viewModel",void 0);return h=x=k.__decorate([C.subclass("esri.widgets.Histogram")],
h)});