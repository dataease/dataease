// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/maybe ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/decorators/aliasOf ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/events ../../../../core/watchUtils ../../../../core/HandleOwner ../../../support/widgetUtils ../../../support/decorators/renderable ../../../../chunks/index ../../../Widget ./ButtonMenuViewModel ../../../support/Popover".split(" "),
function(u,k,f,v,G,H,m,q,I,w,J,K,L,x,y,z,A,n,e,B,C,D){f=function(r){function p(a,b){a=r.call(this,a,b)||this;a._menuContentNode=null;a._popover=null;a._rootNode=null;a.iconClass=null;a.items=null;a.label=null;a.open=!1;a.viewModel=new C;return a}u._inheritsLoose(p,r);var d=p.prototype;d.initialize=function(){this.when(()=>{this._popover=new D({owner:this,placement:A.isRTL()?"bottom-start":"bottom-end",renderContentFunction:this.renderMenuContent,anchorElement:this._rootNode});this.handles.add([y.watch(this,
"open",a=>this._popover.set("open",a))])});document.addEventListener("click",a=>this._handleOutsideClick(a))};d.destroy=function(){var a;null==(a=this._popover)?void 0:a.destroy();this._popover=null;document.removeEventListener("click",b=>this._handleOutsideClick(b))};d._handleOutsideClick=function(a){var b,c;this.open&&this._rootNode&&this._menuContentNode&&(a=a.target,null!=(b=this._menuContentNode)&&b.contains(a)||null!=(c=this._rootNode)&&c.contains(a)||(this.open=!1))};d.render=function(){return e.jsx("div",
{afterCreate:this._afterRootNodeCreate,bind:this,"data-node-ref":"_rootNode",class:this.classes("esri-button-menu","esri-widget"),key:"menu"},this.renderMenuButton())};d.renderMenuButton=function(){const {iconClass:a,id:b,label:c,open:h}=this,g=this.classes(["esri-button-menu__button",a||"esri-icon-menu",h?"esri-button-menu__button--selected":null]);return e.jsx("button",{"aria-pressed":h.toString(),"aria-controls":`${b}-menu`,"aria-expanded":h,"aria-haspopup":"true","aria-label":c,bind:this,class:g,
id:`${b}-button`,title:c,selected:h,onclick:this._toggleOpen,tabindex:"0",type:"button"})};d.renderMenuContent=function(){var a;const {id:b,open:c}=this;return e.jsx("div",{afterCreate:this._afterMenuContentNodeCreate,bind:this,class:"esri-button-menu__content","data-node-ref":"_menuContentNode",key:"esri-button-menu-content",hidden:!c},e.jsx("ul",{"aria-labelledby":`${b}-button`,bind:this,class:"esri-button-menu__item-wrapper",id:`${b}-menu`,role:"menu"},(null==(a=this.items)?void 0:a.length)&&this.renderItems()))};
d.renderItems=function(){var a;return null==(a=this.items)?void 0:a.map((b,c)=>this.renderItem(b,c))};d.renderItem=function(a,b,c){var h;const g=v.isSome(c)?`${this.id}-menu-item-${b}-${c}`:`${this.id}-menu-item-${b}`,t=`${g}-label`,E=this.classes("esri-button-menu__item",a.selectionEnabled?"esri-button-menu__item--selectable":null,a.selectionEnabled&&a.selected?"esri-button-menu__item--selected":null);return e.jsx("li",{afterCreate:this._afterMenuItemCreate,bind:this,class:E,"data-item-index":b,
"data-item-subIndex":c,for:g,key:g,onkeydown:l=>this._handleMenuItemKeydown(l,a),onclick:l=>this._handleMenuItemInteraction(l,a),role:"menuitem",tabindex:"0"},e.jsx("input",{disabled:!0,checked:a.selected,class:"esri-button-menu__checkbox",id:g,name:g,tabindex:"-1",type:"checkbox"}),e.jsx("label",{bind:this,class:this.classes("esri-button-menu__button","esri-button-menu__item-label"),for:g,id:t},e.jsx("span",{class:this.classes("esri-button-menu__icon",a.iconClass),"aria-hidden":!0}),e.jsx("span",
{class:"esri-button-menu__item-label-content"},a.label)),e.jsx("ul",{"aria-labelledby":t,class:"esri-button-menu__embedded-content-wrapper",id:`${this.id}-submenu`,role:"menu"},null==a?void 0:null==(h=a.items)?void 0:h.map((l,F)=>this.renderItem(l,b,F))))};d._afterRootNodeCreate=function(a){var b;this._rootNode=a;null==(b=this._popover)?void 0:b.set("anchorElement",()=>a)};d._handleMenuItemInteraction=function(a,b){b.selected=!b.selected;b.open=!(!b.selected||!b.items);b.autoCloseMenu&&this.set("open",
!1);b.clickFunction&&b.clickFunction({event:a,item:b});a.stopPropagation()};d._handleMenuItemKeydown=function(a,b){const c=x.eventKey(a);"Enter"!==c&&" "!==c||this._handleMenuItemInteraction(a,b);"Escape"===c&&(this.open=!1,a.preventDefault(),a.stopPropagation())};d._afterMenuContentNodeCreate=function(a){this._menuContentNode=a;a.focus()};d._toggleOpen=function(){this.open=!this.open};d._afterMenuItemCreate=function(a){0===a["data-item-index"]&&a.focus()};return p}(z.HandleOwnerMixin(B));k.__decorate([m.property(),
n.renderable()],f.prototype,"iconClass",void 0);k.__decorate([q.aliasOf("viewModel.items")],f.prototype,"items",void 0);k.__decorate([m.property(),n.renderable()],f.prototype,"label",void 0);k.__decorate([q.aliasOf("viewModel.open")],f.prototype,"open",void 0);k.__decorate([m.property(),n.renderable(["viewModel.items","viewModel.open"])],f.prototype,"viewModel",void 0);return f=k.__decorate([w.subclass("esri.widgets.FeatureTable.Grid.support.ButtonMenu")],f)});