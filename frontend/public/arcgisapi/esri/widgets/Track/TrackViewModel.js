// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../support/GeolocationPositioning".split(" "),function(l,d,b,t,u,e,v,p,w,x,y,q){b=function(m){function f(a){a=m.call(this,a)||this;a._watchId=null;a._trackStartingTimeoutId=
null;a._settingPosition=null;return a}l._inheritsLoose(f,m);var c=f.prototype;c.destroy=function(){this._stopTracking()};c.start=function(){"disabled"!==this.state&&"feature-unsupported"!==this.state&&this._startTracking()};c.stop=function(){"disabled"!==this.state&&"feature-unsupported"!==this.state&&this._stopTracking()};c._stopWatchingPosition=function(){null!==this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=null)};c._stopTracking=function(){this._clearWaitingTimer();
this._stopWatchingPosition();this._clear()};c._startTracking=function(){this._stopTracking();const a=navigator.geolocation.watchPosition(r=>{this._watchId=a;this._settingPosition=this._setPosition(r).then(g=>{this._clearWaitingTimer();const {view:h,graphic:k}=this;h&&h.graphics.remove(k);if(k){const n=k.clone();this.graphic=n;h&&h.graphics.push(n)}this.emit("track",{position:g})}).catch(g=>{this._emitError(g);this._clearWaitingTimer();throw g;})},this._handleWatchPositionError.bind(this),this.geolocationOptions);
this._trackStartingTimeoutId=setTimeout(()=>{this._trackStartingTimeoutId=null},15E3)};c._handleWatchPositionError=function(a){this._emitError(a);this._stopTracking()};c._clearWaitingTimer=function(){clearTimeout(this._trackStartingTimeoutId);this._settingPosition=this._trackStartingTimeoutId=null};c._emitError=function(a){this.emit("track-error",{error:a})};l._createClass(f,[{key:"state",get:function(){return this._geolocationUsable?this.view&&!this.view.ready?"disabled":this._settingPosition||null!==
this._trackStartingTimeoutId?"waiting":this.tracking?"tracking":"ready":"feature-unsupported"}},{key:"tracking",get:function(){return null!==this._watchId}}]);return f}(q);d.__decorate([e.property()],b.prototype,"_watchId",void 0);d.__decorate([e.property()],b.prototype,"_trackStartingTimeoutId",void 0);d.__decorate([e.property()],b.prototype,"_settingPosition",void 0);d.__decorate([e.property({dependsOn:["view.ready","tracking","_geolocationUsable","_trackStartingTimeoutId","_settingPosition"],readOnly:!0})],
b.prototype,"state",null);d.__decorate([e.property({readOnly:!0,dependsOn:["_watchId"]})],b.prototype,"tracking",null);d.__decorate([e.property()],b.prototype,"start",null);d.__decorate([e.property()],b.prototype,"stop",null);return b=d.__decorate([p.subclass("esri.widgets.Track.TrackViewModel")],b)});