// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/promiseUtils ../../core/Accessor ../../core/Evented ../../assets ../../symbols/PictureMarkerSymbol ../../Graphic ./GoTo ./geolocationUtils".split(" "),
function(q,g,d,J,K,h,L,r,t,M,N,O,u,v,w,x,y,z,A,n){d=function(p){function l(){var a=p.apply(this,arguments)||this;a._geolocationUsable=!0;a._iconPath=x.getAssetUrl("esri/images/support/sdk_gps_location.png");a.geolocationOptions=null;a.goToLocationEnabled=!0;a.graphic=new z({symbol:new y({url:a._iconPath,width:21,height:21})});a.scale=null;a.useHeadingEnabled=!0;a.view=null;return a}q._inheritsLoose(l,p);var f=l.prototype;f.initialize=function(){n.supported()||(this._geolocationUsable=!1)};f.destroy=
function(){this._clear();this.view=null};f._clear=function(){this.view&&this.view.graphics.remove(this.graphic)};f._getScaleWithinConstraints=function(a,b){if(!b)return a;if("2d"===b.type){const {effectiveMaxScale:e,effectiveMinScale:c}=b.constraints;return Math.min(c,Math.max(e,a))}return a};f._getScale=function(a){const {scale:b}=this;return this._getScaleWithinConstraints("number"===typeof b?b:2500,a)};f._getHeading=function(a,b){b=b&&b.spatialReference;a=a.coords&&a.coords.heading;if(!(!b||!b.isWebMercator&&
!b.isGeographic||"number"!==typeof a||isNaN(a)||0>a||360<a))return a};f._addHeading=function(a){const {heading:b,target:e,view:c}=a;c&&"number"===typeof b&&!isNaN(b)&&("3d"===c.type?e.heading=b:"2d"===c.type&&(e.rotation=360-b))};f._animatePoint=function(a,b,e,c){const {view:k}=this;if(!this.goToLocationEnabled||!k)return u.resolve(b);const m=this.useHeadingEnabled?this._getHeading(b,k):void 0;a={target:a,scale:e};this._addHeading({heading:m,target:a,view:k});return this.callGoTo({target:a,options:c}).then(()=>
b)};f._setPosition=async function(a,b){try{const c=await n.positionToPoint({position:a,view:this.view},b),{graphic:k}=this;var {timestamp:e}=a;const {coords:m}=a,{accuracy:B,altitude:C,altitudeAccuracy:D,heading:E,latitude:F,longitude:G,speed:H}=m;e={timestamp:e,accuracy:B,altitude:C,altitudeAccuracy:D,heading:E,latitude:F,longitude:G,speed:H};k&&(k.geometry=c,k.attributes=e);const I=this._getScale(this.view);return this._animatePoint(c,a,I,b)}catch(c){throw new t("positioning:invalid-point","Cannot position invalid point",
{error:c});}};return l}(A.GoToMixin(w.EventedMixin(v)));g.__decorate([h.property()],d.prototype,"_geolocationUsable",void 0);g.__decorate([h.property()],d.prototype,"geolocationOptions",void 0);g.__decorate([h.property()],d.prototype,"goToLocationEnabled",void 0);g.__decorate([h.property()],d.prototype,"graphic",void 0);g.__decorate([h.property()],d.prototype,"scale",void 0);g.__decorate([h.property()],d.prototype,"useHeadingEnabled",void 0);g.__decorate([h.property()],d.prototype,"view",void 0);
return d=g.__decorate([r.subclass("esri.widgets.support.GeolocationPositioning")],d)});