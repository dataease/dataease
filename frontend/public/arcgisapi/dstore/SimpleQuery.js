//>>built
define(["dojo/_base/declare","dojo/_base/array"],function(w,l){function t(a,b){if(-1<a.indexOf(".")){var g=a.split("."),h=g.length;return function(d){for(var c=0;c<h;c++)d=d&&(b&&d.get?d.get(g[c]):d[g[c]]);return d}}return function(d){return d.get?d.get(a):d[a]}}var x={eq:function(a,b){return a===b},"in":function(a,b){return-1<l.indexOf(b.data||b,a)},ne:function(a,b){return a!==b},lt:function(a,b){return a<b},lte:function(a,b){return a<=b},gt:function(a,b){return a>b},gte:function(a,b){return a>=
b},match:function(a,b,g){return b.test(a,g)},contains:function(a,b,g,h){var d=this;b=b.data?b.data:Array.isArray(b)?b:[b];return l.every(b,function(c){if("object"===typeof c&&c.type){var f=d._getFilterComparator(c.type);return l.some(a,function(e){return f.call(d,e,c.args[1],g,h)})}return-1<l.indexOf(a,c)})}};return w(null,{_createFilterQuerier:function(a){function b(c){var f=c.type;c=c.args;var e=h._getFilterComparator(f);if(e){var k=c[0],y=t(k,g),n=c[1];n&&n.fetchSync&&(n=n.fetchSync());return function(p){return e.call(h,
y(p),n,p,k)}}switch(f){case "and":case "or":for(var r=0,z=c.length;r<z;r++){var u=b(c[r]);var m=m?function(p,v){return"and"===f?function(q){return p(q)&&v(q)}:function(q){return p(q)||v(q)}}(m,u):u}return m;case "function":return c[0];case "string":m=h[c[0]];if(!m)throw Error("No filter function "+c[0]+" was found in the collection");return m;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+f+'"');}}var g=this.queryAccessors,h=this,d=b(a);return function(c){return l.filter(c,
d)}},_getFilterComparator:function(a){return x[a]||this.inherited(arguments)},_createSelectQuerier:function(a){return function(b){var g=a.length;return l.map(b,a instanceof Array?function(h){for(var d={},c=0;c<g;c++){var f=a[c];d[f]=h[f]}return d}:function(h){return h[a]})}},_createSortQuerier:function(a){var b=this.queryAccessors;return function(g){g=g.slice();"function"===typeof a?g.sort(a):a&&a.length&&g.sort(function(h,d){for(var c=0;c<a.length;c++){var f=a[c];if("function"==typeof f)var e=f(h,
d);else{e=f.get||(f.get=t(f.property,b));f=f.descending;var k=e(h);e=e(d);null!=k&&(k=k.valueOf());null!=e&&(e=e.valueOf());e=k===e?0:!!f===("undefined"===typeof e||null===e&&"undefined"!==typeof k||null!=k&&k<e)?1:-1}if(0!==e)return e}return 0});return g}}})});