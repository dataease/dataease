//>>built
define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/dom-class dojo/on dojo/query dojo/dnd/Source".split(" "),function(l,g,h,n,p,w,q){function r(b,a){var c=a[2];b=b[c?"columnSets":"subRows"][a[1]];return c?b[a[2]]:b}function m(b,a,c){a[2]?b.columnSets[a[1]][a[2]]=c:b.subRows[a[1]]=c}function t(b,a){return a.slice(("dgrid-"+b+"-").length)}var u=/(\d+)(?:-(\d+))?$/;l=g(q,{copyState:function(){return!1},checkAcceptance:function(b){return b===this},_legalMouseDown:function(b){return-1<b.target.className.indexOf("dgrid-resize-handle")?
!1:this.inherited(arguments)},onDropInternal:function(b){var a=this.grid,c=u.exec(t(a.id,b[0].getAttribute("dndType"))),d=c[2]?"columnSets":"subRows",e=r(a,c),f=a.columns;this.inherited(arguments);c&&setTimeout(function(){var k=h.map(b[0].parentNode.childNodes,function(v){return f[v.columnId]});m(a,c,k);k={grid:a,subRow:k,column:f[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};k[d]=a[d];p.emit(a.domNode,"dgrid-columnreorder",k)?a.set(d,a[d]):(m(a,c,e),a.renderHeader(),a.sort.length&&a.updateSortArrow(a.sort))},
0)}});g=g(null,{columnDndConstructor:l,_initSubRowDnd:function(b,a){var c;var d=0;for(c=b.length;d<c;d++){var e=b[d];if(!1!==e.reorderable&&(e=e.headerNode,n.add(e,"dojoDndItem"),e.setAttribute("dndType",a),!f))var f=e.parentNode}f&&this._columnDndSources.push(new this.columnDndConstructor(f,{horizontal:!0,grid:this}))},renderHeader:function(){var b="dgrid-"+this.id+"-",a;this.inherited(arguments);this._columnDndSources&&h.forEach(this._columnDndSources,function(d){d.destroy()});this._columnDndSources=
[];if(this.columnSets){var c=0;for(a=this.columnSets.length;c<a;c++)h.forEach(this.columnSets[c],function(d,e){this._initSubRowDnd(d,b+c+"-"+e)},this)}else h.forEach(this.subRows,function(d,e){this._initSubRowDnd(d,b+e)},this)},_destroyColumns:function(){this._columnDndSources&&h.forEach(this._columnDndSources,function(b){b.destroy()});this.inherited(arguments)}});g.ColumnDndSource=l;return g});