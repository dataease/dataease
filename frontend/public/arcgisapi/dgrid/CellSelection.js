//>>built
define("dojo/_base/declare dojo/aspect dojo/dom-class dojo/on dojo/has ./Selection".split(" "),function(p,r,l,t,u,q){return p(q,{selectionDelegate:".dgrid-cell",_selectionTargetType:"cells",_select:function(a,b,d){"undefined"===typeof d&&(d=!0);if("object"!==typeof a||!("element"in a))a=this.cell(a);else if(!a.row){if(d&&"object"===typeof d)for(e in d)this._select(this.cell(a.id,e),null,d[e]);else for(e in this.columns)this._select(this.cell(a.id,e),null,d);return}if(this.allowSelect(a)){var h=a.row.id,
c=this.selection[h];if(a.column){var g=c&&c[a.column.id];null===d&&(d=!g);var k=a.element;c=c||{};c[a.column.id]=d;this.selection[h]=c;var m=!1;for(f in c)if(!0===c[f]){m=!0;break}m||delete this.selection[h];k&&(d?l.add(k,"dgrid-selected"+(this.addUiClasses?" ui-state-active":"")):l.remove(k,"dgrid-selected ui-state-active"));d!=g&&k&&this._selectionEventQueues[(d?"":"de")+"select"].push(a);if(b)if(b.element||(b=this.cell(b)),b&&b.row){g=b.element;var f=a.element;h=this._determineSelectionDirection(f,
g);h||(g=(b=this.cell(document.getElementById(b.row.element.id),g.columnId))&&b.element,h=this._determineSelectionDirection(f,g));f=a.column.id;g=b.column.id;c=[];for(e in this.columns)if(n&&c.push(e),e===f&&(f=c)||e===g&&(g=c)){c.push(e);if(n||f==c&&e==g)break;var n=!0}var e=a.row.element;g=b.row.element;do{for(f=0;f<c.length;f++)a=this.cell(e,c[f]),this._select(a,null,d);if(e==g)break}while(e=a.row.element[h])}else this._lastSelected=k,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")}else for(f in this.columns)this._select(this.cell(h,
f),null,d)}},_determineSelectionDirection:function(){var a=this.inherited(arguments);return"down"===a?"nextSibling":"up"===a?"previousSibling":a},isSelected:function(a,b){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.cell(a,b));b=a.row.id;return b in this.selection?!!this.selection[b][a.column.id]:this.allSelected&&(!a.row.data||this.allowSelect(a))},clearSelection:function(a){a=!1;this.inherited(arguments)}})});