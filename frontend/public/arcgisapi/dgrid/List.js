//>>built
define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/sniff ./util/misc".split(" "),function(y,B,l,m,q,C,h,k){function r(a,b){return C("#"+k.escapeCssIdentifier(a),b)[0]}function z(a,b){a.className="dgrid-scrollbar-measure";document.body.appendChild(a);b=a["offset"+b]-a["client"+b];a.className="";a.parentNode&&document.body.removeChild(a);return b}function t(a){l.replace(this.domNode,a,this._class||"");this._class=a}function A(){return this._class}var u=
[];h("mozilla")&&u.push("has-mozilla");h("touch")&&u.push("has-touch");l.add(document.documentElement,u);h.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});var p,v;h.add("dom-scrollbar-width",function(a,b,c){return z(c,"Width")});h.add("dom-scrollbar-height",function(a,b,c){return z(c,"Height")});h.add("dom-rtl-scrollbar-left",function(a,b,c){a=document.createElement("div");c.className="dgrid-scrollbar-measure";c.setAttribute("dir","rtl");c.appendChild(a);
document.body.appendChild(c);b=!!h("ie")||!!h("trident")||/\bEdge\//.test(navigator.userAgent)||a.offsetLeft>=h("dom-scrollbar-width");c.className="";c.parentNode&&document.body.removeChild(c);m.destroy(a);c.removeAttribute("dir");return b});var D=0,w=function(){this._started&&this.resize()},x=y(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!0,highlightDuration:250,resizeThrottleDelay:k.defaultDelay,resizeThrottleMethod:"throttleDelayed",postscript:function(a,
b){var c=this;(this._Row=function(f,d,g){this.id=f;this.data=d;this.element=g}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:r(b));this.create(a,b)},listType:"list",create:function(a,b){b=this.domNode=b||document.createElement("div");if(a){this.params=a;y.safeMixin(this,a);var c=a["class"]||a.className||b.className}this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=b.id=b.id||this.id||
x.autoIdPrefix+D++;this.buildRendering();c&&t.call(this,c);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this;var f=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";a.setAttribute("role","grid");l.add(a,"dgrid dgrid-"+this.listType+(b?" ui-widget":""));var d=this.headerNode=m.create("div",{className:"dgrid-header dgrid-header-row"+
(b?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},a);var g=this.bodyNode=m.create("div",{className:"dgrid-scroller"},a);h("ff")&&(g.tabIndex=-1);this.headerScrollNode=m.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(b?" ui-widget-header":"")},a);this.footerNode=m.create("div",{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},a);f&&(a.className+=" dgrid-rtl"+(h("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));q(g,"scroll",
function(e){c.showHeader&&(d.scrollLeft=e.scrollLeft||g.scrollLeft);e.stopPropagation();q.emit(a,"scroll",{scrollTarget:g})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=m.create("div",{className:"dgrid-content"+(b?" ui-widget-content":"")},this.bodyNode);"string"===typeof this.resizeThrottleMethod&&k[this.resizeThrottleMethod]?b=k[this.resizeThrottleMethod](w,this,this.resizeThrottleDelay):"function"===typeof this.resizeThrottleMethod?b=this.resizeThrottleMethod(B.hitch(this,
w),this.resizeThrottleDelay):(console.warn("Invalid value specified for resizeThrottleMethod:  "+this.resizeThrottleMethod),b=k.throttleDelayed(w,this,this.resizeThrottleDelay));this._resizeHandle=q(window,"resize",b);this._listeners.push(this._resizeHandle)},postCreate:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this.sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.footerNode;b=this.showFooter?
b.offsetHeight:0;this.headerScrollNode.style.height=a.style.marginTop=this.headerNode.offsetHeight+"px";a.style.marginBottom=b+"px";p||(p=h("dom-scrollbar-width"),v=h("dom-scrollbar-height"),h("ie")&&(p++,v++),k.addCssRule(".dgrid-scrollbar-width","width: "+p+"px"),k.addCssRule(".dgrid-scrollbar-height","height: "+v+"px"),17!==p&&(k.addCssRule(".dgrid-header-row","right: "+p+"px"),k.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+p+"px")))},addCssRule:function(a,b){a=k.addCssRule(a,b);this.cleanAddedRules&&
this._listeners.push(a);return a},on:function(a,b){return q(this.domNode,a,b)},cleanup:function(){for(var a in this._rowIdToObject)if(this._rowIdToObject[a]!==this.columns){var b=r(a,this.domNode);b&&this.removeRow(b,!0)}},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();this._listeners=null}this._started=!1;this.cleanup();m.destroy(this.domNode)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoRowId=0;this.contentNode.innerHTML=
"";this.scrollTo({x:0,y:0})},highlightRow:function(a,b){var c="dgrid-highlight"+(this.addUiClasses?" ui-state-highlight":"");a=a.element||a;l.add(a,c);setTimeout(function(){l.remove(a,c)},b||this.highlightDuration)},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&this.setRowIndex(a,b++,a.rowIndex);while((a=a.nextSibling)&&a.rowIndex!==b)}},renderArray:function(a,b,c){c=c||{};var f=c.start||0,d=document.createDocumentFragment(),g=[],e=0,n=a.length;b||(this._lastCollection=a);
for(;e<n;)g[e]=this.insertRow(a[e],d,null,f++,c),e++;(a=b?b.parentNode:this.contentNode)&&a.parentNode&&(a!==this.contentNode||n)&&(a.insertBefore(d,b||null),n&&this.adjustRowIndices(g[n-1]));return g},renderHeader:function(){},setRowIndex:function(a,b,c){a.rowIndex=b;this.maintainOddEven&&(b=1===b%2?"dgrid-row-odd":"dgrid-row-even",void 0!==c?(c=1===c%2?"dgrid-row-odd":"dgrid-row-even",c!==b&&l.replace(a,c,b)):l.add(a,b))},_autoRowId:0,insertRow:function(a,b,c,f,d){var g=this.id+"-row-"+(this.collection&&
this.collection.getIdentity?this.collection.getIdentity(a):this._autoRowId++),e=r(g,this.domNode),n=e&&e.previousSibling;e&&(e===c&&(c=(c.connected||c).nextSibling),this.removeRow(e,!1,d));e=this.renderRow(a,d);e.className=(e.className||"")+" dgrid-row "+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[e.id=g]=a;b.insertBefore(e,c||null);this.setRowIndex(e,f);n&&n.rowIndex!==e.rowIndex-1&&this.adjustRowIndices(n);return e},renderRow:function(a){var b=document.createElement("div");b.appendChild(document.createTextNode(a));
return b},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||m.destroy(a)},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!==this.domNode)}else return"object"===typeof a?b=this.collection.getIdentity(a):(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,r(this.id+"-row-"+b,
this.domNode))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,f){var d;var g=d=a.element;b=b||1;do if(a=d[0>b?"previousSibling":"nextSibling"]){do if((d=a)&&-1<(d.className+" ").indexOf(c+" ")){g=d;b+=0>b?1:-1;break}while(a=(!f||!d.hidden)&&d[0>b?"lastChild":"firstChild"])}else if(d=d.parentNode,!d||d===this.bodyNode||d===this.headerNode)break;while(b);return g},up:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||
(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:function(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,
a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:A,_setClass:t,_getClassName:A,_setClassName:t,_setSort:function(a,b){this.sort="string"!==typeof a?a:[{property:a,descending:b}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var a=this.sort;if(a&&0<a.length){var b=a[0].property,c=!!a[0].descending;this._lastCollection.sort(function(f,d){f=f[b];d=d[b];
void 0===f&&(f="");void 0===d&&(d="");return f===d?0:f>d!==c?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;l.toggle(b,"dgrid-header-hidden",!a);this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(a){this.showFooter=a;l.toggle(this.footerNode,"dgrid-footer-hidden",!a);this.resize()}});x.autoIdPrefix="dgrid_";return x});