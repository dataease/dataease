// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/layers/support/WebGLRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-style dojox/gfx/matrix ../../kernel ../../lang ../../sniff ../../urlUtils ../../geometry/scaleUtils ../vectorTiles/core/promiseUtils ../vectorTiles/views/2d/engine/StageGL ../vectorTiles/views/2d/engine/webgl/WGLFeatureView ../vectorTiles/views/2d/layers/features/processors/SymbolProcessor ../vectorTiles/views/2d/layers/features/tileRenderers/SymbolTileRenderer ../vectorTiles/views/2d/support/HighlightOptions ../vectorTiles/layers/support/TileInfo ../vectorTiles/views/2d/tiling/TileInfoView ../vectorTiles/geometry/SpatialReference ../vectorTiles/geometry/support/spatialReferenceUtils ../vectorTiles/renderers/SimpleRenderer ../vectorTiles/renderers/ClassBreaksRenderer ../vectorTiles/renderers/UniqueValueRenderer".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z,f,n,r,B,C){function D(f){Object.defineProperty(f,"width",{get:function(){return this.size[0]}});Object.defineProperty(f,"height",{get:function(){return this.size[1]}});Object.defineProperty(f,"center",{get:function(){var f=this.viewpoint.targetGeometry;return[f.x,f.y]}})}var F=t.default,H=u.SymbolProcessor,J=y.default,I=d("esri-will-change"),G=void 0===d("ie")&&7<=d("trident"),Q=d("safari"),W=G||d("edge"),K=function(){var f,a=window.performance||{},n=a.now||
a.webkitNow||a.msNow||a.oNow||a.mozNow;if(void 0!==n)return function(){return n.call(a)};f=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:(new Date).getTime();return function(){return(new Date).getTime()-f}}();t=d("ff");u=d("ie");y=d("webkit");var aa=d("opera"),ba=(new Date).getTime(),ca=window.requestAnimationFrame;ca||(ca=window[(y&&"webkit"||t&&"moz"||aa&&"o"||u&&"ms")+"RequestAnimationFrame"])||(ca=function(f){var a=
K(),n=Math.max(0,16-(a-ba)),c=window.setTimeout(function(){f(K())},n);ba=a+n;return c});k=k(null,{surfaceType:"webgl",surface:null,map:null,layer:null,updateOnPan:!1,renderOnNav:!1,_canvas:null,_mapSR4:null,_dprWatchDelay:2E3,_dprTimer:null,_rendererEvalTimer:null,_redrawPromises:null,_defaultTileSize:512,_tileInfo:null,_tileInfoView:null,_wglContainer:null,_wglView:null,_tileRenderer:null,_tileRendererProps:null,_layerListenerHandles:null,_mapListenerHandles:null,_symbolProcessor:null,_returnCentroid:null,
_started:!1,_renderRequested:!1,_updateRequested:!1,_frameRequested:!1,_frameHandle:null,_viewState:null,_renderParameters:null,_updateParameters:null,_zooming:!1,_panning:!1,_scaleMatrix:null,_defaultTransition:"transform 500ms ease",_panDx:0,_panDy:0,_clipRect:null,constructor:function(f){this._frame=this._frame.bind(this);this._evalRendererChange=this._evalRendererChange.bind(this);this._redrawPromises=new Map;l.mixin(this,f);this._setup()},destroy:function(){this._teardown()},getNode:function(){return this._canvas},
getEventSource:function(){return this.getNode()},setClip:function(f){this._clipRect=null;var a=W&&G?"rect(auto,auto,auto,auto)":null;if(f){var a=f.x,n=f.y,d=f.width;f=f.height;this._clipRect={x:a,y:n,width:d,height:f};var e=this.layer.getNavigationTransform(),a=a+e.dx,n=n+e.dy,a=W?this._getClipRect(a,n,d,f):this._getClipPath(a,n,d,f)}c.set(this.getNode(),W?"clip":"clip-path",a);Q&&c.set(this.getNode(),"-webkit-clip-path",a)},start:function(){this._started=!0;this._renderParameters.pixelRatio=this._updateParameters.pixelRatio=
window.devicePixelRatio;this._watchDPR();this._updateMapView(this.map.extent)},stop:function(){this._started=!1;this._unwatchDPR();this._stopFrame()},redraw:function(){this._handleRendererChange()},hitTest:function(f,a){return this.layer.suspended?p.resolve(null):this._wglView.hitTest(f,a).then(function(f){return 0===f.length?null:this.layer._mode._featureMap[f[0]]}.bind(this))},syncHitTest:function(f,a){var n=this._wglContainer.prepareChildrenRenderParameters(this._renderParameters),n=this._wglView.prepareChildrenRenderParameters(n);
f=this._wglView._hitTest(n,f,a);this._scheduleRender();return this.layer._mode._featureMap[f[0]]},_setup:function(){this._initState();this._createWGLContainer();this._createTileRenderer();this._applyLayerSettings();this._createMapListeners();this._setViewState();this._initRendering()},_teardown:function(){this._destroyRendering();this._destroyMapListeners();this._destroyLayerListeners();this._destroyTileRenderer();this._destroyWGLContainer();this.stop();this.surface.getEventSource().removeChild(this.getNode())},
_createWGLContainer:function(){this._wglContainer=new q;this._canvas=this._wglContainer.createElement();I&&c.set(this._canvas,"will-change","transform");this._wglContainer.setElement(this._canvas);this.surface.getEventSource().appendChild(this._canvas);this._wglContainer.parent={requestChildRender:this._scheduleRender.bind(this)};this._wglContainer.attach(this._renderParameters)},_destroyWGLContainer:function(){this._wglContainer.detach(this._renderParameters);this._wglContainer=null},_createTileRenderer:function(){var n=
this.layer;this._tileRendererProps={layerView:{requestUpdate:function(){this._scheduleUpdate()}.bind(this)},highlightOptions:new x,layer:{objectIdField:n.objectIdField,geometryType:this._getNormalizedGeometryType(n),spatialReference:new f(n.spatialReference.toJson()),fields:n.fields,typeIdField:n.typeIdField,types:a.map(n.types,function(f){return f.toJson()}),outFields:n.getOutFields(),definitionExpression:null,renderer:this._getRenderer4(),gdbVersion:null,historicMoment:null},tileInfoView:this._tileInfoView};
this._tileRenderer=new J(this._tileRendererProps);this._installTileRenderer(this._tileRenderer)},_installTileRenderer:function(f){this._wglView=new F({highlightOptions:f.highlightOptions,tileInfoView:f.tileInfoView,layer:this.layer});f._featuresView=this._wglView;this._wglContainer.addChild(this._wglView);this._wglView._container=this._wglContainer},_getNormalizedGeometryType:function(f){return f.hasXYFootprint()?"esriGeometryPolygon":f.geometryType},_destroyTileRenderer:function(){this._wglContainer.removeChild(this._wglView);
this._wglView.dispose();this._tileRendererProps=this._tileRenderer=this._wglView=this._wglView._container=null},_applyLayerSettings:function(){this._wglContainer.opacity=this.layer.opacity;this._wglContainer.visible=!this.layer.suspended;this._createLayerListeners()},_createLayerListeners:function(){this._destroyLayerListeners();var f=this.layer;this._layerListenerHandles=[f.on("opacity-change",function(){this._wglContainer.opacity=this.layer.opacity}.bind(this)),f.on("suspend",function(){this._wglContainer.visible=
!1}.bind(this)),f.on("resume",function(){this._wglContainer.visible=!0}.bind(this)),f.on("renderer-change",function(){this._handleRendererChange()}.bind(this))]},_destroyLayerListeners:function(){a.forEach(this._layerListenerHandles,function(f){f.remove()});this._layerListenerHandles=null},_createMapListeners:function(){this._destroyMapListeners();var f=this.map;this._mapListenerHandles=[f.on("pan-start",function(f){this._panning=!0;this.updateOnPan||this.renderOnNav||this._stopFrame()}.bind(this)),
f.on("pan",function(f){this._applyPanEvent(f)}.bind(this)),f.on("pan-end",function(f){this._panning=!1;this._applyPanEvent(f)}.bind(this)),f.on("extent-change",function(f){c.set(this.getNode(),g._css.names.transition,"none");this._updateMapView(f.extent)}.bind(this)),f.on("zoom-start",function(f){this._zooming=!0;this._stopFrame()}.bind(this)),f.on("zoom-end",function(f){this._zooming=!1}.bind(this)),f.on("scale",function(f){if(!this.renderOnNav){c.set(this.getNode(),g._css.names.transition,f.immediate?
"none":this._defaultTransition);var a=this.map.__visibleDelta,a=e.translate(-a.x,-a.y);this._scaleMatrix=f=e.multiply(e.invert(a),f.matrix,a);this._applyTransform(f)}}.bind(this))]},_destroyMapListeners:function(){a.forEach(this._mapListenerHandles,function(f){f.remove()});this._mapListenerHandles=null},_getRenderer4:function(f){if(f=f||this.layer._getRenderer()){f=this._fixImageUrl(f.toJson());var a;"simple"===f.type?a=r.fromJSON(f):"classBreaks"===f.type?a=B.fromJSON(f):"uniqueValue"===f.type?a=
C.fromJSON(f):console.error("WebGLRenderer: unsupported layer.renderer!");return a}},_fixImageUrl:function(f){var n=[];switch(f.type){case "simple":n.push(f.symbol);break;case "uniqueValue":n.push(f.defaultSymbol);n=n.concat(a.map(f.uniqueValueInfos,function(f){return f.symbol}));break;case "classBreaks":n.push(f.defaultSymbol),n=n.concat(a.map(f.classBreakInfos,function(f){return f.symbol}))}var n=a.filter(n,function(f){return!!f}),c=this.layer,d=c._url.path+"/images/",e=c._getToken();a.forEach(n,
function(f){var a=f.url;a&&(-1===a.search(/https?\:/)&&-1===a.indexOf("data:")&&(f.url=d+a),e&&-1!==f.url.search(/https?\:/)&&h.hasSameOrigin(f.url,c._url.path)&&(f.url+="?token\x3d"+e))});return f},_setRenderer:function(f){this._tileRendererProps.layer.renderer=f;f=this._tileRenderer.getProcessorConfiguration();var a=this._symbolProcessor;a.setConfiguration(f);this._returnCentroid=a._getReturnCentroid(a.getRendererInfo().renderer);return f},_handleRendererChange:function(){this._rendererEvalTimer||
(this._rendererEvalTimer=setTimeout(this._evalRendererChange,0))},_cancelRendererEval:function(){clearTimeout(this._rendererEvalTimer);this._rendererEvalTimer=null},_evalRendererChange:function(){this._cancelRendererEval();var f=this._returnCentroid,a=this._setRenderer(this._getRenderer4());this._cancelRedraw();this._tileRenderer.needsProcessorReconfiguration(a)?(this._tileRenderer.applyConfiguration(a,!0),f!==this._returnCentroid&&this._returnCentroid?this.layer._mode.refresh():this._redrawView()):
(this._tileRenderer.applyConfiguration(a,!1),this._scheduleUpdate())},_redrawView:function(){this._wglView.children.slice(0).forEach(function(f,a){a=f.key.id;var n=this.layer._mode._tileRequests.get(a);n&&(f=this._redrawTile(n.tsTile,f,n.featureSet),f.isFulfilled()||this._redrawPromises.set(a,f))}.bind(this))},_redrawTile:function(f,a,n){return this._symbolProcessor.getMeshData(f,n).then(function(f){var n=a.key.id;this._redrawPromises["delete"](n);this.layer._mode._tileRequests.get(n)&&this._repaintTile(a,
f.data)}.bind(this)).otherwise(function(f){this._redrawPromises["delete"](a.key.id)}.bind(this))},_repaintTile:function(f,a){this._wglView.removeChild(f);f.attached=!1;this._tileRenderer.onTileData({tileKey:f.key.id,data:a});this._wglView.addChild(f)},_cancelRedraw:function(f){f?(f=this._redrawPromises.get(f))&&f.cancel():this._redrawPromises.forEach(function(f,a){f.cancel()})},_initState:function(){this._mapSR4=new f(this.map.spatialReference.toJson());var a={};D(a);this._viewState=l.mixin(a,{scale:0,
size:[0,0],rotation:0,resolution:1,worldScreenWidth:0,spatialReference:this._mapSR4,viewpoint:{rotation:0,scale:0,targetGeometry:{x:0,y:0},camera:null,clone:function(){var f=l.mixin({},this);f.targetGeometry&&(f.targetGeometry=l.mixin({},f.targetGeometry));return f}},toScreen:function(f,a){var n=this.center[1]+this.resolution*this.height*.5;f[0]=(a[0]-(this.center[0]-this.resolution*this.width*.5))/this.resolution;f[1]=(n-a[1])/this.resolution;return f},toMap:function(f,a){var n=this.center[1]+this.resolution*
this.height*.5;f[0]=this.center[0]-this.resolution*this.width*.5+a[0]*this.resolution;f[1]=n-a[1]*this.resolution;return f},clone:function(){var f=l.mixin({},this);D(f);f.size&&(f.size=f.size.slice(0));f.viewpoint&&(f.viewpoint=f.viewpoint.clone());return f}});this._renderParameters={state:this._viewState,pixelRatio:window.devicePixelRatio,stationary:!0};this._updateParameters={state:this._viewState,pixelRatio:window.devicePixelRatio,stationary:!0};this._tileInfo=A.create({spatialReference:this._mapSR4,
size:this._defaultTileSize});this._tileInfoView=new z(this._tileInfo)},_initRendering:function(){var f=this._tileRendererProps.layer;this._symbolProcessor=new H({configuration:null,service:{fields:f.fields,geometryType:f.geometryType,objectIdField:f.objectIdField,typeIdField:f.typeIdField,types:f.types},spatialReference:this._mapSR4,tileRenderer:this._tileRenderer});f=this._setRenderer(this._getRenderer4());this._tileRenderer.applyConfiguration(f,!0)},_destroyRendering:function(){this._symbolProcessor&&
this._symbolProcessor.destroy();this._cancelRendererEval();this._cancelRedraw()},_updateMapView:function(f){this._setViewState(f);this._scheduleUpdate();this._scheduleRender()},_setViewState:function(f){var a=this.map;if(a.loaded){f=f?f.getCenter():a.extent.getCenter();var n=this._viewState;n.viewpoint.targetGeometry=f.toJson();n.scale=n.viewpoint.scale=a.getScale();n.size=[a.width,a.height]}},_updateViewState:function(){var f=this._viewState;f.resolution=f.scale/(39.37*m.getUnitValueForSR(this.map.spatialReference)*
96);var a=0;f.spatialReference.isWrappable&&(a=n.getInfo(f.spatialReference),a=a.valid[1]-a.valid[0]);f.worldScreenWidth=Math.round(a/f.resolution)},_getClipPath:function(f,a,n,c){return"inset("+(a?a-this._panDy:a)+"px "+(this.map.width-(f+n)+this._panDx)+"px "+(this.map.height-(a+c)+this._panDy)+"px "+(f?f-this._panDx:f)+"px)"},_getClipRect:function(f,a,n,c){a-=this._panDy;f-=this._panDx;return"rect("+a+"px, "+(f+n)+"px, "+(a+c)+"px, "+f+"px)"},_stopFrame:function(){this._frameRequested=this._updateRequested=
this._renderRequested=!1;cancelAnimationFrame(this._frameHandle);this._frameHandle=null},_canRender:function(){return this.renderOnNav||!this._zooming&&!this._panning},_canUpdate:function(){return this.updateOnPan||!this._zooming&&!this._panning},_watchDPR:function(){this._unwatchDPR();this._dprTimer=setTimeout(function(){this._renderParameters.pixelRatio!==window.devicePixelRatio&&this._scheduleRender();this._watchDPR()}.bind(this),this._dprWatchDelay)},_unwatchDPR:function(){clearTimeout(this._dprTimer);
this._dprTimer=null},_scheduleRender:function(){this._started&&this._canRender()&&(this._renderRequested=!0,this._scheduleFrame())},_scheduleUpdate:function(){this._started&&this._canUpdate()&&(this._updateRequested=!0,this._scheduleFrame())},_scheduleFrame:function(){this._frameRequested||(this._frameRequested=!0,this._frameHandle=ca(this._frame))},_frame:function(){this._frameRequested&&(this._frameRequested=!1,this._renderParameters.pixelRatio!==window.devicePixelRatio&&(this._renderParameters.pixelRatio=
this._updateParameters.pixelRatio=window.devicePixelRatio),this._updateParameters.stationary=this._renderParameters.stationary=!0,this._updateViewState(),this._renderRequested&&this._canRender()&&(this._renderRequested=!1,c.set(this._canvas,g._css.names.transition,"none"),this._applyTransform(),this._scaleMatrix=null,this._wglContainer.doRender(this._renderParameters)),this._updateRequested&&this._canUpdate()&&(this._updateRequested=!1,this.layer._mode.update(this._updateParameters)))},_applyPanEvent:function(f){if(!this.renderOnNav){this._panDx=
f.delta.x;this._panDy=f.delta.y;var a=e.translate(f.delta.x,f.delta.y),a=this._scaleMatrix?e.multiply(a,this._scaleMatrix):a;this._applyTransform(a)}(this.updateOnPan||this.renderOnNav)&&this._updateMapView(f.extent)},_applyTransform:function(f){f=f?g._css.matrix(f):"";c.set(this._canvas,g._css.names.transform,f);f||(this._panDx=this._panDy=0,this.setClip(this._clipRect))}});d("extend-esri")&&b.setObject("layers.support.WebGLRenderer",k,g);return k})},"esri/layers/vectorTiles/core/promiseUtils":function(){define("require exports dojo/Deferred dojo/when dojo/promise/all ./Error".split(" "),
function(k,b,a,c,e,g){function l(c){if(c){if("function"!==typeof c.forEach){var d=Object.keys(c),e=d.map(function(a){return c[a]});return l(e).then(function(a){var c={};d.forEach(function(d,e){return c[d]=a[e]});return c})}var b=new a,g=[],t=c.length;0===t&&b.resolve(g);c.forEach(function(a){var c={promise:a};g.push(c);a.then(function(a){c.value=a}).catch(function(a){c.error=a}).then(function(){--t;0===t&&b.resolve(g)})});return b.promise}}Object.defineProperty(b,"__esModule",{value:!0});b.all=function(a){return e(a)};
b.filter=function(a,c){var d=a.slice();return e(a.map(function(a,d){return c(a,d)})).then(function(a){return d.filter(function(c,d){return a[d]})})};b.eachAlways=l;b.create=function(d,e){var b=new a(e);d(function(a){void 0===a&&(a=null);return c(a).then(b.resolve)},b.reject);return b.promise};b.reject=function(c){var d=new a;d.reject(c);return d.promise};b.resolve=function(c){void 0===c&&(c=null);var d=new a;d.resolve(c);return d.promise};b.after=function(c,e){void 0===e&&(e=null);var d=0,b=new a(function(){d&&
(clearTimeout(d),d=0)}),d=setTimeout(function(){b.resolve(e)},c);return b.promise};b.timeout=function(c,e,b){var d=0,m=new a(c.cancel);c.then(function(a){m.isFulfilled()||(m.resolve(a),d&&(clearTimeout(d),d=0))});c.catch(function(a){m.isFulfilled()||(m.reject(a),d&&(clearTimeout(d),d=0))});d=setTimeout(function(){var a=b||new g("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");m.reject(a)},e);return m.promise};b.wrapCallback=function(c){var d=!1,e=new a(function(){return d=
!0});c(function(a){d||e.resolve(a)});return e.promise};b.isThenable=function(a){return a&&"function"===typeof a.then};b.when=function(a){return c(a)}})},"esri/layers/vectorTiles/core/Error":function(){define(["require","exports","./tsSupport/extendsHelper","./lang","./Message"],function(k,b,a,c,e){k=function(e){function b(a,c,m){var d=e.call(this,a,c,m)||this;return d instanceof b?d:new b(a,c,m)}a(b,e);b.prototype.toJSON=function(){return{name:this.name,message:this.message,details:c.clone(this.details),
dojoType:this.dojoType}};b.fromJSON=function(a){var c=new b(a.name,a.message,a.details);null!=a.dojoType&&(c.dojoType=a.dojoType);return c};return b}(e);k.prototype.type="error";return k})},"esri/layers/vectorTiles/core/tsSupport/extendsHelper":function(){define([],function(){return function(){var k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return function(b,a){function c(){this.constructor=b}
k(b,a);b.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}}()})},"esri/layers/vectorTiles/core/lang":function(){define("dojo/_base/kernel dojo/_base/lang dojo/date dojo/number dojo/date/locale dojo/i18n!../nls/common".split(" "),function(k,b,a,c,e,g){function l(a){return void 0!==a&&null!==a}function d(a){return l(a)?a:""}function h(m,h,p){var g=p.match(/([^\(]+)(\([^\)]+\))?/i),t=b.trim(g[1]);p=h[m];var g=JSON.parse((g[2]?b.trim(g[2]):"{}").replace(/^\(/,"{").replace(/\)$/,"}").replace(/([{,])\s*([0-9a-zA-Z\_]+)\s*:/gi,
'$1"$2":').replace(/\"\s*:\s*\'/gi,'":"').replace(/\'\s*(,|\})/gi,'"$1')),f=g.utcOffset;if(-1===q.indexOf(t))t=b.getObject(t),b.isFunction(t)&&(p=t(p,m,h,g));else if("number"===typeof p||"string"===typeof p&&p&&!isNaN(Number(p)))switch(p=Number(p),t){case "NumberFormat":m=b.mixin({},g);h=parseFloat(m.places);if(isNaN(h)||0>h)m.places=Infinity;return c.format(p,m);case "DateString":p=new Date(p);if(g.local||g.systemLocale)return g.systemLocale?p.toLocaleDateString()+(g.hideTime?"":" "+p.toLocaleTimeString()):
p.toDateString()+(g.hideTime?"":" "+p.toTimeString());p=p.toUTCString();g.hideTime&&(p=p.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return p;case "DateFormat":return p=new Date(p),l(f)&&(p=a.add(p,"minute",p.getTimezoneOffset()-f)),e.format(p,g)}return d(p)}function m(a,c){var d;if(c)for(d in a)a.hasOwnProperty(d)&&(void 0===a[d]?delete a[d]:a[d]instanceof Object&&m(a[d],!0));else for(d in a)a.hasOwnProperty(d)&&void 0===a[d]&&delete a[d];return a}function p(a){if(!a||"object"!=typeof a||b.isFunction(a))return a;
if(a instanceof Int8Array||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Int32Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array||a instanceof Date)return new a.constructor(a);if(a instanceof ArrayBuffer)return a.slice(0,a.byteLength);if("function"===typeof a.clone)a=a.clone();else if("function"===typeof a.map&&"function"===typeof a.forEach)a=a.map(p);else if("function"===typeof a.notifyChange&&
"function"===typeof a.watch)a=a.clone();else{var c={},d,e,m={};for(d in a){e=a[d];var f=!(d in m)||m[d]!==e;if(!(d in c)||c[d]!==e&&f)c[d]=p?p(e):e}a=c}return a}var q=["NumberFormat","DateString","DateFormat"],t=/<\/?[^>]+>/g;return{equals:function(a,c){return a===c||"number"===typeof a&&isNaN(a)&&"number"===typeof c&&isNaN(c)||b.isFunction((a||{}).getTime)&&b.isFunction((c||{}).getTime)&&a.getTime()==c.getTime()||b.isFunction((a||{}).equals)&&a.equals(c)||b.isFunction((c||{}).equals)&&c.equals(a)||
!1},mixin:b.mixin,valueOf:function(a,c){for(var d in a)if(a[d]==c)return d;return null},stripTags:function(a){if(a){var c=typeof a;if("string"===c)a=a.replace(t,"");else if("object"===c)for(var d in a)(c=a[d])&&"string"===typeof c&&(c=c.replace(t,"")),a[d]=c}return a},substitute:function(a,c,e){var m,p,f;l(e)&&(b.isObject(e)?(m=e.first,p=e.dateFormat,f=e.numberFormat):m=e);if(c&&"{*}"!==c)return b.replace(c,b.hitch({obj:a},function(a,n){a=n.split(":");return 1<a.length?(n=a[0],a.shift(),h(n,this.obj,
a.join(":"))):p&&-1!==(p.properties||[]).indexOf(n)?h(n,this.obj,p.formatter||"DateString"):f&&-1!==(f.properties||[]).indexOf(n)?h(n,this.obj,f.formatter||"NumberFormat"):d(this.obj[n])}));c=[];var n;c.push('\x3ctable class\x3d"esri-widget__table" summary\x3d"'+g.fieldsSummary+'"\x3e\x3ctbody\x3e');for(n in a)if(e=a[n],p&&-1!==(p.properties||[]).indexOf(n)?e=h(n,a,p.formatter||"DateString"):f&&-1!==(f.properties||[]).indexOf(n)&&(e=h(n,a,f.formatter||"NumberFormat")),c.push("\x3ctr\x3e\x3cth\x3e"+
n+"\x3c/th\x3e\x3ctd\x3e"+d(e)+"\x3c/td\x3e\x3c/tr\x3e"),m)break;c.push("\x3c/tbody\x3e\x3c/table\x3e");return c.join("")},filter:function(a,c,d){c=[b.isString(a)?a.split(""):a,d||k.global,b.isString(c)?new Function("item","index","array",c):c];d={};var e;a=c[0];for(e in a)c[2].call(c[e],a[e],e,a)&&(d[e]=a[e]);return d},startsWith:function(a,c,d){d=d||0;return a.indexOf(c,d)===d},endsWith:function(a,c,d){if("number"!==typeof d||!isFinite(d)||Math.floor(d)!==d||d>a.length)d=a.length;d-=c.length;a=
a.indexOf(c,d);return-1!==a&&a===d},isDefined:l,fixJson:m,clone:p}})},"esri/layers/vectorTiles/core/Message":function(){define(["require","exports","dojo/string"],function(k,b,a){return function(){function c(e,b,l){this instanceof c&&(this.name=e,this.message=b&&a.substitute(b,l,function(a){return null==a?"":a})||"",this.details=l)}c.prototype.toString=function(){return"["+this.name+"]: "+this.message};return c}()})},"esri/layers/vectorTiles/views/2d/engine/StageGL":function(){define("require exports ../../../core/tsSupport/extendsHelper dojo/has ../../../core/promiseUtils ./Container ../engine/webgl/Fader ./webgl/BitBlitRenderer ./webgl/enums ./webgl/WGLPainter ./webgl/shaders/glShaderSnippets ../libs/gl-matrix/common ../libs/gl-matrix/mat2d ../libs/gl-matrix/vec2 ../../support/screenshotUtils ../../webgl/BufferObject ../../webgl/context-util ../../webgl/FramebufferObject ../../webgl/Program ../../webgl/RenderingContext ../../webgl/VertexArrayObject".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z,f,n,r){function B(f){return{state:f.state,pixelRatio:f.pixelRatio,stationary:f.stationary}}var C={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"};return function(b){function g(){var f=null!==b&&b.apply(this,arguments)||this;f._clipData=new Float32Array(8);f._upperLeft=u.create();f._upperRight=u.create();f._lowerLeft=u.create();f._lowerRight=u.create();f._mat2=t.create();f._clipRendererInitialized=!1;f._contextVersion=null;f._labelFader=new l.default(f);
return f}a(g,b);Object.defineProperty(g.prototype,"glPainter",{get:function(){return this._painter},enumerable:!0,configurable:!0});g.prototype.fadeInLabels=function(){this._labelFader.reset();this.requestRender()};g.prototype.createElement=function(){var f=document.createElement("canvas");f.setAttribute("class","esri-display-object");return f};g.prototype.setElement=function(f){this.element=f};g.prototype.useContextVersion=function(f){this._renderingContext||(this._contextVersion=f)};g.prototype.attach=
function(f){if(this.attached)return!0;this._resizeCanvas(f);var a=A.createContextOrErrorHTML(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0},this._contextVersion);this._renderingContext=new n(a);this._contextVersion=this._renderingContext.contextVersion;this.attached=!0;this._cachedRenderParams=B(f);this._painter||(this._painter=new m.default,this._painter.initialize(this._renderingContext));return b.prototype.attach.call(this,f)};g.prototype.detach=function(f){b.prototype.detach.call(this,
f);this._boundFBO=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO1=null);this._labelsFBO2&&(this._labelsFBO2.dispose(),this._labelsFBO2=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._painter&&(this._painter.dispose(),this._painter=null);this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=
null);this._renderingContext&&(this._renderingContext.dispose(),this._renderingContext=null);this._cachedRenderParams=null};g.prototype.renderChildren=function(f){var a=this.children;f.drawPhase=h.WGLDrawPhase.FILL|h.WGLDrawPhase.LINE|h.WGLDrawPhase.MARKER|h.WGLDrawPhase.TEXT;for(var n=a.length,d=0;d<n;d++){var e=a[d];e.attached&&this.renderChild(e,f)}if(c("esri-featurelayer-webgl-labeling")){var r=f.context,b=r.getBoundFramebufferObject();r.bindFramebuffer(this._labelsFBO2);d=f.stationary;r.setClearColor(0,
0,0,d?0:1);r.clear(r.gl.COLOR_BUFFER_BIT);if(d)for(f.drawPhase=h.WGLDrawPhase.LABEL_ALPHA,f.labelFBO=this._labelsFBO1,f.labelStep=this._labelFader.step(),d=0;d<n;d++)e=a[d],e.attached&&this.renderChild(e,f);else this._labelFader.reset();r.bindFramebuffer(b);f.labelFBO=this._labelsFBO2;f.drawPhase=h.WGLDrawPhase.LABEL;for(d=0;d<n;d++)e=a[d],e.attached&&this.renderChild(e,f);f=this._labelsFBO2;this._labelsFBO2=this._labelsFBO1;this._labelsFBO1=f}};g.prototype.beforeRenderChildren=function(f,a){f=a.context;
var n=a.state,d=a.pixelRatio;if(a=this._painter){f.enforceState();a.update(n,d);var e=n.width;a=n.height;var r=n.rotation,e=Math.round(e*d);a=Math.round(a*d);this._boundFBO=f.getBoundFramebufferObject();!c("esri-featurelayer-webgl-labeling")||this._labelsFBO1&&this._labelsFBO1.width===e&&this._labelsFBO1.height===a||(this._labelsFBO1&&(this._labelsFBO1.dispose(),this._labelsFBO2.dispose()),this._labelsFBO1=z.createWithAttachments(f,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,
wrapMode:33071,width:e,height:a},{colorTarget:0,depthStencilTarget:0}),f.bindFramebuffer(this._labelsFBO1),f.setDepthWriteEnabled(!0),f.setStencilWriteMask(255),f.setClearColor(0,0,0,0),f.setClearDepth(1),f.setClearStencil(0),f.clear(f.gl.COLOR_BUFFER_BIT|f.gl.DEPTH_BUFFER_BIT|f.gl.STENCIL_BUFFER_BIT),f.setDepthWriteEnabled(!1),f.bindFramebuffer(this._boundFBO),this._labelsFBO2=z.createWithAttachments(f,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,
width:e,height:a},{colorTarget:0,depthStencilTarget:0}));if(n.spatialReference&&(n.spatialReference._isWrappable?n.spatialReference._isWrappable():n.spatialReference.isWrappable)){var b=q.toRadian(r),m=Math.abs(Math.cos(b)),h=Math.abs(Math.sin(b)),p=Math.round(n.worldScreenWidth);if(Math.round(e*m+a*h)<=p)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===e&&this._clipFBO.height===a||(this._clipFBO=new z(f,{colorTarget:0,depthStencilTarget:3,width:e,height:a}));var l=.5*e,g=.5*a,n=1/e,B=
1/a,d=.5*p*d,C=.5*(e*h+a*m),e=this._upperLeft,m=this._upperRight,h=this._lowerLeft,p=this._lowerRight;u.set(e,-d,-C);u.set(m,d,-C);u.set(h,-d,C);u.set(p,d,C);t.identity(this._mat2);t.translate(this._mat2,this._mat2,[l,g]);0!==r&&t.rotate(this._mat2,this._mat2,b);u.transformMat2d(e,e,this._mat2);u.transformMat2d(m,m,this._mat2);u.transformMat2d(h,h,this._mat2);u.transformMat2d(p,p,this._mat2);r=this._clipData;r.set([2*h[0]*n-1,2*(a-h[1])*B-1,2*p[0]*n-1,2*(a-p[1])*B-1,2*e[0]*n-1,2*(a-e[1])*B-1,2*m[0]*
n-1,2*(a-m[1])*B-1]);this._clipRendererInitialized||this._initializeClipRenderer(f);this._clipVBO.setData(r);this._boundFBO=f.getBoundFramebufferObject();f.bindFramebuffer(this._clipFBO);f.setDepthWriteEnabled(!0);f.setStencilWriteMask(255);f.setClearColor(0,0,0,0);f.setClearDepth(1);f.setClearStencil(0);f.clear(f.gl.COLOR_BUFFER_BIT|f.gl.DEPTH_BUFFER_BIT|f.gl.STENCIL_BUFFER_BIT);f.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1}};g.prototype.afterRenderChildren=function(f,a){this._clipFrame&&
this._clipRendererInitialized&&(f=this._renderingContext,f.bindFramebuffer(this._boundFBO),this._boundFBO=null,f.bindVAO(this._clipVAO),f.bindProgram(this._clipStencilProgram),f.setDepthWriteEnabled(!1),f.setDepthTestEnabled(!1),f.setStencilTestEnabled(!0),f.setBlendingEnabled(!1),f.setColorMask(!1,!1,!1,!1),f.setStencilOp(7680,7680,7681),f.setStencilWriteMask(255),f.setStencilFunction(519,1,255),f.drawElements(4,6,5123,0),f.bindVAO(),f.setColorMask(!0,!0,!0,!0),f.setBlendingEnabled(!0),f.setStencilFunction(514,
1,255),this._blitRenderer.render(f,this._clipFBO.colorTexture,9728,1),f.setStencilTestEnabled(!1))};g.prototype.doRender=function(f){var a=this.element.style;this.visible?(a.display="block",a.opacity=""+this.opacity,this._resizeCanvas(f),b.prototype.doRender.call(this,f),this._cachedRenderParams=B(f)):a.display="none"};g.prototype.takeScreenshot=function(f){void 0===f&&(f={});var a=f.pixelRatio||1;this._cachedRenderParams.pixelRatio=a;var n=Math.round(a*this._cachedRenderParams.state.width),c=Math.round(a*
this._cachedRenderParams.state.height),d=0,r=0,b=n,m=c,h=n,p=c;if(h=f.area)d=Math.round(a*h.x),r=Math.round(a*h.y),b=Math.round(a*h.width),m=Math.round(a*h.height);void 0!==f.width&&void 0!==f.height?(h=f.width/f.height,m*h<b?(h*=m,d+=Math.floor((b-h)/2),b=Math.floor(h)):(h=b/h,r+=Math.floor((m-h)/2),m=Math.floor(h)),h=f.width,p=f.height):(h=b,p=m);a=document.createElement("canvas");a.width=h;a.height=p;var l=a.getContext("2d"),g=new Uint8Array(b*m*4),B=this._renderingContext,q=z.create(B,{colorTarget:1,
depthStencilTarget:3,width:n,height:c});B.bindFramebuffer(q);B.setViewport(0,0,n,c);var t=this._cachedRenderParams,u=this._renderingContext.gl;this._renderingContext.setClearColor(0,0,0,0);this._renderingContext.setClearDepth(1);this._renderingContext.setClearStencil(0);this._renderingContext.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT|u.STENCIL_BUFFER_BIT);t.context=this._renderingContext;t.painter=this._painter;this.beforeRenderChildren(t,t);if(void 0!==f.rotation&&null!==f.rotation){var u=t.state,
D=u.clone();D.viewpoint.rotation=f.rotation;t.state=D;this.renderChildren(t);t.state=u}else this.renderChildren(t);this.afterRenderChildren(t,t);q.readPixels(d,c-(r+m),b,m,6408,5121,g);B.bindFramebuffer();B=l.getImageData(0,0,h,p);if(0!==d||0!==r||b!==n||m!==c||h!==n||p!==c)y.resampleHermite(g,b,m,B.data,h,p,!0);else{r=m-1;m=0;q=4*b;for(D=u=d=c=n=b=t=void 0;m<r;){u=m*q;D=r*q;for(t=0;t<q;t+=4)b=g[u+t],n=g[u+t+1],c=g[u+t+2],d=g[u+t+3],g[u+t]=g[D+t],g[u+t+1]=g[D+t+1],g[u+t+2]=g[D+t+2],g[u+t+3]=g[D+t+
3],g[D+t]=b,g[D+t+1]=n,g[D+t+2]=c,g[D+t+3]=d;m++;r--}b=B.data;n=g.length;for(r=0;r<n;r++)b[r]=g[r]}g=B.data;m=g.length;for(r=0;r<m;r+=4)d=g[r+3],0<d&&(c=d/255,b=Math.floor(g[r+0]/c),n=Math.floor(g[r+1]/c),c=Math.floor(g[r+2]/c),g[r+0]=255>=b?b:255,g[r+1]=255>=n?n:255,g[r+2]=255>=c?c:255);l.putImageData(B,0,0);l=C[f.format?f.format.toLowerCase():"png"];g=1;void 0!==f.quality&&(g=f.quality/100);f=a.toDataURL(l,g);return e.resolve({dataURL:f,x:0,y:0,width:h,height:p})};g.prototype.prepareChildrenRenderParameters=
function(f){if(!this.attached||!this._renderingContext)return null;f=B(f);var a=this._renderingContext,n=a.gl;a.setDepthWriteEnabled(!0);a.setStencilWriteMask(255);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.setClearStencil(0);a.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT);a.setViewport(0,0,this.element.width,this.element.height);a.setDepthWriteEnabled(!1);f.context=a;f.painter=this._painter;return f};g.prototype.attachChild=function(f,a){return f.attach(a)};g.prototype.detachChild=
function(f,a){return f.detach(a)};g.prototype.renderChild=function(f,a){return f.processRender(a)};g.prototype._resizeCanvas=function(f){var a=this.element,n=a.style,c=f.state,d=f.pixelRatio;f=Math.round(c.width*d);d=Math.round(c.height*d);if(a.width!==f||a.height!==d)a.width=f,a.height=d;n.width=c.width+"px";n.height=c.height+"px"};g.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new d;var n={a_pos:0},c=new f(a,p.stencilVS,p.stencilFS,n);
if(!c)return!1;var e=x.createVertex(a,35040,32),b=new Uint16Array([0,1,2,2,1,3]),b=x.createIndex(a,35044,b);a=new r(a,n,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:e},b);this._clipStencilProgram=c;this._clipVBO=e;this._clipVAO=a;return this._clipRendererInitialized=!0};return g}(g)})},"esri/layers/vectorTiles/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(k,
b,a,c){var e;(function(a){a[a.BEFORE=0]="BEFORE";a[a.ATTACHING=1]="ATTACHING";a[a.DETACHING=2]="DETACHING";a[a.RENDERING=3]="RENDERING";a[a.AFTER=4]="AFTER";a[a.DONE=5]="DONE"})(e||(e={}));return function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a._childrenSet=new Set;a._childrenToAttach=[];a._childrenToDetach=[];a._renderPhase=e.DONE;a.children=[];return a}a(b,c);Object.defineProperty(b.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});
b.prototype.detach=function(a){var c=this.children.concat(this._childrenToDetach);a=this.prepareChildrenRenderParameters(a);for(var d=0;d<c.length;d++){var e=c[d];e.attached&&(this.detachChild(e,a),e.attached=!1,e.parent=null)}};b.prototype.doRender=function(a){var c=this.prepareChildrenRenderParameters(a);this._renderPhase=e.BEFORE;this.beforeRenderChildren(a,c);this._renderPhase=e.ATTACHING;this.attachChildren(c);this._renderPhase=e.DETACHING;for(var d=this._childrenToDetach;0<d.length;){var b=
d.shift();this.detachChild(b,c);b.attached=!1;b.parent=null}this._renderPhase=e.RENDERING;this.renderChildren(c);this._renderPhase=e.AFTER;this.afterRenderChildren(a,c);this._renderPhase=e.DONE};b.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};b.prototype.addChildAt=function(a,c){void 0===c&&(c=this.numChildren);if(!a||this.contains(a))return a;var d=a.parent;d&&d!==this&&d.removeChild(a);c>=this.numChildren?this.children.push(a):this.children.splice(c,0,a);this._childrenSet.add(a);
c=this._childrenToDetach.indexOf(a);-1<c&&this._childrenToDetach.splice(c,1);this._childrenToAttach.push(a);this._renderPhase>=e.RENDERING&&this.requestRender();return a};b.prototype.contains=function(a){return this._childrenSet.has(a)};b.prototype.getChildIndex=function(a){return this.children.indexOf(a)};b.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};b.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};b.prototype.removeChild=
function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};b.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);if(a.attached)this._childrenToDetach.push(a),this._renderPhase>=e.RENDERING&&this.requestRender();else{var c=this._childrenToAttach.indexOf(a);-1<c&&this._childrenToAttach.splice(c,1)}return a};b.prototype.requestChildRender=function(a){a&&a.parent===this&&this._renderPhase>=
e.RENDERING&&this.requestRender()};b.prototype.setChildIndex=function(a,c){var d=this.getChildIndex(a);-1<d&&(this.children.splice(d,1),this.children.splice(c,0,a),this._renderPhase>=e.RENDERING&&this.requestRender())};b.prototype.sortChildren=function(a){this._renderPhase>e.RENDERING&&this.requestRender();return this.children.sort(a)};b.prototype.attachChildren=function(a){var c=this._childrenToAttach;if(0!==c.length)for(var d=0,e=!1;!e;)e=c[d],this.attachChild(e,a)?(e.attached=!0,e.parent=this,
c.splice(d,1)):++d,e=c.length===d};b.prototype.renderChildren=function(a){for(var c=this.children,d=c.length,e=0;e<d;e++){var b=c[e];b.attached&&this.renderChild(b,a)}};b.prototype.beforeRenderChildren=function(a,c){};b.prototype.attachChild=function(a,c){return a.attach(c)};b.prototype.detachChild=function(a,c){a.detach(c)};b.prototype.renderChild=function(a,c){a.processRender(c)};b.prototype.afterRenderChildren=function(a,c){};return b}(c)})},"esri/layers/vectorTiles/views/2d/engine/DisplayObject":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./Evented"],function(k,b,a,c){return function(c){function e(){var a=null!==c&&c.apply(this,arguments)||this;a._renderRequestedCalled=!1;a._attached=!1;a._opacity=1;a.renderRequested=!1;a._visible=!0;return a}a(e,c);Object.defineProperty(e.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});e.prototype.attach=function(a){return!0};e.prototype.detach=function(a){};e.prototype.processRender=
function(a){this._renderRequestedCalled=!1;this.doRender(a);this._renderRequestedCalled||(this.renderRequested=!1);this.hasEventListener("post-render")&&this.emit("post-render")};e.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestChildRender(this);a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};e.prototype.dispose=function(){};return e}(c.Evented)})},"esri/layers/vectorTiles/views/2d/engine/Evented":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","dojo/aspect","dojo/on"],function(k,b,a,c,e){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function a(){}a.prototype.on=function(a,d){return c.after(this,"on"+a,d,!0)};a.prototype.once=function(a,c){return e.once(this,a,c)};a.prototype.emit=function(a){e.emit(this,a,this)};a.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)};return a}();b.Evented=k;b.EventedMixin=function(b){return function(b){function d(){return null!==
b&&b.apply(this,arguments)||this}a(d,b);d.prototype.on=function(a,d){return c.after(this,"on"+a,d,!0)};d.prototype.once=function(a,c){return e.once(this,a,c)};d.prototype.emit=function(a,c){e.emit(this,a,c)};d.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)};return d}(b)}})},"esri/layers/vectorTiles/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function a(a,e){void 0===
e&&(e=250);this.duration=e;this._startTime=this._lastTime=0;this._parent=a}a.prototype.reset=function(){0===this._lastTime;this._startTime=performance.now()};a.prototype.step=function(){var a=performance.now();if(0===this._lastTime)return this._lastTime=a,this._parent.requestRender(),0;var e=a-this._lastTime;this._lastTime=a;a-this._startTime<2*this.duration&&this._parent.requestRender();return e/this.duration};return a}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/BitBlitRenderer":function(){define("require exports ./shaders/glShaderSnippets ../../../webgl/BufferObject ../../../webgl/Program ../../../webgl/VertexArrayObject".split(" "),
function(k,b,a,c,e,g){return function(){function b(){this._initialized=!1}b.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};b.prototype.render=function(a,c,e,b){a&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),c.setSamplingMode(e),a.bindTexture(c,0),this._program.setUniform1i("u_tex",
0),this._program.setUniform1f("u_opacity",b),a.drawArrays(5,0,4),a.bindVAO())};b.prototype._initialize=function(d){if(this._initialized)return!0;var b={a_pos:0,a_tex:1},m=new e(d,a.bitblitVS,a.bitblitFS,b);if(!m)return!1;var p=new Int8Array(16);p[0]=-1;p[1]=-1;p[2]=0;p[3]=0;p[4]=1;p[5]=-1;p[6]=1;p[7]=0;p[8]=-1;p[9]=1;p[10]=0;p[11]=1;p[12]=1;p[13]=1;p[14]=1;p[15]=1;d=new g(d,b,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,
stride:4,normalized:!1,divisor:0}]},{geometry:c.createVertex(d,35044,p)});this._program=m;this._vertexArrayObject=d;return this._initialized=!0};return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/shaders/glShaderSnippets":function(){define("require exports dojo/text!./backgroundShaders.xml dojo/text!./bitblitShaders.xml dojo/text!./stencilShaders.xml dojo/text!./tileInfo.xml ../../../../webgl/ShaderSnippets".split(" "),function(k,b,a,c,e,g,l){k=new l;l.parse(a,k);l.parse(c,k);l.parse(e,
k);l.parse(g,k);return k})},"esri/layers/vectorTiles/views/webgl/ShaderSnippets":function(){define(["require","exports","dojox/xml/parser"],function(k,b,a){return function(){function c(a){if(a)for(var c in a)this[c]=a[c]}c.parse=function(c,b){c=a.parse(c).getElementsByTagName("snippet");for(var e=/\$[a-zA-Z][a-zA-Z0-9]*(?:\([^\(\)]*\))?[ \t]*/,d=/[\$\s]+/g,h=/\(([^\(\)]*)\)/,m=0;m<c.length;m++){for(var p=c[m].getAttribute("name"),g=c[m].textContent;;){var t=g.match(e);if(null==t)break;var u=t[0].replace(d,
""),y=u.match(h),k=void 0;y&&(k=y[1].split(",").map(function(a){return a.trim()}));u=u.replace(h,"");k=b._instantiate(u,k);g=g.replace(t[0],k)}b[p]=g}};c.prototype._instantiate=function(a,c){a=this[a];for(c||(c=[]);;){var e=a.match(/\$(\d+)/);if(null==e)break;var d=parseInt(e[1],10);a=a.replace(e[0],c[d])}return a};return c}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(k){k.getObject("xml.parser",
!0,dojox);dojox.xml.parser.parse=function(b,a){var c=k.doc,e;a=a||"text/xml";if(b&&k.trim(b)&&"DOMParser"in k.global){e=(new DOMParser).parseFromString(b,a);b=e.documentElement;if("parsererror"==b.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==b.namespaceURI){if(c=b.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0])c=c.firstChild.data;throw Error("Error parsing text "+b.firstChild.data+" \n"+c);}return e}if("ActiveXObject"in k.global){c=
function(a){return"MSXML"+a+".DOMDocument"};c=["Microsoft.XMLDOM",c(6),c(4),c(3),c(2)];k.some(c,function(a){try{e=new ActiveXObject(a)}catch(d){return!1}return!0});if(b&&e&&(e.async=!1,e.loadXML(b),b=e.parseError,0!==b.errorCode))throw Error("Line: "+b.line+"\nCol: "+b.linepos+"\nReason: "+b.reason+"\nError Code: "+b.errorCode+"\nSource: "+b.srcText);if(e)return e}else if(c.implementation&&c.implementation.createDocument){if(b&&k.trim(b)&&c.createElement){a=c.createElement("xml");a.innerHTML=b;var g=
c.implementation.createDocument("foo","",null);k.forEach(a.childNodes,function(a){g.importNode(a,!0)});return g}return c.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(b,a){if(1<arguments.length)return dojox.xml.parser.replaceChildren(b,(b.ownerDocument||k.doc).createTextNode(a)),a;if(void 0!==b.textContent)return b.textContent;var c="";b&&k.forEach(b.childNodes,function(a){switch(a.nodeType){case 1:case 5:c+=dojox.xml.parser.textContent(a);break;case 3:case 2:case 4:c+=
a.nodeValue}});return c};dojox.xml.parser.replaceChildren=function(b,a){var c=[];k.isIE&&k.forEach(b.childNodes,function(a){c.push(a)});dojox.xml.parser.removeChildren(b);k.forEach(c,k.destroy);k.isArray(a)?k.forEach(a,function(a){b.appendChild(a)}):b.appendChild(a)};dojox.xml.parser.removeChildren=function(b){for(var a=b.childNodes.length;b.hasChildNodes();)b.removeChild(b.firstChild);return a};dojox.xml.parser.innerXML=function(b){return b.innerXML?b.innerXML:b.xml?b.xml:"undefined"!=typeof XMLSerializer?
(new XMLSerializer).serializeToString(b):null};return dojox.xml.parser})},"esri/layers/vectorTiles/views/webgl/BufferObject":function(){define(["require","exports","dojo/has"],function(k,b,a){return function(){function c(e,b,l,d,h){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=e;this._bufferType=b;this._usage=l;this._id=c._nextId++;this._glName=this._context.gl.createBuffer();a("esri-webgl-debug")&&e.instanceCounter.incrementCount(1);
d&&this.setData(d,h)}c.createIndex=function(a,b,l,d){return new c(a,34963,b,l,d)};c.createVertex=function(a,b,l){return new c(a,34962,b,l)};Object.defineProperty(c.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"usage",
{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});c.prototype.dispose=
function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),a("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(1),this._context=null)};c.prototype.setData=function(a,c){if(a){if("number"===typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&c)switch(this._indexType=c,this._size=a,c){case 5123:a*=2;break;case 5125:a*=4}}else c=a.byteLength,a instanceof Uint16Array&&(c/=2,this._indexType=5123),a instanceof
Uint32Array&&(c/=4,this._indexType=5125),this._size=c,ArrayBuffer.isView(a)&&(a=a.buffer);c=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(c)}};c.prototype.setSubData=function(a,c,b,d){void 0===c&&(c=0);void 0===b&&(b=0);if(a){(0>c||c>=this._size)&&console.error("offset is out of range!");var e=c,m=b,p=d,g=a.byteLength;a instanceof Uint16Array&&(g/=2,e*=2,m*=2,p*=2);a instanceof
Uint32Array&&(g/=4,e*=4,m*=4,p*=4);void 0===d&&(d=g-1);b>=d&&console.error("end must be bigger than start!");c+b-d>this._size&&console.error("An attempt to write beyond the end of the buffer!");c=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);b=this._context.gl;a=ArrayBuffer.isView(a)?a.buffer:a;b.bufferSubData(this._bufferType,e,a.slice(m,p));this._context.bindVAO(c)}};c._nextId=0;return c}()})},"esri/layers/vectorTiles/views/webgl/Program":function(){define(["require",
"exports","dojo/has","./ShaderTranspiler"],function(k,b,a,c){var e=a("dojo-debug-messages");return function(){function b(c,d,e,m,p){void 0===p&&(p={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4=
{};c||console.error("RenderingContext isn't initialized!");0===d.length&&console.error("Shaders source should not be empty!");this._context=c;this._vertexShaderSource=d;this._fragmentShaderSource=e;if(Array.isArray(p))for(d=0;d<p.length;d++)this._defines[p[d]]="1";else this._defines=p;this._id=b._nextId++;this._locations=m;a("esri-webgl-debug")&&c.instanceCounter.incrementCount(3)}Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});b.prototype.getDefine=function(a){return this._defines[a]};b.prototype.dispose=function(){if(this._context){var c=this._context.gl;this._vShader&&(c.deleteShader(this._vShader),this._vShader=null);this._fShader&&(c.deleteShader(this._fShader),this._fShader=null);this._glName&&(c.deleteProgram(this._glName),
this._glName=null);a("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(3);this._context=null}};b.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,c=a.createProgram();a.attachShader(c,this._vShader);a.attachShader(c,this._fShader);for(var e in this._locations)a.bindAttribLocation(c,this._locations[e],e);a.linkProgram(c);
a.getProgramParameter(c,a.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+a.getProgramParameter(c,a.VALIDATE_STATUS)+", gl error ["+a.getError()+"]infoLog: "+a.getProgramInfoLog(c));this._glName=c;this._initialized=!0}};b.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};b.prototype.hasUniform=function(a){return null!==
this.getUniformLocation(a)};b.prototype.getAttribLocation=function(a){this.initialize();void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};b.prototype.setUniform1i=function(a,c){var d=this._nameToUniform1[a];if(void 0===d||c!==d)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),c),this._nameToUniform1[a]=c};b.prototype.setUniform1f=function(a,c){var d=this._nameToUniform1[a];
if(void 0===d||c!==d)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),c),this._nameToUniform1[a]=c};b.prototype.setUniform1fv=function(a,c){var d=this._nameToUniform2[a];void 0!==d&&b._arraysEqual(c,d)||(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(a),c),void 0===d?this._nameToUniform2[a]=new Float32Array(c):d.set(c))};b.prototype.setUniform2f=function(a,c,e){var d=this._nameToUniform2[a];if(void 0===d||c!==d[0]||e!==d[1])this._context.bindProgram(this),
this._context.gl.uniform2f(this.getUniformLocation(a),c,e),void 0===d?this._nameToUniform2[a]=new Float32Array([c,e]):(d[0]=c,d[1]=e)};b.prototype.setUniform2fv=function(a,c){e&&0!==c.length%2&&console.error("Value array must have even number of elements!");var d=this._nameToUniform2[a];void 0!==d&&b._arraysEqual(c,d)||(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(a),c),void 0===d?this._nameToUniform2[a]=new Float32Array(c):d.set(c))};b.prototype.setUniform3f=
function(a,c,e,b){var d=this._nameToUniform3[a];if(void 0===d||c!==d[0]||e!==d[1]||b!==d[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),c,e,b),void 0===d?this._nameToUniform3[a]=new Float32Array([c,e,b]):(d[0]=c,d[1]=e,d[2]=b)};b.prototype.setUniform3fv=function(a,c){e&&0!==c.length%3&&console.error("Value array must contain sets of three values!");var d=this._nameToUniform3[a];void 0!==d&&b._arraysEqual(c,d)||(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(a),
c),void 0===d?this._nameToUniform3[a]=new Float32Array(c):d.set(c))};b.prototype.setUniform4f=function(a,c,e,b,p){var d=this._nameToUniform4[a];if(void 0===d||c!==d[0]||e!==d[1]||b!==d[2]||p!==d[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),c,e,b,p),void 0===d?this._nameToUniform4[a]=new Float32Array([c,e,b,p]):(d[0]=c,d[1]=e,d[2]=b,d[3]=p)};b.prototype.setUniform4fv=function(a,c){e&&0!==c.length%4&&console.error("Value array must contain sets of four values!");
var d=this._nameToUniform4[a];void 0!==d&&b._arraysEqual(c,d)||(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(a),c),void 0===d?this._nameToUniform4[a]=new Float32Array(c):d.set(c))};b.prototype.setUniformMatrix3fv=function(a,c,h){void 0===h&&(h=!1);e&&0!==c.length%9&&console.error("Matrix array must contain sets ot 9 elements!");var d=this._nameToUniformMatrix3[a];void 0!==d&&(9===d.length?b._matrix3Equal(d,c):b._arraysEqual(c,d))||(this._context.bindProgram(this),
this._context.gl.uniformMatrix3fv(this.getUniformLocation(a),h,c),void 0===d?this._nameToUniformMatrix3[a]=new Float32Array(c):d.set(c))};b.prototype.setUniformMatrix4fv=function(a,c,h){void 0===h&&(h=!1);e&&0!==c.length%16&&console.error("Matrix array must contain sets ot 16 elements!");var d=this._nameToUniformMatrix4[a];void 0!==d&&(16===d.length?b._matrix4Equal(d,c):b._arraysEqual(c,d))||(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(a),h,c),void 0===
d?this._nameToUniformMatrix4[a]=new Float32Array(c):d.set(c))};b._padToThree=function(a){var c=a.toString();1E3>a&&(c=("  "+a).slice(-3));return c};b.prototype._addLineNumbers=function(a){var c=2;return a.replace(/\n/g,function(){return"\n"+b._padToThree(c++)+":"})};b.prototype._loadShader=function(a){var d=35633===a,e=d?this._vertexShaderSource:this._fragmentShaderSource,b;b="";for(var p in this._defines)b+="#define "+p+" "+this._defines[p]+"\n";b+=e;"webgl2"===this._context.contextVersion&&(b=c.transpileShader(b,
d?"vertex":"fragment"));d=this._context.gl;a=d.createShader(a);d.shaderSource(a,b);d.compileShader(a);d.getShaderParameter(a,d.COMPILE_STATUS)||(console.error(d.getShaderInfoLog(a)),console.error(this._addLineNumbers(b)),"webgl2"===this._context.contextVersion&&(console.log("Shader source before transpilation:"),console.log(e)));return a};b._matrix4Equal=function(a,c){e&&(16===a.length&&16===c.length||console.error("Matrix object must contain 16 elements!"));return a[0]===c[0]&&a[1]===c[1]&&a[2]===
c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]};b._matrix3Equal=function(a,c){e&&(9===a.length&&9===c.length||console.error("Matrix object must contain 16 elements!"));return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]};b._arraysEqual=function(a,c){if(a.length!==c.length)return!1;for(var d=
0;d<a.length;++d)if(a[d]!==c[d])return!1;return!0};b._nextId=0;return b}()})},"esri/layers/vectorTiles/views/webgl/ShaderTranspiler":function(){define(["require","exports","./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(k,b,a,c){function e(a){return a.map(function(a){return"eof"!==a.type?a.data:""}).join("")}function g(a,c,d,e){e=e||d;for(var b=0;b<a.length;b++){var m=a[b];if("ident"===m.type&&m.data===d)return e in c?c[e]++:c[e]=0,g(a,c,e+"_"+c[e],e)}return d}function l(a,c,d){void 0===
d&&(d="afterVersion");var e={data:"\n",type:"whitespace"},b=function(c){return c<a.length?/[^\r\n]$/.test(a[c].data):!1},m=function(a){for(var c=-1,f=0,n=-1,e=0;e<a.length;e++){var b=a[e];"preprocessor"===b.type&&(b.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++f:b.data.match(/\#endif\s*.*/)&&--f);("afterVersion"===d||"afterPrecision"===d)&&"preprocessor"===b.type&&/^#version/.test(b.data)&&(n=Math.max(n,e));if("afterPrecision"===d&&"keyword"===b.type&&"precision"===b.data){a:{for(b=e;b<a.length;b++){var m=
a[b];if("operator"===m.type&&";"===m.data)break a}b=null}if(null===b)throw Error("precision statement not followed by any semicolons!");n=Math.max(n,b)}c<n&&0===f&&(c=e)}return c+1}(a);b(m-1)&&a.splice(m++,0,e);for(var h=0;h<c.length;h++){var p=c[h];a.splice(m++,0,p)}b(m-1)&&b(m)&&a.splice(m,0,e)}Object.defineProperty(b,"__esModule",{value:!0});var d=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];b.transpileShader=function(b,m){b=c(b);var h;a:{h=
"100";var q="300 es";void 0===h&&(h="100");void 0===q&&(q="300 es");for(var t=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,u=0;u<b.length;u++){var y=b[u];if("preprocessor"===y.type){var k=t.exec(y.data);if(k)if(t=k[1].replace(/\s\s+/g," "),t===q){h=t;break a}else if(t===h){y.data="#version "+q;break a}else throw Error("unknown glsl version: "+t);}}b.splice(0,0,{type:"preprocessor",data:"#version "+q},{type:"whitespace",data:"\n"});h=null}if("300 es"===h)throw Error("shader is already glsl 300 es");
t=y=null;u={};k={};for(h=0;h<b.length;++h)switch(q=b[h],q.type){case "keyword":"vertex"===m&&"attribute"===q.data?q.data="in":"varying"===q.data&&(q.data="vertex"===m?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(q.data.trim())&&(q.data=q.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===m&&"gl_FragColor"===q.data){if(!y){var y=g(b,u,"fragColor"),A=void 0;void 0===A&&(A="lowp");l(b,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:A},
{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:y},{type:"operator",data:";"}],"afterPrecision")}q.data=y}else"fragment"===m&&"gl_FragDepthEXT"===q.data&&(t||(t=g(b,u,"gl_FragDepth")),q.data=t);break;case "ident":if(0<=a.indexOf(q.data)){if(A="vertex"===m)a:{for(A=h-1;0<=A;A--){var z=b[A];if("whitespace"!==z.type&&"block-comment"!==z.type)if("keyword"===z.type){if("attribute"===z.data||"in"===z.data){A=!0;break a}}else break}A=!1}if(A)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");
q.data in k||(k[q.data]=g(b,u,q.data));q.data=k[q.data]}}for(h=b.length-1;0<=h;--h)q=b[h],"preprocessor"===q.type&&((m=q.data.match(/\#extension\s+(.*)\:/))&&m[1]&&0<=d.indexOf(m[1].trim())&&(m=b[h+1],b.splice(h,m&&"whitespace"===m.type?2:1)),(m=q.data.match(/\#ifdef\s+(.*)/))&&m[1]&&0<=d.indexOf(m[1].trim())&&(q.data="#if 1"),(m=q.data.match(/\#ifndef\s+(.*)/))&&m[1]&&0<=d.indexOf(m[1].trim())&&(q.data="#if 0"));return e(b)}})},"esri/layers/vectorTiles/views/webgl/reservedWordsGLSL3":function(){define(["require",
"exports"],function(k,b){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/layers/vectorTiles/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(k){"use strict;";return function(b){var a=k(),c=[],c=c.concat(a(b));return c=c.concat(a(null))}})},"esri/layers/vectorTiles/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(k,b,a){"use strict;";var c="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function e(a){a.length&&
z.push({type:c[u],data:a,position:r,line:f,column:n})}function g(){A=A.length?[]:A;if("/"===x&&"*"===y)return r=t+q-1,u=0,x=y,q+1;if("/"===x&&"/"===y)return r=t+q-1,u=1,x=y,q+1;if("#"===y)return u=2,r=t+q,q;if(/\s/.test(y))return u=9,r=t+q,q;B=/\d/.test(y);C=/[^\w_]/.test(y);r=t+q;u=B?4:C?3:9999;return q}function l(){if(("\r"===y||"\n"===y)&&"\\"!==x)return e(A.join("")),u=999,q;A.push(y);x=y;return q+1}function d(){if("."===x&&/\d/.test(y))return u=5,q;if("/"===x&&"*"===y)return u=0,q;if("/"===x&&
"/"===y)return u=1,q;if("."===y&&A.length){for(;h(A););u=5;return q}if(";"===y||")"===y||"("===y){if(A.length)for(;h(A););e(y);u=999;return q+1}var a=2===A.length&&"\x3d"!==y;if(/[\w_\d\s]/.test(y)||a){for(;h(A););u=999;return q}A.push(y);x=y;return q+1}function h(a){var f=0,c,n;do{c=b.indexOf(a.slice(0,a.length+f).join(""));n=b[c];if(-1===c){if(0<f--+a.length)continue;n=a.slice(0,1).join("")}e(n);r+=n.length;A=A.slice(n.length);return A.length}while(1)}function m(){if("."===y||/[eE]/.test(y))return A.push(y),
u=5,x=y,q+1;if("x"===y&&1===A.length&&"0"===A[0])return u=11,A.push(y),x=y,q+1;if(/[^\d]/.test(y))return e(A.join("")),u=999,q;A.push(y);x=y;return q+1}function p(){"f"===y&&(A.push(y),x=y,q+=1);if(/[eE]/.test(y)||"-"===y&&/[eE]/.test(x))return A.push(y),x=y,q+1;if(/[^\d]/.test(y))return e(A.join("")),u=999,q;A.push(y);x=y;return q+1}var q=0,t=0,u=999,y,x,A=[],z=[],f=1,n=0,r=0,B=!1,C=!1,D="",F;return function(c){z=[];if(null!==c){c=c.replace?c.replace(/\r\n/g,"\n"):c;q=0;D+=c;for(F=D.length;y=D[q],
q<F;){c=q;switch(u){case 0:"/"===y&&"*"===x?(A.push(y),e(A.join("")),u=999):(A.push(y),x=y);q+=1;break;case 1:q=l();break;case 2:q=l();break;case 3:q=d();break;case 4:q=m();break;case 11:/[^a-fA-F0-9]/.test(y)?(e(A.join("")),u=999):(A.push(y),x=y,q+=1);break;case 5:q=p();break;case 9999:if(/[^\d\w_]/.test(y)){var b=A.join("");u=-1<k.indexOf(b)?8:-1<a.indexOf(b)?7:6;e(A.join(""));u=999}else A.push(y),x=y,q+=1;break;case 9:/[^\s]/g.test(y)?(e(A.join("")),u=999):(A.push(y),x=y,q+=1);break;case 999:q=
g()}if(c!==q)switch(D[c]){case "\n":n=0;++f;break;default:++n}}t+=q;D=D.slice(q);return z}A.length&&e(A.join(""));u=10;e("(eof)");return z}}})},"esri/layers/vectorTiles/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/layers/vectorTiles/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/layers/vectorTiles/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/layers/vectorTiles/views/webgl/VertexArrayObject":function(){define(["require","exports","dojo/has","./Util"],function(k,b,a,c){return function(){function e(c,b,d,h,m){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=c;this._layout=d;this._buffers=h;this._locations=b;m&&(this._indexBuffer=m);this._id=e._nextId++;a("esri-webgl-debug")&&c.instanceCounter.incrementCount(2)}Object.defineProperty(e.prototype,"id",
{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"size",{get:function(){var a=this;return Object.keys(this._buffers).reduce(function(c,
d){return c+a._buffers[d].size},this._indexBuffer?this._indexBuffer.size:0)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});e.prototype.dispose=function(c){void 0===c&&(c=!0);if(this._context){var e=this._context.capabilities.vao;e&&this._glName&&(e.deleteVertexArray(this._glName),this._glName=
null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(c){for(var d in this._buffers)this._buffers[d].dispose(),delete this._buffers[d];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}a("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(2);this._context=null}};e.prototype.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){var c=a.createVertexArray();a.bindVertexArray(c);this._bindLayout();a.bindVertexArray(null);
this._glName=c}this._initialized=!0}};e.prototype.bind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};e.prototype._bindLayout=function(){var a=this._buffers,e=!!this._context.capabilities.vao,d=this._layout,b=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var m=this._context.gl,p;for(p in a){var q=a[p];q||console.error("Vertex buffer is uninitialized!");var t=d[p];t||console.error("Vertex element descriptor is empty!");
c.bindVertexBufferLayout(this._context,this._locations,q,t)}b&&(e?m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,b.glName):this._context.bindBuffer(b))};e.prototype.unbind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};e.prototype._unbindLayout=function(){var a=this._buffers,e=this._layout;a||console.error("Vertex buffer dictionary is empty!");for(var d in a){var b=a[d];b||console.error("Vertex buffer is uninitialized!");c.unbindVertexBufferLayout(this._context,
this._locations,b,e[d])}(a=this._indexBuffer)&&this._context.unbindBuffer(a.bufferType)};e._nextId=0;return e}()})},"esri/layers/vectorTiles/views/webgl/Util":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/Error"],function(k,b,a,c){return function(){function e(){}e.vertexCount=function(a,c){return a.vertexBuffers[c].size/e.getStride(a.layout[c])};e.getStride=function(a){return a[0].stride};e.getBytesPerElement=function(a){switch(a){case 5126:return 4;case 5124:return 4;
case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw Error("Unknown data type");}};e.addDescriptor=function(a,c,d,b,m,p){var h=e.getBytesPerElement(b);if(0<a.length){var g=a[0].stride,l=g+h*d;a.forEach(function(a){return a.stride=l});a.push({name:c,count:d,type:b,offset:g,stride:l,normalized:m,divisor:p})}else a.push({name:c,count:d,type:b,offset:0,stride:h*d,normalized:m,divisor:p})};e.assertCompatibleVertexAttributeLocations=function(a,c){(a=
a.locations===c.locations)||console.error("VertexAttributeLocations are incompatible");return a};e.hasAttribute=function(a,c){for(var d=0;d<a.length;d++)if(a[d].name===c)return!0;return!1};e.findAttribute=function(a,c){for(var d=0;d<a.length;d++)if(a[d].name===c)return a[d];return null};e.copyFramebufferToTexture=function(a,c,d,e,b){void 0===b&&(b=0);var m=a.getBoundFramebufferObject(),h=a.getBoundTexture(0);a.bindFramebuffer(c);a.bindTexture(d,0);a.gl.copyTexImage2D(a.gl.TEXTURE_2D,b,d.descriptor.pixelFormat,
e[0],e[1],e[2],e[3],0);a.gl.flush();a.bindFramebuffer(m);a.bindTexture(h,0)};e.assert=function(a,e){if(!a)throw new c(e);};e.setBaseInstanceOffset=function(c,e){var d={},b;for(b in c)d[b]=c[b].map(function(c){return c.divisor?a({},c,{baseInstance:e}):c});return d};e.bindVertexBufferLayout=function(a,c,d,e,b){var m=a.gl,h=a.capabilities.instancing;a.bindBuffer(d);e.forEach(function(a){var d=c[a.name],e=(b?b:0+a.baseInstance?a.baseInstance:0)*a.stride;void 0===d&&console.error("There is no location for vertex attribute '"+
a.name+"' defined.");a.baseInstance&&!a.divisor&&console.error("Vertex attribute '"+a.name+"' uses baseInstanceOffset without divisor.");if(4>=a.count)m.vertexAttribPointer(d,a.count,a.type,a.normalized,a.stride,a.offset+e),m.enableVertexAttribArray(d),a.divisor&&0<a.divisor&&h&&h.vertexAttribDivisor(d,a.divisor);else if(9===a.count)for(var p=0;3>p;p++)m.vertexAttribPointer(d+p,3,a.type,a.normalized,a.stride,a.offset+12*p+e),m.enableVertexAttribArray(d+p),a.divisor&&0<a.divisor&&h&&h.vertexAttribDivisor(d+
p,a.divisor);else if(16===a.count)for(p=0;4>p;p++)m.vertexAttribPointer(d+p,4,a.type,a.normalized,a.stride,a.offset+16*p+e),m.enableVertexAttribArray(d+p),a.divisor&&0<a.divisor&&h&&h.vertexAttribDivisor(d+p,a.divisor);else console.error("Unsupported vertex attribute element count: "+a.count)})};e.unbindVertexBufferLayout=function(a,c,d,e){var b=a.gl;a.bindBuffer(d);e.forEach(function(a){var d=c[a.name];if(4>=a.count)b.disableVertexAttribArray(d);else if(9===a.count)for(a=0;3>a;a++)b.disableVertexAttribArray(d+
a);else if(16===a.count)for(a=0;4>a;a++)b.disableVertexAttribArray(d+a);else console.error("Unsupported vertex attribute element count: "+a.count)});a.unbindBuffer(34962)};return e}()})},"esri/layers/vectorTiles/core/tsSupport/assignHelper":function(){define([],function(){return Object.assign||function(k){for(var b,a=1,c=arguments.length;a<c;a++){b=arguments[a];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(k[e]=b[e])}return k}})},"esri/layers/vectorTiles/views/2d/engine/webgl/enums":function(){define(["require",
"exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]="LABEL";a[a.NONE=5]="NONE";a[a.UNKNOWN=6]="UNKNOWN";a[a.COUNT=7]="COUNT"})(b.WGLGeometryType||(b.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(b.WGLGeometryTransactionStatus||(b.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=0]="NONE";a[a.FILL=
1]="FILL";a[a.LINE=2]="LINE";a[a.MARKER=4]="MARKER";a[a.TEXT=8]="TEXT";a[a.LABEL=16]="LABEL";a[a.LABEL_ALPHA=32]="LABEL_ALPHA";a[a.HITTEST=64]="HITTEST";a[a.HIGHLIGHT=128]="HIGHLIGHT";a[a.CLIP=256]="CLIP";a[a.DEBUG=512]="DEBUG";a[a.NUM_DRAW_PHASES=12]="NUM_DRAW_PHASES"})(b.WGLDrawPhase||(b.WGLDrawPhase={}));(function(a){a[a.SIZE=0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(b.VVType||(b.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=
2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(b.WGLVVFlag||(b.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(b.WGLVVTarget||(b.WGLVVTarget=
{}));(function(a){a[a.UNKNOWN=0]="UNKNOWN";a[a.BUTT=1]="BUTT";a[a.ROUND=2]="ROUND";a[a.SQUARE=3]="SQUARE"})(b.CapType||(b.CapType={}));(function(a){a[a.UNKNOWN=0]="UNKNOWN";a[a.MITER=1]="MITER";a[a.BEVEL=2]="BEVEL";a[a.ROUND=3]="ROUND"})(b.JoinType||(b.JoinType={}));(function(a){a.SIMPLE_MARKER="esriSMS";a.SIMPLE_LINE="esriSLS";a.SIMPLE_FILL="esriSFS";a.PICTURE_MARKER="esriPMS";a.PICTURE_FILL="esriPFS";a.TEXT="esriTS"})(b.EsriSymbolType||(b.EsriSymbolType={}));(function(a){a.SIMPLE_MARKER="simple-marker";
a.SIMPLE_LINE="simple-line";a.SIMPLE_FILL="simple-fill";a.PICTURE_MARKER="picture-marker";a.PICTURE_FILL="picture-fill";a.TEXT="text"})(b.EsriSymbolTypeKebab||(b.EsriSymbolTypeKebab={}))})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLPainter":function(){define("require exports ../../../../core/tsSupport/assignHelper dojo/has ../../../../core/libs/gl-matrix/mat4 ./enums ./GeometryUtils ./MaterialManager ./Utils ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil ./brushes/WGLGeometryBrushFill ./brushes/WGLGeometryBrushLabel ./brushes/WGLGeometryBrushLine ./brushes/WGLGeometryBrushMarker ./brushes/WGLGeometryBrushText ./painter/WGLHighlightPainter ./../../../webgl/FramebufferObject".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function a(){this._initialized=!1}a.prototype.registerPass=function(a,f){this._initialize();for(var c=0;c<f.length;c++)this._passMap.set(f[c],a);return this};a.prototype.getPaintPassTs=function(a){this._initialize();return this._passMap.has(a)?[this._passMap.get(a)]:[]};a.prototype._initialize=function(){this._initialized||(this._passMap=new Map,this._initialized=!0)};return a}();b.WGLPainterOptions=
k;var f=new Uint8Array(4*h.C_HITTEST_SEARCH_SIZE*h.C_HITTEST_SEARCH_SIZE),n=new Uint32Array(f.buffer);k=function(){function b(){this._hlPainter=new A;this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._extrudeRotateVector=new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0;this.materialManager=new d}b.allGeometryPhases=function(){return[g.WGLDrawPhase.FILL,
g.WGLDrawPhase.LINE,g.WGLDrawPhase.MARKER,g.WGLDrawPhase.TEXT]};b.toWGLDrawPhases=function(a){for(var f=[],c,n=0;n<g.WGLDrawPhase.NUM_DRAW_PHASES;n++)c=1<<n,c&a&&f.push(c);return f};Object.defineProperty(b.prototype,"extrudeMatrix",{get:function(){return this._extrudeMatrix},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"extrudeNoRotationMatrix",{get:function(){return this._extrudeNoRotationMatrix},enumerable:!0,configurable:!0});b.prototype.dispose=function(){this.materialManager.dispose();
this.textureManager=null;this._hlPainter&&(this._hlPainter.dispose(),this._hlPainter=null);this._hittestFBO&&(this._hittestFBO.dispose(),this._hittestFBO=null);this._passes&&(this._passes.forEach(function(a){return a.dispose()}),this._passes.clear());this._brushes&&(this._brushes.forEach(function(a){return a.forEach(function(a){return a.dispose()})}),this._brushes.clear())};b.prototype.initialize=function(a){this.materialManager.initialize(a)};b.prototype.update=function(a,f){this._state=a;if(this._state.width!==
this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)this._extrudeScaleVector[0]=2/a.width,this._extrudeScaleVector[1]=-2/a.height,e.identity(this._extrudeMatrix),e.rotate(this._extrudeMatrix,this._extrudeMatrix,-a.rotation*l.C_DEG_TO_RAD,this._extrudeRotateVector),e.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),e.transpose(this._extrudeMatrix,this._extrudeMatrix),e.identity(this._extrudeNoRotationMatrix),e.scale(this._extrudeNoRotationMatrix,
this._extrudeNoRotationMatrix,this._extrudeScaleVector),e.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation};b.prototype.getBrushes=function(a){if(!this._brushes){var f=new q.default,c=new y.default,n=new u.default,d=new x.default,b=new t.default,e=new m.default,r=new p.default;this._brushes=new Map;this._brushes.set(g.WGLDrawPhase.FILL,[f]);this._brushes.set(g.WGLDrawPhase.MARKER,
[c]);this._brushes.set(g.WGLDrawPhase.LINE,[n]);this._brushes.set(g.WGLDrawPhase.TEXT,[d]);this._brushes.set(g.WGLDrawPhase.LABEL,[b]);this._brushes.set(g.WGLDrawPhase.LABEL_ALPHA,[b]);this._brushes.set(g.WGLDrawPhase.HITTEST,[f,c,n,d]);this._brushes.set(g.WGLDrawPhase.HIGHLIGHT,[f,c,n,d]);this._brushes.set(g.WGLDrawPhase.CLIP,[r]);this._brushes.set(g.WGLDrawPhase.DEBUG,[e])}if(!this._brushes.has(a))throw Error("WGLPainter: Tried to get brush for unknown phase: "+a);return this._brushes.get(a)};b.prototype.bindTextureManager=
function(a){this.textureManager=a};b.prototype.draw=function(a,f,c,n){c[0]===g.WGLDrawPhase.LABEL_ALPHA&&c[0]===g.WGLDrawPhase.LABEL||this._drawClippingRects(a,f);var d=a.context;d.setBlendingEnabled(!0);d.setStencilWriteMask(0);d.setBlendFunctionSeparate(1,771,1,771);this._drawPhases(a,f,c,n);this._debugTiles(a,f)};b.prototype.setHighlightOptions=function(a){this._hlPainter.setHighlightOptions(a)};b.prototype.highlight=function(a,f){var c=a.context,n=c.getViewport();this._hlPainter.setup(c,n.width,
n.height);this._hlPainter.startMaskDraw(c);this._drawClippingRects(a,f);c.setBlendingEnabled(!0);c.setStencilWriteMask(0);c.setBlendFunctionSeparate(1,771,1,771);this._drawPhases(a,f,[g.WGLDrawPhase.HIGHLIGHT]);this._hlPainter.draw(c)};b.prototype.hitTest=function(a,c){var d=h.C_HITTEST_SEARCH_SIZE,b=[0,0],e=[0,0],r=a.state;r.toMap(b,[0,0]);r.toMap(e,[d,d]);if(0===c.filter(function(a){return!(b[0]>a.bounds[2]||e[0]<a.bounds[0]||b[1]<a.bounds[1]||e[1]>a.bounds[3])}).length)return[];r=a.context;this._hittestFBO||
(this._hittestFBO=z.create(r,{colorTarget:0,depthStencilTarget:3,width:d,height:d}));var m=r.getViewport(),p=r.getBoundFramebufferObject();r.bindFramebuffer(this._hittestFBO);r.setViewport(0,0,d,d);this._drawClippingRects(a,c);var l=r.gl;r.setClearColor(1,1,1,1);r.clear(l.COLOR_BUFFER_BIT);r.setBlendingEnabled(!1);r.setStencilWriteMask(0);this._drawPhases(a,c,[g.WGLDrawPhase.HITTEST]);r.setBlendingEnabled(!0);this._hittestFBO.readPixels(0,0,d,d,6408,5121,f);a=d*d;c=new Set;for(d=0;d<a;d++)l=n[d],
4294967295!==l&&c.add(l);r.bindFramebuffer(p);r.setViewport(m.x,m.y,m.width,m.height);var B=[];c.forEach(function(a){B.push(a)});return B};b.prototype._getPaintPass=function(a){this._passes||(this._passes=new Map);if(!this._passes.has(a))try{this._passes.set(a,new a)}catch(C){throw Error("Tried to instantiate WGLPaintPass with unknown constructor: "+a+",\n"+C);}return this._passes.get(a)};b.prototype._getPaintPasses=function(a,f){var c=this;return f.getPaintPassTs(a).map(function(a){return c._getPaintPass(a)})};
b.prototype._drawPhases=function(f,c,n,d){f.context.setStencilTestEnabled(!0);for(var b=0;b<n.length;b++){var e=n[b],r=d?this._getPaintPasses(e,d):[],e=a({},f,{drawPhase:e});r.forEach(function(a){return a.preRender(f,f.rendererInfo)});for(var m=0,h=c;m<h.length;m++)h[m].doRender(e);r.reverse().forEach(function(a){return a.postRender(f,f.rendererInfo)})}f.context.setStencilTestEnabled(!1)};b.prototype._debugTiles=function(a,f){c("esri-feature-tiles-debug")&&this._drawPhases(a,f,[g.WGLDrawPhase.DEBUG])};
b.prototype._drawClippingRects=function(a,f){if(0!==f.length){var c=a.context;c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);c.setBlendingEnabled(!1);c.setColorMask(!1,!1,!1,!1);c.setStencilOp(7680,7680,7681);c.setClearStencil(0);c.clear(c.gl.STENCIL_BUFFER_BIT);c.setStencilWriteMask(255);for(var c=0,n=f.length;c<f.length;c++,n--){var d=f[c];d.attached&&(d.stencilRef=n)}this._drawPhases(a,f,[g.WGLDrawPhase.CLIP]);a.context.setColorMask(!0,!0,!0,!0)}};return b}();
b.default=k})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat4":function(){define(["./common"],function(k){var b={scalar:{},SIMD:{},create:function(){var a=new k.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var c=new k.ARRAY_TYPE(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=
a[14];c[15]=a[15];return c},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];a[9]=c[9];a[10]=c[10];a[11]=c[11];a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a},fromValues:function(a,c,b,g,l,d,h,m,p,q,t,u,y,x,A,z){var f=new k.ARRAY_TYPE(16);f[0]=a;f[1]=c;f[2]=b;f[3]=g;f[4]=l;f[5]=d;f[6]=h;f[7]=m;f[8]=p;f[9]=q;f[10]=t;f[11]=u;f[12]=y;f[13]=x;f[14]=A;f[15]=z;return f},set:function(a,c,b,g,l,d,h,m,p,q,t,u,y,k,A,z,f){a[0]=c;a[1]=b;a[2]=
g;a[3]=l;a[4]=d;a[5]=h;a[6]=m;a[7]=p;a[8]=q;a[9]=t;a[10]=u;a[11]=y;a[12]=k;a[13]=A;a[14]=z;a[15]=f;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}};b.scalar.transpose=function(a,c){if(a===c){var b=c[1],g=c[2],l=c[3],d=c[6],h=c[7],m=c[11];a[1]=c[4];a[2]=c[8];a[3]=c[12];a[4]=b;a[6]=c[9];a[7]=c[13];a[8]=g;a[9]=d;a[11]=c[14];a[12]=l;a[13]=h;a[14]=m}else a[0]=c[0],a[1]=c[4],a[2]=c[8],a[3]=c[12],
a[4]=c[1],a[5]=c[5],a[6]=c[9],a[7]=c[13],a[8]=c[2],a[9]=c[6],a[10]=c[10],a[11]=c[14],a[12]=c[3],a[13]=c[7],a[14]=c[11],a[15]=c[15];return a};b.SIMD.transpose=function(a,c){var b,g,l,d,h,m;b=SIMD.Float32x4.load(c,0);g=SIMD.Float32x4.load(c,4);l=SIMD.Float32x4.load(c,8);c=SIMD.Float32x4.load(c,12);d=SIMD.Float32x4.shuffle(b,g,0,1,4,5);h=SIMD.Float32x4.shuffle(l,c,0,1,4,5);m=SIMD.Float32x4.shuffle(d,h,0,2,4,6);d=SIMD.Float32x4.shuffle(d,h,1,3,5,7);SIMD.Float32x4.store(a,0,m);SIMD.Float32x4.store(a,4,
d);d=SIMD.Float32x4.shuffle(b,g,2,3,6,7);h=SIMD.Float32x4.shuffle(l,c,2,3,6,7);b=SIMD.Float32x4.shuffle(d,h,0,2,4,6);g=SIMD.Float32x4.shuffle(d,h,1,3,5,7);SIMD.Float32x4.store(a,8,b);SIMD.Float32x4.store(a,12,g);return a};b.transpose=k.USE_SIMD?b.SIMD.transpose:b.scalar.transpose;b.scalar.invert=function(a,c){var b=c[0],g=c[1],l=c[2],d=c[3],h=c[4],m=c[5],p=c[6],q=c[7],t=c[8],u=c[9],y=c[10],k=c[11],A=c[12],z=c[13],f=c[14];c=c[15];var n=b*m-g*h,r=b*p-l*h,B=b*q-d*h,C=g*p-l*m,D=g*q-d*m,F=l*q-d*p,H=t*
z-u*A,J=t*f-y*A,I=t*c-k*A,G=u*f-y*z,Q=u*c-k*z,W=y*c-k*f,K=n*W-r*Q+B*G+C*I-D*J+F*H;if(!K)return null;K=1/K;a[0]=(m*W-p*Q+q*G)*K;a[1]=(l*Q-g*W-d*G)*K;a[2]=(z*F-f*D+c*C)*K;a[3]=(y*D-u*F-k*C)*K;a[4]=(p*I-h*W-q*J)*K;a[5]=(b*W-l*I+d*J)*K;a[6]=(f*B-A*F-c*r)*K;a[7]=(t*F-y*B+k*r)*K;a[8]=(h*Q-m*I+q*H)*K;a[9]=(g*I-b*Q-d*H)*K;a[10]=(A*D-z*B+c*n)*K;a[11]=(u*B-t*D-k*n)*K;a[12]=(m*J-h*G-p*H)*K;a[13]=(b*G-g*J+l*H)*K;a[14]=(z*r-A*C-f*n)*K;a[15]=(t*C-u*r+y*n)*K;return a};b.SIMD.invert=function(a,c){var b,g,l,d,h,m,
p,q;h=SIMD.Float32x4.load(c,0);m=SIMD.Float32x4.load(c,4);p=SIMD.Float32x4.load(c,8);q=SIMD.Float32x4.load(c,12);c=SIMD.Float32x4.shuffle(h,m,0,1,4,5);g=SIMD.Float32x4.shuffle(p,q,0,1,4,5);b=SIMD.Float32x4.shuffle(c,g,0,2,4,6);g=SIMD.Float32x4.shuffle(g,c,1,3,5,7);c=SIMD.Float32x4.shuffle(h,m,2,3,6,7);d=SIMD.Float32x4.shuffle(p,q,2,3,6,7);l=SIMD.Float32x4.shuffle(c,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,c,1,3,5,7);c=SIMD.Float32x4.mul(l,d);c=SIMD.Float32x4.swizzle(c,1,0,3,2);h=SIMD.Float32x4.mul(g,
c);m=SIMD.Float32x4.mul(b,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,c),h);m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),m);m=SIMD.Float32x4.swizzle(m,2,3,0,1);c=SIMD.Float32x4.mul(g,l);c=SIMD.Float32x4.swizzle(c,1,0,3,2);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,c),h);q=SIMD.Float32x4.mul(b,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(d,c));q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),q);q=SIMD.Float32x4.swizzle(q,2,3,0,1);
c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,3,0,1),d);c=SIMD.Float32x4.swizzle(c,1,0,3,2);l=SIMD.Float32x4.swizzle(l,2,3,0,1);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h);p=SIMD.Float32x4.mul(b,c);c=SIMD.Float32x4.swizzle(c,2,3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),p);p=SIMD.Float32x4.swizzle(p,2,3,0,1);c=SIMD.Float32x4.mul(b,g);c=SIMD.Float32x4.swizzle(c,1,0,3,2);p=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,c),p);q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,
c),q);c=SIMD.Float32x4.swizzle(c,2,3,0,1);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,c),p);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(l,c));c=SIMD.Float32x4.mul(b,d);c=SIMD.Float32x4.swizzle(c,1,0,3,2);m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(l,c));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,c),p);c=SIMD.Float32x4.swizzle(c,2,3,0,1);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),m);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(g,c));c=SIMD.Float32x4.mul(b,l);c=SIMD.Float32x4.swizzle(c,1,0,3,2);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,
c),m);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(g,c));c=SIMD.Float32x4.swizzle(c,2,3,0,1);m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(d,c));q=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,c),q);b=SIMD.Float32x4.mul(b,h);b=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(b,2,3,0,1),b);b=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(b,1,0,3,2),b);c=SIMD.Float32x4.reciprocalApproximation(b);b=SIMD.Float32x4.sub(SIMD.Float32x4.add(c,c),SIMD.Float32x4.mul(b,SIMD.Float32x4.mul(c,c)));b=SIMD.Float32x4.swizzle(b,0,0,0,0);if(!b)return null;
SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(b,h));SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(b,m));SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(b,p));SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(b,q));return a};b.invert=k.USE_SIMD?b.SIMD.invert:b.scalar.invert;b.scalar.adjoint=function(a,c){var b=c[0],g=c[1],l=c[2],d=c[3],h=c[4],m=c[5],p=c[6],q=c[7],t=c[8],u=c[9],y=c[10],k=c[11],A=c[12],z=c[13],f=c[14];c=c[15];a[0]=m*(y*c-k*f)-u*(p*c-q*f)+z*(p*k-q*y);a[1]=-(g*(y*c-k*f)-u*(l*c-d*f)+z*(l*k-d*y));a[2]=
g*(p*c-q*f)-m*(l*c-d*f)+z*(l*q-d*p);a[3]=-(g*(p*k-q*y)-m*(l*k-d*y)+u*(l*q-d*p));a[4]=-(h*(y*c-k*f)-t*(p*c-q*f)+A*(p*k-q*y));a[5]=b*(y*c-k*f)-t*(l*c-d*f)+A*(l*k-d*y);a[6]=-(b*(p*c-q*f)-h*(l*c-d*f)+A*(l*q-d*p));a[7]=b*(p*k-q*y)-h*(l*k-d*y)+t*(l*q-d*p);a[8]=h*(u*c-k*z)-t*(m*c-q*z)+A*(m*k-q*u);a[9]=-(b*(u*c-k*z)-t*(g*c-d*z)+A*(g*k-d*u));a[10]=b*(m*c-q*z)-h*(g*c-d*z)+A*(g*q-d*m);a[11]=-(b*(m*k-q*u)-h*(g*k-d*u)+t*(g*q-d*m));a[12]=-(h*(u*f-y*z)-t*(m*f-p*z)+A*(m*y-p*u));a[13]=b*(u*f-y*z)-t*(g*f-l*z)+A*(g*
y-l*u);a[14]=-(b*(m*f-p*z)-h*(g*f-l*z)+A*(g*p-l*m));a[15]=b*(m*y-p*u)-h*(g*y-l*u)+t*(g*p-l*m);return a};b.SIMD.adjoint=function(a,c){var b,g,l,d,h,m,p,q;b=SIMD.Float32x4.load(c,0);g=SIMD.Float32x4.load(c,4);l=SIMD.Float32x4.load(c,8);d=SIMD.Float32x4.load(c,12);m=SIMD.Float32x4.shuffle(b,g,0,1,4,5);h=SIMD.Float32x4.shuffle(l,d,0,1,4,5);c=SIMD.Float32x4.shuffle(m,h,0,2,4,6);h=SIMD.Float32x4.shuffle(h,m,1,3,5,7);m=SIMD.Float32x4.shuffle(b,g,2,3,6,7);g=SIMD.Float32x4.shuffle(l,d,2,3,6,7);b=SIMD.Float32x4.shuffle(m,
g,0,2,4,6);g=SIMD.Float32x4.shuffle(g,m,1,3,5,7);m=SIMD.Float32x4.mul(b,g);m=SIMD.Float32x4.swizzle(m,1,0,3,2);l=SIMD.Float32x4.mul(h,m);d=SIMD.Float32x4.mul(c,m);m=SIMD.Float32x4.swizzle(m,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,m),l);d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,m),d);d=SIMD.Float32x4.swizzle(d,2,3,0,1);m=SIMD.Float32x4.mul(h,b);m=SIMD.Float32x4.swizzle(m,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,m),l);q=SIMD.Float32x4.mul(c,m);m=SIMD.Float32x4.swizzle(m,2,3,0,1);
l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(g,m));q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,m),q);q=SIMD.Float32x4.swizzle(q,2,3,0,1);m=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,3,0,1),g);m=SIMD.Float32x4.swizzle(m,1,0,3,2);b=SIMD.Float32x4.swizzle(b,2,3,0,1);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(b,m),l);p=SIMD.Float32x4.mul(c,m);m=SIMD.Float32x4.swizzle(m,2,3,0,1);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(b,m));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,m),p);p=SIMD.Float32x4.swizzle(p,2,3,0,
1);m=SIMD.Float32x4.mul(c,h);m=SIMD.Float32x4.swizzle(m,1,0,3,2);p=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,m),p);q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,m),q);m=SIMD.Float32x4.swizzle(m,2,3,0,1);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,m),p);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(b,m));m=SIMD.Float32x4.mul(c,g);m=SIMD.Float32x4.swizzle(m,1,0,3,2);d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(b,m));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,m),p);m=SIMD.Float32x4.swizzle(m,2,3,0,1);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(b,
m),d);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(h,m));m=SIMD.Float32x4.mul(c,b);m=SIMD.Float32x4.swizzle(m,1,0,3,2);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,m),d);q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(h,m));m=SIMD.Float32x4.swizzle(m,2,3,0,1);d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(g,m));q=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,m),q);SIMD.Float32x4.store(a,0,l);SIMD.Float32x4.store(a,4,d);SIMD.Float32x4.store(a,8,p);SIMD.Float32x4.store(a,12,q);return a};b.adjoint=k.USE_SIMD?b.SIMD.adjoint:
b.scalar.adjoint;b.determinant=function(a){var c=a[0],b=a[1],g=a[2],l=a[3],d=a[4],h=a[5],m=a[6],p=a[7],q=a[8],t=a[9],u=a[10],y=a[11],k=a[12],A=a[13],z=a[14];a=a[15];return(c*h-b*d)*(u*a-y*z)-(c*m-g*d)*(t*a-y*A)+(c*p-l*d)*(t*z-u*A)+(b*m-g*h)*(q*a-y*k)-(b*p-l*h)*(q*z-u*k)+(g*p-l*m)*(q*A-t*k)};b.SIMD.multiply=function(a,c,b){var e=SIMD.Float32x4.load(c,0),l=SIMD.Float32x4.load(c,4),d=SIMD.Float32x4.load(c,8);c=SIMD.Float32x4.load(c,12);var h=SIMD.Float32x4.load(b,0),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,
0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),l),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),d),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),c))));SIMD.Float32x4.store(a,0,h);h=SIMD.Float32x4.load(b,4);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),l),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),d),
SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),c))));SIMD.Float32x4.store(a,4,h);h=SIMD.Float32x4.load(b,8);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),l),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),d),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),c))));SIMD.Float32x4.store(a,8,h);b=SIMD.Float32x4.load(b,12);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,
0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,1,1,1,1),l),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,2,2,2,2),d),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,3,3,3,3),c))));SIMD.Float32x4.store(a,12,e);return a};b.scalar.multiply=function(a,c,b){var e=c[0],l=c[1],d=c[2],h=c[3],m=c[4],p=c[5],q=c[6],t=c[7],u=c[8],y=c[9],k=c[10],A=c[11],z=c[12],f=c[13],n=c[14];c=c[15];var r=b[0],B=b[1],C=b[2],D=b[3];a[0]=r*e+B*m+C*u+D*z;a[1]=r*l+B*p+C*y+D*f;a[2]=r*d+B*
q+C*k+D*n;a[3]=r*h+B*t+C*A+D*c;r=b[4];B=b[5];C=b[6];D=b[7];a[4]=r*e+B*m+C*u+D*z;a[5]=r*l+B*p+C*y+D*f;a[6]=r*d+B*q+C*k+D*n;a[7]=r*h+B*t+C*A+D*c;r=b[8];B=b[9];C=b[10];D=b[11];a[8]=r*e+B*m+C*u+D*z;a[9]=r*l+B*p+C*y+D*f;a[10]=r*d+B*q+C*k+D*n;a[11]=r*h+B*t+C*A+D*c;r=b[12];B=b[13];C=b[14];D=b[15];a[12]=r*e+B*m+C*u+D*z;a[13]=r*l+B*p+C*y+D*f;a[14]=r*d+B*q+C*k+D*n;a[15]=r*h+B*t+C*A+D*c;return a};b.multiply=k.USE_SIMD?b.SIMD.multiply:b.scalar.multiply;b.mul=b.multiply;b.scalar.translate=function(a,c,b){var e=
b[0],l=b[1];b=b[2];var d,h,m,p,q,t,u,y,k,A,z,f;c===a?(a[12]=c[0]*e+c[4]*l+c[8]*b+c[12],a[13]=c[1]*e+c[5]*l+c[9]*b+c[13],a[14]=c[2]*e+c[6]*l+c[10]*b+c[14],a[15]=c[3]*e+c[7]*l+c[11]*b+c[15]):(d=c[0],h=c[1],m=c[2],p=c[3],q=c[4],t=c[5],u=c[6],y=c[7],k=c[8],A=c[9],z=c[10],f=c[11],a[0]=d,a[1]=h,a[2]=m,a[3]=p,a[4]=q,a[5]=t,a[6]=u,a[7]=y,a[8]=k,a[9]=A,a[10]=z,a[11]=f,a[12]=d*e+q*l+k*b+c[12],a[13]=h*e+t*l+A*b+c[13],a[14]=m*e+u*l+z*b+c[14],a[15]=p*e+y*l+f*b+c[15]);return a};b.SIMD.translate=function(a,c,b){var e=
SIMD.Float32x4.load(c,0),l=SIMD.Float32x4.load(c,4),d=SIMD.Float32x4.load(c,8),h=SIMD.Float32x4.load(c,12);b=SIMD.Float32x4(b[0],b[1],b[2],0);c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11]);e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(b,0,0,0,0));l=SIMD.Float32x4.mul(l,SIMD.Float32x4.swizzle(b,1,1,1,1));d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(b,2,2,2,2));c=SIMD.Float32x4.add(e,SIMD.Float32x4.add(l,SIMD.Float32x4.add(d,
h)));SIMD.Float32x4.store(a,12,c);return a};b.translate=k.USE_SIMD?b.SIMD.translate:b.scalar.translate;b.scalar.scale=function(a,c,b){var e=b[0],l=b[1];b=b[2];a[0]=c[0]*e;a[1]=c[1]*e;a[2]=c[2]*e;a[3]=c[3]*e;a[4]=c[4]*l;a[5]=c[5]*l;a[6]=c[6]*l;a[7]=c[7]*l;a[8]=c[8]*b;a[9]=c[9]*b;a[10]=c[10]*b;a[11]=c[11]*b;a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a};b.SIMD.scale=function(a,c,b){var e;b=SIMD.Float32x4(b[0],b[1],b[2],0);e=SIMD.Float32x4.load(c,0);SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(e,
SIMD.Float32x4.swizzle(b,0,0,0,0)));e=SIMD.Float32x4.load(c,4);SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(b,1,1,1,1)));e=SIMD.Float32x4.load(c,8);SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(b,2,2,2,2)));a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a};b.scale=k.USE_SIMD?b.SIMD.scale:b.scalar.scale;b.rotate=function(a,c,b,g){var e=g[0],d=g[1];g=g[2];var h=Math.sqrt(e*e+d*d+g*g),m,p,q,t,u,y,x,A,z,f,n,r,B,C,D,F,H,J,I,G;if(Math.abs(h)<k.EPSILON)return null;
h=1/h;e*=h;d*=h;g*=h;m=Math.sin(b);p=Math.cos(b);q=1-p;b=c[0];h=c[1];t=c[2];u=c[3];y=c[4];x=c[5];A=c[6];z=c[7];f=c[8];n=c[9];r=c[10];B=c[11];C=e*e*q+p;D=d*e*q+g*m;F=g*e*q-d*m;H=e*d*q-g*m;J=d*d*q+p;I=g*d*q+e*m;G=e*g*q+d*m;e=d*g*q-e*m;d=g*g*q+p;a[0]=b*C+y*D+f*F;a[1]=h*C+x*D+n*F;a[2]=t*C+A*D+r*F;a[3]=u*C+z*D+B*F;a[4]=b*H+y*J+f*I;a[5]=h*H+x*J+n*I;a[6]=t*H+A*J+r*I;a[7]=u*H+z*J+B*I;a[8]=b*G+y*e+f*d;a[9]=h*G+x*e+n*d;a[10]=t*G+A*e+r*d;a[11]=u*G+z*e+B*d;c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);
return a};b.scalar.rotateX=function(a,c,b){var e=Math.sin(b);b=Math.cos(b);var l=c[4],d=c[5],h=c[6],m=c[7],p=c[8],q=c[9],t=c[10],u=c[11];c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[4]=l*b+p*e;a[5]=d*b+q*e;a[6]=h*b+t*e;a[7]=m*b+u*e;a[8]=p*b-l*e;a[9]=q*b-d*e;a[10]=t*b-h*e;a[11]=u*b-m*e;return a};b.SIMD.rotateX=function(a,c,b){var e=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],
a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);var l=SIMD.Float32x4.load(c,4);c=SIMD.Float32x4.load(c,8);SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(l,b),SIMD.Float32x4.mul(c,e)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),SIMD.Float32x4.mul(l,e)));return a};b.rotateX=k.USE_SIMD?b.SIMD.rotateX:b.scalar.rotateX;b.scalar.rotateY=function(a,c,b){var e=Math.sin(b);b=Math.cos(b);var l=c[0],d=c[1],h=c[2],m=c[3],p=c[8],q=c[9],t=c[10],u=c[11];c!==a&&(a[4]=c[4],
a[5]=c[5],a[6]=c[6],a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=l*b-p*e;a[1]=d*b-q*e;a[2]=h*b-t*e;a[3]=m*b-u*e;a[8]=l*e+p*b;a[9]=d*e+q*b;a[10]=h*e+t*b;a[11]=m*e+u*b;return a};b.SIMD.rotateY=function(a,c,b){var e=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));c!==a&&(a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);var l=SIMD.Float32x4.load(c,0);c=SIMD.Float32x4.load(c,8);SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,
b),SIMD.Float32x4.mul(c,e)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(l,e),SIMD.Float32x4.mul(c,b)));return a};b.rotateY=k.USE_SIMD?b.SIMD.rotateY:b.scalar.rotateY;b.scalar.rotateZ=function(a,c,b){var e=Math.sin(b);b=Math.cos(b);var l=c[0],d=c[1],h=c[2],m=c[3],p=c[4],q=c[5],t=c[6],u=c[7];c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=l*b+p*e;a[1]=d*b+q*e;a[2]=h*b+t*e;a[3]=m*b+u*e;a[4]=p*b-l*e;a[5]=q*b-d*e;a[6]=t*b-h*
e;a[7]=u*b-m*e;return a};b.SIMD.rotateZ=function(a,c,b){var e=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);var l=SIMD.Float32x4.load(c,0);c=SIMD.Float32x4.load(c,4);SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(l,b),SIMD.Float32x4.mul(c,e)));SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,b),SIMD.Float32x4.mul(l,e)));return a};b.rotateZ=k.USE_SIMD?
b.SIMD.rotateZ:b.scalar.rotateZ;b.fromTranslation=function(a,c){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};b.fromScaling=function(a,c){a[0]=c[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=c[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromRotation=function(a,c,b){var e=b[0],l=b[1];b=b[2];var d=Math.sqrt(e*e+l*l+b*b),h;if(Math.abs(d)<k.EPSILON)return null;d=1/d;e*=d;
l*=d;b*=d;d=Math.sin(c);c=Math.cos(c);h=1-c;a[0]=e*e*h+c;a[1]=l*e*h+b*d;a[2]=b*e*h-l*d;a[3]=0;a[4]=e*l*h-b*d;a[5]=l*l*h+c;a[6]=b*l*h+e*d;a[7]=0;a[8]=e*b*h+l*d;a[9]=l*b*h-e*d;a[10]=b*b*h+c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromXRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=b;a[7]=0;a[8]=0;a[9]=-b;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromYRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=
0;a[2]=-b;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=b;a[9]=0;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromZRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=b;a[2]=0;a[3]=0;a[4]=-b;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromRotationTranslation=function(a,c,b){var e=c[0],l=c[1],d=c[2],h=c[3],m=e+e,p=l+l,q=d+d;c=e*m;var t=e*p,e=e*q,u=l*p,l=l*q,d=d*q,m=h*m,p=h*p,h=h*q;a[0]=1-(u+d);a[1]=t+h;a[2]=e-p;a[3]=0;a[4]=
t-h;a[5]=1-(c+d);a[6]=l+m;a[7]=0;a[8]=e+p;a[9]=l-m;a[10]=1-(c+u);a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};b.getTranslation=function(a,c){a[0]=c[12];a[1]=c[13];a[2]=c[14];return a};b.getRotation=function(a,c){var b=c[0]+c[5]+c[10],g=0;0<b?(g=2*Math.sqrt(b+1),a[3]=.25*g,a[0]=(c[6]-c[9])/g,a[1]=(c[8]-c[2])/g,a[2]=(c[1]-c[4])/g):c[0]>c[5]&c[0]>c[10]?(g=2*Math.sqrt(1+c[0]-c[5]-c[10]),a[3]=(c[6]-c[9])/g,a[0]=.25*g,a[1]=(c[1]+c[4])/g,a[2]=(c[8]+c[2])/g):c[5]>c[10]?(g=2*Math.sqrt(1+c[5]-
c[0]-c[10]),a[3]=(c[8]-c[2])/g,a[0]=(c[1]+c[4])/g,a[1]=.25*g,a[2]=(c[6]+c[9])/g):(g=2*Math.sqrt(1+c[10]-c[0]-c[5]),a[3]=(c[1]-c[4])/g,a[0]=(c[8]+c[2])/g,a[1]=(c[6]+c[9])/g,a[2]=.25*g);return a};b.fromRotationTranslationScale=function(a,c,b,g){var e=c[0],d=c[1],h=c[2],m=c[3],p=e+e,q=d+d,t=h+h;c=e*p;var u=e*q,e=e*t,y=d*q,d=d*t,h=h*t,p=m*p,q=m*q,m=m*t,t=g[0],k=g[1];g=g[2];a[0]=(1-(y+h))*t;a[1]=(u+m)*t;a[2]=(e-q)*t;a[3]=0;a[4]=(u-m)*k;a[5]=(1-(c+h))*k;a[6]=(d+p)*k;a[7]=0;a[8]=(e+q)*g;a[9]=(d-p)*g;a[10]=
(1-(c+y))*g;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};b.fromRotationTranslationScaleOrigin=function(a,c,b,g,l){var d=c[0],e=c[1],m=c[2],p=c[3],q=d+d,t=e+e,u=m+m;c=d*q;var y=d*t,d=d*u,k=e*t,e=e*u,m=m*u,q=p*q,t=p*t,p=p*u,u=g[0],A=g[1];g=g[2];var z=l[0],f=l[1];l=l[2];a[0]=(1-(k+m))*u;a[1]=(y+p)*u;a[2]=(d-t)*u;a[3]=0;a[4]=(y-p)*A;a[5]=(1-(c+m))*A;a[6]=(e+q)*A;a[7]=0;a[8]=(d+t)*g;a[9]=(e-q)*g;a[10]=(1-(c+k))*g;a[11]=0;a[12]=b[0]+z-(a[0]*z+a[4]*f+a[8]*l);a[13]=b[1]+f-(a[1]*z+a[5]*f+a[9]*
l);a[14]=b[2]+l-(a[2]*z+a[6]*f+a[10]*l);a[15]=1;return a};b.fromQuat=function(a,c){var b=c[0],g=c[1],l=c[2];c=c[3];var d=b+b,h=g+g,m=l+l,b=b*d,p=g*d,g=g*h,q=l*d,t=l*h,l=l*m,d=c*d,h=c*h;c*=m;a[0]=1-g-l;a[1]=p+c;a[2]=q-h;a[3]=0;a[4]=p-c;a[5]=1-b-l;a[6]=t+d;a[7]=0;a[8]=q+h;a[9]=t-d;a[10]=1-b-g;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.frustum=function(a,c,b,g,l,d,h){var e=1/(b-c),p=1/(l-g),q=1/(d-h);a[0]=2*d*e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*d*p;a[6]=0;a[7]=0;a[8]=(b+c)*e;a[9]=(l+g)*p;a[10]=
(h+d)*q;a[11]=-1;a[12]=0;a[13]=0;a[14]=h*d*2*q;a[15]=0;return a};b.perspective=function(a,c,b,g,l){c=1/Math.tan(c/2);var d=1/(g-l);a[0]=c/b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(l+g)*d;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*l*g*d;a[15]=0;return a};b.perspectiveFromFieldOfView=function(a,c,b,g){var e=Math.tan(c.upDegrees*Math.PI/180),d=Math.tan(c.downDegrees*Math.PI/180),h=Math.tan(c.leftDegrees*Math.PI/180);c=Math.tan(c.rightDegrees*Math.PI/180);var m=2/(h+c),p=2/(e+d);a[0]=
m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=p;a[6]=0;a[7]=0;a[8]=-((h-c)*m*.5);a[9]=(e-d)*p*.5;a[10]=g/(b-g);a[11]=-1;a[12]=0;a[13]=0;a[14]=g*b/(b-g);a[15]=0;return a};b.ortho=function(a,c,b,g,l,d,h){var e=1/(c-b),p=1/(g-l),q=1/(d-h);a[0]=-2*e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*p;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*q;a[11]=0;a[12]=(c+b)*e;a[13]=(l+g)*p;a[14]=(h+d)*q;a[15]=1;return a};b.lookAt=function(a,c,e,g){var l,d,h,m,p,q,t,u,y=c[0],x=c[1];c=c[2];h=g[0];m=g[1];d=g[2];t=e[0];g=e[1];l=e[2];if(Math.abs(y-
t)<k.EPSILON&&Math.abs(x-g)<k.EPSILON&&Math.abs(c-l)<k.EPSILON)return b.identity(a);e=y-t;g=x-g;t=c-l;u=1/Math.sqrt(e*e+g*g+t*t);e*=u;g*=u;t*=u;l=m*t-d*g;d=d*e-h*t;h=h*g-m*e;(u=Math.sqrt(l*l+d*d+h*h))?(u=1/u,l*=u,d*=u,h*=u):h=d=l=0;m=g*h-t*d;p=t*l-e*h;q=e*d-g*l;(u=Math.sqrt(m*m+p*p+q*q))?(u=1/u,m*=u,p*=u,q*=u):q=p=m=0;a[0]=l;a[1]=m;a[2]=e;a[3]=0;a[4]=d;a[5]=p;a[6]=g;a[7]=0;a[8]=h;a[9]=q;a[10]=t;a[11]=0;a[12]=-(l*y+d*x+h*c);a[13]=-(m*y+p*x+q*c);a[14]=-(e*y+g*x+t*c);a[15]=1;return a};b.str=function(a){return"mat4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};b.add=function(a,c,
b){a[0]=c[0]+b[0];a[1]=c[1]+b[1];a[2]=c[2]+b[2];a[3]=c[3]+b[3];a[4]=c[4]+b[4];a[5]=c[5]+b[5];a[6]=c[6]+b[6];a[7]=c[7]+b[7];a[8]=c[8]+b[8];a[9]=c[9]+b[9];a[10]=c[10]+b[10];a[11]=c[11]+b[11];a[12]=c[12]+b[12];a[13]=c[13]+b[13];a[14]=c[14]+b[14];a[15]=c[15]+b[15];return a};b.subtract=function(a,c,b){a[0]=c[0]-b[0];a[1]=c[1]-b[1];a[2]=c[2]-b[2];a[3]=c[3]-b[3];a[4]=c[4]-b[4];a[5]=c[5]-b[5];a[6]=c[6]-b[6];a[7]=c[7]-b[7];a[8]=c[8]-b[8];a[9]=c[9]-b[9];a[10]=c[10]-b[10];a[11]=c[11]-b[11];a[12]=c[12]-b[12];
a[13]=c[13]-b[13];a[14]=c[14]-b[14];a[15]=c[15]-b[15];return a};b.sub=b.subtract;b.multiplyScalar=function(a,c,b){a[0]=c[0]*b;a[1]=c[1]*b;a[2]=c[2]*b;a[3]=c[3]*b;a[4]=c[4]*b;a[5]=c[5]*b;a[6]=c[6]*b;a[7]=c[7]*b;a[8]=c[8]*b;a[9]=c[9]*b;a[10]=c[10]*b;a[11]=c[11]*b;a[12]=c[12]*b;a[13]=c[13]*b;a[14]=c[14]*b;a[15]=c[15]*b;return a};b.multiplyScalarAndAdd=function(a,c,b,g){a[0]=c[0]+b[0]*g;a[1]=c[1]+b[1]*g;a[2]=c[2]+b[2]*g;a[3]=c[3]+b[3]*g;a[4]=c[4]+b[4]*g;a[5]=c[5]+b[5]*g;a[6]=c[6]+b[6]*g;a[7]=c[7]+b[7]*
g;a[8]=c[8]+b[8]*g;a[9]=c[9]+b[9]*g;a[10]=c[10]+b[10]*g;a[11]=c[11]+b[11]*g;a[12]=c[12]+b[12]*g;a[13]=c[13]+b[13]*g;a[14]=c[14]+b[14]*g;a[15]=c[15]+b[15]*g;return a};b.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]};b.equals=function(a,c){var b=a[0],g=a[1],l=a[2],d=a[3],h=a[4],m=a[5],p=a[6],q=a[7],
t=a[8],u=a[9],y=a[10],x=a[11],A=a[12],z=a[13],f=a[14];a=a[15];var n=c[0],r=c[1],B=c[2],C=c[3],D=c[4],F=c[5],H=c[6],J=c[7],I=c[8],G=c[9],Q=c[10],W=c[11],K=c[12],aa=c[13],ba=c[14];c=c[15];return Math.abs(b-n)<=k.EPSILON*Math.max(1,Math.abs(b),Math.abs(n))&&Math.abs(g-r)<=k.EPSILON*Math.max(1,Math.abs(g),Math.abs(r))&&Math.abs(l-B)<=k.EPSILON*Math.max(1,Math.abs(l),Math.abs(B))&&Math.abs(d-C)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(h-D)<=k.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))&&
Math.abs(m-F)<=k.EPSILON*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(p-H)<=k.EPSILON*Math.max(1,Math.abs(p),Math.abs(H))&&Math.abs(q-J)<=k.EPSILON*Math.max(1,Math.abs(q),Math.abs(J))&&Math.abs(t-I)<=k.EPSILON*Math.max(1,Math.abs(t),Math.abs(I))&&Math.abs(u-G)<=k.EPSILON*Math.max(1,Math.abs(u),Math.abs(G))&&Math.abs(y-Q)<=k.EPSILON*Math.max(1,Math.abs(y),Math.abs(Q))&&Math.abs(x-W)<=k.EPSILON*Math.max(1,Math.abs(x),Math.abs(W))&&Math.abs(A-K)<=k.EPSILON*Math.max(1,Math.abs(A),Math.abs(K))&&Math.abs(z-
aa)<=k.EPSILON*Math.max(1,Math.abs(z),Math.abs(aa))&&Math.abs(f-ba)<=k.EPSILON*Math.max(1,Math.abs(f),Math.abs(ba))&&Math.abs(a-c)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};return b})},"esri/layers/vectorTiles/core/libs/gl-matrix/common":function(){define([],function(){var k={EPSILON:1E-6};k.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;k.RANDOM=Math.random;k.ENABLE_SIMD=!1;k.SIMD_AVAILABLE=k.ARRAY_TYPE===Float32Array&&"SIMD"in this;k.USE_SIMD=k.ENABLE_SIMD&&k.SIMD_AVAILABLE;
k.setMatrixArrayType=function(a){k.ARRAY_TYPE=a};var b=Math.PI/180;k.toRadian=function(a){return a*b};k.equals=function(a,c){return Math.abs(a-c)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(k,b){function a(a,c){a%=c;return 0<=a?a:a+c}Object.defineProperty(b,"__esModule",{value:!0});b.C_INFINITY=Number.POSITIVE_INFINITY;b.C_PI=Math.PI;b.C_2PI=2*b.C_PI;b.C_PI_BY_2=b.C_PI/2;
b.C_RAD_TO_256=128/b.C_PI;b.C_256_TO_RAD=b.C_PI/128;b.C_DEG_TO_256=256/360;b.C_DEG_TO_RAD=b.C_PI/180;b.C_SQRT2=1.414213562;b.C_SQRT2_INV=1/b.C_SQRT2;var c=1/Math.LN2;b.positiveMod=a;b.radToByte=function(c){return a(c*b.C_RAD_TO_256,256)};b.degToByte=function(c){return a(c*b.C_DEG_TO_256,256)};b.log2=function(a){return Math.log(a)*c};b.sqr=function(a){return a*a};b.clamp=function(a,c,b){return Math.min(Math.max(a,c),b)};b.interpolate=function(a,c,b){return a*(1-b)+c*b};b.between=function(a,c,b){return a>=
c&&a<=b||a>=b&&a<=c}})},"esri/layers/vectorTiles/views/2d/engine/webgl/MaterialManager":function(){define("require exports ./enums ./MaterialInfoUtils ./shaders/fillShaderSnippets ./shaders/iconShaderSnippets ./shaders/labelShaderSnippets ./shaders/lineShaderSnippets ./shaders/textShaderSnippets ../../../webgl/ShaderVariations".split(" "),function(k,b,a,c,e,g,l,d,h,m){return function(){function b(){this._programRep=new Map;this.isInitialize=!1}b.prototype.dispose=function(){this._fillShaderVariations&&
(this._fillShaderVariations.dispose(),this._fillShaderVariations=null);this._lineShaderVariations&&(this._lineShaderVariations.dispose(),this._lineShaderVariations=null);this._iconShaderVariations&&(this._iconShaderVariations.dispose(),this._iconShaderVariations=null);this._textShaderVariations&&(this._textShaderVariations.dispose(),this._textShaderVariations=null);0!==this._programRep.size&&(this._programRep.forEach(function(a){return a.dispose()}),this._programRep.clear())};b.prototype.initialize=
function(a){if(!this.isInitialize){var c=new m("label",["labelVS","labelFS"],[],l,a);c.addDefine("ID","ID",[!0,!0],"ID");c.addDefine("HIGHLIGHT","HIGHLIGHT",[!1,!1],"HIGHLIGHT");c.addDefine("SDF","SDF",[!1,!1],"SDF");c.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE");c.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS");c.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS");c.addDefine("VV_SIZE_UNIT_VALUE",
"VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE");c.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");c.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION");c.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");c.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");c.addDefine("PATTERN","PATTERN",[!1,!1],"PATTERN");c.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");var b=new m("text",["textVS","textFS"],[],h,a);b.addDefine("ID","ID",[!0,!0],"ID");b.addDefine("HIGHLIGHT",
"HIGHLIGHT",[!1,!1],"HIGHLIGHT");b.addDefine("SDF","SDF",[!1,!1],"SDF");b.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE");b.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS");b.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS");b.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE");b.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");b.addDefine("VV_ROTATION",
"VV_ROTATION",[!0,!1],"VV_ROTATION");b.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");b.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");b.addDefine("PATTERN","PATTERN",[!1,!1],"PATTERN");b.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");var p=new m("icon",["iconVS","iconFS"],[],g,a);p.addDefine("ID","ID",[!0,!0],"ID");p.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");p.addDefine("SDF","SDF",[!0,!0],"SDF");p.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",
[!0,!1],"VV_SIZE_MIN_MAX_VALUE");p.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS");p.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS");p.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE");p.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");p.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION");p.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");p.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",
[!1,!1],"VERTEX_VISIBILITY");p.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");p.addDefine("HEATMAP","HEATMAP",[!0,!0],"HEATMAP");var q=new m("fill",["fillVS","fillFS"],[],e,a);q.addDefine("ID","ID",[!0,!0],"ID");q.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");q.addDefine("SDF","SDF",[!1,!1],"SDF");q.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!1,!1],"VV_SIZE_MIN_MAX_VALUE");q.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!1,!1],"VV_SIZE_SCALE_STOPS");q.addDefine("VV_SIZE_FIELD_STOPS",
"VV_SIZE_FIELD_STOPS",[!1,!1],"VV_SIZE_FIELD_STOPS");q.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!1,!1],"VV_SIZE_UNIT_VALUE");q.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");q.addDefine("VV_ROTATION","VV_ROTATION",[!1,!1],"VV_ROTATION");q.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");q.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");q.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");q.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");a=new m("line",
["lineVS","lineFS"],[],d,a);a.addDefine("ID","ID",[!0,!0],"ID");a.addDefine("HIGHLIGHT","HIGHLIGHT",[!0,!0],"HIGHLIGHT");a.addDefine("SDF","SDF",[!0,!0],"SDF");a.addDefine("VV_SIZE_MIN_MAX_VALUE","VV_SIZE_MIN_MAX_VALUE",[!0,!1],"VV_SIZE_MIN_MAX_VALUE");a.addDefine("VV_SIZE_SCALE_STOPS","VV_SIZE_SCALE_STOPS",[!0,!1],"VV_SIZE_SCALE_STOPS");a.addDefine("VV_SIZE_FIELD_STOPS","VV_SIZE_FIELD_STOPS",[!0,!1],"VV_SIZE_FIELD_STOPS");a.addDefine("VV_SIZE_UNIT_VALUE","VV_SIZE_UNIT_VALUE",[!0,!1],"VV_SIZE_UNIT_VALUE");
a.addDefine("VV_COLOR","VV_COLOR",[!0,!1],"VV_COLOR");a.addDefine("VV_ROTATION","VV_ROTATION",[!0,!1],"VV_ROTATION");a.addDefine("VV_OPACITY","VV_OPACITY",[!0,!1],"VV_OPACITY");a.addDefine("VERTEX_VISIBILITY","VERTEX_VISIBILITY",[!1,!1],"VERTEX_VISIBILITY");a.addDefine("PATTERN","PATTERN",[!0,!0],"PATTERN");a.addDefine("HEATMAP","HEATMAP",[!1,!1],"HEATMAP");this._labelShaderVariations=c;this._textShaderVariations=b;this._fillShaderVariations=q;this._iconShaderVariations=p;this._lineShaderVariations=
a;this.isInitialize=!0}};b.prototype.getProgram=function(b,d,e){b|=d===a.WGLDrawPhase.HITTEST?8:0;b|=d===a.WGLDrawPhase.HIGHLIGHT?16:0;if(this._programRep[b])return this._programRep[b];if(!(this._iconShaderVariations&&this._fillShaderVariations&&this._lineShaderVariations&&this._labelShaderVariations))return null;d=c.getMaterialVariations(b);var m;switch(d.geometryType){case a.WGLGeometryType.MARKER:m=this._iconShaderVariations.getProgram(d.variations,null,null,e);break;case a.WGLGeometryType.TEXT:m=
this._textShaderVariations.getProgram(d.variations,null,null,e);break;case a.WGLGeometryType.LABEL:m=this._labelShaderVariations.getProgram(d.variations,null,null,e);break;case a.WGLGeometryType.FILL:m=this._fillShaderVariations.getProgram(d.variations,null,null,e);break;case a.WGLGeometryType.LINE:m=this._lineShaderVariations.getProgram(d.variations,null,null,e)}m&&(this._programRep[b]=m);return m};return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/MaterialInfoUtils":function(){define(["require",
"exports","./enums","./MaterialInfo","./MaterialKeyInfo"],function(k,b,a,c,e){function g(a){var c=[];c[0]=a.sdf?!0:!1;c[1]=a.vvSizeMinMaxValue?!0:!1;c[2]=a.vvSizeScaleStops?!0:!1;c[3]=a.vvSizeFieldStops?!0:!1;c[4]=a.vvSizeUnitValue?!0:!1;c[5]=a.vvColor?!0:!1;c[6]=a.vvRotation?!0:!1;c[7]=a.vvOpacity?!0:!1;c[8]=a.visibility?!0:!1;c[9]=a.pattern?!0:!1;c[10]=a.heatmap?!0:!1;return c.reduce(function(a,c,b){c&&(a|=1<<b+2);return a},0)}function l(c){if(c.geometryType===a.WGLGeometryType.UNKNOWN)return-1;
var b=g(c)<<3;return c.geometryType+b}Object.defineProperty(b,"__esModule",{value:!0});b.createTextMaterialInfo=function(b,h,m){var d=new c.default,g=new e;g.geometryType=m;g.sdf=!0;g.pattern=!1;g.visibility=!1;g.heatmap=!1;d.texBindingInfo.push(new c.TexBindingInfo(2,b.page,"u_texture"));0===h?g.vvOpacity=g.vvSizeMinMaxValue=g.vvSizeScaleStops=g.vvSizeFieldStops=g.vvSizeUnitValue=g.vvColor=g.vvRotation=!1:(g.vvOpacity=0!==(h&a.WGLVVFlag.OPACITY),g.vvSizeMinMaxValue=0!==(h&a.WGLVVFlag.SIZE_MINMAX_VALUE),
g.vvSizeScaleStops=0!==(h&a.WGLVVFlag.SIZE_SCALE_STOPS),g.vvSizeFieldStops=0!==(h&a.WGLVVFlag.SIZE_FIELD_STOPS),g.vvSizeUnitValue=0!==(h&a.WGLVVFlag.SIZE_UNIT_VALUE),g.vvColor=0!==(h&a.WGLVVFlag.COLOR),g.vvRotation=0!==(h&a.WGLVVFlag.ROTATION));d.materialKey=l(g);d.materialKeyInfo=g;return d};b.createMaterialInfo=function(b,h,m){var d=new c.default,g=new e;g.geometryType=h;b?(b=b.spriteMosaicItem,g.sdf=b.sdf,g.pattern=!0,d.texBindingInfo.push(new c.TexBindingInfo(1,b.page,"u_texture"))):(g.sdf=!1,
g.pattern=!1);0===m?g.vvOpacity=g.vvSizeMinMaxValue=g.vvSizeScaleStops=g.vvSizeFieldStops=g.vvSizeUnitValue=g.vvColor=g.vvRotation=!1:(g.vvOpacity=0!==(m&a.WGLVVFlag.OPACITY),g.vvSizeMinMaxValue=0!==(m&a.WGLVVFlag.SIZE_MINMAX_VALUE),g.vvSizeScaleStops=0!==(m&a.WGLVVFlag.SIZE_SCALE_STOPS),g.vvSizeFieldStops=0!==(m&a.WGLVVFlag.SIZE_FIELD_STOPS),g.vvSizeUnitValue=0!==(m&a.WGLVVFlag.SIZE_UNIT_VALUE),g.vvColor=0!==(m&a.WGLVVFlag.COLOR),g.vvRotation=0!==(m&a.WGLVVFlag.ROTATION));g.visibility=!1;d.materialKey=
l(g);d.materialKeyInfo=g;return d};b.getMaterialKey=l;b.getMaterialVariations=function(a){var c=a&7;a>>=3;return{geometryType:c,variations:[0!==(a&1),0!==(a&2),0!==(a&4),0!==(a&8),0!==(a&16),0!==(a&32),0!==(a&64),0!==(a&128),0!==(a&256),0!==(a&512),0!==(a&1024),0!==(a&2048),0!==(a&4096)]}}})},"esri/layers/vectorTiles/views/2d/engine/webgl/MaterialInfo":function(){define("require exports ./enums ./MaterialInfoUtils ./MaterialInfoUtils_updateMaterialVariations ./MaterialKeyInfo ./util/serializationUtils".split(" "),
function(k,b,a,c,e,g,l){Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,c,b){this.unit=a;this.pageId=c;this.semantic=b}a.prototype.clone=function(){return new a(this.unit,this.pageId,this.semantic)};a.prototype.serialize=function(a){a.writeInt32(this.unit);a.writeInt32(this.pageId);return a};a.deserialize=function(c){var b=c.readInt32();c=c.readInt32();return new a(b,c,"u_texture")};return a}();b.TexBindingInfo=d;var h=function(){function a(a,c){this.name=a;this.value=
c}a.prototype.clone=function(){return new a(this.name,this.value)};a.prototype.serialize=function(a){a.writeInt32(this.value);return a};a.deserialize=function(c){c=c.readInt32();return new a("u_my_param",c)};return a}();b.MaterialParam=h;k=function(){function b(){this.texBindingInfo=[];this.materialParams=[]}b.fromSprite=function(e,m,h){var p=new b,l=new g;l.geometryType=m;e?(l.sdf=e.sdf,l.pattern=!0,p.texBindingInfo.push(new d(1,e.page,"u_texture"))):(l.sdf=!1,l.pattern=!1);0===h?l.vvOpacity=l.vvSizeMinMaxValue=
l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!==(h&a.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!==(h&a.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!==(h&a.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!==(h&a.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=0!==(h&a.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!==(h&a.WGLVVFlag.COLOR),l.vvRotation=0!==(h&a.WGLVVFlag.ROTATION));l.visibility=!1;p.materialKey=c.getMaterialKey(l);p.materialKeyInfo=l;return p};
b.fromGlyph=function(e,m,h){var p=new b,l=new g;l.geometryType=m;l.sdf=!0;l.pattern=!1;l.visibility=!1;l.heatmap=!1;p.texBindingInfo.push(new d(2,e.page,"u_texture"));0===h?l.vvOpacity=l.vvSizeMinMaxValue=l.vvSizeScaleStops=l.vvSizeFieldStops=l.vvSizeUnitValue=l.vvColor=l.vvRotation=!1:(l.vvOpacity=0!==(h&a.WGLVVFlag.OPACITY),l.vvSizeMinMaxValue=0!==(h&a.WGLVVFlag.SIZE_MINMAX_VALUE),l.vvSizeScaleStops=0!==(h&a.WGLVVFlag.SIZE_SCALE_STOPS),l.vvSizeFieldStops=0!==(h&a.WGLVVFlag.SIZE_FIELD_STOPS),l.vvSizeUnitValue=
0!==(h&a.WGLVVFlag.SIZE_UNIT_VALUE),l.vvColor=0!==(h&a.WGLVVFlag.COLOR),l.vvRotation=0!==(h&a.WGLVVFlag.ROTATION));p.materialKey=c.getMaterialKey(l);p.materialKeyInfo=l;return p};b.prototype.copy=function(a){this.materialParams=a.materialParams.map(function(a){return a.clone()});this.texBindingInfo=a.texBindingInfo.map(function(a){return a.clone()});a.materialKeyInfo&&(this.materialKeyInfo=new g,this.materialKeyInfo.copy(a.materialKeyInfo));this.materialKey=a.materialKey};b.prototype.serialize=function(a){a.writeInt32(this.materialKey);
l.serializeList(a,this.texBindingInfo);l.serializeList(a,this.materialParams);return a};b.deserialize=function(a){var c=new b;c.materialKey=a.readInt32();c.texBindingInfo=l.deserializeList(a,d);c.materialParams=l.deserializeList(a,h);c.materialKeyInfo=new g;e(c.materialKeyInfo,c.materialKey);return c};return b}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/MaterialInfoUtils_updateMaterialVariations":function(){define(["require","exports"],function(k,b){return function(a,c){a.geometryType=
c&7;c>>=3;a.sdf=0!==(c&4);a.vvSizeMinMaxValue=0!==(c&8);a.vvSizeScaleStops=0!==(c&16);a.vvSizeFieldStops=0!==(c&32);a.vvSizeUnitValue=0!==(c&64);a.vvColor=0!==(c&128);a.vvRotation=0!==(c&256);a.vvOpacity=0!==(c&512);a.visibility=0!==(c&1024);a.pattern=0!==(c&2048);a.heatmap=0!==(c&4096);return a}})},"esri/layers/vectorTiles/views/2d/engine/webgl/MaterialKeyInfo":function(){define(["require","exports"],function(k,b){return function(){function a(){this.heatmap=this.pattern=this.visibility=this.vvOpacity=
this.vvRotation=this.vvColor=this.vvSizeUnitValue=this.vvSizeFieldStops=this.vvSizeScaleStops=this.vvSizeMinMaxValue=this.sdf=!1}a.prototype.copy=function(a){this.geometryType=a.geometryType;this.sdf=a.sdf;this.vvSizeMinMaxValue=a.vvSizeMinMaxValue;this.vvSizeScaleStops=a.vvSizeScaleStops;this.vvSizeFieldStops=a.vvSizeFieldStops;this.vvSizeUnitValue=a.vvSizeUnitValue;this.vvColor=a.vvColor;this.vvRotation=a.vvRotation;this.vvOpacity=a.vvOpacity;this.visibility=a.visibility;this.pattern=a.pattern;
this.heatmap=a.heatmap};a.prototype.hasVV=function(){void 0===this._hasVV&&(this._hasVV=this.vvColor||this.vvOpacity||this.vvRotation||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue);return this._hasVV};a.prototype.hasVVSize=function(){return this.vvSizeMinMaxValue||this.vvSizeFieldStops||this.vvSizeScaleStops||this.vvSizeUnitValue};a.prototype.hasVVColor=function(){return this.vvColor};a.prototype.hasVVRotation=function(){return this.vvRotation};a.prototype.hasVVOpacity=
function(){return this.vvOpacity};return a}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.serializeList=function(a,c){if(null===c)a.writeInt32(0);else{a.writeInt32(c.length);for(var b=0;b<c.length;b++)c[b].serialize(a);return a}};b.deserializeList=function(a,c,b){for(var e=a.readInt32(),e=Array(e),l=0;l<e.length;l++)e[l]=c.deserialize(a,b);return e}})},"esri/layers/vectorTiles/views/2d/engine/webgl/shaders/fillShaderSnippets":function(){define(["require",
"exports","dojo/text!./fillShaders.xml","../../../../webgl/ShaderSnippets"],function(k,b,a,c){k=new c;c.parse(a,k);return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/shaders/iconShaderSnippets":function(){define(["require","exports","dojo/text!./iconShaders.xml","../../../../webgl/ShaderSnippets"],function(k,b,a,c){k=new c;c.parse(a,k);return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/shaders/labelShaderSnippets":function(){define(["require","exports","dojo/text!./labelShaders.xml",
"../../../../webgl/ShaderSnippets"],function(k,b,a,c){k=new c;c.parse(a,k);return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/shaders/lineShaderSnippets":function(){define(["require","exports","dojo/text!./lineShaders.xml","../../../../webgl/ShaderSnippets"],function(k,b,a,c){k=new c;c.parse(a,k);return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/shaders/textShaderSnippets":function(){define(["require","exports","dojo/text!./textShaders.xml","../../../../webgl/ShaderSnippets"],function(k,
b,a,c){k=new c;c.parse(a,k);return k})},"esri/layers/vectorTiles/views/webgl/ShaderVariations":function(){define(["require","exports","./Program","./ShaderSourceVariator","./Util"],function(k,b,a,c,e){function g(a){return a.reduce(function(a,c,b){c&&(a|=1<<b);return a},0)}return function(){function b(a,c,b,e,g,l){"string"===typeof a?this._initParams(a,c,b,e,g,l):this._initObject({programNamePrefix:a.programNamePrefix,shaderSnippetPrefixes:a.shaderSnippetPrefixes,baseDefines:a.baseDefines,snippets:a.snippets,
rctx:a.rctx,vertexAttribLocs:a.vertexAttribLocs})}b.prototype.dispose=function(){this._programCache&&(this._programCache.forEach(function(a){return a.dispose()}),this._programCache.clear())};b.prototype._initObject=function(a){this._initParams(a.programNamePrefix,a.shaderSnippetPrefixes,a.baseDefines,a.snippets,a.rctx,a.vertexAttribLocs)};b.prototype._initParams=function(a,b,e,p,g,l){this._defaultSnippets=p;this._defaultRctx=g;this._defaultVertexAttribLocs=l;this._programCache=new Map;this._variationInfo=
new Map;this._shaderSourceVariator=new c(a,b,e)};b.prototype.addDefine=function(a,c,b,e){this._shaderSourceVariator.addDefine(a,c,b,e)};b.prototype.addBinaryShaderSnippetSuffix=function(a,c,b){this._shaderSourceVariator.addBinaryShaderSnippetSuffix(a,c,b)};b.prototype.addNaryShaderSnippetSuffix=function(a,c){this._shaderSourceVariator.addNaryShaderSnippetSuffix(a,c)};b.prototype.getProgram=function(c,b,m,p){b=b||this._defaultSnippets;m=m||this._defaultRctx;p=p||this._defaultVertexAttribLocs;if(!b)throw Error("No ShaderSnippets provided to getProgram nor to ShaderVariations constructor.");
if(!m)throw Error("No RenderingContext provided to getProgram nor to ShaderVariations constructor.");if(!p)throw Error("No VertexAttributeLocations provided to getProgram nor to ShaderVariations constructor.");var d=g(c);if(this._programCache.has(d))return this._programCache.get(d);c=this._shaderSourceVariator.getShaderVariation(c);var h,l;h=c.shaderSnippetNames[0];l=b[h];e.assert(null!=l,"shader snippet '"+h+"' does not exist");h=c.shaderSnippetNames[1];b=b[h];e.assert(null!=b,"shader snippet '"+
h+"' does not exist");m=new a(m,l,b,p,c.defines);this._programCache.set(d,m);return m};b.prototype.getProgramByKey=function(c){if(this._programCache.has(c))return this._programCache.get(c);if(!this._variationInfo[c])return null;var b=this._variationInfo[c],d=this._defaultSnippets,p=this._defaultRctx,g=this._defaultVertexAttribLocs,l,u;l=b.shaderSnippetNames[0];u=d[l];e.assert(null!=u,"shader snippet '"+l+"' does not exist");l=b.shaderSnippetNames[1];d=d[l];e.assert(null!=d,"shader snippet '"+l+"' does not exist");
b=new a(p,u,d,g,b.defines);this._programCache.set(c,b);return b};b.prototype.getProgramInfo=function(a){var c=this._shaderSourceVariator.getShaderVariation(a);a=g(a);this._variationInfo[a]||(this._variationInfo[a]=c);return{name:c.programName,key:a}};return b}()})},"esri/layers/vectorTiles/views/webgl/ShaderSourceVariator":function(){define(["require","exports","../../core/lang","./Util"],function(k,b,a,c){return function(){function b(a,b,d){var e;"string"===typeof a?e=a:(e=a.programNamePrefix,b=
a.shaderSnippetPrefixes,d=a.baseDefines);c.assert(b,"you must specify shader snippet prefixes");c.assert(2===b.length,"you must specify shader snippet prefixes for vertex and fragment shaders");d&&0!==d.length||(d=[]);this.programNamePrefix=e;this.shaderSnippetPrefixes=b;this.baseDefines=d;this.variables=[];this.sealed=!1}b.prototype.addDefine=function(a,b,d,e){c.assert(!this.sealed,"you cannot add another variable after the first program has been generated");c.assert(a,"you must specify a program name suffix");
this.variables.push({programNameSuffixes:["",a],shaderNameSuffixes:e||a,defineStr:b,affectsShaderTypes:d||[!0,!0]})};b.prototype.addBinaryShaderSnippetSuffix=function(a,b,d){c.assert(!this.sealed,"you cannot add another variable after the first program has been generated");c.assert(a,"you must specify a program name suffix");this.variables.push({programNameSuffixes:["",a],shaderSnippetSuffixes:["",b],affectsShaderTypes:d||[!0,!0]})};b.prototype.addNaryShaderSnippetSuffix=function(a,b){c.assert(!this.sealed,
"you cannot add another variable after the first program has been generated");var d=a.map(function(a){c.assert(null!=a.value,"value must always be specified");return a.value});this.variables.push({values:d,programNameSuffixes:a.map(function(a,c){return null!=a.programNameSuffix?a.programNameSuffix:d[c]}),shaderSnippetSuffixes:a.map(function(a,c){return null!=a.shaderSnippetSuffix?a.shaderSnippetSuffix:d[c]}),affectsShaderTypes:b||[!0,!0]})};b.prototype.getShaderVariation=function(b){c.assert(b.length===
this.variables.length,"you must specify a value for each variable");for(var e=this.programNamePrefix,d=a.clone(this.shaderSnippetPrefixes),h=a.clone(this.shaderSnippetPrefixes),m=a.clone(this.baseDefines),p=0;p<this.variables.length;p++){var g=this.variables[p],t=b[p],u=void 0;g.values?(u=g.values.indexOf(t),c.assert(0<=u,"invalid value "+t+" for variable "+p)):u=t?1:0;e+=g.programNameSuffixes[u];for(t=0;2>t;t++)g.affectsShaderTypes[t]&&(g.shaderSnippetSuffixes&&(d[t]+=g.shaderSnippetSuffixes[u],
h[t]+=g.shaderSnippetSuffixes[u]),g.defineStr&&u&&(m.push(g.defineStr),h[t]+=g.shaderNameSuffixes))}return{programName:e,shaderSnippetNames:d,shaderNames:h,defines:m}};return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../arcade/Dictionary ../../../../arcade/Feature ../../../../core/Logger ../../../../core/screenUtils ../../../../support/arcadeUtils ./color ./enums ./SymbolProperties".split(" "),function(k,b,a,c,e,g,l,d,h,m){function p(a){return a.map(function(a){return a.name})}
function q(a){for(var f={},c=0;c<a.length;c++){var b=a[c];f[b.name]=b.strideInBytes}return f}function t(a,f){switch(a){case h.WGLGeometryType.MARKER:return f?b.C_ICON_VERTEX_NAMES_VV:b.C_ICON_VERTEX_NAMES;case h.WGLGeometryType.FILL:return f?b.C_FILL_VERTEX_NAMES_VV:b.C_FILL_VERTEX_NAMES;case h.WGLGeometryType.LINE:return f?b.C_LINE_VERTEX_NAMES_VV:b.C_LINE_VERTEX_NAMES;case h.WGLGeometryType.TEXT:return f?b.C_TEXT_VERTEX_NAMES_VV:b.C_TEXT_VERTEX_NAMES;case h.WGLGeometryType.LABEL:return b.C_LABEL_VERTEX_NAMES}return null}
function u(a){switch(a){case "esriSMS":return"simple-marker";case "esriPMS":return"picture-marker";case "esriSLS":return"simple-line";case "esriPLS":return"picture-line";case "esriSFS":return"simple-fill";case "esriPFS":return"picture-fill";case "esriTS":return"text"}return a}function y(a){if(a=u(a.type)){switch(a){case "simple-marker":case "picture-marker":return!0;case "CIMPointSymbol":return!0}return!1}}function x(a){if(a=u(a.type)){switch(a){case "simple-fill":case "picture-fill":return!0;case "CIMPolygonSymbol":return!0}return!1}}
function A(a){if(a=u(a.type)){switch(a){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}}function z(a){if(a=u(a.type)){switch(a){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}function f(a){return a&&a.length||0}function n(a){return"string"===typeof a}Object.defineProperty(b,"__esModule",{value:!0});var r=e.getLogger("esri.views.2d.engine.webgl.Utils");b.C_HITTEST_SEARCH_SIZE=4;b.C_VBO_GEOMETRY="geometry";b.C_VBO_PERINSTANCE="per_instance";b.C_VBO_PERINSTANCE_VV=
"per_instance_vv";b.C_VBO_VISIBILITY="visibility";b.C_VBO_VISIBILITY_RANGE="visibilityRange";b.C_ICON_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];b.C_ICON_VERTEX_DEF_VV=[{name:b.C_VBO_GEOMETRY,strideInBytes:44,divisor:0}];b.C_ICON_HEATMAP=[{name:b.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];b.C_FILL_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];b.C_FILL_VERTEX_DEF_VV=[{name:b.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];b.C_LINE_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,
strideInBytes:32,divisor:0}];b.C_LINE_VERTEX_DEF_VV=[{name:b.C_VBO_GEOMETRY,strideInBytes:44,divisor:0}];b.C_TEXT_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:20,divisor:0},{name:b.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}];b.C_TEXT_VERTEX_DEF_VV=[{name:b.C_VBO_GEOMETRY,strideInBytes:36,divisor:0},{name:b.C_VBO_VISIBILITY,strideInBytes:1,divisor:0}];b.C_LABEL_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:20,divisor:0},{name:b.C_VBO_VISIBILITY,strideInBytes:1,divisor:0},{name:b.C_VBO_VISIBILITY_RANGE,
strideInBytes:2,divisor:0}];b.C_ICON_VERTEX_NAMES=p(b.C_ICON_VERTEX_DEF);b.C_ICON_VERTEX_NAMES_VV=p(b.C_ICON_VERTEX_DEF_VV);b.C_FILL_VERTEX_NAMES=p(b.C_FILL_VERTEX_DEF);b.C_FILL_VERTEX_NAMES_VV=p(b.C_FILL_VERTEX_DEF_VV);b.C_LINE_VERTEX_NAMES=p(b.C_LINE_VERTEX_DEF);b.C_LINE_VERTEX_NAMES_VV=p(b.C_LINE_VERTEX_DEF_VV);b.C_TEXT_VERTEX_NAMES=p(b.C_TEXT_VERTEX_DEF);b.C_TEXT_VERTEX_NAMES_VV=p(b.C_TEXT_VERTEX_DEF_VV);b.C_LABEL_VERTEX_NAMES=p(b.C_LABEL_VERTEX_DEF);b.C_ICON_STRIDE_SPEC=q(b.C_ICON_VERTEX_DEF);
b.C_ICON_STRIDE_SPEC_VV=q(b.C_ICON_VERTEX_DEF_VV);b.C_ICON_STRIDE_SPEC_HEATMAP=q(b.C_ICON_HEATMAP);b.C_FILL_STRIDE_SPEC=q(b.C_FILL_VERTEX_DEF);b.C_FILL_STRIDE_SPEC_VV=q(b.C_FILL_VERTEX_DEF_VV);b.C_LINE_STRIDE_SPEC=q(b.C_LINE_VERTEX_DEF);b.C_LINE_STRIDE_SPEC_VV=q(b.C_LINE_VERTEX_DEF_VV);b.C_TEXT_STRIDE_SPEC=q(b.C_TEXT_VERTEX_DEF);b.C_TEXT_STRIDE_SPEC_VV=q(b.C_TEXT_VERTEX_DEF_VV);b.C_LABEL_STRIDE_SPEC=q(b.C_LABEL_VERTEX_DEF);b.getStrides=function(a,f,c){void 0===c&&(c=!1);switch(a){case h.WGLGeometryType.MARKER:return f?
b.C_ICON_STRIDE_SPEC_VV:c?b.C_ICON_STRIDE_SPEC_HEATMAP:b.C_ICON_STRIDE_SPEC;case h.WGLGeometryType.FILL:return f?b.C_FILL_STRIDE_SPEC_VV:b.C_FILL_STRIDE_SPEC;case h.WGLGeometryType.LINE:return f?b.C_LINE_STRIDE_SPEC_VV:b.C_LINE_STRIDE_SPEC;case h.WGLGeometryType.TEXT:return f?b.C_TEXT_STRIDE_SPEC_VV:b.C_TEXT_STRIDE_SPEC;case h.WGLGeometryType.LABEL:return b.C_LABEL_STRIDE_SPEC}return null};b.getNamedBuffers=t;b.getSymbolGeometryType=function(a){return y(a)?h.WGLGeometryType.MARKER:A(a)?h.WGLGeometryType.LINE:
x(a)?h.WGLGeometryType.FILL:z(a)?h.WGLGeometryType.TEXT:h.WGLGeometryType.UNKNOWN};b.normalizeSymbolType=u;b.isMarkerSymbol=y;b.isFillSymbol=x;b.isLineSymbol=A;b.isPictureSymbol=function(a){if(a=u(a.type))switch(a){case "picture-marker":case "picture-line":case "picture-fill":return!0}return!1};b.isTextSymbol=z;b.getTextProperties=function(a){return m.TextProperties.pool.acquire(a.color?d.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?d.copyAndPremultiply(a.haloColor):[255,255,255,255],
g.pt2px(a.haloSize),g.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};b.isSameUniformValue=function(a,f){return!1};b.isSameMaterialInfo=function(a,c){if(a.materialKey!==c.materialKey||f(a.texBindingInfo)!==f(c.texBindingInfo)||f(a.materialParams)!==f(c.materialParams))return!1;for(var b=a.texBindingInfo.length,n=0;n<b;++n){var d=
a.texBindingInfo[n],r=c.texBindingInfo[n];if(d.unit!==r.unit||d.pageId!==r.pageId||d.semantic!==r.semantic)return!1}a=a.materialParams.length;for(n=0;n<a;)return!1;return!0};b.serializeString=function(a,f,c){for(var b=0,n=a.length,d=0;d<n;++d)f&&(f[c+b]=a.charCodeAt(d)),++b;f&&(f[c+b]=0);++b;return b};b.deserializeString=function(a,f,c){var b=0;a.s="";for(var n=!0;n;){var d=f[c+b];++b;0!==d?a.s+=String.fromCharCode(d):n=!1}return b};b.isDefined=function(a){return null!==a&&void 0!==a};b.isNumber=
function(a){return"number"===typeof a};b.isString=n;b.isStringOrNull=function(a){return null==a||n(a)};b.lerp=function(a,f,c){return a+(f-a)*c};k=function(){function a(){this._arr=[];this._push=this._push.bind(this)}a.prototype._push=function(a,f){this._arr.push(f)};a.prototype.getKeys=function(a){this._arr.length=0;a&&a.forEach(this._push);return this._arr};return a}();b.KeysGetter=k;k=function(){function a(){this._arr=[];this._push=this._push.bind(this)}a.prototype._push=function(a,f){this._arr.push(a)};
a.prototype.getValues=function(a){this._arr.length=0;a&&a.forEach(this._push);return this._arr};return a}();b.ValuesGetter=k;b.getCapType=function(a){switch(a){case "butt":return h.CapType.BUTT;case "round":return h.CapType.ROUND;case "square":return h.CapType.SQUARE;default:return r.error("Cannot interpret unknown cap: "+a),h.CapType.UNKNOWN}};b.getJoinType=function(a){switch(a){case "miter":return h.JoinType.MITER;case "bevel":return h.JoinType.BEVEL;case "round":return h.JoinType.ROUND;default:return r.error("Cannot interpret unknown join: "+
a),h.JoinType.UNKNOWN}};b.getVVType=function(a){switch(a){case "opacity":return h.VVType.OPACITY;case "color":return h.VVType.COLOR;case "rotation":return h.VVType.ROTATION;case "size":return h.VVType.SIZE;default:return r.error("Cannot interpret unknown vv: "+a),null}};b.createArcadeFunction=function(f,b){var n=f.spatialReference,d=f.layer,r=l.createFunction(f.valueExpression),e=new c;return function(f,c){e.repurposeFromGraphicLikeObject(f.geometry,f.attributes,d);f=c&&new a({viewingMode:c.viewingMode,
scale:c.scale});f=l.executeFunction(r,{vars:{$feature:e,$view:f||{}},spatialReference:n});return b?b(f):f}};b.copyMeshData=function(a,f,c,b,n,d,r){for(var e in d)for(var m=d[e].stride,h=d[e].data,p=c[e].data,g=m*n.vertexCount/4,l=m*a/4,B=m*n.vertexFrom/4,m=0;m<g;++m)p[m+l]=h[m+B];c=n.indexCount;for(m=0;m<c;++m)b[m+f]=r[m+n.indexFrom]-n.vertexFrom+a};b.C_VBO_INFO=(B={},B[b.C_VBO_GEOMETRY]=35044,B[b.C_VBO_VISIBILITY]=35044,B[b.C_VBO_VISIBILITY_RANGE]=35048,B);b.createGeometryData=function(a,f,c){for(var b=
[],n=0;5>n;++n){for(var d={},r=0,e=t(n,a);r<e.length;r++){var m=e[r];d[m]={data:c(n,m)}}b.push({data:f(n),buffers:d})}return b};var B})},"esri/layers/vectorTiles/arcade/Dictionary":function(){define(["require","exports","esri/arcade/Dictionary"],function(k,b,a){return a})},"esri/layers/vectorTiles/arcade/Feature":function(){define(["require","exports","esri/arcade/Feature"],function(k,b,a){a.prototype.repurposeFromGraphicLikeObject=function(a,b,g){void 0===g&&(g=null);null===b&&(b={});this.attributes=
b;this.geometry=a;this._datesfixed=(this._layer=g)?!1:!0};return a})},"esri/layers/vectorTiles/core/Logger":function(){define(["require","exports","dojo/has"],function(k,b,a){var c={info:0,warn:1,error:2};k=function(){function a(c){void 0===c&&(c={});this.module=c.module||"";this.writer=c.writer||null;this.level=c.level||null;null!=c.enabled&&(this.enabled=!!c.enabled);a._loggers[this.module]=this;c=this.module.lastIndexOf(".");-1!==c&&(this.parent=a.getLogger(this.module.slice(0,c)))}a.prototype.log=
function(a){for(var c=[],b=1;b<arguments.length;b++)c[b-1]=arguments[b];this._isEnabled()&&this._matchLevel(a)&&(b=this._inheritedWriter())&&b.apply(void 0,[a,this.module].concat(c))};a.prototype.error=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];this.log.apply(this,["error"].concat(a))};a.prototype.warn=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];this.log.apply(this,["warn"].concat(a))};a.prototype.info=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=
arguments[c];this.log.apply(this,["info"].concat(a))};a.prototype.getLogger=function(c){return a.getLogger(this.module+"."+c)};a.getLogger=function(c){var b=a._loggers[c];b||(b=new a({module:c}));return b};a.prototype._parentWithMember=function(a,c){for(var b=this;b&&null==b[a];)b=b.parent;return b?b[a]:c};a.prototype._inheritedWriter=function(){return this._parentWithMember("writer",this._consoleWriter)};a.prototype._consoleWriter=function(a,c){for(var b=[],e=2;e<arguments.length;e++)b[e-2]=arguments[e];
console[a].apply(console,["["+c+"]"].concat(b))};a.prototype._matchLevel=function(a){return c[this._parentWithMember("level","error")]<=c[a]};a.prototype._isEnabled=function(){return this._parentWithMember("enabled",!0)};a._loggers={};return a}();b=k.getLogger("esri");a("dojo-debug-messages")?b.level="info":b.level="warn";return k})},"esri/layers/vectorTiles/core/screenUtils":function(){define(["require","exports"],function(k,b){function a(a){return a?72*a/b.DPI:0}Object.defineProperty(b,"__esModule",
{value:!0});var c=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;b.DPI=96;b.pt2px=function(a){return a?a/72*b.DPI:0};b.px2pt=a;b.toPt=function(b){if("string"===typeof b){if(c.test(b)){var e=b.match(c),l=Number(e[1]),e=e[3]&&e[3].toLowerCase();b="-"===b.charAt(0);l="px"===e?a(l):l;return b?-l:l}console.warn("screenUtils.toPt: input not recognized!");return null}return b}})},"esri/layers/vectorTiles/support/arcadeUtils":function(){define(["require","exports","esri/renderers/arcadeUtils","esri/arcade/Dictionary"],
function(k,b,a,c){Object.defineProperty(b,"__esModule",{value:!0});b.createSyntaxTree=function(c){return a.createSyntaxTree(c)};b.createFunction=function(c,b){return a.createFunction(c,b)};b.createExecContext=function(c,b){return a.createExecContext(c,b)};b.executeFunction=function(c,b){return a.executeFunction(c,b)};b.extractFieldNames=function(c){return a.extractFieldNames(c)};b.getViewInfo=function(a){if(a&&a.viewingMode&&null!=a.scale&&a.spatialReference)return{view:new c({viewingMode:a.viewingMode,
scale:a.scale}),sr:a.spatialReference}}})},"esri/renderers/arcadeUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","../support/expressionUtils"],function(k,b,a,c){b("extend-esri")&&k.setObject("renderer.arcadeUtils",c,a);return c})},"esri/layers/vectorTiles/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],function(k,b,a){function c(a,c){Array.isArray(c)?(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3]):(a[0]=c.r,a[1]=c.g,a[2]=c.b,a[3]=c.a);return a}function e(a,
c,b){void 0===c&&(c=0);void 0===b&&(b=!1);var d=a[c+3];a[c+0]*=d;a[c+1]*=d;a[c+2]*=d;b||(a[c+3]*=255);return a}Object.defineProperty(b,"__esModule",{value:!0});b.white=[255,255,255,1];var g=[0,0,0,0];b.premultiplyAlpha=e;b.copyAndPremultiply=function(a){return e(c([],a))};b.premultiplyAlphaUint32=function(b){e(c(g,b));return a.i8888to32(g[0],g[1],g[2],g[3])};b.premultiplyAlphaRGBA=function(c){var b=c.a;return a.i8888to32(c.r*b,c.g*b,c.b*b,255*b)}})},"esri/layers/vectorTiles/views/2d/engine/webgl/number":function(){define(["require",
"exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});var a=new Float32Array(1),c=new Uint32Array(a.buffer);b.nextHighestPowerOfTwo=function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a};b.toUint32=function(b){a[0]=b;return c[0]};b.i1616to32=function(a,c){return 65535&a|c<<16};b.i8888to32=function(a,c,b,d){return a&255|(c&255)<<8|(b&255)<<16|d<<24};b.i8816to32=function(a,c,b){return a&255|(c&255)<<8|b<<16};b.numTo32=function(a){return a|0}})},"esri/layers/vectorTiles/views/2d/engine/webgl/SymbolProperties":function(){define(["require",
"exports","../../../../core/ObjectPool"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function c(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}c.prototype.acquire=function(a,c,b,d,h,m,p,q,t){this.color=a;this.haloColor=c;this.haloSize=b;this.size=d;this.angle=h;this.offsetX=m;this.offsetY=p;this.hAnchor=q;this.vAnchor=t};c.prototype.release=function(){this.color[0]=this.color[1]=
this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};c.pool=new a(c);return c}();b.TextProperties=k})},"esri/layers/vectorTiles/core/ObjectPool":function(){define(["require","exports"],function(k,b){var a=function(){return function(){}}();return function(){function c(a,c,b,d,h){void 0===d&&(d=1);void 0===h&&(h=0);this.classConstructor=a;this.acquireFunctionOrWithConstructor=
c;this.releaseFunction=b;this.growthSize=d;!0===c?this.acquireFunction=this._constructorAcquireFunction:"function"===typeof c&&(this.acquireFunction=c);this._pool=Array(h);this._set=new Set;this._initialSize=h;for(a=0;a<h;a++)this._pool[a]=new this.classConstructor;this.growthSize=Math.max(d,1)}c.prototype.acquire=function(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];b=this.classConstructor||a;if(0===this._pool.length)for(var l=this.growthSize,d=0;d<l;d++)this._pool[d]=new b;b=this._pool.shift();
this.acquireFunction?this.acquireFunction.apply(this,[b].concat(c)):b&&b.acquire&&"function"===typeof b.acquire&&b.acquire.apply(b,c);this._set.delete(b);return b};c.prototype.release=function(a){a&&!this._set.has(a)&&(this.releaseFunction?this.releaseFunction(a):a&&a.release&&"function"===typeof a.release&&a.release(),this._pool.push(a),this._set.add(a))};c.prototype.prune=function(a){void 0===a&&(a=this._initialSize);if(!(this._pool.length<=a))for(var c;a>this._pool.length;)c=this._pool.shift(),
this._set.delete(c),c.dispose&&"function"===typeof c.dispose&&c.dispose()};c.prototype._constructorAcquireFunction=function(a){for(var c=[],b=1;b<arguments.length;b++)c[b-1]=arguments[b];(d=this.classConstructor).call.apply(d,[a].concat(c));var d};return c}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../GeometryUtils ./WGLBrush ../shaders/glShaderSnippets ../../../tiling/enums ../../../../webgl/BufferObject ../../../../webgl/Program ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function e(){var a=b.call(this)||this;a._initialized=!1;a._maxWidth=0;a._color=new Float32Array([1,0,0,1]);return a}a(e,b);e.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=
null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};e.prototype.draw=function(a,c){a=a.context;if(c.status!==l.TileStatus.INITIALIZED){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord);
this._outlineProgram.setUniform1f("u_coord_range",512);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var b=this._getTexture(a,c);b&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(b,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord),
this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",1),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",b.descriptor.width,b.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};e.prototype._initialize=function(a){if(this._initialized)return!0;var c={a_pos:0},b=new h(a,g.backgroundVS,g.backgroundFS,c),e=new h(a,g.tileInfoVS,g.tileInfoFS,c),m={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,
normalized:!1,divisor:0}]},f=new Int8Array([0,0,1,0,1,1,0,1]),f=d.createVertex(a,35044,f),f=new p(a,c,m,{geometry:f}),n=new Int8Array([0,0,1,0,0,1,1,1]),n=d.createVertex(a,35044,n);a=new p(a,c,m,{geometry:n});this._outlineProgram=b;this._tileInfoProgram=e;this._outlineVertexArrayObject=f;this._tileInfoVertexArrayObject=a;return this._initialized=!0};e.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id",
"canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var d=b.key.id,e=this._canvas.getContext("2d");e.font="24px sans-serif";e.textAlign="left";e.textBaseline="middle";var h=e.measureText(d),h=Math.pow(2,Math.ceil(c.log2(h.width+2)));h>this._maxWidth&&(this._maxWidth=h);e.clearRect(0,0,this._maxWidth,32);e.fillStyle="blue";e.fillText(d,0,16);b.texture=new m(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},
this._canvas);return b.texture};return e}(e.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});k=function(){return function(){}}();b.default=k})},"esri/layers/vectorTiles/views/2d/tiling/enums":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});k=b.TileStatus||(b.TileStatus={});k[k.INITIALIZED=0]="INITIALIZED";
k[k.NO_DATA=1]="NO_DATA";k[k.READY=2]="READY";k[k.MODIFIED=3]="MODIFIED";k[k.INVALID=4]="INVALID"})},"esri/layers/vectorTiles/views/webgl/Texture":function(){define(["require","exports","dojo/has"],function(k,b,a){return function(){function c(b,g,l){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=b;this._desc={pixelFormat:g.pixelFormat,internalFormat:g.internalFormat,dataType:g.dataType,target:g.target?
g.target:3553,samplingMode:g.samplingMode?g.samplingMode:9729,wrapMode:g.wrapMode?g.wrapMode:10497,maxAnisotropy:g.maxAnisotropy,flipped:void 0!==g.flipped?g.flipped:!1,hasMipmap:void 0!==g.hasMipmap?g.hasMipmap:!1,level:void 0!==g.level?g.level:0,unpackAlignment:g.unpackAlignment?g.unpackAlignment:4,width:g.width,height:g.height,preMultiplyAlpha:void 0!==g.preMultiplyAlpha?g.preMultiplyAlpha:!1};this._id=++c._nextId;a("esri-webgl-debug")&&b.instanceCounter.incrementCount(0);this.setData(l)}Object.defineProperty(c.prototype,
"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});c.prototype.dispose=function(){var c=this;if(this._context){if(this._glName){var b=this._context.gl;this._boundToUnits.forEach(function(a){c._context.bindTexture(null,a)});b.deleteTexture(this._glName);this._glName=
null}a("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(0);this._context=null}};c.prototype.resize=function(a,c){var b=this._desc;if(b.width!==a||b.height!==c)b.width=a,b.height=c,this.setData(null)};c.prototype.setData=function(a){var b=this._context.gl;this._glName||(this._glName=b.createTexture());void 0===a&&(a=null);null===a&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var e=this._context.getBoundTexture(0);this._context.bindTexture(this,0);
var d=this._desc;c._validateTexture(d);b.pixelStorei(b.UNPACK_ALIGNMENT,d.unpackAlignment);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,d.flipped?1:0);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d.preMultiplyAlpha);if(a instanceof ImageData||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement)d.width&&d.height&&console.assert(a.width===d.width&&a.height===d.height),b.texImage2D(b.TEXTURE_2D,d.level,d.internalFormat?d.internalFormat:d.pixelFormat,d.pixelFormat,d.dataType,
a),void 0===this._desc.width&&(this._desc.width=a.width),void 0===this._desc.height&&(this._desc.height=a.height);else{null!=d.width&&null!=d.height||console.error("Width and height must be specified!");var h=d.internalFormat?d.internalFormat:d.pixelFormat,m=d.pixelFormat;b.DEPTH24_STENCIL8&&h===b.DEPTH_STENCIL&&(h=b.DEPTH24_STENCIL8);b.texImage2D(b.TEXTURE_2D,d.level,h,d.width,d.height,0,m,d.dataType,a)}d.hasMipmap&&this.generateMipmap();c._applySamplingMode(b,this._desc);c._applyWrapMode(b,this._desc);
c._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(e,0)};c.prototype.updateData=function(a,c,b,d,h,m){m||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var e=this._context.gl,l=this._desc,g=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>c||0>b||d>l.width||h>l.height||c+d>l.width||b+h>l.height)&&console.error("An attempt to update out of bounds of the texture!");
m instanceof ImageData||m instanceof HTMLImageElement||m instanceof HTMLCanvasElement||m instanceof HTMLVideoElement?(console.assert(m.width===d&&m.height===h),e.texSubImage2D(e.TEXTURE_2D,a,c,b,l.pixelFormat,l.dataType,m)):e.texSubImage2D(e.TEXTURE_2D,a,c,b,d,h,l.pixelFormat,l.dataType,m);this._context.bindTexture(g,0)};c.prototype.generateMipmap=function(){var a=this._desc;a.hasMipmap||(a.hasMipmap=!0,c._validateTexture(a));9729===a.samplingMode?(this._samplingModeDirty=!0,a.samplingMode=9985):
9728===a.samplingMode&&(this._samplingModeDirty=!0,a.samplingMode=9984);a=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var b=this._context.gl;b.generateMipmap(b.TEXTURE_2D);this._context.bindTexture(a,0)};c.prototype.setSamplingMode=function(a){a!==this._desc.samplingMode&&(this._desc.samplingMode=a,c._validateTexture(this._desc),this._samplingModeDirty=!0)};c.prototype.setWrapMode=function(a){a!==this._desc.wrapMode&&(this._desc.wrapMode=a,c._validateTexture(this._desc),this._wrapModeDirty=
!0)};c.prototype.applyChanges=function(){var a=this._context.gl,b=this._desc;this._samplingModeDirty&&(c._applySamplingMode(a,b),this._samplingModeDirty=!1);this._wrapModeDirty&&(c._applyWrapMode(a,b),this._wrapModeDirty=!1)};c.prototype.setBoundToUnit=function(a,c){c?this._boundToUnits.add(a):this._boundToUnits.delete(a)};c._isPowerOfTwo=function(a){return 0===(a&a-1)};c._validateTexture=function(a){(0>a.width||0>a.height)&&console.error("Negative dimension parameters are not allowed!");c._isPowerOfTwo(a.width)&&
c._isPowerOfTwo(a.height)||(33071!==a.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),a.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};c._applySamplingMode=function(a,c){var b=c.samplingMode;if(9985===b||9987===b)b=9729;else if(9984===b||9986===b)b=9728;a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,c.samplingMode)};c._applyWrapMode=function(a,c){a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_S,c.wrapMode);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,c.wrapMode)};c._applyAnisotropicFilteringParameters=function(a,c){if(null!=c.maxAnisotropy){var b=a.capabilities.textureFilterAnisotropic;b&&(a=a.gl,a.texParameterf(a.TEXTURE_2D,b.TEXTURE_MAX_ANISOTROPY,c.maxAnisotropy))}};c._nextId=0;return c}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix/vec4 ./WGLBrush ../shaders/glShaderSnippets ../../../../webgl/BufferObject ../../../../webgl/Program ../../../../webgl/VertexArrayObject".split(" "),
function(k,b,a,c,e,g,l,d,h){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function e(){var a=b.call(this)||this;a._color=c.create();a._initialized=!1;a._color.set([1,0,0,1]);return a}a(e,b);e.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};e.prototype.draw=function(a,c){a=a.context;this._initialized||this._initialize(a);
a.setStencilFunctionSeparate(1032,519,c.stencilRef,255);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform);this._solidProgram.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord);this._solidProgram.setUniform1f("u_coord_range",512);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};e.prototype._initialize=
function(a){if(this._initialized)return!0;var c={a_pos:0},b=new d(a,g.backgroundVS,g.backgroundFS,c);if(!b)return!1;var e=new Int8Array([0,0,1,0,0,1,1,1]),e=l.createVertex(a,35044,e);a=new h(a,c,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:e});this._solidProgram=b;this._solidVertexArrayObject=a;return this._initialized=!0};return e}(e.default);b.default=k})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec4":function(){define(["./common"],function(k){var b=
{create:function(){var a=new k.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var c=new k.ARRAY_TYPE(4);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];return c},fromValues:function(a,c,b,g){var e=new k.ARRAY_TYPE(4);e[0]=a;e[1]=c;e[2]=b;e[3]=g;return e},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a},set:function(a,c,b,g,l){a[0]=c;a[1]=b;a[2]=g;a[3]=l;return a},add:function(a,c,b){a[0]=c[0]+b[0];a[1]=c[1]+b[1];a[2]=c[2]+b[2];a[3]=c[3]+b[3];return a},subtract:function(a,
c,b){a[0]=c[0]-b[0];a[1]=c[1]-b[1];a[2]=c[2]-b[2];a[3]=c[3]-b[3];return a}};b.sub=b.subtract;b.multiply=function(a,c,b){a[0]=c[0]*b[0];a[1]=c[1]*b[1];a[2]=c[2]*b[2];a[3]=c[3]*b[3];return a};b.mul=b.multiply;b.divide=function(a,c,b){a[0]=c[0]/b[0];a[1]=c[1]/b[1];a[2]=c[2]/b[2];a[3]=c[3]/b[3];return a};b.div=b.divide;b.ceil=function(a,c){a[0]=Math.ceil(c[0]);a[1]=Math.ceil(c[1]);a[2]=Math.ceil(c[2]);a[3]=Math.ceil(c[3]);return a};b.floor=function(a,c){a[0]=Math.floor(c[0]);a[1]=Math.floor(c[1]);a[2]=
Math.floor(c[2]);a[3]=Math.floor(c[3]);return a};b.min=function(a,c,b){a[0]=Math.min(c[0],b[0]);a[1]=Math.min(c[1],b[1]);a[2]=Math.min(c[2],b[2]);a[3]=Math.min(c[3],b[3]);return a};b.max=function(a,c,b){a[0]=Math.max(c[0],b[0]);a[1]=Math.max(c[1],b[1]);a[2]=Math.max(c[2],b[2]);a[3]=Math.max(c[3],b[3]);return a};b.round=function(a,c){a[0]=Math.round(c[0]);a[1]=Math.round(c[1]);a[2]=Math.round(c[2]);a[3]=Math.round(c[3]);return a};b.scale=function(a,c,b){a[0]=c[0]*b;a[1]=c[1]*b;a[2]=c[2]*b;a[3]=c[3]*
b;return a};b.scaleAndAdd=function(a,c,b,g){a[0]=c[0]+b[0]*g;a[1]=c[1]+b[1]*g;a[2]=c[2]+b[2]*g;a[3]=c[3]+b[3]*g;return a};b.distance=function(a,c){var b=c[0]-a[0],g=c[1]-a[1],l=c[2]-a[2];a=c[3]-a[3];return Math.sqrt(b*b+g*g+l*l+a*a)};b.dist=b.distance;b.squaredDistance=function(a,c){var b=c[0]-a[0],g=c[1]-a[1],l=c[2]-a[2];a=c[3]-a[3];return b*b+g*g+l*l+a*a};b.sqrDist=b.squaredDistance;b.length=function(a){var c=a[0],b=a[1],g=a[2];a=a[3];return Math.sqrt(c*c+b*b+g*g+a*a)};b.len=b.length;b.squaredLength=
function(a){var c=a[0],b=a[1],g=a[2];a=a[3];return c*c+b*b+g*g+a*a};b.sqrLen=b.squaredLength;b.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];a[2]=-c[2];a[3]=-c[3];return a};b.inverse=function(a,c){a[0]=1/c[0];a[1]=1/c[1];a[2]=1/c[2];a[3]=1/c[3];return a};b.normalize=function(a,c){var b=c[0],g=c[1],l=c[2];c=c[3];var d=b*b+g*g+l*l+c*c;0<d&&(d=1/Math.sqrt(d),a[0]=b*d,a[1]=g*d,a[2]=l*d,a[3]=c*d);return a};b.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]+a[2]*c[2]+a[3]*c[3]};b.lerp=function(a,c,b,g){var e=
c[0],d=c[1],h=c[2];c=c[3];a[0]=e+g*(b[0]-e);a[1]=d+g*(b[1]-d);a[2]=h+g*(b[2]-h);a[3]=c+g*(b[3]-c);return a};b.random=function(a,c){c=c||1;a[0]=k.RANDOM();a[1]=k.RANDOM();a[2]=k.RANDOM();a[3]=k.RANDOM();b.normalize(a,a);b.scale(a,a,c);return a};b.transformMat4=function(a,c,b){var e=c[0],l=c[1],d=c[2];c=c[3];a[0]=b[0]*e+b[4]*l+b[8]*d+b[12]*c;a[1]=b[1]*e+b[5]*l+b[9]*d+b[13]*c;a[2]=b[2]*e+b[6]*l+b[10]*d+b[14]*c;a[3]=b[3]*e+b[7]*l+b[11]*d+b[15]*c;return a};b.transformQuat=function(a,c,b){var e=c[0],l=
c[1],d=c[2],h=b[0],m=b[1],p=b[2];b=b[3];var q=b*e+m*d-p*l,t=b*l+p*e-h*d,u=b*d+h*l-m*e,e=-h*e-m*l-p*d;a[0]=q*b+e*-h+t*-p-u*-m;a[1]=t*b+e*-m+u*-h-q*-p;a[2]=u*b+e*-p+q*-m-t*-h;a[3]=c[3];return a};b.forEach=function(){var a=b.create();return function(c,b,g,l,d,h){b||(b=4);g||(g=0);for(l=l?Math.min(l*b+g,c.length):c.length;g<l;g+=b)a[0]=c[g],a[1]=c[g+1],a[2]=c[g+2],a[3]=c[g+3],d(a,a,h),c[g]=a[0],c[g+1]=a[1],c[g+2]=a[2],c[g+3]=a[3];return c}}();b.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+
a[3]+")"};b.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]};b.equals=function(a,c){var b=a[0],g=a[1],l=a[2];a=a[3];var d=c[0],h=c[1],m=c[2];c=c[3];return Math.abs(b-d)<=k.EPSILON*Math.max(1,Math.abs(b),Math.abs(d))&&Math.abs(g-h)<=k.EPSILON*Math.max(1,Math.abs(g),Math.abs(h))&&Math.abs(l-m)<=k.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(a-c)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};return b})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../enums ../Utils ./WGLGeometryBrush ../../../../webgl/VertexArrayObject".split(" "),
function(k,b,a,c,e,g,l){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a._isInitialized=!1;a._fillAttributeLocations={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4};a._fillAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4,a_vv:5};a._spritesTextureSize=new Float32Array(2);return a}a(d,b);d.prototype.dispose=function(){};d.prototype.getGeometryType=function(){return c.WGLGeometryType.FILL};d.prototype.drawGeometry=
function(a,c,b,d){d=a.context;var m=a.painter,e=a.rendererInfo,h=a.requiredLevel,p=a.stationary,l=b.indexCount,f=b.indexFrom;this._initialize();var n=b.materialInfo.materialKeyInfo,r=n.hasVV()?this._fillAttributeLocationsVV:this._fillAttributeLocations;if(r=a.painter.materialManager.getProgram(b.materialInfo.materialKey,a.drawPhase,r)){d.bindProgram(r);var B=this._getVAO(d,c,n.hasVV());d.bindVAO(B);if(0<b.materialInfo.texBindingInfo.length){b=b.materialInfo.texBindingInfo[0];var B=b.pageId,g=a.painter.textureManager.sprites;
this._spritesTextureSize[0]=g.getWidth(B);this._spritesTextureSize[1]=g.getHeight(B);r.setUniform1f("u_zoomFactor",1/Math.pow(2,h-c.key.level)/a.pixelRatio);m.textureManager.bindSpritePage(d,B,b.unit,p?9728:9729);r.setUniform1i(b.semantic,b.unit);r.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}r.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform);r.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord);r.setUniform1f("u_opacity",1);n.vvColor&&(r.setUniform1fv("u_vvColorValues",
e.vvColorValues),r.setUniform4fv("u_vvColors",e.vvColors));n.vvOpacity&&(r.setUniform1fv("u_vvOpacityValues",e.vvOpacityValues),r.setUniform1fv("u_vvOpacities",e.vvOpacities));d.drawElements(4,l,5125,4*f);d.bindVAO(null)}};d.prototype._initialize=function(){if(this._isInitialized)return!0;this._fillVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,
type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]};this._fillVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_tlbr",count:4,
type:5123,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_vv",count:2,type:5126,offset:24,stride:32,normalized:!1,divisor:0}]};this._isInitialized=!0};d.prototype._getVAO=function(a,c,b){if(c.fillGeometry.vao)return c.fillGeometry.vao;var d=c.fillGeometry.vertexBufferMap[e.C_VBO_GEOMETRY],m=c.fillGeometry.indexBuffer;if(!d||!m)return null;c.fillGeometry.vao=b?new l(a,this._fillAttributeLocationsVV,this._fillVertexAttributeLayoutVV,
{geometry:d},m):new l(a,this._fillAttributeLocations,this._fillVertexAttributeLayout,{geometry:d},m);return c.fillGeometry.vao};return d}(g.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define(["require","exports","../../../../../core/tsSupport/extendsHelper","./WGLBrush","../util/iterator"],function(k,b,a,c,e){Object.defineProperty(b,"__esModule",{value:!0});k=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}a(b,
c);b.prototype.draw=function(a,c){var b=this;if(c.canDisplay){var d=this.getGeometryType(),h=c.getDisplayList(a.drawPhase),l=c.getGeometry(d);l&&e.forEachIter(h.ofType(d),function(d){return b.drawGeometry(a,c,d,l)})}};return b}(c.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/util/iterator":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.forEachIter=function(a,c){for(;;){var b=a.next();if(b.done)break;c(b.value)}}})},
"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../enums ../Utils ./WGLGeometryBrush ../../../../webgl/VertexArrayObject".split(" "),function(k,b,a,c,e,g,l){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a._attributeLocations={a_pos:0,a_color:1,a_vertexOffset:2,a_texAndSize:3,a_refSymbolAndPlacementOffset:4,a_visible:5,
a_visibilityRange:6};a._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_texAndSize",count:4,type:5120,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_refSymbolAndPlacementOffset",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",
count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}],visibilityRange:[{name:"a_visibilityRange",count:2,type:5121,offset:0,stride:2,normalized:!1,divisor:0}]};a._glyphsTextureSize=new Float32Array(2);return a}a(d,b);d.prototype.dispose=function(){};d.prototype.drawGeometry=function(a,b,d,e){if(a.requiredLevel===b.key.level){e=a.context;var m=a.painter,h=a.drawPhase,p=d.materialInfo,l=d.indexCount;d=d.indexFrom;var g=this._attributeLocations,f=a.drawPhase===c.WGLDrawPhase.LABEL_ALPHA,n=p.materialKey;
f&&(n|=8);if(h=m.materialManager.getProgram(n,h,g))e.setStencilTestEnabled(!1),e.bindProgram(h),g=this._getVAO(e,b),e.bindVAO(g),f?(e.setBlendingEnabled(!1),h.setUniform1f("u_fadeStep",a.labelStep)):(p=p.texBindingInfo[0],m.textureManager.bindGlyphsPage(e,p.pageId,p.unit),h.setUniform1i(p.semantic,p.unit)),p=m.textureManager.glyphs,this._glyphsTextureSize[0]=p.width/4,this._glyphsTextureSize[1]=p.height/4,m=m.extrudeNoRotationMatrix,e.bindTexture(a.labelFBO.colorTexture,3),h.setUniform1i("u_referenceTex",
3),h.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),h.setUniformMatrix4fv("u_extrudeMatrix",m),h.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),h.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),h.setUniform1f("u_pixelRatio",a.pixelRatio),h.setUniform1f("u_opacity",1),h.setUniform1f("u_zoomLevel",10*a.displayLevel),h.setUniform1f("u_mapRotation",a.state.rotation),h.setUniform1f("u_mapAligned",0),h.setUniform2fv("u_screenSize",a.state.size),e.drawElements(4,
l,5125,4*d),e.bindVAO(null),e.setStencilTestEnabled(!0),e.setBlendingEnabled(!0)}};d.prototype.getGeometryType=function(){return c.WGLGeometryType.LABEL};d.prototype._getVAO=function(a,c){if((c=c.labelGeometry)&&c.vao)return c.vao;var b=c.vertexBufferMap[e.C_VBO_GEOMETRY],d=c.vertexBufferMap[e.C_VBO_VISIBILITY_RANGE],m=c.indexBuffer;if(!b||!m||!d)return null;c.vao=new l(a,this._attributeLocations,this._vertexAttributeLayout,{geometry:b,visibility:c.vertexBufferMap[e.C_VBO_VISIBILITY],visibilityRange:d},
m);return c.vao};return d}(g.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../enums ../Utils ./WGLGeometryBrush ../../../../webgl/VertexArrayObject".split(" "),function(k,b,a,c,e,g,l){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a._lineAttributeLocations={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,
a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6};a._lineAttributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_offsetAndNormal:3,a_accumulatedDistanceAndHalfWidth:4,a_tlbr:5,a_segmentDirection:6,a_vv:7};a._lineVertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_offsetAndNormal",
count:4,type:5120,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:32,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:32,normalized:!1,divisor:0}]};a._lineVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:44,
normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:44,normalized:!0,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:12,stride:44,normalized:!1,divisor:0},{name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123,offset:16,stride:44,normalized:!1,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:20,stride:44,normalized:!1,divisor:0},{name:"a_segmentDirection",count:4,type:5120,offset:28,stride:44,normalized:!1,divisor:0},{name:"a_vv",count:3,type:5126,offset:32,
stride:44,normalized:!1,divisor:0}]};a._spritesTextureSize=new Float32Array(2);return a}a(d,b);d.prototype.dispose=function(){};d.prototype.getGeometryType=function(){return c.WGLGeometryType.LINE};d.prototype.drawGeometry=function(a,c,b,d){d=a.context;var e=a.painter,m=a.rendererInfo,h=a.requiredLevel,p=a.drawPhase,l=b.indexFrom,f=b.indexCount,n=b.materialInfo;b=n.materialKeyInfo;var r=b.hasVV()?this._lineAttributeLocationsVV:this._lineAttributeLocations;if(p=e.materialManager.getProgram(n.materialKey,
p,r)){d.bindProgram(p);r=this._getVAO(d,c,b.hasVV());d.bindVAO(r);r=1/a.pixelRatio;if(0<n.texBindingInfo.length){var n=n.texBindingInfo[0],B=n.pageId,g=e.textureManager.sprites;this._spritesTextureSize[0]=g.getWidth(B);this._spritesTextureSize[1]=g.getHeight(B);e.textureManager.bindSpritePage(d,B,n.unit);p.setUniform1i(n.semantic,n.unit);p.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}a=Math.pow(2,h-c.key.level)/a.pixelRatio;p.setUniform1f("u_zoomFactor",a);p.setUniformMatrix4fv("u_transformMatrix",
c.tileTransform.transform);p.setUniformMatrix4fv("u_extrudeMatrix",e.extrudeMatrix);p.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord);p.setUniform1f("u_opacity",1);p.setUniform1f("u_blur",0+r);p.setUniform1f("u_antialiasing",r);p.setUniform1f("u_zoomFactor",a);b.vvSizeMinMaxValue&&p.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue);b.vvSizeScaleStops&&p.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue);b.vvSizeFieldStops&&(p.setUniform1fv("u_vvSizeFieldStopsValues",
m.vvSizeFieldStopsValues),p.setUniform1fv("u_vvSizeFieldStopsSizes",m.vvSizeFieldStopsSizes));b.vvSizeUnitValue&&p.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio);b.vvColor&&(p.setUniform1fv("u_vvColorValues",m.vvColorValues),p.setUniform4fv("u_vvColors",m.vvColors));b.vvOpacity&&(p.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),p.setUniform1fv("u_vvOpacities",m.vvOpacities));d.setFaceCullingEnabled(!0);d.setFrontFace(2305);d.setCullFace(1029);d.drawElements(4,
f,5125,4*l);d.setFaceCullingEnabled(!1);d.bindVAO(null)}};d.prototype._getVAO=function(a,c,b){if(c.lineGeometry.vao)return c.lineGeometry.vao;var d=c.lineGeometry.vertexBufferMap[e.C_VBO_GEOMETRY],m=c.lineGeometry.indexBuffer;if(!d||!m)return null;c.lineGeometry.vao=b?new l(a,this._lineAttributeLocationsVV,this._lineVertexAttributeLayoutVV,{geometry:d},m):new l(a,this._lineAttributeLocations,this._lineVertexAttributeLayout,{geometry:d},m);return c.lineGeometry.vao};return d}(g.default);b.default=
k})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../enums ../Utils ./WGLGeometryBrush ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),function(k,b,a,c,e,g,l,d){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function m(){var a=null!==b&&b.apply(this,arguments)||this;a._iconAttributeLocations={a_pos:0,a_vertexOffset:1,a_vertexTex:2,a_id:3,a_color:4,
a_outlineColor:5,a_sizeAndOutlineWidth:6};a._iconAttributeLocationsVV={a_pos:0,a_vertexOffset:1,a_vertexTex:2,a_id:3,a_color:4,a_outlineColor:5,a_sizeAndOutlineWidth:6,a_vv:7};a._iconAttributeLocationsHeatmap={a_pos:0,a_vertexOffset:1,a_vertexTex:2,a_id:3,a_color:4,a_outlineColor:5,a_sizeAndOutlineWidth:6,a_weight:7};a._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:28,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:28,normalized:!1,
divisor:0},{name:"a_vertexTex",count:4,type:5121,offset:8,stride:28,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:12,stride:28,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:28,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:20,stride:28,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:24,stride:28,normalized:!1,divisor:0}]};a._iconVertexAttributesWithVV={geometry:[{name:"a_pos",count:2,type:5122,
offset:0,stride:44,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:44,normalized:!1,divisor:0},{name:"a_vertexTex",count:4,type:5121,offset:8,stride:44,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:12,stride:44,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:44,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:20,stride:44,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:24,
stride:44,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:28,stride:44,normalized:!1,divisor:0}]};a._iconVertexAttributesWithHeatmap={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:32,normalized:!1,divisor:0},{name:"a_vertexTex",count:4,type:5121,offset:8,stride:32,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:12,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,
type:5121,offset:16,stride:32,normalized:!0,divisor:0},{name:"a_outlineColor",count:4,type:5121,offset:20,stride:32,normalized:!0,divisor:0},{name:"a_sizeAndOutlineWidth",count:4,type:5121,offset:24,stride:32,normalized:!1,divisor:0},{name:"a_weight",count:1,type:5126,offset:28,stride:32,normalized:!1,divisor:0}]};a._spritesTextureSize=new Float32Array(2);return a}a(m,b);m.prototype.dispose=function(){};m.prototype.getGeometryType=function(){return c.WGLGeometryType.MARKER};m.prototype.drawGeometry=
function(a,c,b,d){d=a.context;var e=a.painter,m=a.rendererInfo,h=a.drawPhase;a=b.indexCount;var p=b.indexFrom,f=b.materialInfo;b=f.materialKeyInfo;var n=b.heatmap,r=b.hasVV()?this._iconAttributeLocationsVV:this._iconAttributeLocations;if(h=e.materialManager.getProgram(f.materialKey,h,r))d.bindProgram(h),r=this._getVAO(d,c,b.hasVV(),n),d.bindVAO(r),n?(f=this._getIntensityTexture(d,m.heatmapParameters),d.bindTexture(f,1),h.setUniform1i("u_texture",1),this._spritesTextureSize[0]=Math.round(m.heatmapParameters.radius),
this._spritesTextureSize[1]=Math.round(m.heatmapParameters.radius)):(n=f.texBindingInfo[0],f=n.pageId,e.textureManager.bindSpritePage(d,f,n.unit),h.setUniform1i(n.semantic,n.unit),n=e.textureManager.sprites,this._spritesTextureSize[0]=n.getWidth(f)/4,this._spritesTextureSize[1]=n.getHeight(f)/4),e=m.vvMaterialParameters.vvRotationEnabled&&"geographic"===m.vvMaterialParameters.vvRotationType?e.extrudeMatrix:e.extrudeNoRotationMatrix,h.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform),
h.setUniformMatrix4fv("u_extrudeMatrix",e),h.setUniform2fv("u_normalized_origin",c.tileTransform.displayCoord),h.setUniform2fv("u_mosaicSize",this._spritesTextureSize),h.setUniform1f("u_opacity",1),b.vvSizeMinMaxValue&&h.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue),b.vvSizeScaleStops&&h.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue),b.vvSizeFieldStops&&(h.setUniform1fv("u_vvSizeFieldStopsValues",m.vvSizeFieldStopsValues),h.setUniform1fv("u_vvSizeFieldStopsSizes",m.vvSizeFieldStopsSizes)),
b.vvSizeUnitValue&&h.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",m.vvSizeUnitValueToPixelsRatio),b.vvColor&&(h.setUniform1fv("u_vvColorValues",m.vvColorValues),h.setUniform4fv("u_vvColors",m.vvColors)),b.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),h.setUniform1fv("u_vvOpacities",m.vvOpacities)),b.vvRotation&&h.setUniform1f("u_vvRotationType","geographic"===m.vvMaterialParameters.vvRotationType?0:1),d.drawElements(4,a,5125,4*p),d.bindVAO(null)};m.prototype._getVAO=function(a,
c,b,m){if(c.iconGeometry.vao)return c.iconGeometry.vao;var h=c.iconGeometry.vertexBufferMap[e.C_VBO_GEOMETRY],p=c.iconGeometry.indexBuffer;if(!h||!p)return null;c.iconGeometry.vao=b?new d(a,this._iconAttributeLocationsVV,this._iconVertexAttributesWithVV,{geometry:h},p):m?new d(a,this._iconAttributeLocationsHeatmap,this._iconVertexAttributesWithHeatmap,{geometry:h},p):new d(a,this._iconAttributeLocations,this._iconVertexAttributes,{geometry:h},p);return c.iconGeometry.vao};m.prototype._getIntensityTexture=
function(a,c){if(c.intensityKernel&&!c.refreshIntensityKernel)return c.intensityKernel;c.intensityKernel&&(c.intensityKernel.dispose(),c.intensityKernel=null);for(var b=c.radius,d=c.kernelSize,e=c.blurRadius,m=b*b,h=[],p=-1;++p<d;)h[p]=Math.exp(-Math.pow(p-e,2)/(2*m))/(b/2*Math.sqrt(2*Math.PI));for(var b=[],f,n=0;n<d;n++)for(m=h[n],p=0;p<d;p++)f=n*d+p,e=h[p],b[4*f+0]=m*e,b[4*f+1]=0,b[4*f+2]=0,b[4*f+3]=1;a=new l(a,{target:3553,pixelFormat:6408,internalFormat:a.capabilities.colorBufferFloat.RGBA32F,
dataType:5126,samplingMode:a.capabilities.textureFloatLinear?9729:9728,wrapMode:33071,width:d,height:d},new Float32Array(b));c.intensityKernel=a;c.refreshIntensityKernel=!1;return a};return m}(g.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../enums ../Utils ./WGLGeometryBrush ../../../../webgl/VertexArrayObject".split(" "),function(k,b,a,c,e,g,l){Object.defineProperty(b,
"__esModule",{value:!0});k=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a._attributeLocations={a_pos:0,a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_visible:5};a._attributeLocationsVV={a_pos:0,a_id:1,a_color:2,a_vertexOffset:3,a_texFontSize:4,a_vv:5,a_visible:6};a._vertexAttributeLayout={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:20,normalized:!0,divisor:0},{name:"a_color",count:4,
type:5121,offset:8,stride:20,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:20,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:20,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]};a._vertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:36,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:36,normalized:!0,divisor:0},
{name:"a_color",count:4,type:5121,offset:8,stride:36,normalized:!0,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:12,stride:36,normalized:!1,divisor:0},{name:"a_texFontSize",count:4,type:5120,offset:16,stride:36,normalized:!1,divisor:0},{name:"a_vv",count:4,type:5126,offset:20,stride:36,normalized:!1,divisor:0}],visibility:[{name:"a_visible",count:1,type:5121,offset:0,stride:1,normalized:!0,divisor:0}]};a._glyphsTextureSize=new Float32Array(2);return a}a(d,b);d.prototype.dispose=function(){};
d.prototype.getGeometryType=function(){return c.WGLGeometryType.TEXT};d.prototype.drawGeometry=function(a,c,b,d){d=a.context;var e=a.painter,m=a.rendererInfo,h=b.materialInfo,p=b.indexCount;b=b.indexFrom;var l=h.materialKeyInfo,f=l.vvSizeMinMaxValue||l.vvSizeScaleStops||l.vvSizeFieldStops||l.vvSizeUnitValue||l.vvColor||l.vvRotation||l.vvOpacity;if(a=e.materialManager.getProgram(h.materialKey,a.drawPhase,f?this._attributeLocationsVV:this._attributeLocations))d.bindProgram(a),f=this._getVAO(d,c,f,this.getGeometryType()),
d.bindVAO(f),h=h.texBindingInfo[0],e.textureManager.bindGlyphsPage(d,h.pageId,h.unit),a.setUniform1i(h.semantic,h.unit),h=e.textureManager.glyphs,this._glyphsTextureSize[0]=h.width/4,this._glyphsTextureSize[1]=h.height/4,e=m.vvMaterialParameters.vvRotationEnabled&&"geographic"===m.vvMaterialParameters.vvRotationType?e.extrudeMatrix:e.extrudeNoRotationMatrix,a.setUniformMatrix4fv("u_transformMatrix",c.tileTransform.transform),a.setUniformMatrix4fv("u_extrudeMatrix",e),a.setUniform2fv("u_normalized_origin",
c.tileTransform.displayCoord),a.setUniform2fv("u_mosaicSize",this._glyphsTextureSize),a.setUniform1f("u_pixelRatio",1),a.setUniform1f("u_opacity",1),l.vvSizeMinMaxValue&&a.setUniform4fv("u_vvSizeMinMaxValue",m.vvSizeMinMaxValue),l.vvSizeScaleStops&&a.setUniform1f("u_vvSizeScaleStopsValue",m.vvSizeScaleStopsValue),l.vvSizeFieldStops&&(a.setUniform1fv("u_vvSizeFieldStopsValues",m.vvSizeFieldStopsValues),a.setUniform1fv("u_vvSizeFieldStopsSizes",m.vvSizeFieldStopsSizes)),l.vvSizeUnitValue&&a.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",
m.vvSizeUnitValueToPixelsRatio),l.vvColor&&(a.setUniform1fv("u_vvColorValues",m.vvColorValues),a.setUniform4fv("u_vvColors",m.vvColors)),l.vvOpacity&&(a.setUniform1fv("u_vvOpacityValues",m.vvOpacityValues),a.setUniform1fv("u_vvOpacities",m.vvOpacities)),l.vvRotation&&a.setUniform1f("u_vvRotationType","geographic"===m.vvMaterialParameters.vvRotationType?0:1),d.drawElements(4,p,5125,4*b),d.bindVAO(null)};d.prototype._getVAO=function(a,c,b,d){if((c=c.getGeometry(d))&&c.vao)return c.vao;d=c.vertexBufferMap[e.C_VBO_GEOMETRY];
var m=c.vertexBufferMap[e.C_VBO_VISIBILITY],h=c.indexBuffer;if(!d||!h)return null;c.vao=b?new l(a,this._attributeLocationsVV,this._vertexAttributeLayoutVV,{geometry:d,visibility:m},h):new l(a,this._attributeLocations,this._vertexAttributeLayout,{geometry:d,visibility:m},h);return c.vao};return d}(g.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/painter/WGLHighlightPainter":function(){define(["require","exports","dojo/has","./highlight/HighlightRenderer","./highlight/HighlightSurfaces"],
function(k,b,a,c,e){return function(){function b(){this._hlRenderer=new c;this._hlSurfaces=new e;this._height=this._width=void 0}b.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._boundFBO=null};b.prototype.setup=function(a,c,b){var d=c%4,e=b%4;c+=2>d?-d:4-d;b+=2>e?-e:4-e;this._width=c;this._height=b;this._boundFBO=a.getBoundFramebufferObject();c=Math.round(.75*c);b=Math.round(.75*b);this._hlRenderer.setup(a,c,b);this._hlSurfaces.setup(a,
c,b)};b.prototype.setHighlightOptions=function(a){this._hlRenderer.setHighlightOptions({fillColor:a.fillColor,outlineColor:a.outlineColor,outlineWidth:.75*a.outlineWidth,outerHaloWidth:.75*a.outerHaloWidth,innerHaloWidth:.75*a.innerHaloWidth,outlinePosition:.75*a.outlinePosition})};b.prototype.startMaskDraw=function(a){a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.setClearStencil(0);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.STENCIL_BUFFER_BIT);a.setViewport(0,0,.75*this._width,
.75*this._height)};b.prototype.draw=function(c){c.setStencilTestEnabled(!1);c.setBlendingEnabled(!1);c.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(c,this._hlSurfaces.sharedBlur1Tex);a("esri-feature-highlight-debug")?(c.bindFramebuffer(null),c.clear(c.gl.COLOR_BUFFER_BIT),this._hlRenderer.finalBlur(c,this._hlSurfaces.sharedBlur2Tex)):(c.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),c.setClearColor(0,0,0,0),c.clear(c.gl.COLOR_BUFFER_BIT),
this._hlRenderer.finalBlur(c,this._hlSurfaces.sharedBlur2Tex),c.bindFramebuffer(this._boundFBO),c.setBlendingEnabled(!0),c.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(c,this._hlSurfaces.sharedBlur1Tex),this._boundFBO=null)};return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/painter/highlight/HighlightRenderer":function(){define("require exports ../../shaders/hlShaderSnippets ../../../../../webgl/BufferObject ../../../../../webgl/ShaderVariations ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject".split(" "),
function(k,b,a,c,e,g,l){var d=[void 0,void 0,void 0,1],h=[3,4],m=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return function(){function b(){this._height=this._width=void 0;this._highlightOptions={fillColor:[.2,.6,.9,.75],outlineColor:[.2,.6,.9,.9],outlinePosition:0,outlineWidth:3.4,innerHaloWidth:2,outerHaloWidth:3.3};this._resources=null}b.prototype.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),
this._resources.blurProgram.dispose(),this._resources.shadeTex.dispose(),this._resources=null)};b.prototype.preBlur=function(a,c){a.bindTexture(c,h[0]);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",m);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.finalBlur=function(a,c){a.bindTexture(c,h[0]);a.bindProgram(this._resources.blurProgram);
this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",p);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.renderHighlight=function(a,c){a.bindTexture(c,h[0]);a.bindTexture(this._resources.shadeTex,h[1]);a.bindProgram(this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype._initialize=function(b,m,p){this._width=m;this._height=
p;m=new c(b,34962,35044,(new Int8Array([-128,-128,0,0,127,-128,255,0,-128,127,0,255,127,127,255,255])).buffer);p=new l(b,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!0},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!0}]},{geometry:m});var q=(new e("hl",["texturedVS","highlightFS"],[],a,b,{a_position:0,a_texcoord:1})).getProgram([]),t=(new e("hl",["texturedVS","blurFS"],[],a,b,{a_position:0,a_texcoord:1})).getProgram([]);
q.setUniform1i("u_texture",h[0]);q.setUniform1i("u_shade",h[1]);q.setUniform4fv("u_sigmas",d);t.setUniform1i("u_texture",h[0]);t.setUniform4fv("u_sigmas",d);b=new g(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:256,height:1,samplingMode:9728});this._resources={quadGeometry:m,quadVAO:p,highlightProgram:q,blurProgram:t,shadeTex:b}};b.prototype.setHighlightOptions=function(a){function c(a,f,c){r[0]=(1-c)*a[0]+c*f[0];r[1]=(1-c)*a[1]+c*f[1];r[2]=(1-c)*a[2]+c*f[2];r[3]=(1-c)*a[3]+c*
f[3]}this._highlightOptions=a;if(this._resources){var b=a.outlinePosition-a.outlineWidth/2-a.outerHaloWidth,e=a.outlinePosition-a.outlineWidth/2,m=a.outlinePosition+a.outlineWidth/2,h=a.outlinePosition+a.outlineWidth/2+a.innerHaloWidth,f=Math.sqrt(Math.PI/2)*d[3],n=Math.abs(b)>f?Math.round(10*(Math.abs(b)-f))/10:0,f=Math.abs(h)>f?Math.round(10*(Math.abs(h)-f))/10:0;n&&!f?console.warn("The outer rim of the highlight is "+n+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):
!n&&f?console.warn("The inner rim of the highlight is "+f+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):n&&f&&console.warn("The highlight is "+Math.max(n,f)+"px away from the edge of the feature; consider reducing some width values.");for(var n=new Uint8Array(1024),r=[void 0,void 0,void 0,void 0],p=0;256>p;++p)f=b+p/255*(h-b),f<b?(n[4*p+0]=0,n[4*p+1]=0,n[4*p+2]=0,n[4*p+3]=0):f<e?c([0,0,0,0],a.outlineColor,
(f-b)/(e-b)):f<m?(r[0]=a.outlineColor[0],r[1]=a.outlineColor[1],r[2]=a.outlineColor[2],r[3]=a.outlineColor[3]):f<h?c(a.outlineColor,a.fillColor,(f-m)/(h-m)):(n[4*p+0]=a.fillColor[0],n[4*p+1]=a.fillColor[1],n[4*p+2]=a.fillColor[2],n[4*p+3]=a.fillColor[3]),n[4*p+0]=255*r[0]*r[3],n[4*p+1]=255*r[1]*r[3],n[4*p+2]=255*r[2]*r[3],n[4*p+3]=255*r[3];this._resources.highlightProgram.setUniform2fv("u_minMaxDistance",[b,h]);this._resources.shadeTex.updateData(0,0,0,256,1,n)}};b.prototype.setup=function(a,c,b){this._resources?
(this._width=c,this._height=b):(this._initialize(a,c,b),this.setHighlightOptions(this._highlightOptions))};return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/shaders/hlShaderSnippets":function(){define(["require","exports","dojo/text!./hlShaders.xml","../../../../webgl/ShaderSnippets"],function(k,b,a,c){k=new c;c.parse(a,k);return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/painter/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl/FramebufferObject",
"../../../../../webgl/Texture"],function(k,b,a,c){function e(b,e,d){e=new c(b,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:e,height:d,samplingMode:9729});b=a.createWithAttachments(b,e,{colorTarget:0,depthStencilTarget:2});return[e,b]}return function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),
this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};a.prototype._initialize=function(a,c,b){this._width=c;this._height=b;var d=e(a,c,b),h=d[0],d=d[1];a=e(a,c,b);this._resources={sharedBlur1Tex:h,sharedBlur1Fbo:d,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};a.prototype.setup=function(a,c,b){!this._resources||this._width===c&&this._height===b||this.dispose();this._resources||this._initialize(a,c,b)};Object.defineProperty(a.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/webgl/FramebufferObject":function(){define(["require",
"exports","dojo/has","./Renderbuffer","./Texture"],function(k,b,a,c,e){return function(){function b(l,d,h,m){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=null;this._initialized=!1;this._context=l;this._desc={colorTarget:d.colorTarget,depthStencilTarget:d.depthStencilTarget,width:d.width,height:d.height,multisampled:d.multisampled};this._id=b._nextId++;a("esri-webgl-debug")&&l.instanceCounter.incrementCount(4);h&&(l=void 0,h instanceof e?(this._colorAttachment=
h,l=h.descriptor):(l=h,this._colorAttachment=new e(this._context,l)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),b._validateTextureDimensions(l,this._desc));m instanceof c?(2===d.depthStencilTarget?this._stencilAttachment=m:1===d.depthStencilTarget||3===d.depthStencilTarget?this._depthAttachment=m:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),
b._validateBufferDimensions(m.descriptor,this._desc)):m&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),d=void 0,m instanceof e?(this._depthStencilTexture=m,d=this._depthStencilTexture.descriptor):(d=m,this._depthStencilTexture=new e(this._context,d)),b._validateTextureDimensions(d,this._desc))}b.create=function(a,c){return new b(a,c)};b.createWithAttachments=function(a,
c,e,m){return new b(a,e,c,m)};Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof e?this._colorAttachment:null},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});b.prototype.dispose=function(){this._context&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),
this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),a("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(4),this._context=null)};b.prototype.attachColorTexture=function(a){if(a){b._validateTextureDimensions(a.descriptor,this._desc);this._disposeColorAttachment();if(this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,a.glName,0)}this._colorAttachment=a}};b.prototype.detachColorTexture=
function(){var a=void 0;if(this._colorAttachment instanceof e){a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;this._context.gl.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0)}this._colorAttachment=null}return a};b.prototype.attachDepthStencilTexture=function(a){if(a){var c=a.descriptor;34041!==c.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==c.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");
this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");b._validateTextureDimensions(c,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),c=this._context.gl,c.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,a.glName,0));this._depthStencilTexture=
a}};b.prototype.detachDepthStencilTexture=function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var c=this._context.gl;this._context.gl.framebufferTexture2D(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return a};b.prototype.attachDepthStencilBuffer=function(a){if(a){var c=a.descriptor;34041!==c.internalFormat&&33189!==c.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");
b._validateBufferDimensions(c,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===c.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),c=this._context.gl,c.framebufferRenderbuffer(c.FRAMEBUFFER,1===this._desc.depthStencilTarget?c.DEPTH_ATTACHMENT:c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,a.glName));this._depthAttachment=a}};b.prototype.detachDepthStencilBuffer=function(){var a=this._context.gl,c=this._depthAttachment;c&&this._initialized&&
(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null));this._depthAttachment=null;return c};b.prototype.copyToTexture=function(a,c,b,e,p,g,t){(0>a||0>c||0>p||0>g)&&console.error("Offsets cannot be negative!");(0>=b||0>=e)&&console.error("Copy width and height must be greater than zero!");var d=this._desc,m=t.descriptor;3553!==t.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");
(a+b>d.width||c+e>d.height||p+b>m.width||g+e>m.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");d=this._context;d.bindTexture(t);d.bindFramebuffer(this);d.gl.copyTexSubImage2D(3553,0,p,g,a,c,b,e)};b.prototype.readPixels=function(a,c,b,e,p,g,t){(0>=b||0>=e)&&console.error("Copy width and height must be greater than zero!");t||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(a,
c,b,e,p,g,t)};b.prototype.resize=function(a,c){var d=this._desc;if(d.width!==a||d.height!==c)if(this._initialized)d.width=a,d.height=c,this._colorAttachment instanceof e?(m=this._colorAttachment,d=m.descriptor,d.width=a,d.height=c,this._colorAttachment.dispose(),this._colorAttachment=new e(this._context,d),b._validateTextureDimensions(m.descriptor,this._desc)):this._colorAttachment&&this._disposeColorAttachment(),null!=this._depthStencilTexture?(d=this._depthStencilTexture.descriptor,d.width=a,d.height=
c,this._depthStencilTexture.dispose(),this._depthStencilTexture=new e(this._context,d)):(this._depthAttachment||this._stencilAttachment)&&this._disposeDepthStencilAttachments(),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1;else{d.width=a;d.height=c;if(this._colorAttachment instanceof e){var m=this._colorAttachment;m.resize(a,c)}this._depthStencilTexture&&this._depthStencilTexture.resize(a,c)}};b.prototype.initialize=function(){if(this._initialized)return!1;
var a=this._context.gl;this._glName&&a.deleteFramebuffer(this._glName);var b=a.createFramebuffer(),h=this._desc;a.bindFramebuffer(a.FRAMEBUFFER,b);if(!this._colorAttachment)if(0===h.colorTarget)this._colorAttachment=new e(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:h.width,height:h.height});else{var m=new c(this._context,{internalFormat:32854,width:h.width,height:h.height});a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,
m.glName);this._colorAttachment=m}this._colorAttachment instanceof e&&a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._colorAttachment.glName,0);switch(h.depthStencilTarget){case 1:case 3:this._depthAttachment||(this._depthAttachment=new c(this._context,{internalFormat:1===h.depthStencilTarget?33189:34041,width:h.width,height:h.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,1===h.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this._depthAttachment.glName);
break;case 2:this._stencilAttachment||(this._stencilAttachment=new c(this._context,{internalFormat:36168,width:h.width,height:h.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:this._depthStencilTexture||(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new e(this._context,
{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:h.width,height:h.height})),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,this._depthStencilTexture.glName,0)}a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");this._glName=b;return this._initialized=!0};b.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof e){var a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);
var c=this._context.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0)}a.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(a=this._colorAttachment,c=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(a));this._colorAttachment=null};b.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;this._depthAttachment&&
(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&
(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};b._validateBufferDimensions=function(a,c){console.assert(0<=a.width&&0<=a.height);void 0!==c.width&&0<=c.width&&void 0!==c.height&&0<=c.height?c.width===a.width&&c.height===a.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(c.width=a.width,c.height=a.height)};
b._validateTextureDimensions=function(a,c){console.assert(0<=a.width&&0<=a.height);3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==c.width&&0<=c.width&&void 0!==c.height&&0<=c.height?c.width===a.width&&c.height===a.height||console.error("Color attachment texture must match the framebuffer's!"):(c.width=a.width,c.height=a.height)};b._nextId=0;return b}()})},"esri/layers/vectorTiles/views/webgl/Renderbuffer":function(){define(["require","exports","dojo/has"],function(k,b,
a){return function(){function c(b,g){this._context=b;this._desc=g;this._glName=null;this._id=-1;b=this._context.gl;a("esri-webgl-debug")&&this._context.instanceCounter.incrementCount(5);this._id=++c._nextId;this._glName=b.createRenderbuffer();this._context.bindRenderbuffer(this);b.renderbufferStorage(b.RENDERBUFFER,g.internalFormat,g.width,g.height)}Object.defineProperty(c.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"id",
{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});c.prototype.resize=function(a,c){var b=this._context.gl,d=this._desc;if(d.width!==a||d.height!==c)d.width=a,d.height=c,this._context.bindRenderbuffer(this),b.renderbufferStorage(b.RENDERBUFFER,d.internalFormat,d.width,d.height)};c.prototype.dispose=function(){this._glName&&(this._context.gl.deleteRenderbuffer(this._glName),
this._glName=null);a("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(5);this._context=null};c._nextId=0;return c}()})},"esri/layers/vectorTiles/views/2d/libs/gl-matrix/common":function(){define([],function(){if(!k)var k=1E-6;if(!b)var b="undefined"!==typeof Float32Array?Float32Array:Array;if(!a)var a=Math.random;var c={GLMAT_EPSILON:k,GLMAT_ARRAY_TYPE:b,GLMAT_RANDOM:a,setMatrixArrayType:function(a){c.GLMAT_ARRAY_TYPE=a}},e=Math.PI/180,g=180/Math.PI;c.toRadian=function(a){return a*
e};c.toDegree=function(a){return a*g};c.setMatrixArrayType(Array);return c})},"esri/layers/vectorTiles/views/2d/libs/gl-matrix/mat2d":function(){define(["./common"],function(k){var b=k.GLMAT_ARRAY_TYPE;k={create:function(){var a=new b(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var c=new b(6);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];return c},copy:function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];return a},identity:function(a){a[0]=
1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},invert:function(a,c){var b=c[0],g=c[1],l=c[2],d=c[3],h=c[4];c=c[5];var m=b*d-g*l;if(!m)return null;m=1/m;a[0]=d*m;a[1]=-g*m;a[2]=-l*m;a[3]=b*m;a[4]=(l*c-d*h)*m;a[5]=(g*h-b*c)*m;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,c,b){var e=c[0],l=c[1],d=c[2],h=c[3],m=c[4];c=c[5];var p=b[0],q=b[1],t=b[2],u=b[3],k=b[4];b=b[5];a[0]=e*p+d*q;a[1]=l*p+h*q;a[2]=e*t+d*u;a[3]=l*t+h*u;a[4]=e*k+d*b+m;a[5]=l*k+h*b+c;return a}};k.mul=
k.multiply;k.rotate=function(a,c,b){var e=c[0],l=c[1],d=c[2],h=c[3],m=c[4];c=c[5];var p=Math.sin(b);b=Math.cos(b);a[0]=e*b+d*p;a[1]=l*b+h*p;a[2]=e*-p+d*b;a[3]=l*-p+h*b;a[4]=m;a[5]=c;return a};k.scale=function(a,c,b){var e=c[1],l=c[2],d=c[3],h=c[4],m=c[5],p=b[0];b=b[1];a[0]=c[0]*p;a[1]=e*p;a[2]=l*b;a[3]=d*b;a[4]=h;a[5]=m;return a};k.translate=function(a,c,b){var e=c[0],l=c[1],d=c[2],h=c[3],m=c[4];c=c[5];var p=b[0];b=b[1];a[0]=e;a[1]=l;a[2]=d;a[3]=h;a[4]=e*p+d*b+m;a[5]=l*p+h*b+c;return a};k.fromRotation=
function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=b;a[2]=-b;a[3]=c;a[4]=0;a[5]=0;return a};k.fromScaling=function(a,c){a[0]=c[0];a[1]=0;a[2]=0;a[3]=c[1];a[4]=0;a[5]=0;return a};k.fromTranslation=function(a,c){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=c[0];a[5]=c[1];return a};k.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};k.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],
2)+1)};return k})},"esri/layers/vectorTiles/views/2d/libs/gl-matrix/vec2":function(){define(["./common"],function(k){var b=k.GLMAT_ARRAY_TYPE,a=k.GLMAT_RANDOM,c={create:function(){var a=new b(2);a[0]=0;a[1]=0;return a},clone:function(a){var c=new b(2);c[0]=a[0];c[1]=a[1];return c},fromValues:function(a,c){var e=new b(2);e[0]=a;e[1]=c;return e},copy:function(a,c){a[0]=c[0];a[1]=c[1];return a},set:function(a,c,b){a[0]=c;a[1]=b;return a},add:function(a,c,b){a[0]=c[0]+b[0];a[1]=c[1]+b[1];return a},subtract:function(a,
c,b){a[0]=c[0]-b[0];a[1]=c[1]-b[1];return a}};c.sub=c.subtract;c.multiply=function(a,c,b){a[0]=c[0]*b[0];a[1]=c[1]*b[1];return a};c.mul=c.multiply;c.divide=function(a,c,b){a[0]=c[0]/b[0];a[1]=c[1]/b[1];return a};c.div=c.divide;c.min=function(a,c,b){a[0]=Math.min(c[0],b[0]);a[1]=Math.min(c[1],b[1]);return a};c.max=function(a,c,b){a[0]=Math.max(c[0],b[0]);a[1]=Math.max(c[1],b[1]);return a};c.scale=function(a,c,b){a[0]=c[0]*b;a[1]=c[1]*b;return a};c.scaleAndAdd=function(a,c,b,d){a[0]=c[0]+b[0]*d;a[1]=
c[1]+b[1]*d;return a};c.distance=function(a,c){var b=c[0]-a[0];a=c[1]-a[1];return Math.sqrt(b*b+a*a)};c.dist=c.distance;c.squaredDistance=function(a,c){var b=c[0]-a[0];a=c[1]-a[1];return b*b+a*a};c.sqrDist=c.squaredDistance;c.length=function(a){var c=a[0];a=a[1];return Math.sqrt(c*c+a*a)};c.len=c.length;c.squaredLength=function(a){var c=a[0];a=a[1];return c*c+a*a};c.sqrLen=c.squaredLength;c.negate=function(a,c){a[0]=-c[0];a[1]=-c[1];return a};c.inverse=function(a,c){a[0]=1/c[0];a[1]=1/c[1];return a};
c.normalize=function(a,c){var b=c[0],d=c[1],b=b*b+d*d;0<b&&(b=1/Math.sqrt(b),a[0]=c[0]*b,a[1]=c[1]*b);return a};c.dot=function(a,c){return a[0]*c[0]+a[1]*c[1]};c.cross=function(a,c,b){c=c[0]*b[1]-c[1]*b[0];a[0]=a[1]=0;a[2]=c;return a};c.lerp=function(a,c,b,d){var e=c[0];c=c[1];a[0]=e+d*(b[0]-e);a[1]=c+d*(b[1]-c);return a};c.random=function(c,b){b=b||1;var e=2*a()*Math.PI;c[0]=Math.cos(e)*b;c[1]=Math.sin(e)*b;return c};c.transformMat2=function(a,c,b){var d=c[0];c=c[1];a[0]=b[0]*d+b[2]*c;a[1]=b[1]*
d+b[3]*c;return a};c.transformMat2d=function(a,c,b){var d=c[0];c=c[1];a[0]=b[0]*d+b[2]*c+b[4];a[1]=b[1]*d+b[3]*c+b[5];return a};c.transformMat3=function(a,c,b){var d=c[0];c=c[1];a[0]=b[0]*d+b[3]*c+b[6];a[1]=b[1]*d+b[4]*c+b[7];return a};c.transformMat4=function(a,c,b){var d=c[0];c=c[1];a[0]=b[0]*d+b[4]*c+b[12];a[1]=b[1]*d+b[5]*c+b[13];return a};c.forEach=function(){var a=c.create();return function(c,b,d,e,m,p){b||(b=2);d||(d=0);for(e=e?Math.min(e*b+d,c.length):c.length;d<e;d+=b)a[0]=c[d],a[1]=c[d+
1],m(a,a,p),c[d]=a[0],c[d+1]=a[1];return c}}();c.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};return c})},"esri/layers/vectorTiles/views/support/screenshotUtils":function(){define(["require","exports","../../core/tsSupport/assignHelper"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.adjustScreenshotSettings=function(c,b){c=a({format:"png",quality:100},c);var e,l;c.includePadding?(e=b.width,l=b.height):(e=b.width-b.padding.left-b.padding.right,l=b.height-b.padding.top-b.padding.bottom);
var d=e/l;void 0!==c.width&&void 0===c.height?c.height=c.width/d:void 0!==c.height&&void 0===c.width&&(c.width=d*c.height);void 0!==c.height&&(c.height=Math.floor(c.height));void 0!==c.width&&(c.width=Math.floor(c.width));c.area||c.includePadding||(c.area={x:b.padding.left,y:b.padding.top,width:e,height:l});return c};b.resampleHermite=function(a,b,g,l,d,h,m){void 0===m&&(m=!0);var c=b/d;g/=h;for(var e=Math.ceil(c/2),t=Math.ceil(g/2),u=0;u<h;u++)for(var k=0;k<d;k++){for(var x=4*(k+(m?h-u-1:u)*d),A=
0,z=0,f=0,n=0,r=0,B=0,C=0,D=(u+.5)*g,F=Math.floor(u*g);F<(u+1)*g;F++)for(var H=Math.abs(D-(F+.5))/t,J=(k+.5)*c,H=H*H,I=Math.floor(k*c);I<(k+1)*c;I++){var G=Math.abs(J-(I+.5))/e,A=Math.sqrt(H+G*G);-1<=A&&1>=A&&(A=2*A*A*A-3*A*A+1,0<A&&(G=4*(I+F*b),C+=A*a[G+3],f+=A,255>a[G+3]&&(A=A*a[G+3]/250),n+=A*a[G],r+=A*a[G+1],B+=A*a[G+2],z+=A))}l[x]=n/z;l[x+1]=r/z;l[x+2]=B/z;l[x+3]=C/f}}})},"esri/layers/vectorTiles/views/webgl/context-util":function(){define(["require","exports"],function(k,b){function a(a,c,b){void 0===
c&&(c={});var d;switch(b){case "webgl":d=["webgl","experimental-webgl","webkit-3d","moz-webgl"];break;case "webgl2":d=["webgl2"];break;default:d=["webgl","experimental-webgl","webkit-3d","moz-webgl"]}b=null;for(var e=0;e<d.length;e++){var h=d[e];try{b=a.getContext(h,c)}catch(t){}if(b)break}return b}function c(a,c){(a=a.parentNode)&&(a.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
c+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}Object.defineProperty(b,"__esModule",{value:!0});b.createContextOrErrorHTML=function(b,d,h){void 0===d&&(d={});if(!window.WebGLRenderingContext)return c(b,e),null;d=a(b,d,h);return d?d:(c(b,g),null)};b.createContext=a;var e='This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e',g='It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'})},
"esri/layers/vectorTiles/views/webgl/RenderingContext":function(){define("require exports dojo/has ./enums ./InstanceCounter ./capabilities/isWebGL2Context ./capabilities/load".split(" "),function(k,b,a,c,e,g,l){return function(){function b(b,c){this.gl=null;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=
!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,
zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.contextVersion=g.default(b)?"webgl2":"webgl";this.gl=b;b instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=l.loadCapabilities(b,c);b=this.gl.getParameter(this.gl.VIEWPORT);this._viewport={x:b[0],y:b[1],
width:b[2],height:b[3]};b=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:b?this.gl.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)};a("esri-webgl-debug")&&(this.instanceCounter=new e);
this.enforceState()}Object.defineProperty(b.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0});b.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap={};a("esri-webgl-debug")&&this.instanceCounter.printResourceCount();this.gl=null};b.prototype.setBlendingEnabled=
function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a)};b.prototype.setBlendColor=function(a,b,c,d){if(a!==this._blendColorState.r||b!==this._blendColorState.g||c!==this._blendColorState.b||d!==this._blendColorState.a)this.gl.blendColor(a,b,c,d),this._blendColorState.r=a,this._blendColorState.g=b,this._blendColorState.b=c,this._blendColorState.a=d};b.prototype.setBlendFunction=function(a,b){if(a!==this._blendFunctionState.srcRGB||
b!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,b),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=b};b.prototype.setBlendFunctionSeparate=function(a,b,c,d){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==c||this._blendFunctionState.dstRGB!==b||this._blendFunctionState.dstAlpha!==d)this.gl.blendFuncSeparate(a,b,c,d),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=
c,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=d};b.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a)};b.prototype.setBlendEquationSeparate=function(a,b){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==b)this.gl.blendEquationSeparate(a,b),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=b};b.prototype.setColorMask=
function(a,b,c,d){if(this._colorMaskState.r!==a||this._colorMaskState.g!==b||this._colorMaskState.b!==c||this._colorMaskState.a!==d)this.gl.colorMask(a,b,c,d),this._colorMaskState.r=a,this._colorMaskState.g=b,this._colorMaskState.b=c,this._colorMaskState.a=d};b.prototype.setClearColor=function(a,b,c,d){if(this._clearColor.r!==a||this._clearColor.g!==b||this._clearColor.b!==c||this._clearColor.a!==d)this.gl.clearColor(a,b,c,d),this._clearColor.r=a,this._clearColor.g=b,this._clearColor.b=c,this._clearColor.a=
d};b.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a)};b.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a)};b.prototype.setPolygonOffset=function(a,b){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==
b)this._polygonOffset[0]=a,this._polygonOffset[1]=b,this.gl.polygonOffset(a,b)};b.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a)};b.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a)};b.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};b.prototype.setScissorRect=function(a,
b,c,d){if(this._scissorRect.x!==a||this._scissorRect.y!==b||this._scissorRect.width!==c||this._scissorRect.height!==d)this.gl.scissor(a,b,c,d),this._scissorRect.x=a,this._scissorRect.y=b,this._scissorRect.width=c,this._scissorRect.height=d};b.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a)};b.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),
this._clearDepth=a)};b.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a)};b.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a)};b.prototype.setDepthRange=function(a,b){if(this._depthRange.zNear!==a||this._depthRange.zFar!==b)this.gl.depthRange(a,b),this._depthRange.zNear=a,this._depthRange.zFar=b};b.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==
a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a)};b.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};b.prototype.setStencilFunction=function(a,b,c){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==b||this._stencilFunction.mask!==c)this.gl.stencilFunc(a,b,c),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=b,this._stencilFunction.mask=
c};b.prototype.setStencilFunctionSeparate=function(a,b,c,d){if(this._stencilFunction.face!==a||this._stencilFunction.func!==b||this._stencilFunction.ref!==c||this._stencilFunction.mask!==d)this.gl.stencilFuncSeparate(a,b,c,d),this._stencilFunction.face=a,this._stencilFunction.func=b,this._stencilFunction.ref=c,this._stencilFunction.mask=d};b.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a)};b.prototype.setStencilOp=function(a,
b,c){if(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==c)this.gl.stencilOp(a,b,c),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=b,this._stencilOperation.zPass=c};b.prototype.setStencilOpSeparate=function(a,b,c,d){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==b||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==d)this.gl.stencilOpSeparate(a,b,c,d),this._stencilOperation.face=
a,this._stencilOperation.face=a,this._stencilOperation.fail=b,this._stencilOperation.zFail=c,this._stencilOperation.zPass=d};b.prototype.setLineWidth=function(a){var b=this._lineWidth;this._lineWidth!==a&&(this.gl.lineWidth(a),this._lineWidth=a);return b};b.prototype.setActiveTexture=function(a){var b=this._activeTextureUnit;0<=a&&a!==this._activeTextureUnit&&(this.gl.activeTexture(c.BASE_TEXTURE_UNIT+a),this._activeTextureUnit=a);return b};b.prototype.clear=function(a){a&&this.gl.clear(a)};b.prototype.drawArrays=
function(a,b,c){this.gl.drawArrays(a,b,c)};b.prototype.drawElements=function(a,b,c,d){5123===c?this.gl.drawElements(a,b,c,d):5125===c&&this.gl.drawElements(a,b,c,d)};Object.defineProperty(b.prototype,"capabilities",{get:function(){return this._capabilities},enumerable:!0,configurable:!0});b.prototype.setViewport=function(a,b,c,d){var e=this._viewport;if(e.x!==a||e.y!==b||e.width!==c||e.height!==d)e.x=a,e.y=b,e.width=c,e.height=d,this.gl.viewport(a,b,c,d)};b.prototype.getViewport=function(){return{x:this._viewport.x,
y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};b.prototype.bindProgram=function(a){a?this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),this._activeShaderProgram=null)};b.prototype.bindTexture=function(a,c){void 0===c&&(c=0);-1===b._MAX_TEXTURE_IMAGE_UNITS&&(b._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(c>=b._MAX_TEXTURE_IMAGE_UNITS||0>c)&&console.error("Input texture unit is out of range of available units!");
var d=this._textureUnitMap[c];this.setActiveTexture(c);null==a||null==a.glName?(null!=d&&(this.gl.bindTexture(d.descriptor.target,null),d.setBoundToUnit(c,!1)),this._textureUnitMap[c]=null):d&&d.id===a.id?a.applyChanges():(this.gl.bindTexture(a.descriptor.target,a.glName),a.setBoundToUnit(c,!0),a.applyChanges(),this._textureUnitMap[c]=a)};b.prototype.bindFramebuffer=function(a){a?this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=
a):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null)};b.prototype.bindBuffer=function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))};b.prototype.bindRenderbuffer=function(a){var b=this.gl;a||(b.bindRenderbuffer(b.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==a&&(b.bindRenderbuffer(b.RENDERBUFFER,
a.glName),this._activeRenderbuffer=a)};b.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=b._bindBuffer(this.gl,null,a,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,null,a,this._activeIndexBuffer)};b.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};
b.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};b.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};b.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};b.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,
0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,
0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};b.prototype.enforceState=function(){var a=this.gl,b=this._capabilities.vao;b&&b.bindVertexArray(null);for(var d=0;d<this.parameters.maxVertexAttributes;d++)a.disableVertexAttribArray(d);this._activeVertexBuffer?a.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):
a.bindBuffer(34962,null);this._activeIndexBuffer?a.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):a.bindBuffer(34963,null);if(b&&this._activeVertexArrayObject){if(b=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(b)}a.bindFramebuffer(a.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);a.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);a.blendColor(this._blendColorState.r,
this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);a.bindRenderbuffer(a.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?a.enable(this.gl.BLEND):a.disable(this.gl.BLEND);a.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);a.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);a.clearColor(this._clearColor.r,
this._clearColor.g,this._clearColor.b,this._clearColor.a);a.clearDepth(this._clearDepth);a.clearStencil(this._clearStencil);a.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);a.cullFace(this._cullFace);a.depthFunc(this._depthFunction);a.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST);a.depthMask(this._depthWriteEnabled);a.frontFace(this._frontFace);a.lineWidth(this._lineWidth);
!0===this._polygonCullingEnabled?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE);a.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL);a.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?a.enable(a.SCISSOR_TEST):a.disable(a.SCISSOR_TEST);a.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);
a.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST);a.stencilMask(this._stencilWriteMask);for(b=0;b<this.parameters.maxTextureImageUnits;b++)a.activeTexture(c.BASE_TEXTURE_UNIT+b),a.bindTexture(3553,null),(d=this._textureUnitMap[b])&&a.bindTexture(d.descriptor.target,d.glName);a.activeTexture(c.BASE_TEXTURE_UNIT+this._activeTextureUnit);
a.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};b._bindBuffer=function(a,b,c,d){if(!b)return a.bindBuffer(c,null),null;if(d===b)return d;a.bindBuffer(c,b.glName);return b};b._MAX_TEXTURE_IMAGE_UNITS=-1;return b}()})},"esri/layers/vectorTiles/views/webgl/enums":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.BASE_TEXTURE_UNIT=33984})},"esri/layers/vectorTiles/views/webgl/InstanceCounter":function(){define(["require",
"exports"],function(k,b){return function(){function a(){this._instanceCount={textureCount:0,bufferCount:0,vaoCount:0,programCount:0,framebufferCount:0,renderBufferCount:0}}a.prototype.incrementCount=function(a){switch(a){case 0:this._instanceCount.textureCount++;break;case 1:this._instanceCount.bufferCount++;break;case 2:this._instanceCount.vaoCount++;break;case 3:this._instanceCount.programCount++;break;case 4:this._instanceCount.framebufferCount++;break;case 5:this._instanceCount.renderBufferCount++}};
a.prototype.decrementCount=function(a){switch(a){case 0:this._instanceCount.textureCount--;break;case 1:this._instanceCount.bufferCount--;break;case 2:this._instanceCount.vaoCount--;break;case 3:this._instanceCount.programCount--;break;case 4:this._instanceCount.framebufferCount--;break;case 5:this._instanceCount.renderBufferCount--}};a.prototype.printResourceCount=function(){console.log("Live objects:");console.log("Textures: "+this._instanceCount.textureCount);console.log("Buffers: "+this._instanceCount.bufferCount);
console.log("VAOs: "+this._instanceCount.vaoCount);console.log("Programs: "+this._instanceCount.programCount);console.log("Framebuffers: "+this._instanceCount.framebufferCount);console.log("Renderbuffers: "+this._instanceCount.renderBufferCount)};return a}()})},"esri/layers/vectorTiles/views/webgl/capabilities/isWebGL2Context":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.default=function(a){return window.WebGL2RenderingContext&&a instanceof
window.WebGL2RenderingContext}})},"esri/layers/vectorTiles/views/webgl/capabilities/load":function(){define("require exports ./DisjointTimerQuery ./Instancing ./isWebGL2Context ./VertexArrayObjects".split(" "),function(k,b,a,c,e,g){function l(a,b,c,p,g){if(p&&e.default(a))return!0;if(b[c])return!1;for(b=0;b<g.length;b++)if(a.getExtension(g[b]))return!0;return!1}Object.defineProperty(b,"__esModule",{value:!0});b.loadCapabilities=function(b,h){h=h&&h.disabledExtensions||{};var d=c.load(b,h),p=g.load(b,
h),q;q=h.compressedTextureS3TC?null:(q=b.getExtension("WEBGL_compressed_texture_s3tc"))?{COMPRESSED_RGB_S3TC_DXT1:q.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:q.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:q.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:q.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null;var t;t=h.textureFilterAnisotropic?null:(t=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?
{MAX_TEXTURE_MAX_ANISOTROPY:t.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:t.TEXTURE_MAX_ANISOTROPY_EXT}:null;var u=a.load(b,h),k;if(e.default(b))k=h.colorBufferFloat||!b.getExtension("EXT_color_buffer_float")?null:{R16F:b.R16F,RG16F:b.RG16F,RGBA16F:b.RGBA16F,R32F:b.R32F,RG32F:b.RG32F,RGBA32F:b.RGBA32F,R11F_G11F_B10F:b.R11F_G11F_B10F};else if(b instanceof WebGLRenderingContext){k=!h.colorBufferFloat&&b.getExtension("EXT_color_buffer_half_float");var x=!h.colorBufferFloat&&b.getExtension("WEBGL_color_buffer_float");
k=k||x?{RGBA16F:k?k.RGBA16F_EXT:void 0,RGBA32F:x?x.RGBA32F_EXT:void 0}:null}else k=void 0;x=e.default(b)?{MIN:b.MIN,MAX:b.MAX}:h.blendMinMax?null:(x=b.getExtension("EXT_blend_minmax"))?{MIN:x.MIN_EXT,MAX:x.MAX_EXT}:null;return{instancing:d,vao:p,compressedTextureS3TC:q,textureFilterAnisotropic:t,disjointTimerQuery:u,colorBufferFloat:k,blendMinMax:x,depthTexture:l(b,h,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),standardDerivatives:l(b,h,"standardDerivatives",
!0,["OES_standard_derivatives"]),shaderTextureLOD:l(b,h,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]),textureFloatLinear:l(b,h,"textureFloatLinear",!1,["OES_texture_float_linear"]),fragDepth:l(b,h,"fragDepth",!0,["EXT_frag_depth"])}}})},"esri/layers/vectorTiles/views/webgl/capabilities/DisjointTimerQuery":function(){define(["require","exports","./isWebGL2Context"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.load=function(b,e){if(e.disjointTimerQuery)return null;var c=b.getExtension("EXT_disjoint_timer_query")||
b.getExtension("EXT_disjoint_timer_query_webgl2");return c?a.default(b)?{createQuery:function(){return b.createQuery()},resultAvailable:function(a){return b.getQueryParameter(a,b.QUERY_RESULT_AVAILABLE)},getResult:function(a){return b.getQueryParameter(a,b.QUERY_RESULT)},disjoint:function(){return b.getParameter(c.GPU_DISJOINT_EXT)},beginTimeElapsed:function(a){return b.beginQuery(c.TIME_ELAPSED_EXT,a)},endTimeElapsed:function(){return b.endQuery(c.TIME_ELAPSED_EXT)},createTimestamp:function(a){return c.queryCounterEXT(a,
c.TIMESTAMP_EXT)},timestampBits:function(){return b.getQuery(c.TIMESTAMP_EXT,c.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return c.createQueryEXT()},resultAvailable:function(a){return c.getQueryObjectEXT(a,c.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(a){return c.getQueryObjectEXT(a,c.QUERY_RESULT_EXT)},disjoint:function(){return b.getParameter(c.GPU_DISJOINT_EXT)},beginTimeElapsed:function(a){return c.beginQueryEXT(c.TIME_ELAPSED_EXT,a)},endTimeElapsed:function(){return c.endQueryEXT(c.TIME_ELAPSED_EXT)},
createTimestamp:function(a){return c.queryCounterEXT(a,c.TIMESTAMP_EXT)},timestampBits:function(){return c.getQueryEXT(c.TIMESTAMP_EXT,c.QUERY_COUNTER_BITS_EXT)}}:null}})},"esri/layers/vectorTiles/views/webgl/capabilities/Instancing":function(){define(["require","exports","./isWebGL2Context"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.load=function(b,e){return a.default(b)?{drawArraysInstanced:b.drawArraysInstanced.bind(b),drawElementsInstanced:b.drawElementsInstanced.bind(b),
vertexAttribDivisor:b.vertexAttribDivisor.bind(b)}:e.angleInstancedArrays?null:(b=b.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:b.drawArraysInstancedANGLE.bind(b),drawElementsInstanced:b.drawElementsInstancedANGLE.bind(b),vertexAttribDivisor:b.vertexAttribDivisorANGLE.bind(b)}:null}})},"esri/layers/vectorTiles/views/webgl/capabilities/VertexArrayObjects":function(){define(["require","exports","./isWebGL2Context"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.load=
function(b,e){return a.default(b)?{createVertexArray:b.createVertexArray.bind(b),deleteVertexArray:b.deleteVertexArray.bind(b),bindVertexArray:b.bindVertexArray.bind(b)}:e.vao?null:(b=b.getExtension("OES_vertex_array_object")||b.getExtension("MOZ_OES_vertex_array_object")||b.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:b.createVertexArrayOES.bind(b),deleteVertexArray:b.deleteVertexArrayOES.bind(b),bindVertexArray:b.bindVertexArrayOES.bind(b)}:null}})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLFeatureView":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/extendsHelper ../../../../core/promiseUtils ../../../../core/promiseUtils ../../../../core/libs/gl-matrix/mat4 ../../../../core/libs/gl-matrix/vec3 ../../../../geometry/Point ../Container ../StageGL ../../engine/webgl/TileData ./enums ./GeometryUtils ./TextureManager ./Utils ./WGLPainter ./WGLRendererInfo".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function f(a){var f=b.call(this)||this;f._rendererInfo=new z;f._stage=new p;f._container=null;f._tileCoordinateScale=d.create();f._orientationVec=d.fromValues(0,0,1);f._displayScale=d.create();f._defaultTransform=l.create();f._pointToCallbacks=new Map;f._highlightIDs=new Set;f._tileId=void 0;f._patches={};f._displayWidth=0;f._displayHeight=0;f._highlightOptionsUpToDate=!1;f.layer=null;f.textureManager=
new y;f.highlightOptions=a.highlightOptions;f.tileInfoView=a.tileInfoView;f._stage.useContextVersion("webgl");f.layer=a.layer;f._layerView=a.layerView;return f}c(f,b);f.prototype.dispose=function(){this.textureManager&&(this.textureManager.dispose(),this.textureManager=null);this.removeAllChildren();for(var a=0,b=this.children;a<b.length;a++)b[a].dispose()};f.prototype.disposeWebGLResources=function(){for(var a=0,b=this.children;a<b.length;a++)b[a].clear()};f.prototype.displayWidth=function(){return this._displayWidth};
Object.defineProperty(f.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){this._highlightOptions=a;this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"visualVariablesInfo",{get:function(){return this._visualVariablesInfo},set:function(a){this._visualVariablesInfo=a;this.requestRender()},
enumerable:!0,configurable:!0});f.prototype.install=function(a){a.addChild(this._stage);this._stage.addChild(this);this._container=a};f.prototype.uninstall=function(a){a.removeChild(this._stage);this._stage.removeChild(this);this.dispose();this._container=null};f.prototype.hitTest=function(a,b){var f=this,c=[a,b];return e.create(function(a,b){f._pointToCallbacks.set(c,{resolve:a,reject:b});f.requestRender()},function(){f._pointToCallbacks.has(c)&&f._pointToCallbacks.delete(c)})};f.prototype.highlight=
function(a){var b=this;b.addHighlight(a);return{remove:function(){b.removeHighlight(a)}}};f.prototype.setHighlight=function(a){this._highlightIDs.clear();this.addHighlight(a)};f.prototype.setVisibility=function(a,b){for(var f=function(f){if(f.data){var c=f.data.tileDisplayData.displayObjectRegistry,n=a.filter(function(a){return c.has(a.id)});f.setVisibility(n,b)}},c=0,n=this.children;c<n.length;c++)f(n[c])};f.prototype.setVisibilityRange=function(a,b,f,c){for(var n=0,d=this.children;n<d.length;n++){var r=
d[n];r.data&&r.data.tileDisplayData.displayObjectRegistry.has(a)&&r.setVisibilityRange(a,b,f,c)}};f.prototype.addHighlight=function(a){for(var b=0;b<a.length;b++)this._highlightIDs.add(a[b]);this._buildHLList()};f.prototype.removeHighlight=function(a){for(var b=0;b<a.length;b++)this._highlightIDs.delete(a[b]);this._buildHLList()};f.prototype.getMaterialItems=function(a){if(a&&0!==a.length){for(var b=[],f=0;f<a.length;f++){var c=a[f];b.push(this.textureManager.rasterizeItem(c.symbol,c.glyphIds))}return g.all(b).then(function(a){return a.map(function(a,
b){return{id:b,mosaicItem:a}})})}};f.prototype.onTileData=function(a,b){var f=null;b&&(f=q.decode(b));a.setData(f,null!=this.visualVariablesInfo.vvFields,this.layer.labelsVisible);a.buildHLList(this._highlightIDs);this._layerView&&this._layerView.view.labelManager.requestUpdate();this.addChild(a);this._stage.fadeInLabels();this.requestRender()};f.prototype.onTileDataUpdate=function(a,b){this._patches[a.key.id]=this._patches[a.key.id]||[];this._patches[a.key.id].push({tile:a,patch:b});this._stage.fadeInLabels();
this.requestRender()};f.prototype.onTileError=function(a){a.clear();a.buildHLList(this._highlightIDs);this.addChild(a);this.requestRender()};f.prototype.addChild=function(a){var f=b.prototype.addChild.call(this,a);this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.addTile(this.layer.uid,a);this._buildHLList();return f};f.prototype.removeChild=function(a){var f=b.prototype.removeChild.call(this,a);this.layer.labelingInfo&&this._layerView&&this._layerView.view.labelManager.removeTile(this.layer.uid,
a.key.id);this._buildHLList();return f};f.prototype.prepareChildrenRenderParameters=function(b){this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,b.state);var f=this.tileInfoView.getClosestInfoForScale(b.state.scale).level,c=this.tileInfoView.tileInfo.scaleToZoom(b.state.scale);return a({},b,{rendererInfo:this._rendererInfo,requiredLevel:f,displayLevel:c})};f.prototype.renderChildren=function(a){for(var b=this,f=0;this._nextTile()&&4>f;){for(var c=0,n=this._patches[this._tileId];c<
n.length;c++){var d=n[c];this._patchTileVisuals(d.tile,d.patch)}delete this._patches[this._tileId];++f}f=a.painter;f.bindTextureManager(this.textureManager);this._rendererInfo.updateVisualVariables(this._visualVariablesInfo.vvRanges,a.state);this.sortChildren(function(a,b){return 0!==a.key.level-b.key.level?a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:a.key.col-b.key.col});c=A.default.toWGLDrawPhases(a.drawPhase);if(0<c.length&&c[0]===t.WGLDrawPhase.LABEL||c[0]===t.WGLDrawPhase.LABEL_ALPHA){n=
this.layer;if(!(n.labelsVisible&&n.labelingInfo&&0<n.labelingInfo.length))return;this._updateTilesTransform(a.state,a.requiredLevel);f.update(a.state,a.pixelRatio)}f.draw(a,this.children,c,this._painterOptions);0<this._highlightIDs.size&&f.highlight(a,this.children);0!==this._pointToCallbacks.size&&(this._pointToCallbacks.forEach(function(f,c){f.resolve(b._hitTest(a,c[0],c[1]))}),this._pointToCallbacks.clear())};f.prototype.attachChild=function(a,b){return a.attach(b)};f.prototype.detachChild=function(a,
b){a.detach(b)};f.prototype.renderChild=function(a,b){a.doRender(b)};f.prototype.beforeRenderChildren=function(a,b){this._updateTilesTransform(a.state,this.tileInfoView.getClosestInfoForScale(a.state.scale).level);this._updateHighlightOptions();this._stage.opacity=this._container.opacity};f.prototype._hitTest=function(a,b,f){var c=a.painter,n=a.requiredLevel,d=[0,0];a.state.toMap(d,[b,f]);b=a.state.clone();f=b.viewpoint.clone();f.targetGeometry=new h(d[0],d[1],a.state.spatialReference);b.viewpoint=
f;b.size=[x.C_HITTEST_SEARCH_SIZE,x.C_HITTEST_SEARCH_SIZE];this._updateTilesTransform(b,n);c.update(b,a.pixelRatio);return c.hitTest({context:a.context,drawPhase:t.WGLDrawPhase.HITTEST,painter:c,pixelRatio:a.pixelRatio,displayLevel:a.displayLevel,rendererInfo:this._rendererInfo,requiredLevel:n,state:b,stationary:a.stationary},this.children)};f.prototype._updateTilesTransform=function(a,b){var f=1/a.width,c=1/a.height,n=[0,0];this._calculateRelativeViewProjMat(this.tileInfoView.tileInfo.lods[b].resolution,
a.resolution,a.rotation,this.tileInfoView.tileInfo.size[0],a.width,a.height,this._defaultTransform);for(var d=0,r=this.children;d<r.length;d++){var e=r[d];a.toScreen(n,e.coords);n[1]=a.height-n[1];e.tileTransform.displayCoord[0]=2*n[0]*f-1;e.tileTransform.displayCoord[1]=2*n[1]*c-1;e.key.level===b?e.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this.tileInfoView.tileInfo.lods[e.key.level].resolution,a.resolution,a.rotation,this.tileInfoView.tileInfo.size[0],
a.width,a.height,e.tileTransform.transform)}};f.prototype._calculateRelativeViewProjMat=function(a,b,f,c,n,d,e){a/=b;this._tileCoordinateScale.set([a,a,1]);if(n!==this._displayWidth||d!==this._displayHeight)this._displayScale.set([2/n,-2/d,1]),this._displayWidth=n,this._displayHeight=d;l.identity(e);l.scale(e,e,this._tileCoordinateScale);l.rotate(e,e,-f*u.C_DEG_TO_RAD,this._orientationVec);l.scale(e,e,this._displayScale);l.transpose(e,e)};f.prototype._updateHighlightOptions=function(){if(!this._highlightOptionsUpToDate&&
this.parent){var a=this.parent.glPainter,b=this._highlightOptions;if(a){var f=b.color.toRgba();f[0]/=255;f[1]/=255;f[2]/=255;var c=f.slice();f[3]*=b.fillOpacity;c[3]*=b.haloOpacity;a.setHighlightOptions({fillColor:f,outlineColor:c,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0})}}};f.prototype._buildHLList=function(){for(var a=0,b=this.children;a<b.length;a++)b[a].buildHLList(this._highlightIDs);this.requestRender()};f.prototype._nextTile=function(){var a=Object.keys(this._patches);
if(0===a.length)return this._tileId=void 0,!1;if(!this._tileId)return this._tileId=a[0],!0;var b=a.indexOf(this._tileId),b=(b+1)%a.length;this._tileId=a[b];return!0};f.prototype._patchTileVisuals=function(a,b){var f=b.addOrUpdate?q.decode(b.addOrUpdate):null;a.patchData({remove:b.remove||[],addOrUpdate:f},this.layer.labelsVisible);a.buildHLList(this._highlightIDs);this.contains(a)||this.addChild(a)};return f}(m);b.default=k})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec3":function(){define(["./common"],
function(k){var b={create:function(){var a=new k.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new k.ARRAY_TYPE(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,e){var c=new k.ARRAY_TYPE(3);c[0]=a;c[1]=b;c[2]=e;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,e,g){a[0]=b;a[1]=e;a[2]=g;return a},add:function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];a[2]=b[2]+e[2];return a},subtract:function(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];
a[2]=b[2]-e[2];return a}};b.sub=b.subtract;b.multiply=function(a,b,e){a[0]=b[0]*e[0];a[1]=b[1]*e[1];a[2]=b[2]*e[2];return a};b.mul=b.multiply;b.divide=function(a,b,e){a[0]=b[0]/e[0];a[1]=b[1]/e[1];a[2]=b[2]/e[2];return a};b.div=b.divide;b.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a};b.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};b.min=function(a,b,e){a[0]=Math.min(b[0],e[0]);a[1]=Math.min(b[1],e[1]);
a[2]=Math.min(b[2],e[2]);return a};b.max=function(a,b,e){a[0]=Math.max(b[0],e[0]);a[1]=Math.max(b[1],e[1]);a[2]=Math.max(b[2],e[2]);return a};b.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};b.scale=function(a,b,e){a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;return a};b.scaleAndAdd=function(a,b,e,g){a[0]=b[0]+e[0]*g;a[1]=b[1]+e[1]*g;a[2]=b[2]+e[2]*g;return a};b.distance=function(a,b){var c=b[0]-a[0],g=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*c+g*g+a*a)};b.dist=
b.distance;b.squaredDistance=function(a,b){var c=b[0]-a[0],g=b[1]-a[1];a=b[2]-a[2];return c*c+g*g+a*a};b.sqrDist=b.squaredDistance;b.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};b.len=b.length;b.squaredLength=function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};b.sqrLen=b.squaredLength;b.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};b.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};b.normalize=function(a,b){var c=b[0],g=b[1],
l=b[2],c=c*c+g*g+l*l;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};b.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};b.cross=function(a,b,e){var c=b[0],l=b[1];b=b[2];var d=e[0],h=e[1];e=e[2];a[0]=l*e-b*h;a[1]=b*d-c*e;a[2]=c*h-l*d;return a};b.lerp=function(a,b,e,g){var c=b[0],d=b[1];b=b[2];a[0]=c+g*(e[0]-c);a[1]=d+g*(e[1]-d);a[2]=b+g*(e[2]-b);return a};b.hermite=function(a,b,e,g,l,d){var c=d*d,m=c*(2*d-3)+1,p=c*(d-2)+d,q=c*(d-1);d=c*(3-2*d);a[0]=b[0]*m+e[0]*p+g[0]*q+
l[0]*d;a[1]=b[1]*m+e[1]*p+g[1]*q+l[1]*d;a[2]=b[2]*m+e[2]*p+g[2]*q+l[2]*d;return a};b.bezier=function(a,b,e,g,l,d){var c=1-d,m=c*c,p=d*d,q=m*c,m=3*d*m,c=3*p*c;d*=p;a[0]=b[0]*q+e[0]*m+g[0]*c+l[0]*d;a[1]=b[1]*q+e[1]*m+g[1]*c+l[1]*d;a[2]=b[2]*q+e[2]*m+g[2]*c+l[2]*d;return a};b.random=function(a,b){b=b||1;var c=2*k.RANDOM()*Math.PI,g=2*k.RANDOM()-1,l=Math.sqrt(1-g*g)*b;a[0]=Math.cos(c)*l;a[1]=Math.sin(c)*l;a[2]=g*b;return a};b.transformMat4=function(a,b,e){var c=b[0],l=b[1];b=b[2];var d=e[3]*c+e[7]*l+
e[11]*b+e[15],d=d||1;a[0]=(e[0]*c+e[4]*l+e[8]*b+e[12])/d;a[1]=(e[1]*c+e[5]*l+e[9]*b+e[13])/d;a[2]=(e[2]*c+e[6]*l+e[10]*b+e[14])/d;return a};b.transformMat3=function(a,b,e){var c=b[0],l=b[1];b=b[2];a[0]=c*e[0]+l*e[3]+b*e[6];a[1]=c*e[1]+l*e[4]+b*e[7];a[2]=c*e[2]+l*e[5]+b*e[8];return a};b.transformQuat=function(a,b,e){var c=b[0],l=b[1],d=b[2];b=e[0];var h=e[1],m=e[2];e=e[3];var p=e*c+h*d-m*l,q=e*l+m*c-b*d,t=e*d+b*l-h*c,c=-b*c-h*l-m*d;a[0]=p*e+c*-b+q*-m-t*-h;a[1]=q*e+c*-h+t*-b-p*-m;a[2]=t*e+c*-m+p*-h-
q*-b;return a};b.rotateX=function(a,b,e,g){var c=[],d=[];c[0]=b[0]-e[0];c[1]=b[1]-e[1];c[2]=b[2]-e[2];d[0]=c[0];d[1]=c[1]*Math.cos(g)-c[2]*Math.sin(g);d[2]=c[1]*Math.sin(g)+c[2]*Math.cos(g);a[0]=d[0]+e[0];a[1]=d[1]+e[1];a[2]=d[2]+e[2];return a};b.rotateY=function(a,b,e,g){var c=[],d=[];c[0]=b[0]-e[0];c[1]=b[1]-e[1];c[2]=b[2]-e[2];d[0]=c[2]*Math.sin(g)+c[0]*Math.cos(g);d[1]=c[1];d[2]=c[2]*Math.cos(g)-c[0]*Math.sin(g);a[0]=d[0]+e[0];a[1]=d[1]+e[1];a[2]=d[2]+e[2];return a};b.rotateZ=function(a,b,e,g){var c=
[],d=[];c[0]=b[0]-e[0];c[1]=b[1]-e[1];c[2]=b[2]-e[2];d[0]=c[0]*Math.cos(g)-c[1]*Math.sin(g);d[1]=c[0]*Math.sin(g)+c[1]*Math.cos(g);d[2]=c[2];a[0]=d[0]+e[0];a[1]=d[1]+e[1];a[2]=d[2]+e[2];return a};b.forEach=function(){var a=b.create();return function(b,e,g,l,d,h){e||(e=3);g||(g=0);for(l=l?Math.min(l*e+g,b.length):b.length;g<l;g+=e)a[0]=b[g],a[1]=b[g+1],a[2]=b[g+2],d(a,a,h),b[g]=a[0],b[g+1]=a[1],b[g+2]=a[2];return b}}();b.angle=function(a,c){a=b.fromValues(a[0],a[1],a[2]);c=b.fromValues(c[0],c[1],c[2]);
b.normalize(a,a);b.normalize(c,c);c=b.dot(a,c);return 1<c?0:Math.acos(c)};b.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};b.equals=function(a,b){var c=a[0],g=a[1];a=a[2];var l=b[0],d=b[1];b=b[2];return Math.abs(c-l)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(l))&&Math.abs(g-d)<=k.EPSILON*Math.max(1,Math.abs(g),Math.abs(d))&&Math.abs(a-b)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return b})},"esri/layers/vectorTiles/geometry/Point":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Logger ../core/accessorSupport/decorators ./Geometry ./SpatialReference ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m){function p(a){return a&&("esri.geometry.SpatialReference"===a.declaredClass||null!=a.wkid)}var q=[0,0],t=e.getLogger("esri.geometry.Point");k=function(b){function e(a,c,f,n,d){a=b.call(this)||this;a.x=0;a.y=0;a.z=void 0;a.m=void 0;a.type="point";return a}a(e,b);l=e;e.copy=function(a,b){b.x=a.x;b.y=a.y;b.z=a.z;b.m=a.m;b.spatialReference=Object.isFrozen(a.spatialReference)?a.spatialReference:a.spatialReference.clone()};e.distance=function(a,b){var f=a.x-b.x,c=a.y-b.y;a=
a.hasZ&&b.hasZ?a.z-b.z:0;return Math.sqrt(f*f+c*c+a*a)};e.prototype.normalizeCtorArgs=function(a,b,f,c,r){var n;if(Array.isArray(a))n=a,r=b,a=n[0],b=n[1],f=n[2],c=n[3];else if(a&&"object"===typeof a){if(n=a,a=null!=n.x?n.x:n.longitude,b=null!=n.y?n.y:n.latitude,f=null!=n.z?n.z:n.altitude,c=n.m,(r=n.spatialReference)&&"esri.geometry.SpatialReference"!==r.declaredClass&&(r=new d(r)),null!=n.longitude||null!=n.latitude)null==n.longitude?t.warn(".longitude\x3d","Latitude was defined without longitude"):
null==n.latitude?t.warn(".latitude\x3d","Longitude was defined without latitude"):!n.declaredClass&&r&&r.isWebMercator&&(b=m.lngLatToXY(n.longitude,n.latitude,q),a=b[0],b=b[1])}else p(f)?(r=f,f=null):p(c)&&(r=c,c=null);a={x:a,y:b};null!=r&&(a.spatialReference=r);null!=f&&(a.z=f);null!=c&&(a.m=c);return a};Object.defineProperty(e.prototype,"hasM",{get:function(){return void 0!==this.m},set:function(a){var b=this._get("hasM");a!==b&&(this._set("m",a?0:void 0),this._set("hasM",a))},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"hasZ",{get:function(){return void 0!==this.z},set:function(a){var b=this._get("hasZ");a!==b&&(this._set("z",a?0:void 0),this._set("hasZ",a))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"latitude",{get:function(){var a=this._get("spatialReference");if(a){if(a.isWebMercator)return m.xyToLngLat(this.x,this.y,q)[1];if(a.isWGS84)return this._get("y")}return null},set:function(a){var b=this._get("spatialReference");b&&(b.isWebMercator?this._set("y",
m.lngLatToXY(this.x,a,q)[1]):b.isWGS84&&this._set("y",a),this._set("latitude",a))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"longitude",{get:function(){var a=this._get("spatialReference");if(a){if(a.isWebMercator)return m.xyToLngLat(this._get("x"),this._get("y"),q)[0];if(a.isWGS84)return this._get("x")}return null},set:function(a){var b=this._get("spatialReference");b&&(b.isWebMercator?this._set("x",m.lngLatToXY(a,this._get("y"),q)[0]):b.isWGS84&&this._set("x",a),this._set("longitude",
a))},enumerable:!0,configurable:!0});e.prototype.clone=function(){var a=new l;a.x=this.x;a.y=this.y;a.z=this.z;a.m=this.m;a.spatialReference=this.spatialReference;return a};e.prototype.copy=function(a){l.copy(a,this);return this};e.prototype.equals=function(a){if(!a)return!1;var b=this.x,f=this.y,c=this.z,d=this.m,e=this.spatialReference,p=a.z,h=a.m,g=a.x,l=a.y;a=a.spatialReference;if(!e.equals(a))if(e.isWebMercator&&a.isWGS84)l=m.lngLatToXY(g,l),g=l[0],l=l[1],a=e;else if(e.isWGS84&&a.isWebMercator)l=
m.xyToLngLat(g,l),g=l[0],l=l[1],a=e;else return!1;return b===g&&f===l&&c===p&&d===h&&e.wkid===a.wkid};e.prototype.offset=function(a,b,f){this.x+=a;this.y+=b;null!=f&&this.hasZ&&(this.z+=f);return this};e.prototype.normalize=function(){if(!this.spatialReference)return this;var a=h.getInfo(this.spatialReference);if(!a)return this;var b=this.x,f=a.valid,a=f[0],c=f[1],f=2*c;b>c?(a=Math.ceil(Math.abs(b-c)/f),b-=a*f):b<a&&(a=Math.ceil(Math.abs(b-a)/f),b+=a*f);this._set("x",b);return this};e.prototype.distance=
function(a){return l.distance(this,a)};e.prototype.toArray=function(){var a=this.hasZ,b=this.hasM;return a&&b?[this.x,this.y,this.z,this.m]:a?[this.x,this.y,this.z]:b?[this.x,this.y,this.m]:[this.x,this.y]};e.prototype.toJSON=function(a){return this.write(null,a)};c([g.property({dependsOn:["x","y","z","m","spatialReference"]})],e.prototype,"cache",void 0);c([g.property({type:Boolean,dependsOn:["m"],json:{write:{enabled:!1,overridePolicy:null}}})],e.prototype,"hasM",null);c([g.property({type:Boolean,
dependsOn:["z"],json:{write:{enabled:!1,overridePolicy:null}}})],e.prototype,"hasZ",null);c([g.property({type:Number,dependsOn:["y"]})],e.prototype,"latitude",null);c([g.property({type:Number,dependsOn:["x"]})],e.prototype,"longitude",null);c([g.property({type:Number,json:{write:{isRequired:!0}}})],e.prototype,"x",void 0);c([g.property({type:Number,json:{write:!0}})],e.prototype,"y",void 0);c([g.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],e.prototype,
"z",void 0);c([g.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],e.prototype,"m",void 0);return e=l=c([g.subclass("esri.geometry.Point")],e);var l}(g.declared(l));k.prototype.toJSON.isDefaultToJSON=!0;return k})},"esri/layers/vectorTiles/core/tsSupport/declareExtendsHelper":function(){define(["require","exports"],function(k,b){return function(a,b){a.__bases__=b.__bases__}})},"esri/layers/vectorTiles/core/tsSupport/decorateHelper":function(){define([],function(){return function(k,
b,a,c){var e=arguments.length,g=3>e?b:null===c?c=Object.getOwnPropertyDescriptor(b,a):c,l;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)g=Reflect.decorate(k,b,a,c);else for(var d=k.length-1;0<=d;d--)if(l=k[d])g=(3>e?l(g):3<e?l(b,a,g):l(b,a))||g;return 3<e&&g&&Object.defineProperty(b,a,g),g}})},"esri/layers/vectorTiles/core/accessorSupport/decorators":function(){define("require exports ./decorators/aliasOf ./decorators/autoDestroy ./decorators/cast ./decorators/declared ./decorators/property ./decorators/reader ./decorators/shared ./decorators/subclass ./decorators/writer".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p){function q(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0});q(a);q(c);q(e);q(g);q(l);q(d);q(h);q(m);q(p)})},"esri/layers/vectorTiles/core/accessorSupport/decorators/aliasOf":function(){define(["require","exports","../metadata"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.aliasOf=function(b){return function(c,g){a.getPropertyMetadata(c,g).aliasOf=b}}})},"esri/layers/vectorTiles/core/accessorSupport/metadata":function(){define(["require",
"exports"],function(k,b){function a(a){return null!=a.__accessorMetadata__}function c(b){return a(b)&&null!=e(b).properties}function e(a){a.__accessorMetadata__||Object.defineProperty(a,"__accessorMetadata__",{value:{},enumerable:!0,configurable:!0,writable:!0});return a.__accessorMetadata__}function g(a){a=e(a);var b=a.properties;b||(b=a.properties={});return b}function l(a,b){var c=e(a);a=c.parameters;a||(a=c.parameters={});c=a[b];c||(c=[],a[b]=c);return c}Object.defineProperty(b,"__esModule",{value:!0});
b.hasMetadata=a;b.hasPropertiesMetadata=c;b.hasPropertyMetadata=function(a,b){return c(a)&&null!=g(a)[b]};b.hasParametersMetadata=function(b,c){return a(b)&&null!=e(b).parameters&&null!=e(b).parameters[c]};b.getMetadata=e;b.getPropertiesMetadata=g;b.getPropertyMetadata=function(a,b){a=g(a);var c=a[b];c||(c=a[b]={});return c};b.setPropertyMetadata=function(a,b,c){g(a)[b]=c};b.getParametersMetadata=l;b.getParameterMetadata=function(a,b,c){var d=l(a,b)[c];d||(l(a,b)[c]=d={index:c});return d}})},"esri/layers/vectorTiles/core/accessorSupport/decorators/autoDestroy":function(){define(["require",
"exports","../metadata"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.autoDestroy=function(){return function(b,e,g){a.getMetadata(b).autoDestroy=!0;return b[e]}}})},"esri/layers/vectorTiles/core/accessorSupport/decorators/cast":function(){define(["require","exports","../ensureType","../metadata"],function(k,b,a,c){function e(b){var c="_meta"in b?a.ensureType(b):b;return function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a.push(c);return"number"===typeof a[2]?
l.apply(this,a):g.apply(this,a)}}function g(a,b,d,e){c.getPropertyMetadata(a,b).cast=e}function l(a,b,d,e){c.getParameterMetadata(a,b,d).cast=e}function d(a){return function(b,d,e){c.getPropertyMetadata(b,a).cast=b[d]}}Object.defineProperty(b,"__esModule",{value:!0});var h=Object.prototype.toString;b.autocastMethod=function(a,b,d){if(c.hasParametersMetadata(a,b)){var e=c.getParametersMetadata(a,b).filter(function(a){return null!=a.cast});if(e.length){var m=d.value;d.value=function(){for(var a=[],
b=0;b<arguments.length;b++)a[b]=arguments[b];for(b=0;b<e.length;b++){var c=e[b];a[c.index]=c.cast(a[c.index])}return m.apply(this,a)};return d}console.warn("Method "+a.declaredClass+"::"+b+" is decorated with @cast but no parameters are decorated")}};b.cast=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(3!==a.length||"string"!==typeof a[1]){if(1===a.length&&"[object Function]"===h.call(a[0]))return e(a[0]);if(1===a.length&&"string"===typeof a[0])return d(a[0])}}})},"esri/layers/vectorTiles/core/accessorSupport/ensureType":function(){define(["require",
"exports","../Logger"],function(k,b,a){function c(a,b){return b.isInstanceOf?b.isInstanceOf(a):b instanceof a}function e(a){return null==a?a:new Date(a)}function g(a){return null==a?a:!!a}function l(a){return null==a?a:a.toString()}function d(a){return null==a?a:parseFloat(a)}function h(a){return null==a?a:Math.round(parseFloat(a))}function m(a){return a&&a.constructor&&void 0!==a.constructor._meta}function p(a,b){return null!=b&&a&&!c(a,b)}function q(a,b){p(a,b)&&(m(b)?f.error("Accessor#set","Assigning an instance of '"+
(b.declaredClass||"unknown")+"' which is not a subclass of '"+(a&&a.prototype&&a.prototype.declaredClass||"unknown")+"'"):b=new a(b));return b}function t(a){switch(a){case Number:return d;case n:return h;case Boolean:return g;case String:return l;case Date:return e;default:return q.bind(null,a)}}function u(a,b){var f=t(a);return 1===arguments.length?f:f(b)}function y(a,b){return 1===arguments.length?y.bind(null,a):b?Array.isArray(b)?b.map(a):[a(b)]:b}function x(a,b,f){return 0!==b&&Array.isArray(f)?
f.map(function(f){return x(a,b-1,f)}):a(f)}function A(a,b,f){if(2===arguments.length)return A.bind(null,a,b);if(!f)return f;f=x(a,b,f);for(var c=b,n=f;0<c&&Array.isArray(n);)c--,n=n[0];if(void 0!==n)for(n=0;n<c;n++)f=[f];return f}function z(a,b){if(2===arguments.length)return z(a).call(null,b);var c={},n=[],d=[],r;for(r in a.typeMap){var e=a.typeMap[r];c[r]=u(e);n.push(e&&e.prototype&&e.prototype.declaredClass||"unknown");d.push(r)}var h="string"===typeof a.key?function(b){return b[a.key]}:a.key;
return function(b){if(a.base&&!p(a.base,b))return b;var r=h(b)||a.defaultKeyValue,e=c[r];if(!e)return f.error("Accessor#set","Invalid property value, value needs to be one of "+("'"+n.join("', '")+"'")+", or a plain object that can auto-cast (having .type \x3d "+("'"+d.join("', '")+"'")+")"),null;if(!p(a.typeMap[r],b))return b;if("string"!==typeof a.key||m(b))return e(b);var r={},B;for(B in b)B!==a.key&&(r[B]=b[B]);return e(r)}}Object.defineProperty(b,"__esModule",{value:!0});var f=a.getLogger("esri.core.Accessor");
b.isInstanceOf=c;b.ensureDate=e;b.ensureBoolean=g;b.ensureString=l;b.ensureNumber=d;b.ensureInteger=h;b.isClassedType=m;b.requiresType=p;b.ensureClass=q;b.ensureType=u;b.ensureArrayTyped=y;b.ensureArray=function(a,b){return 1===arguments.length?y(u.bind(null,a)):y(u.bind(null,a),b)};b.ensureNArrayTyped=A;b.ensureNArray=function(a,b,f){return 2===arguments.length?A(u.bind(null,a),b):A(u.bind(null,a),b,f)};b.ensureOneOfType=z;var n=function(){return function(){}}();b.Integer=n;b.default=u})},"esri/layers/vectorTiles/core/accessorSupport/decorators/declared":function(){define(["require",
"exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.declared=function(a){for(var b=[],e=1;e<arguments.length;e++)b[e-1]=arguments[e];e=function(){return this||{}};e.__bases__=[a].concat(b);return e}})},"esri/layers/vectorTiles/core/accessorSupport/decorators/property":function(){define("require exports dojo/has ../../lang ../../Logger ../metadata".split(" "),function(k,b,a,c,e,g){Object.defineProperty(b,"__esModule",{value:!0});var l=e.getLogger("esri.core.accessorSupport.decorators.property");
b.property=function(b){void 0===b&&(b={});return function(d,e){var m=d.constructor.prototype;if(m===Function.prototype)a("dojo-debug-messages")&&l.error("Inappropriate use of @property() on a static field: "+d.name+"."+e+". Accessor does not support static properties.");else{var h=Object.getOwnPropertyDescriptor(d,e);h&&(h.get||h.set)?(b=c.clone(b),h.set&&(b.set=h.set),h.get&&(b.get=h.get)):h&&h.hasOwnProperty("value")&&(b=c.clone(b),a("dojo-debug-messages")&&b.hasOwnProperty("value")&&l.warn('@property() will redefine the value of "'+
e+'" on "'+d.constructor.name+'" already defined in the metadata',b),b.value=h.value);d=g.getPropertyMetadata(m,e);for(var t in b)e=b[t],Array.isArray(e)?d[t]=(d[t]||[]).concat(e):d[t]=e}}};b.propertyJSONMeta=function(a,b,c){a=g.getPropertyMetadata(a.constructor.prototype,c);a.json||(a.json={});a=a.json;void 0!==b&&(a.origins||(a.origins={}),a.origins[b]||(a.origins[b]={}),a=a.origins[b]);return a}})},"esri/layers/vectorTiles/core/accessorSupport/decorators/reader":function(){define(["require","exports",
"../../object","./property"],function(k,b,a,c){Object.defineProperty(b,"__esModule",{value:!0});b.reader=function(b,g,l){var d,e;void 0===g||Array.isArray(g)?(e=b,l=g,d=[void 0]):(e=g,d=Array.isArray(b)?b:[b]);return function(b,p,h){var m=b.constructor.prototype;d.forEach(function(d){d=c.propertyJSONMeta(b,d,e);d.read&&"object"!==typeof d.read&&(d.read={});a.setDeepValue("read.reader",m[p],d);l&&(d.read.source=(d.read.source||[]).concat(l))})}}})},"esri/layers/vectorTiles/core/object":function(){define(["require",
"exports"],function(k,b){function a(a,b,g){for(var c=0;c<a.length;c++){var d=a[c];if(!(d in g))if(b)g[d]={};else return;g=g[d]}return g}Object.defineProperty(b,"__esModule",{value:!0});b.getDeepValue=function(b,e){return a(b.split("."),!1,e)};b.setDeepValue=function(b,e,g){var c=b.split(".");b=c.pop();(g=a(c,!0,g))&&b&&(g[b]=e)}})},"esri/layers/vectorTiles/core/accessorSupport/decorators/shared":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});
b.shared=function(a){return function(b,e){b[e]=a}}})},"esri/layers/vectorTiles/core/accessorSupport/decorators/subclass":function(){define(["require","exports","../../declare","../metadata"],function(k,b,a,c){function e(a,b){a.read&&("function"===typeof a.read?b.push(a.read):"object"===typeof a.read&&a.read.reader&&b.push(a.read.reader))}function g(a,b){a.write&&("function"===typeof a.write?b.push(a.write):"object"===typeof a.write&&a.write.writer&&b.push(a.write.writer))}function l(a){var b=[];a=
c.getPropertiesMetadata(a.prototype);if(!a)return b;for(var d in a){var m=a[d];m.cast&&b.push(m.cast);m.copy&&b.push(m.copy);if(m=m.json)if(e(m,b),g(m,b),m=m.origins)for(var p in m){var h=m[p];e(h,b);g(h,b)}}return b}function d(a){var b={values:{},descriptors:{}},d=["__bases__"],e=c.getPropertiesMetadata(a.prototype),p=l(a);Object.getOwnPropertyNames(a.prototype).filter(function(b){return-1!==d.indexOf(b)||e&&e.hasOwnProperty(b)||!m(Object.getOwnPropertyDescriptor(a.prototype,b))&&-1!==p.indexOf(a.prototype[b])?
!1:!0}).forEach(function(c){var d=Object.getOwnPropertyDescriptor(a.prototype,c);m(d)?b.descriptors[c]=d:b.values[c]=a.prototype[c]});return b}function h(a){var b=Object.getOwnPropertyNames(a),c=Object.getPrototypeOf(a.prototype).constructor,d=Object.getOwnPropertyNames(Function);d.push("__bases__");var e=Object.getOwnPropertyNames(c),p={values:{},descriptors:{}};b.filter(function(b){return-1!==d.indexOf(b)?!1:-1===e.indexOf(b)||c[b]!==a[b]?!0:!1}).forEach(function(b){var c=Object.getOwnPropertyDescriptor(a,
b);m(c)?p.descriptors[b]=c:p.values[b]=a[b]});return p}function m(a){return a&&!(!a.get&&!a.set)}Object.defineProperty(b,"__esModule",{value:!0});b.subclass=function(b){return function(c){var e=d(c),m=h(c);null!=b&&(e.values.declaredClass=b);c=a(c.__bases__,e.values);Object.defineProperties(c.prototype,e.descriptors);for(var p in m.values)c[p]=m.values[p];Object.defineProperties(c,m.descriptors);return c}}})},"esri/layers/vectorTiles/core/declare":function(){define(["require","exports","dojo/_base/declare"],
function(k,b,a){function c(a,b){a&&!Array.isArray(a)&&"function"!==typeof a&&(b=a,a=null);a=a||[];b=b||{};return e([this].concat(a),b)}function e(b,e){b&&!Array.isArray(b)&&"function"!==typeof b&&(e=b,b=null);"function"===typeof b?b=[b]:b||(b=[]);e=e||{};var d,p;d=0;for(p=g.length;d<p;d++)g[d](b,e);b=a(b,e);b.createSubclass=c;d=0;for(p=l.length;d<p;d++)l[d](b);return b}var g=[],l=[];(function(b){b.hasMixin=function(a,b){a=Array.isArray(a)?a.reduce(function(a,b){return b._meta?a.concat(b._meta.bases):
a},[]):a._meta?a._meta.bases:a;if(!a)return!1;if("string"===typeof b)for(var c=a.length-1;0<=c;c--)if(a[c].prototype.declaredClass===b)return!0;return-1!==a.indexOf(b)};b.safeMixin=function(b,c){return a.safeMixin(b,c)};b.before=function(a){g.push(a)};b.after=function(a){l.push(a)}})(e||(e={}));return e})},"esri/layers/vectorTiles/core/accessorSupport/decorators/writer":function(){define(["require","exports","../../object","./property"],function(k,b,a,c){Object.defineProperty(b,"__esModule",{value:!0});
b.writer=function(b,g,l){var d,e;void 0===g?(e=b,d=[void 0]):"string"!==typeof g?(e=b,d=[void 0],l=g):(e=g,d=Array.isArray(b)?b:[b]);return function(b,p,h){var m=b.constructor.prototype;d.forEach(function(d){d=c.propertyJSONMeta(b,d,e);d.write&&"object"!==typeof d.write&&(d.write={});l&&a.setDeepValue("write.target",l,d);a.setDeepValue("write.writer",m[p],d)})}}})},"esri/layers/vectorTiles/geometry/Geometry":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./SpatialReference".split(" "),
function(k,b,a,c,e,g,l){return function(b){function d(){var a=b.call(this)||this;a.type=null;a.extent=null;a.hasM=!1;a.hasZ=!1;a.spatialReference=l.WGS84;return a}a(d,b);Object.defineProperty(d.prototype,"cache",{get:function(){return{}},enumerable:!0,configurable:!0});d.prototype.clone=function(){console.warn(".clone() is not implemented for "+this.declaredClass);return null};d.prototype.clearCache=function(){this.notifyChange("cache")};d.prototype.getCacheValue=function(a){return this.cache[a]};
d.prototype.setCacheValue=function(a,b){this.cache[a]=b};c([g.property()],d.prototype,"type",void 0);c([g.property({readOnly:!0,dependsOn:["spatialReference"]})],d.prototype,"cache",null);c([g.property({readOnly:!0,dependsOn:["spatialReference"]})],d.prototype,"extent",void 0);c([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],d.prototype,"hasM",void 0);c([g.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],d.prototype,
"hasZ",void 0);c([g.property({type:l,json:{write:!0}})],d.prototype,"spatialReference",void 0);return d=c([g.subclass("esri.geometry.Geometry")],d)}(g.declared(e))})},"esri/layers/vectorTiles/core/JSONSupport":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./declare ./accessorSupport/decorators ./accessorSupport/read ./accessorSupport/write".split(" "),function(k,b,a,c,e,g,l,d,h){function m(a,b){if(!a)return null;if(a.declaredClass)throw Error("JSON object is already hydrated");
var c=new this;c.read(a,b);return c}var p=function(b){function e(){return null!==b&&b.apply(this,arguments)||this}a(e,b);e.prototype.read=function(a,b){d.default(this,a,b);return this};e.prototype.write=function(a,b){return h.default(this,a||{},b)};e.prototype.toJSON=function(a){return this.write(null,a)};e.fromJSON=function(a,b){return m.call(this,a,b)};return e=c([l.subclass("esri.core.JSONSupport")],e)}(l.declared(e));p.prototype.toJSON.isDefaultToJSON=!0;g.after(function(a){g.hasMixin(a,p)&&(a.fromJSON=
m.bind(a))});return p})},"esri/layers/vectorTiles/core/Accessor":function(){define("./declare ./accessorSupport/Properties ./accessorSupport/get ./accessorSupport/introspection ./accessorSupport/set ./accessorSupport/watch".split(" "),function(k,b,a,c,e,g){b=b.default;k.before(function(a,b){k.hasMixin(a,l)&&c.processPrototype(b)});k.after(function(a){k.hasMixin(a,l)&&(c.processClass(a),Object.defineProperties(a.prototype,{initialized:{get:function(){return this.__accessor__&&this.__accessor__.initialized||
!1}},constructed:{get:function(){return this.__accessor__&&2===this.__accessor__.lifecycle||!1}},destroyed:{get:function(){return this.__accessor__&&this.__accessor__.destroyed||!1}}}))});var l=k(null,{declaredClass:"esri.core.Accessor","-chains-":{initialize:"after",destroy:"before"},constructor:function(){if(this.constructor===l)throw Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{value:new b(this)});
if(0<arguments.length&&this.normalizeCtorArgs){for(var a=[],c=0;c<arguments.length;c++)a.push(arguments[c]);this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,a)}},__accessor__:null,postscript:function(a){var b=this.__accessor__;a=b.ctorArgs||a;var c;null!=this.getDefaults&&(c=this.getDefaults(a||{}),this.set(c));b.initialize();a&&(this.set(a),b.ctorArgs=null);b.constructed();this.initialize()},initialize:function(){},destroy:function(){if(this.destroyed)try{throw Error("instance is already destroyed");
}catch(d){console.warn(d.stack)}else g.removeTarget(this),this.__accessor__.destroy()},get:function(b){return a.get(this,b)},hasOwnProperty:function(a){return this.__accessor__?this.__accessor__.has(a):Object.prototype.hasOwnProperty.call(this,a)},keys:function(){return this.__accessor__?this.__accessor__.keys():[]},set:function(a,b){e.set(this,a,b);return this},watch:function(a,b,c){return g.watch(this,a,b,c)},_clearOverride:function(a){return this.__accessor__.clearOverride(a)},_override:function(a,
b){return this.__accessor__.override(a,b)},_isOverridden:function(a){return this.__accessor__.isOverridden(a)},notifyChange:function(a){this.__accessor__.propertyInvalidated(a)},_get:function(a){return this.__accessor__.internalGet(a)},_set:function(a,b){return this.__accessor__.internalSet(a,b)}});return l})},"esri/layers/vectorTiles/core/accessorSupport/Properties":function(){define("require exports dojo/has ../Logger ./extensions ./PropertyOrigin ./Store".split(" "),function(k,b,a,c,e,g,l){function d(b,
c){return c.metadatas[b]?!0:(a("dojo-debug-messages")&&m.warn("cannot access unknown property '"+b+"' on instance of "+c.host.declaredClass+"."),!1)}function h(b,c,d,e){return b.nonNullable&&null==d?(a("dojo-debug-messages")&&m.warn("cannot set non-nullable property '"+c+"' to null on "+e.host.declaredClass+"."),!1):!0}Object.defineProperty(b,"__esModule",{value:!0});var m=c.getLogger("esri.core.accessorSupport.Properties");k=function(){function a(a){this.host=a;this._origin=g.OriginId.USER;this.ctorArgs=
this.cursors=null;this.destroyed=!1;this.dirties={};this.lifecycle=0;this.overridden=null;this.store=new l.default;a=this.host.constructor.__accessorMetadata__;this.metadatas=a.properties;this.autoDestroy=a.autoDestroy}a.prototype.initialize=function(){this.lifecycle=1;e.instanceCreated(this.host,this.metadatas)};a.prototype.constructed=function(){this.lifecycle=2};a.prototype.destroy=function(){this.destroyed=!0;var a=this.cursors;if(this.cursors)for(var b=0,c=Object.getOwnPropertyNames(a);b<c.length;b++){var d=
c[b],e=a[d];if(e){for(;0<e.length;)e.pop().propertyDestroyed(this,d);a[d]=null}}if(this.autoDestroy)for(d in this.metadatas)(a=this.internalGet(d))&&a&&"function"===typeof a.destroy&&(a.destroy(),this.metadatas[d].nonNullable||this.internalSet(d,null))};Object.defineProperty(a.prototype,"initialized",{get:function(){return 0!==this.lifecycle},enumerable:!0,configurable:!0});a.prototype.clearOverride=function(a){this.isOverridden(a)&&(this.overridden[a]=!1,this.propertyInvalidated(a))};a.prototype.get=
function(a){d(a,this);var b=this.metadatas[a];if(this.store.has(a)&&!this.dirties[a])return this.store.get(a);var c=b.get;return c?(b=c.call(this.host),this.store.set(a,b,g.OriginId.COMPUTED),this.propertyCommitted(a),b):b.value};a.prototype.originOf=function(a){var b=this.store.originOf(a);return void 0===b&&(a=this.metadatas[a])&&a.hasOwnProperty("value")?"defaults":g.idToName(b)};a.prototype.has=function(a){return this.metadatas[a]?this.store.has(a):!1};a.prototype.internalGet=function(a){if(d(a,
this)){var b=this.store;return b.has(a)?b.get(a):this.metadatas[a].value}};a.prototype.internalSet=function(a,b){d(a,this)&&(this.propertyInvalidated(a),this.initialized?this.store.set(a,b,this._origin):this.store.set(a,b,g.OriginId.DEFAULTS),this.propertyCommitted(a))};a.prototype.isOverridden=function(a){return null!=this.overridden&&!0===this.overridden[a]};a.prototype.keys=function(){return this.store.keys()};a.prototype.override=function(a,b){if(d(a,this)){this.overridden||(this.overridden={});
var c=this.metadatas[a];h(c,a,b,this)&&((c=c.cast)&&(b=c.call(this.host,b)),this.overridden[a]=!0,this.internalSet(a,b))}};a.prototype.set=function(a,b){if(d(a,this)){var c=this.metadatas[a];if(h(c,a,b,this)){var e=c.set;(c=c.cast)&&(b=c.call(this.host,b));e?e.call(this.host,b):this.internalSet(a,b)}}};a.prototype.setDefaultOrigin=function(a){this._origin=g.nameToId(a)};a.prototype.propertyInvalidated=function(a){var b=this.dirties,c=this.isOverridden(a),d=this.cursors&&this.cursors[a],e=this.metadatas[a].computes;
if(d)for(var m=0;m<d.length;m++)d[m].propertyInvalidated(this,a);c||(b[a]=!0);if(e)for(a=0;a<e.length;a++)this.propertyInvalidated(e[a])};a.prototype.propertyCommitted=function(a){var b=this.cursors&&this.cursors[a];this.dirties[a]=!1;if(b)for(var c=0;c<b.length;c++)b[c].propertyCommitted(this,a)};a.prototype.addCursor=function(a,b){this.cursors||(this.cursors={});var c=this.cursors[a];c||(this.cursors[a]=c=[]);c.push(b)};a.prototype.removeCursor=function(a,b){var c=this.cursors[a];this.cursors[a]&&
(c.splice(c.indexOf(b),1),0===c.length&&(this.cursors[a]=null))};return a}();b.default=k})},"esri/layers/vectorTiles/core/accessorSupport/extensions":function(){define(["require","exports","./extensions/aliasedProperty","./extensions/computedProperty","./extensions/serializableProperty"],function(k,b,a,c,e){Object.defineProperty(b,"__esModule",{value:!0});var g=[a.default,c.default,e.default];b.processPrototypeMetadatas=function(a,b){for(var c=Object.getOwnPropertyNames(a),d=0;d<g.length;d++){var e=
g[d];if(e.processPrototypePropertyMetadata)for(var l=0,t=c;l<t.length;l++){var u=t[l];e.processPrototypePropertyMetadata(u,a[u],a,b)}}};b.processClassMetadatas=function(a,b){for(var c=Object.getOwnPropertyNames(a),d=0;d<g.length;d++){var e=g[d];if(e.processClassPropertyMetadata)for(var l=0,t=c;l<t.length;l++){var u=t[l];e.processClassPropertyMetadata(u,a[u],a,b)}}};b.instanceCreated=function(a,b){for(var c=Object.getOwnPropertyNames(b),d=0;d<g.length;d++){var e=g[d];e.instanceCreated&&e.instanceCreated(a,
b,c)}}})},"esri/layers/vectorTiles/core/accessorSupport/extensions/aliasedProperty":function(){define("require exports dojo/has ../get ../set ../utils ../wire".split(" "),function(k,b,a,c,e,g,l){function d(a,b,c){var d=g.getProperties(a);return l.wire(a,c.aliasOf,function(){d.propertyInvalidated(b)})}Object.defineProperty(b,"__esModule",{value:!0});var h=a("dojo-debug-messages");b.AliasedPropertyExtension={processClassPropertyMetadata:function(a,b,d,g){var m=b.aliasOf;if(m){var p=m.split(".")[0];
if(null==d[p])h&&console.error("[accessor] class '"+g+"' - property '"+a+"' is alias of aliased of '"+m+"', but '"+p+"' isn't declared as property. This can be fix by adding '"+p+"' to the metadata for example.");else if(b.set)h&&console.error("[accessor] class '"+g+"' - property '"+a+"' is alias of aliased of '"+m+"', so it cannot have a setter defined");else if(b.get)h&&console.error("[accessor] class '"+g+"' - property '"+a+"' is alias of aliased of '"+m+"', so it cannot have a getter defined");
else{var l;b.get=function(){var a=c.default(this,m);if("function"===typeof a){l||(l=m.split(".").slice(0,-1).join("."));var b=c.default(this,l);b&&(a=a.bind(b))}return a};b.readOnly||(b.set=function(a){return e.default(this,m,a)})}}},instanceCreated:function(a,b,c){for(var e=0;e<c.length;e++){var m=c[e],p=b[m];p.aliasOf&&d(a,m,p)}}};b.default=b.AliasedPropertyExtension})},"esri/layers/vectorTiles/core/accessorSupport/get":function(){define(["require","exports","./utils"],function(k,b,a){function c(b,
c,e){if(null!=e.getItemAt||Array.isArray(e)){var d=parseInt(b,10);if(!isNaN(d))return Array.isArray(e)?e[d]:e.getItemAt(d)}d=a.getProperties(e);return c?a.isPropertyDeclared(d,b)?d.get(b):e[b]:a.isPropertyDeclared(d,b)?d.internalGet(b):e[b]}function e(a,b,m,p){if(null==a)return a;if((a=c(b[p],m,a))||!(p<b.length-1))return p===b.length-1?a:e(a,b,m,p+1)}function g(b,h,m,p){void 0===m&&(m=!1);void 0===p&&(p=0);return"string"===typeof h&&-1===h.indexOf(".")?c(h,m,b):e(b,a.pathToArray(h),m,p)}function l(a,
b){return g(a,b,!0)}Object.defineProperty(b,"__esModule",{value:!0});b.valueOf=g;b.get=l;b.exists=function(a,b){return void 0!==g(b,a,!0)};b.default=l})},"esri/layers/vectorTiles/core/accessorSupport/utils":function(){define(["require","exports","../lang"],function(k,b,a){function c(b,e){return e?Object.keys(e).reduce(function(b,d){if("value"===d)return b[d]=e[d],b;if(void 0===b[d])return b[d]=a.clone(e[d]),b;var m=b[d],p=e[d];if(m===p)return b;if(Array.isArray(p)||Array.isArray(b))m=m?Array.isArray(m)?
b[d]=m.concat():b[d]=[m]:b[d]=[],p&&(Array.isArray(p)||(p=[p]),p.forEach(function(a){-1===m.indexOf(a)&&m.push(a)}));else if(p&&"object"===typeof p)b[d]=c(m,p);else if(!b.hasOwnProperty(d)||e.hasOwnProperty(d))b[d]=p;return b},b||{}):b}function e(a){return Array.isArray(a)?a:a.split(".")}function g(a){if(Array.isArray(a)||-1<a.indexOf(",")){a=Array.isArray(a)?a:a.split(",");for(var b=0;b<a.length;b++)a[b]=a[b].trim();return 1===a.length?a[0]:a}return a.trim()}function l(a){var b=!1;return function(){b||
(b=!0,a())}}Object.defineProperty(b,"__esModule",{value:!0});b.getProperties=function(a){return a?a.__accessor__?a.__accessor__:a.propertyInvalidated?a:null:null};b.isPropertyDeclared=function(a,b){return a&&a.metadatas&&null!=a.metadatas[b]};b.merge=c;b.pathToStringOrArray=function(a){return a?"string"===typeof a&&-1===a.indexOf(".")?a:e(a):a};b.pathToArray=e;b.splitPath=g;b.parse=function(a,b,c,e){b=g(b);if(Array.isArray(b)){var d=b.map(function(b){return e(a,b.trim(),c)});return{remove:l(function(){return d.forEach(function(a){return a.remove()})})}}return e(a,
b.trim(),c)};b.once=l})},"esri/layers/vectorTiles/core/accessorSupport/set":function(){define(["require","exports","dojo/has","../Logger","./get"],function(k,b,a,c,e){function g(b,c,m){if(b&&c)if("object"===typeof c){m=0;for(var d=Object.getOwnPropertyNames(c);m<d.length;m++){var h=d[m];g(b,h,c[h])}}else"_"!==c[0]&&(-1!==c.indexOf(".")?(c=c.split("."),h=c.splice(c.length-1,1)[0],g(e.default(b,c),h,m)):(a("dojo-debug-messages")&&(h=b.__accessor__,null==h||h.metadatas[c]||l.warn("setting unknown property '"+
c+"' on instance of "+h.host.declaredClass)),b[c]=m))}Object.defineProperty(b,"__esModule",{value:!0});var l=c.getLogger("esri.core.accessorSupport.set");b.set=g;b.default=g})},"esri/layers/vectorTiles/core/accessorSupport/wire":function(){define(["require","exports","./utils"],function(k,b,a){function c(b,c,g){c=a.splitPath(c);if(Array.isArray(c)){for(var m=[],p=0;p<c.length;p++)m.push((new e(c[p],g)).install(b));return new d(m)}b=(new e(c,g)).install(b);return new h(b)}Object.defineProperty(b,"__esModule",
{value:!0});var e=function(){function b(b,c){this.path=b;this.callback=c;this.chain=null;this.path=b;-1<b.indexOf(".")&&(this.chain=a.pathToArray(b));this.callback=c;return this}b.prototype.install=function(a){a=this.chain?new l(this,a):new g(this,a);return a};b.prototype.notify=function(a){this.callback(a,this.path)};return b}(),g=function(){function b(b,c){this.binding=b;this.target=c;a.getProperties(c).addCursor(this.binding.path,this)}b.prototype.destroy=function(){this.target&&(a.getProperties(this.target).removeCursor(this.binding.path,
this),this.target=this.binding=null)};b.prototype.propertyDestroyed=function(b,c){a.getProperties(this.target).removeCursor(c,this)};b.prototype.propertyInvalidated=function(a,b){this.binding&&this.binding.notify(this.target)};b.prototype.propertyCommitted=function(a,b){this.binding&&this.binding.notify(this.target)};return b}(),l=function(){function b(b,c){this.binding=b;this.target=c;this.stack=[];this.properties=a.getProperties(c);this.stack.push({properties:this.properties,propertyName:b.chain[0]});
this.properties.addCursor(b.chain[0],this);this.moveForward();return this}b.prototype.destroy=function(){for(;;){var a=this.stack.pop();if(null==a)break;a.properties.removeCursor(a.propertyName,this)}this.target=this.binding=null};b.prototype.propertyDestroyed=function(a,b){this.moveBackward(a,b)};b.prototype.propertyInvalidated=function(a,b){this.binding&&this.binding.notify(this.target)};b.prototype.propertyCommitted=function(a,b){this.binding&&(this.moveBackward(a,b),this.moveForward(),this.binding.notify(this.target))};
b.prototype.moveBackward=function(a,b){for(var c=this.stack,d=c[c.length-1];d.properties!==a&&d.propertyName!==b;)d.properties.removeCursor(d.propertyName,this),c.pop(),d=c[c.length-1]};b.prototype.moveForward=function(){var b=this.stack,c=b[b.length-1],c=c.properties.internalGet(c.propertyName);(c=a.getProperties(c))&&b.length<this.binding.chain.length&&(b=this.binding.chain[b.length],this.stack.push({properties:c,propertyName:b}),c.addCursor(b,this),this.moveForward())};return b}(),d=function(){function a(a){this.cursors=
a}a.prototype.remove=function(){for(var a=this.cursors;0<a.length;)a.pop().destroy();this.cursors=null};return a}(),h=function(){function a(a){this.cursor=a}a.prototype.remove=function(){this.cursor.destroy();this.cursor=null};return a}();b.create=function(b,c){b=a.splitPath(b);if(Array.isArray(b)){for(var m=[],p=0;p<b.length;p++)m.push(new e(b[p],c));return function(a){for(var b=[],c=0;c<m.length;c++)b[c]=m[c].install(a);return new d(b)}}var g=new e(b,c);return function(a){return new h(g.install(a))}};
b.wire=c;b.default=c})},"esri/layers/vectorTiles/core/accessorSupport/extensions/computedProperty":function(){define("require exports dojo/has ../../Logger ../utils ../wire".split(" "),function(k,b,a,c,e,g){Object.defineProperty(b,"__esModule",{value:!0});var l=a("dojo-debug-messages"),d=c.getLogger("esri.core.accessorSupport.extensions.computedProperty");b.ComputedPropertyExtension={processClassPropertyMetadata:function(a,b,c,q){if(l){var m=b.dependsOn;m&&m.length&&m.map(function(a){return a.split(".")[0]}).forEach(function(b){null==
c[b]&&d.error("[accessor] class '"+q+"' - property '"+a+"' depends on unknown property '"+b+"' which hasn't been found during introspection. This can be fix by adding '"+b+"' to the metadata for example.")})}b.dependsOn&&(m=void 0,m=b.dependsOn.slice())&&(b.wire=g.create(m,function(b){return e.getProperties(b).propertyInvalidated(a)}))},instanceCreated:function(a,b,c){for(var d=0;d<c.length;d++){var e=b[c[d]];e.wire&&e.wire(a)}}};b.default=b.ComputedPropertyExtension})},"esri/layers/vectorTiles/core/accessorSupport/extensions/serializableProperty":function(){define("require exports ./serializableProperty/originAliases ./serializableProperty/reader ./serializableProperty/shorthands ./serializableProperty/writer".split(" "),
function(k,b,a,c,e,g){function l(a,b,c){var d=a&&a.json;a&&a.json&&a.json.origins&&c&&(a=a.json.origins[c.origin])&&b in a&&(d=a);return d}Object.defineProperty(b,"__esModule",{value:!0});b.originSpecificReadPropertyDefinition=function(a,b){return l(a,"read",b)};b.originSpecificWritePropertyDefinition=function(a,b){return l(a,"write",b)};b.SerializablePropertyExtension={processPrototypePropertyMetadata:function(b,h,m,p){if(e.process(h)){a.process(h);m=h.type;for(p=0;Array.isArray(m);)m=m[0],p++;if(h.json.origins)for(var d in h.json.origins){var l=
h.json.origins[d];c.create(m,p,b,l);g.create(m,p,b,l)}c.create(m,p,b,h.json);g.create(m,p,b,h.json)}}};b.default=b.SerializablePropertyExtension})},"esri/layers/vectorTiles/core/accessorSupport/extensions/serializableProperty/originAliases":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.process=function(a){if(a.json&&a.json.origins){var b=a.json.origins,e={"web-document":["web-scene","web-map"]};a=function(a){if(b[a]){var c=b[a];e[a].forEach(function(a){b[a]=
c});delete b[a]}};for(var g in e)a(g)}}})},"esri/layers/vectorTiles/core/accessorSupport/extensions/serializableProperty/reader":function(){define(["require","exports","../../../object","./type"],function(k,b,a,c){function e(a,b,c,e){if(1<b)return d(a,b);if(1===b)return h(a);if(m(a)){var p=h(a.prototype.itemType.Type);return function(b,c,f){return(b=p(b,c,f))?new a(b):b}}return g(a)}function g(a){return a.prototype.read?function(b,c,d){return null==b?b:(new a).read(b,d)}:a.fromJSON}function l(a,b,
c,d){return 0!==d&&Array.isArray(b)?b.map(function(b){return l(a,b,c,d-1)}):a(b,null,c)}function d(a,b){a=g(a);var c=l.bind(null,a);return function(a,d,e){if(null==a)return a;a=c(a,e,b);d=b;for(e=a;0<d&&Array.isArray(e);)d--,e=e[0];if(void 0!==e)for(e=0;e<d;e++)a=[a];return a}}function h(a){var b=g(a);return function(a,c,d){return null==a?a:Array.isArray(a)?a.map(function(a){return b(a,null,d)}):[b(a,null,d)]}}function m(a){return c.isCollection(a)?(a=a.prototype.itemType)&&a.Type&&"function"===typeof a.Type?
p(a.Type):!1:!1}function p(a){return!!a&&(!!a.prototype.read||!!a.fromJSON||m(a))}Object.defineProperty(b,"__esModule",{value:!0});b.create=function(b,c,d,m){(!m.read||!m.read.reader&&!1!==m.read.enabled)&&p(b)&&a.setDeepValue("read.reader",e(b,c,d,m),m)}})},"esri/layers/vectorTiles/core/accessorSupport/extensions/serializableProperty/type":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.isCollection=function(a){return!!a&&!!a.prototype.declaredClass&&
0===a.prototype.declaredClass.indexOf("esri.core.Collection")}})},"esri/layers/vectorTiles/core/accessorSupport/extensions/serializableProperty/shorthands":function(){define(["require","exports"],function(k,b){function a(a){"boolean"===typeof a.read?a.read={enabled:a.read}:"function"===typeof a.read?a.read={enabled:!0,reader:a.read}:a.read&&"object"===typeof a.read&&void 0===a.read.enabled&&(a.read.enabled=!0)}function c(a){"boolean"===typeof a.write?a.write={enabled:a.write}:"function"===typeof a.write?
a.write={enabled:!0,writer:a.write}:a.write&&"object"===typeof a.write&&void 0===a.write.enabled&&(a.write.enabled=!0)}Object.defineProperty(b,"__esModule",{value:!0});b.process=function(b){b.json||(b.json={});a(b.json);c(b.json);if(b.json.origins)for(var e in b.json.origins)a(b.json.origins[e]),c(b.json.origins[e]);return!0}})},"esri/layers/vectorTiles/core/accessorSupport/extensions/serializableProperty/writer":function(){define(["require","exports","../../../object","./type"],function(k,b,a,c){function e(b,
c,d,e){a.setDeepValue(d,g(b,e),c)}function g(a,b){return a&&"function"===typeof a.write?a.write({},b):a&&"function"===typeof a.toJSON?a.toJSON():"number"===typeof a?-Infinity===a?-Number.MAX_VALUE:Infinity===a?Number.MAX_VALUE:isNaN(a)?null:a:a}function l(b,c,d,e){null===b?b=null:b&&"function"===typeof b.map?(b=b.map(function(a){return g(a,e)}),"function"===typeof b.toArray&&(b=b.toArray())):b=[g(b,e)];a.setDeepValue(d,b,c)}function d(a,b,c){return 0!==c&&Array.isArray(a)?a.map(function(a){return d(a,
b,c-1)}):g(a,b)}function h(b){return function(c,e,m,h){if(null===c)c=null;else{c=d(c,h,b);h=b;for(var p=c;0<h&&Array.isArray(p);)h--,p=p[0];if(void 0!==p)for(p=0;p<h;p++)c=[c]}a.setDeepValue(m,c,e)}}Object.defineProperty(b,"__esModule",{value:!0});b.create=function(a,b,d,g){g.write&&!g.write.writer&&!1!==g.write.enabled&&(1===b||c.isCollection(a)?g.write.writer=l:g.write.writer=1<b?h(b):e)}})},"esri/layers/vectorTiles/core/accessorSupport/PropertyOrigin":function(){define(["require","exports"],function(k,
b){function a(a){switch(a){case "defaults":return e.DEFAULTS;case "service":return e.SERVICE;case "portal-item":return e.PORTAL_ITEM;case "web-scene":return e.WEB_SCENE;case "web-map":return e.WEB_MAP;case "user":return e.USER}}function c(a){switch(a){case e.DEFAULTS:return"defaults";case e.SERVICE:return"service";case e.PORTAL_ITEM:return"portal-item";case e.WEB_SCENE:return"web-scene";case e.WEB_MAP:return"web-map";case e.USER:return"user"}}Object.defineProperty(b,"__esModule",{value:!0});var e;
(function(a){a[a.DEFAULTS=0]="DEFAULTS";a[a.COMPUTED=1]="COMPUTED";a[a.SERVICE=2]="SERVICE";a[a.PORTAL_ITEM=3]="PORTAL_ITEM";a[a.WEB_SCENE=4]="WEB_SCENE";a[a.WEB_MAP=5]="WEB_MAP";a[a.USER=6]="USER";a[a.NUM=7]="NUM"})(e=b.OriginId||(b.OriginId={}));b.nameToId=a;b.idToName=c;b.readableNameToId=function(b){return a(b)};b.idToReadableName=function(a){return c(a)};b.writableNameToId=function(b){return a(b)};b.idToWritableName=function(a){return c(a)}})},"esri/layers/vectorTiles/core/accessorSupport/Store":function(){define(["require",
"exports","./PropertyOrigin"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(){this._values={}}b.prototype.get=function(a){return this._values[a]};b.prototype.originOf=function(b){return a.OriginId.USER};b.prototype.keys=function(){return Object.keys(this._values)};b.prototype.set=function(a,b){this._values[a]=b};b.prototype.clear=function(a){delete this._values[a]};b.prototype.has=function(a){return a in this._values};return b}();b.default=k})},"esri/layers/vectorTiles/core/accessorSupport/introspection":function(){define("require exports ../object ./ensureType ./extensions ./metadata ./utils ./decorators/cast".split(" "),
function(k,b,a,c,e,g,l,d){Object.defineProperty(b,"__esModule",{value:!0});var h=Object.prototype.hasOwnProperty,m=/^_([a-zA-Z0-9]+)(Getter|Setter|Reader|Writer|Caster)$/,p={Getter:"get",Setter:"set",Reader:"json.read.reader",Writer:"json.write.writer",Caster:"cast"},q=/^_(set|get)([a-zA-Z0-9]+)Attr$/;b.processPrototype=function(b){for(var d=b.declaredClass,t=b.properties||{},k=0,A=Object.getOwnPropertyNames(t);k<A.length;k++){var z=A[k],f=t[z],n=typeof f;null==f?g.setPropertyMetadata(b,z,{value:f}):
Array.isArray(f)?g.setPropertyMetadata(b,z,{type:[f[0]],value:null}):"object"===n?l.getProperties(f)||f instanceof Date?g.setPropertyMetadata(b,z,{type:f.constructor,value:f}):g.setPropertyMetadata(b,z,f):"boolean"===n?g.setPropertyMetadata(b,z,{type:Boolean,value:f}):"string"===n?g.setPropertyMetadata(b,z,{type:String,value:f}):"number"===n?g.setPropertyMetadata(b,z,{type:Number,value:f}):"function"===n&&g.setPropertyMetadata(b,z,{type:f,value:null})}k=0;for(A=Object.getOwnPropertyNames(b);k<A.length;k++){var n=
A[k],f=b[n],t=z=void 0,r=m.exec(n);if(r)z=r[1],t=p[r[2]];else if(r=q.exec(n))z=r[2][0].toLowerCase()+r[2].substr(1),t=r[1].toLowerCase();z&&t&&(z=g.getPropertyMetadata(b,z),a.setDeepValue(t,f,z))}k=0;for(A=Object.getOwnPropertyNames(g.getPropertiesMetadata(b));k<A.length;k++)if(z=A[k],f=g.getPropertyMetadata(b,z),t=f.type,n=f.types,void 0===f.value&&h.call(b,z)&&(f.value=b[z]),!f.cast&&t){z=f;f=0;for(n=t;Array.isArray(n);)n=n[0],f++;t=1===f?c.ensureArray(n):1<f?c.ensureNArray(n,f):c.ensureType(t);
z.cast=t}else!f.cast&&n&&(Array.isArray(n)?f.cast=c.ensureArrayTyped(c.ensureOneOfType(n[0])):f.cast=c.ensureOneOfType(n));e.processPrototypeMetadatas(g.getPropertiesMetadata(b),d);return g.getPropertiesMetadata(b)};b.processClass=function(a){for(var b=a.prototype,c=b.declaredClass,m=a._meta.bases,p={},h=m.length-1;0<=h;h--)l.merge(p,g.getMetadata(m[h].prototype));var f=p.properties;e.processClassMetadatas(f,c);Object.defineProperty(a,"__accessorMetadata__",{value:{properties:f,autoDestroy:!!p.autoDestroy}});
for(var n={},c=function(a){var b=f[a];n[a]={enumerable:!0,configurable:!0,get:function(){return this.__accessor__?this.__accessor__.get(a):b.value},set:function(c){var f=this.__accessor__;if(!f)Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:c});else if(!Object.isFrozen(this)){if(f.initialized&&b.readOnly)throw new TypeError("[accessor] cannot assign to read-only property '"+a+"' of "+this.declaredClass);if(2===f.lifecycle&&b.constructOnly)throw new TypeError("[accessor] cannot assign to construct-only property '"+
a+"' of "+this.declaredClass);f.set(a,c)}}}},m=0,h=Object.getOwnPropertyNames(f);m<h.length;m++)c(h[m]);Object.defineProperties(a.prototype,n);if(p.parameters)for(a=0,c=Object.getOwnPropertyNames(p.parameters);a<c.length;a++)m=c[a],h=Object.getOwnPropertyDescriptor(b,m)||{value:b[m]},(h=d.autocastMethod(b,m,h))&&Object.defineProperty(b,m,h);return p}})},"esri/layers/vectorTiles/core/accessorSupport/watch":function(){define("require exports ../ArrayPool ../lang ../ObjectPool ../scheduling ./get ./utils ./wire".split(" "),
function(k,b,a,c,e,g,l,d,h){function m(a){z.has(a)?f.splice(f.indexOf(a),1):z.add(a);f.push(a);n||(n=g.schedule(q))}function p(a){if(!a.removed){var b=a.callback,f=a.path,n=a.oldValue,d=a.target,r=l.valueOf(d,a.propertyPath,!0);c.equals(n,r)||(a.oldValue=r,b.call(d,r,n,f,d))}}function q(){if(n){n=null;var a=f;f=A.acquire();z.clear();for(var b=A.acquire(),c=0;c<a.length;c++){var d=a[c];p(d);d.removed&&b.push(d)}for(c=0;c<f.length;c++)d=f[c],d.removed&&(b.push(d),z.delete(d),f.splice(c,1),--c);for(c=
0;c<b.length;c++)x.pool.release(b[c]);A.release(a);A.release(b);r.forEach(function(a){return a()})}}function t(a,b,c){var f=d.parse(a,b,c,function(a,b,c){var n=l.valueOf(a,b,!0),r,e=h.wire(a,b,function(a,b){a.__accessor__.destroyed?f.remove():(r||(r=x.pool.acquire(a,b,n,c),n=null),m(r))});return{remove:d.once(function(){e.remove();r&&(r.removed=!0,m(r),r=null);f=e=n=null})}});return f}function u(a,b,f){var n=d.parse(a,b,f,function(a,b,f){var d=l.valueOf(a,b,!0),r=!1;return h.wire(a,b,function(a,b){if(a.__accessor__.destroyed)n.remove();
else if(!r){r=!0;var e=l.valueOf(a,b,!0);c.equals(d,e)||f.call(a,e,d,b,a);d=l.valueOf(a,b,!0);r=!1}})});return n}function y(a,b,c,f){void 0===f&&(f=!1);return!a.__accessor__||a.__accessor__.destroyed?{remove:function(){}}:f?u(a,b,c):t(a,b,c)}Object.defineProperty(b,"__esModule",{value:!0});var x=function(){function a(a,b,c,f){this.target=a;this.path=b;this.oldValue=c;this.callback=f;this.removed=!1;this.propertyPath=d.pathToStringOrArray(b)}a.prototype.release=function(){this.target=this.path=this.propertyPath=
this.callback=this.oldValue=null;this.removed=!0};a.pool=new e(a,!0);return a}(),A=new a,z=new Set,f=A.acquire(),n;b.dispatchTarget=function(a){for(var b=A.copy(f),c=0;c<b.length;c++){var n=b[c];n.target===a&&(p(n),z.delete(n),f.splice(f.indexOf(n),1))}};b.removeTarget=function(a){for(var b=0;b<f.length;b++){var c=f[b];c.target===a&&(c.removed=!0)}};b.dispatch=q;var r=new Set;b.afterDispatch=function(a){r.add(a);return{remove:function(){r.delete(a)}}};b.watch=y;b.isValueInUse=function(a){return f.some(function(b){return b.oldValue===
a})};b.default=y})},"esri/layers/vectorTiles/core/ArrayPool":function(){define(["require","exports","./ObjectPool"],function(k,b,a){function c(a){a.length=0}var e=Array.prototype.splice;k=function(){function b(b,e){void 0===b&&(b=50);void 0===e&&(e=50);this._pool=new a(Array,!1,c,e,b)}b.prototype.acquire=function(){return this._pool.acquire()};b.prototype.copy=function(a){var b=this.acquire();a.unshift(0,0);e.apply(b,a);a.splice(0,2);return b};b.prototype.release=function(a){this._pool.release(a)};
b.acquire=function(){return g.acquire()};b.copy=function(a){return g.copy(a)};b.release=function(a){return g.release(a)};return b}();var g=new k(100);return k})},"esri/layers/vectorTiles/core/scheduling":function(){define(["require","exports","./nextTick","./now","./requestAnimationFrame"],function(k,b,a,c,e){function g(a){void 0===a&&(a=b.now());b.debug.rafId=null;0<n.length&&(b.debug.rafId=l());if(0<t){var c=a-t;x=Math.min(c,x);if(c<u)return}b.debug.executeFrameTasks(a)}function l(){return b.debug.requestNextFrame?
b.debug.requestNextFrame(m):m()}function d(){for(var a=0;a<n.length;){var b=n[a];a++;if(b.removed){n.splice(a-1,1);for(var c=0;c<z.length;c++){var f=z[c];if(b.phases[f]){var f=r[f],d=f.indexOf(b);-1!==d&&f.splice(d,1)}}}}}function h(){for(;f.length;){var a=f.shift();a.isActive&&(a.isActive=!1,a.callback())}b.debug.willDispatch=!1}function m(){return e(g)}Object.defineProperty(b,"__esModule",{value:!0});b.now=c;var p=function(){return function(a){this.phases=a;this.paused=!1;this.pausedAt=0;this.epoch=
-1;this.dt=0;this.ticks=-1;this.removed=!1}}(),q=function(){function a(a){this.callback=a;this.isActive=!0}a.prototype.remove=function(){this.isActive=!1};return a}(),t=-1,u=0,y=0,x=Number.POSITIVE_INFINITY,A={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0,spendInTask:0},z=["prepare","preRender","render","postRender","update"],f=[],n=[],r={prepare:[],preRender:[],render:[],postRender:[],update:[]},B=function(){function a(a){this._task=a}a.prototype.remove=function(){this._task.removed=!0};
a.prototype.pause=function(){this._task.paused||(this._task.paused=!0,this._task.pausedAt=b.now())};a.prototype.resume=function(){this._task.paused&&(this._task.paused=!1,-1!==this._task.epoch&&(this._task.epoch+=b.now()-this._task.pausedAt))};return a}();b.FrameTaskHandle=B;b.debug={frameTasks:n,rafId:null,requestNextFrame:null,willDispatch:!1,clearFrameTasks:function(a){void 0===a&&(a=!1);for(var b=0;b<n.length;b++)n[b].removed=!0;a&&d()},dispatch:h,executeFrameTasks:function(a){void 0===a&&(a=
b.now());0>t&&(t=a);var c=a-t;t=a;for(var f=0;f<n.length;f++){var e=n[f];-1!==e.epoch&&(e.dt=c)}for(f=0;f<z.length;f++)for(var c=z[f],m=r[c],p=0;p<m.length;p++)e=m[p],e.paused||e.removed||(0===f&&e.ticks++,-1===e.epoch&&(e.epoch=a),A.time=a,A.deltaTime=e.dt,A.elapsedFrameTime=b.now()-a,A.frameDuration=0<y?y:x,A.spendInTask=a-e.epoch,e.phases[c].call(e,A));d()}};b.schedule=function(c){c=new q(c);f.push(c);b.debug.willDispatch||(b.debug.willDispatch=!0,a(h));return c};b.addFrameTask=function(a){var c=
new p(a);n.push(c);for(var f=0,d=z;f<d.length;f++){var e=d[f];a[e]&&r[e].push(c)}b.debug.rafId||(t=-1,b.debug.rafId=l());return new B(c)};b.setFrameRate=function(a){if(0>=a)y=u=0;else{var b=1.05*x;a=Math.ceil(1E3/a/b);u=(a-1)*b;y=a*x}};b.requestNextFrame=l})},"esri/layers/vectorTiles/core/nextTick":function(){define(["require","exports","./global"],function(k,b,a){function c(){if(a.postMessage&&!a.importScripts){var b=a.onmessage,c=!0;a.onmessage=function(){c=!1};a.postMessage("","*");a.onmessage=
b;return c}return!1}var e=a.MutationObserver||a.WebKitMutationObserver;return function(){var b;if(a.process&&a.process.nextTick)b=function(b){a.process.nextTick(b)};else if(a.Promise)b=function(b){a.Promise.resolve().then(b)};else if(e){var l=[],d=document.createElement("div");(new e(function(){for(;0<l.length;)l.shift()()})).observe(d,{attributes:!0});b=function(a){l.push(a);d.setAttribute("queueStatus","1")}}else if(c()){var h=[];a.addEventListener("message",function(b){if(b.source===a&&"esri-nexttick-message"===
b.data)for(b.stopPropagation();h.length;)h.shift()()},!0);b=function(b){h.push(b);a.postMessage("esri-nexttick-message","*")}}else b=a.setImmediate?function(b){return a.setImmediate(b)}:function(b){return a.setTimeout(b,0)};return b}()})},"esri/layers/vectorTiles/core/global":function(){define(["require","exports"],function(k,b){return function(){if("undefined"!==typeof global)return global;if("undefined"!==typeof window)return window;if("undefined"!==typeof self)return self}()})},"esri/layers/vectorTiles/core/now":function(){define(["require",
"exports","./global"],function(k,b,a){return function(){var b=a.performance||{};if(b.now)return function(){return b.now()};if(b.webkitNow)return function(){return b.webkitNow()};if(b.mozNow)return function(){return b.mozNow()};if(b.msNow)return function(){return b.msNow()};if(b.oNow)return function(){return b.oNow()};var e;e=b.timing&&b.timing.navigationStart?b.timing.navigationStart:Date.now();return function(){return Date.now()-e}}()})},"esri/layers/vectorTiles/core/requestAnimationFrame":function(){define(["require",
"exports","./global","./now"],function(k,b,a,c){var e=c();k=a.requestAnimationFrame;if(!k){b=["ms","moz","webkit","o"];for(var g=0;g<b.length&&!k;++g)k=a[b[g]+"RequestAnimationFrame"];k||(k=function(b){var d=c(),h=Math.max(0,16-(d-e)),m=a.setTimeout(function(){b(c())},h);e=d+h;return m})}return k})},"esri/layers/vectorTiles/core/accessorSupport/read":function(){define("require exports ../tsSupport/assignHelper ./get ./utils ./extensions/serializableProperty".split(" "),function(k,b,a,c,e,g){function l(a,
b,p){void 0===p&&(p=d);for(var m=e.getProperties(a),h=m.metadatas,l={},k=0,x=Object.getOwnPropertyNames(b);k<x.length;k++){var A=l,z=h,f=x[k],n=b,r=p,B=g.originSpecificReadPropertyDefinition(z[f],r);B&&(!B.read||!1!==B.read.enabled&&!B.read.source)&&(A[f]=!0);for(var C=0,D=Object.getOwnPropertyNames(z);C<D.length;C++){var F=D[C],B=g.originSpecificReadPropertyDefinition(z[F],r),H;a:{H=f;var J=n;if(B&&B.read&&!1!==B.read.enabled&&B.read.source)if(B=B.read.source,"string"===typeof B){if(B===H||-1<B.indexOf(".")&&
0===B.indexOf(H)&&c.exists(B,J)){H=!0;break a}}else for(var I=0;I<B.length;I++){var G=B[I];if(G===H||-1<G.indexOf(".")&&0===G.indexOf(H)&&c.exists(G,J)){H=!0;break a}}H=!1}H&&(A[F]=!0)}}m.setDefaultOrigin(p.origin);x=0;for(A=Object.getOwnPropertyNames(l);x<A.length;x++)k=A[x],f=(z=g.originSpecificReadPropertyDefinition(h[k],p).read)&&z.source,n=void 0,n=f&&"string"===typeof f?c.valueOf(b,f):b[k],z&&z.reader&&(n=z.reader.call(a,n,b,p)),void 0!==n&&m.set(k,n);b=0;for(h=Object.getOwnPropertyNames(h);b<
h.length;b++)k=h[b],l[k]||(x=a,A=m,z=p,f=(f=g.originSpecificReadPropertyDefinition(A.metadatas[k],z))&&f.read&&f.read.default,void 0!==f&&(x="function"===typeof f?f.call(x,k,z):f,void 0!==x&&A.set(k,x)));m.setDefaultOrigin("user")}Object.defineProperty(b,"__esModule",{value:!0});var d={origin:"service"};b.read=l;b.readLoadable=function(b,c,e,g){void 0===g&&(g=d);c=a({},g,{messages:[]});e(c);c.messages.forEach(function(a){"warning"!==a.type||b.loaded?g&&g.messages.push(a):b.loadWarnings.push(a)})};
b.default=l})},"esri/layers/vectorTiles/core/accessorSupport/write":function(){define("require exports ../Error ../Logger ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(k,b,a,c,e,g,l){function d(b,c,d,h,g,l){if(!h||!h.write)return!1;var p=b.get(d);if(void 0===p)return!1;if(!g&&h.write.overridePolicy){var q=h.write.overridePolicy.call(b,p,d,l);void 0!==q&&(g=q)}g||(g=h.write);if(!g||!1===g.enabled)return!1;if(null===p){if(g.allowNull)return!0;g.isRequired&&((b=new a("web-document-write:property-required",
"Missing value for required property '"+d+"' on '"+b.declaredClass+"'",{propertyName:d,target:b}),l)&&l.messages?l.messages.push(b):b&&!l&&m.error(b.name,b.message));return!1}return!g.ignoreOrigin&&l&&l.origin&&c.store.originOf(d)<e.nameToId(l.origin)?!1:!0}function h(a,b,c){if(a&&"function"===typeof a.toJSON&&(!a.toJSON.isDefaultToJSON||!a.write))return g.merge(b,a.toJSON());var m=g.getProperties(a),p=m.metadatas,h;for(h in p){var q=l.originSpecificWritePropertyDefinition(p[h],c);if(d(a,m,h,q,null,
c)){var t=a.get(h),f={};q.write.writer.call(a,t,f,"string"===typeof q.write.target?q.write.target:h,c);q=f;0<Object.keys(q).length&&(b=g.merge(b,q),c&&c.writtenProperties&&c.writtenProperties.push({target:a,propName:h,oldOrigin:e.idToReadableName(m.store.originOf(h)),newOrigin:c.origin}))}}return b}Object.defineProperty(b,"__esModule",{value:!0});var m=c.getLogger("esri.core.accessorSupport.write");b.willPropertyWrite=function(a,b,c,e){var m=g.getProperties(a),p=l.originSpecificWritePropertyDefinition(m.metadatas[b],
e);return p?d(a,m,b,p,c,e):!1};b.write=h;b.disableWriteDefaultPolicy=function(a){return function(b){return{enabled:b!==a}}};b.default=h})},"esri/layers/vectorTiles/geometry/SpatialReference":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/spatialReferenceUtils".split(" "),function(k,b,a,c,e,g,l,d){k=function(b){function e(a){a=b.call(this)||this;a.latestWkid=null;
a.wkid=null;a.wkt=null;return a}a(e,b);p=e;e.fromJSON=function(a){if(!a)return null;if(a.wkid){if(102100===a.wkid)return p.WebMercator;if(4326===a.wkid)return p.WGS84}var b=new p;b.read(a);return b};e.prototype.normalizeCtorArgs=function(a){return a&&"object"===typeof a?a:(b={},b["string"===typeof a?"wkt":"wkid"]=a,b);var b};Object.defineProperty(e.prototype,"isWGS84",{get:function(){return d.isWGS84(this)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isWebMercator",{get:function(){return d.isWebMercator(this)},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isGeographic",{get:function(){return d.isGeographic(this)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isWrappable",{get:function(){return d.isWrappable(this)},enumerable:!0,configurable:!0});e.prototype.writeWkt=function(a,b){this.wkid||(b.wkt=a)};e.prototype.clone=function(){if(this===p.WGS84)return p.WGS84;if(this===p.WebMercator)return p.WebMercator;var a=new p;null!=this.wkid?(a.wkid=this.wkid,null!=this.latestWkid&&
(a.latestWkid=this.latestWkid),null!=this.vcsWkid&&(a.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(a.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(a.wkt=this.wkt);return a};e.prototype.equals=function(a){return d.equals(this,a)};e.prototype.toJSON=function(a){return this.write(null,a)};e.GCS_NAD_1927=null;e.WGS84=null;e.WebMercator=null;c([l.property({dependsOn:["wkid"],readOnly:!0})],e.prototype,"isWGS84",null);c([l.property({dependsOn:["wkid"],readOnly:!0})],e.prototype,"isWebMercator",
null);c([l.property({dependsOn:["wkid","wkt"],readOnly:!0})],e.prototype,"isGeographic",null);c([l.property({dependsOn:["wkid"],readOnly:!0})],e.prototype,"isWrappable",null);c([l.property({type:Number,json:{write:!0}})],e.prototype,"latestWkid",void 0);c([l.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkt?!0:!1}}}}}}})],e.prototype,"wkid",void 0);c([l.property({type:String,json:{origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===
this.wkid?!0:!1}}}}}}})],e.prototype,"wkt",void 0);c([l.writer("wkt"),l.writer("web-scene","wkt")],e.prototype,"writeWkt",null);c([l.property({type:Number,json:{write:!0}})],e.prototype,"vcsWkid",void 0);c([l.property({type:Number,json:{write:!0}})],e.prototype,"latestVcsWkid",void 0);return e=p=c([l.subclass("esri.geometry.SpatialReference")],e);var p}(l.declared(e));k.prototype.toJSON.isDefaultToJSON=!0;k.GCS_NAD_1927=new k({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'});
k.WGS84=new k(4326);k.WGS84.wkt=g.substitute({Central_Meridian:"0.0"},d.getInfo(k.WGS84).wkTemplate);k.WebMercator=new k({wkid:102100,latestWkid:3857});Object.freeze&&(Object.freeze(k.GCS_NAD_1927),Object.freeze(k.WGS84),Object.freeze(k.WebMercator));return k})},"esri/layers/vectorTiles/geometry/support/spatialReferenceUtils":function(){define(["require","exports","./WKIDUnitConversion"],function(k,b,a){function c(a){return a.wkid&&!0===e[a.wkid]}Object.defineProperty(b,"__esModule",{value:!0});var e=
{102113:!0,102100:!0,3857:!0,3785:!0},g={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0};k=[-2.0037508342788905E7,2.0037508342788905E7];var l=[-2.0037508342787E7,2.0037508342787E7],d={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:k,origin:l,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:k,origin:l,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:k,origin:l,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:k,origin:l,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}};b.equals=function(a,b){if(b){if(a===b)return!0;if(null!=a.wkid||null!=b.wkid)return a.wkid===b.wkid||c(a)&&c(b)||null!=b.latestWkid&&a.wkid===b.latestWkid||null!=a.latestWkid&&b.wkid===a.latestWkid;if(a.wkt&&b.wkt)return a.wkt.toUpperCase()===b.wkt.toUpperCase()}return!1};b.getInfo=function(a){return a.wkid?d[a.wkid]:null};b.isGeographic=function(b){return b.wkid?null==a[b.wkid]:b.wkt?!!/^\s*GEOGCS/i.test(b.wkt):!1};b.isWGS84=function(a){return 4326===
a.wkid};b.isWebMercator=c;b.isWrappable=function(a){return a.wkid&&!0===g[a.wkid]}})},"esri/layers/vectorTiles/geometry/support/WKIDUnitConversion":function(){define(["esri/WKIDUnitConversion"],function(k){return k})},"esri/layers/vectorTiles/geometry/support/webMercatorUtils":function(){define(["require","exports","../SpatialReference","./spatialReferenceUtils"],function(k,b,a,c){function e(a,b,c,d,e){if("point"===a.type&&"point"===e.type)b=b(a.x,a.y,h,0,d),e.x=b[0],e.y=b[1];else if("extent"===a.type&&
"extent"===e.type)m=b(a.xmin,a.ymin,h,0,d),e.xmin=m[0],e.ymin=m[1],b=b(a.xmax,a.ymax,h,0,d),e.xmax=b[0],e.ymax=b[1];else if("polyline"===a.type&&"polyline"===e.type||"polygon"===a.type&&"polygon"===e.type){var m="polyline"===a.type?a.paths:a.rings,p=[],g=void 0;for(a=0;a<m.length;a++){var l=m[a],g=[];p.push(g);for(var f=0;f<l.length;f++)g.push(b(l[f][0],l[f][1],[0,0],0,d)),2<l[f].length&&g[f].push(l[f][2]),3<l[f].length&&g[f].push(l[f][3])}"polyline"===e.type?e.paths=p:e.rings=p}else if("multipoint"===
a.type&&"multipoint"===e.type){m=a.points;p=[];for(a=0;a<m.length;a++)p[a]=b(m[a][0],m[a][1],[0,0],0,d),2<m[a].length&&p[a].push(m[a][2]),3<m[a].length&&p[a].push(m[a][3]);e.points=p}else if("mesh"===a.type&&"mesh"===e.type&&(m=a.vertexAttributes&&a.vertexAttributes.position,p=e.vertexAttributes&&e.vertexAttributes.position,m))for(g=[0,0],a=0;a<m.length;a+=3)b(m[a],m[a+1],g,0,d),p[a]=g[0],p[a+1]=g[1];e.spatialReference=c;return e;var m}function g(a,b){a=a&&(null!=a.wkid||null!=a.wkt?a:a.spatialReference);
b=b&&(null!=b.wkid||null!=b.wkt?b:b.spatialReference);return a&&b?c.equals(b,a)?!0:c.isWebMercator(b)&&c.isWGS84(a)||c.isWebMercator(a)&&c.isWGS84(b):!1}function l(a,b,c,d){void 0===c&&(c=[0,0]);void 0===d&&(d=0);89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;c[d]=111319.49079327169*a;c[d+1]=3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)));return c}function d(a,b,c,d,e){void 0===c&&(c=[0,0]);void 0===d&&(d=0);void 0===e&&(e=!1);a=a/6378137*57.29577951308232;c[d]=e?a:a-360*
Math.floor((a+180)/360);c[d+1]=57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)));return c}Object.defineProperty(b,"__esModule",{value:!0});var h=[0,0];b.canProject=g;b.project=function(b,p){var m=b&&b.spatialReference;p=p&&(null!=p.wkid||null!=p.wkt?p:p.spatialReference);return g(m,p)?c.equals(m,p)?b.clone():c.isWebMercator(p)?e(b,l,a.WebMercator,!1,b.clone()):c.isWGS84(p)?e(b,d,a.WGS84,!1,b.clone()):null:null};b.lngLatToXY=l;b.xyToLngLat=d;b.geographicToWebMercator=function(b,
c,d){void 0===c&&(c=!1);void 0===d&&(d=b.clone());return e(b,l,a.WebMercator,c,d)};b.webMercatorToGeographic=function(b,c,h){void 0===c&&(c=!1);void 0===h&&(h=b.clone());return e(b,d,a.WGS84,c,h)}})},"esri/layers/vectorTiles/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayList ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./mesh/factories/WGLMeshFactory ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u){var y=new a.default,x=new a.default;return function(){function a(){this.tileBufferData=this.tileDisplayData=null}a.prototype.reshuffle=function(){y.reset();var b=this._collectDisplayRecords(),f;for(f in b)for(var n=b[f],d=0,e=n;d<e.length;d++){var m=e[d];y.needMore(m.geometryType,m.meshData?m.meshData.vertexCount:m.vertexCount,m.meshData?m.meshData.indexData.length:m.indexCount)}d=b.length;e=new c;for(f=0;f<d;++f){e.geometries[f].indexBuffer=new Uint32Array(Math.round(1.15*
y.indicesFor(f)));var m=[],p;for(p in this.tileBufferData.geometries[f].vertexBuffer)m.push(this.tileBufferData.geometries[f].vertexBuffer[p].stride);var m=a._computeVertexAlignment(m),n=Math.round(1.15*y.verticesFor(f)),m=a._align(n,m),h;for(h in this.tileBufferData.geometries[f].vertexBuffer)n=this.tileBufferData.geometries[f].vertexBuffer[h].stride,e.geometries[f].vertexBuffer[h]={stride:n,data:new Uint32Array(Math.round(m*n/4))}}x.reset();this.tileDisplayData.displayList=new l;for(f=0;f<d;++f){n=
b[f];p=0;for(h=n;p<h.length;p++){m=h[p];if(m.meshData)m.writeMeshDataToBuffers(x.verticesFor(f),e.geometries[f].vertexBuffer,x.indicesFor(f),e.geometries[f].indexBuffer),m.meshData=null;else{var q=this.tileBufferData.geometries[f].vertexBuffer,t=this.tileBufferData.geometries[f].indexBuffer,k=e.geometries[f].vertexBuffer,u=e.geometries[f].indexBuffer,A=x.verticesFor(f),W=x.indicesFor(f);g.copyMeshData(A,W,k,u,m,q,t);m.vertexFrom=A;m.indexFrom=W}x.needMore(f,m.vertexCount,m.indexCount)}this.tileDisplayData.displayList.addToList(n)}this.tileBufferData=
e};a.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var c=this.tileBufferData.geometries[b];a[b]={};for(var d in c.vertexBuffer)a[b][d]=c.vertexBuffer[d].stride}return a};a.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};a.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),
c=this.tileDisplayData.serialize(new u.default(Int32Array,this._guessSize())).buffer();b.push(c);return{result:{displayData:c,bufferData:a},transferList:b}};a.decode=function(b){var f=p.MaterialStore.deserialize(new q.default(b.materialStore)),n=t.deserializeList(new q.default(b.displayObjects),d,{store:f}),f={},r;for(r in b.vertexBuffersMap)f[r]=m.VertexBuffers.decode(b.vertexBuffersMap[r]);b=new a;r=new e;var h=new c;r.displayObjects=n;for(var g in f)n=f[g],h.geometries[g].indexBuffer=n.indexBuffer,
h.geometries[g].vertexBuffer=n.namedBuffers;b.tileDisplayData=r;b.tileBufferData=h;return b};a.bind=function(b,c){var f=new a;f.tileDisplayData=b;f.tileBufferData=c;return f};a.create=function(b,f){var n=new a;n.tileDisplayData=new e;n.tileDisplayData.displayObjects=b;for(var d=[0,0,0,0,0],m=[0,0,0,0,0],p=[[],[],[],[],[]],g=0;g<b.length;g++)for(var l=0,q=b[g].displayRecords;l<q.length;l++){var t=q[l];p[t.geometryType].push(t);d[t.geometryType]+=t.meshData.vertexCount;m[t.geometryType]+=t.meshData.indexData.length}b=
new c;f=[f.fill||{},f.line||{},f.icon||{},f.text||{},f.label||{}];for(g=0;5>g;g++){var l=new Uint32Array(m[g]),q=f[g],t=d[g],k={},u=void 0;for(u in q){var z={data:new Uint32Array(t*q[u]/4),stride:q[u]};k[u]=z}q=k;h.writeAllMeshDataToBuffers(p[g],q,l);b.geometries[g]={indexBuffer:l,vertexBuffer:q}}n.tileBufferData=b;return n};a._align=function(a,b){var c=a%b;return 0===c?a:a+(b-c)};a._computeVertexAlignment=function(a){for(var b=!1,c=!1,d=0;d<a.length;d++){var e=a[d];2===e%4?b=!0:0!==e%4&&(c=!0)}return c?
4:b?2:1};a.prototype._collectDisplayRecords=function(){for(var a=[[],[],[],[],[]],b=0,c=this.tileDisplayData.displayObjects;b<c.length;b++)for(var d=0,e=c[b].displayRecords;d<e.length;d++){var m=e[d];a[m.geometryType].push(m)}return a};return a}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function a(){this._byGeometryType=null}Object.defineProperty(a.prototype,
"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._byGeometryType=null};a.prototype.verticesFor=function(a){return this._byGeometryType?this._byGeometryType[a].vertices:0};a.prototype.indicesFor=function(a){return this._byGeometryType?this._byGeometryType[a].indices:0};a.prototype.needMore=function(a,b,g){if(b||g)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},
{vertices:0,indices:0},{vertices:0,indices:0}]),a=this._byGeometryType[a],a.vertices+=b,a.indices+=g};return a}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports"],function(k,b){return function(){function a(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.deserialize=function(b){for(var c=
new a,g=0;5>g;++g){c.geometries[g].indexBuffer=new Uint32Array(b.geometries[g].indexBuffer);c.geometries[g].vertexBuffer={};for(var l in b.geometries[g].vertexBuffer)c.geometries[g].vertexBuffer[l]={data:new Uint32Array(b.geometries[g].vertexBuffer[l].data),stride:b.geometries[g].vertexBuffer[l].stride}}return c};a.prototype.serialize=function(){for(var a={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},
{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},b=0;5>b;++b)for(var g in this.geometries[b].vertexBuffer)a.geometries[b].vertexBuffer[g]={data:this.geometries[b].vertexBuffer[g].data.buffer,stride:this.geometries[b].vertexBuffer[g].stride};return a};a.prototype.getBuffers=function(){for(var a=[],b=0;5>b;++b){a.push(this.geometries[b].indexBuffer.buffer);
for(var g in this.geometries[b].vertexBuffer)a.push(this.geometries[b].vertexBuffer[g].data.buffer)}return a};return a}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/TileDisplayData":function(){define("require exports ./WGLDisplayList ./WGLDisplayObject ./mesh/factories/WGLMeshFactory ./util/serializationUtils".split(" "),function(k,b,a,c,e,g){return function(){function b(){}Object.defineProperty(b.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=
new Map;for(var a=0,b=this.displayObjects;a<b.length;a++){var c=b[a];this._displayObjectRegistry.set(c.id,c)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"displayList",{get:function(){if(!this._displayList){this._displayList=new a;for(var b=0,c=this.displayObjects;b<c.length;b++)for(var e=0,p=c[b].displayRecords;e<p.length;e++)this._displayList.addToList(p[e])}return this._displayList},set:function(a){this._displayList=a},enumerable:!0,configurable:!0});
b.prototype.serialize=function(a){this.materialStore.serialize(a);g.serializeList(a,this.displayObjects);return a};b.prototype._deserializeObjects=function(b){for(var d=b.readInt32(),d=Array(d),e=new a,p=new Map,g={store:this.materialStore},l=0;l<d.length;++l){var k=c.deserialize(b,g);d[l]=k;p.set(k.id,k);for(var y=0,k=k.displayRecords;y<k.length;y++)e.addToList(k[y])}this.displayObjects=d;this._displayList=e;this._displayObjectRegistry=p};b.deserialize=function(a){var c=new b;c.materialStore=e.MaterialStore.deserialize(a);
c._deserializeObjects(a);return c};return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLDisplayList":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/Logger ./enums ./MaterialInfo ./Utils ./util/serializationUtils".split(" "),function(k,b,a,c,e,g,l,d){var h=c.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");k=function(){function b(){this.symbolLevels=[]}Object.defineProperty(b.prototype,"empty",{get:function(){return!this.symbolLevels||
0===this.symbolLevels.length},enumerable:!0,configurable:!0});b.prototype.addToList=function(a){var b=this;Array.isArray(a)?a.forEach(function(a){b._addToList(a)}):this._addToList(a)};b.prototype.removeFromList=function(a){var b=this;Array.isArray(a)||(a=[a]);a.forEach(function(a){b._removeFromList(a)})};b.prototype.ofType=function(b){var c,d,e,f,n,r,m,p,h,g,l;return a(this,function(a){switch(a.label){case 0:c=0,d=this.symbolLevels,a.label=1;case 1:if(!(c<d.length))return[3,8];e=d[c];f=0;n=e.zLevels;
a.label=2;case 2:if(!(f<n.length))return[3,7];r=n[f];m=r.geometryDPInfo;p=this._getDPInfoType(b);if(!m[p])return[3,6];h=0;g=m[p];a.label=3;case 3:if(!(h<g.length))return[3,6];l=g[h];return[4,l];case 4:a.sent(),a.label=5;case 5:return h++,[3,3];case 6:return f++,[3,2];case 7:return c++,[3,1];case 8:return[2]}})};b.prototype._addToList=function(a){var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=0<b.length?b[b.length-1]:null;null!==c&&l.isSameMaterialInfo(c.materialInfo,a.materialInfo)&&
c.indexFrom+c.indexCount===a.indexFrom?c.indexCount+=a.indexCount:(c=new m,c.indexFrom=a.indexFrom,c.indexCount=a.indexCount,c.materialInfo=a.materialInfo,c.geometryType=a.geometryType,b.push(c))};b.prototype._removeFromList=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,d=void 0,f=0;f<c;++f){var n=b[f];a.indexFrom+a.indexCount>n.indexFrom&&a.indexFrom<n.indexFrom+n.indexCount&&(d=f)}if(void 0!==d)if(n=b[d],a.indexFrom===n.indexFrom)n.indexCount-=a.indexCount,
n.indexFrom+=a.indexCount;else if(a.indexFrom+a.indexCount===n.indexFrom+n.indexCount)n.indexCount-=a.indexCount;else{var c=n.indexFrom,f=a.indexFrom-n.indexFrom,e=a.indexCount;a=n.indexFrom+n.indexCount-(a.indexFrom+a.indexCount);n.indexCount=f;var p=new m;p.geometryType=n.geometryType;p.materialInfo=new g.default;p.materialInfo.copy(n.materialInfo);p.indexFrom=c+f+e;p.indexCount=a;b.splice(d+1,0,p)}};b.prototype._getDisplayList=function(a,b,c){for(var d,f=this.symbolLevels.length,n=0;n<f;n++)if(this.symbolLevels[n].symbolLevel===
a){d=this.symbolLevels[n];break}d||(d=new t,d.symbolLevel=a,this.symbolLevels.push(d));var r;a=d.zLevels.length;for(f=0;f<a;f++)if(d.zLevels[f].zLevel===b){r=d.zLevels[f];break}r||(r=new q,r.geometryDPInfo=new p,r.zLevel=b,d.zLevels.push(r));var m;switch(c){case e.WGLGeometryType.FILL:r.geometryDPInfo.fill||(r.geometryDPInfo.fill=[]);m=r.geometryDPInfo.fill;break;case e.WGLGeometryType.LINE:r.geometryDPInfo.line||(r.geometryDPInfo.line=[]);m=r.geometryDPInfo.line;break;case e.WGLGeometryType.MARKER:r.geometryDPInfo.marker||
(r.geometryDPInfo.marker=[]);m=r.geometryDPInfo.marker;break;case e.WGLGeometryType.TEXT:r.geometryDPInfo.text||(r.geometryDPInfo.text=[]);m=r.geometryDPInfo.text;break;case e.WGLGeometryType.LABEL:r.geometryDPInfo.label||(r.geometryDPInfo.label=[]);m=r.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+c+"'.")}return m};b.prototype.serialize=function(a){d.serializeList(a,this.symbolLevels);return a};b.deserialize=function(a){var c=new b;c.symbolLevels=
d.deserializeList(a,t);return c};b.prototype._getDPInfoType=function(a){switch(a){case e.WGLGeometryType.FILL:return"fill";case e.WGLGeometryType.LINE:return"line";case e.WGLGeometryType.MARKER:return"marker";case e.WGLGeometryType.TEXT:return"text";case e.WGLGeometryType.LABEL:return"label";default:h.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return b}();var m=function(){function a(){this.materialInfo=null;this.indexCount=this.indexFrom=0}a.prototype.serialize=function(a){this.materialInfo.serialize(a);
a.writeInt32(this.indexFrom);a.writeInt32(this.indexCount);return a};a.deserialize=function(b,c){var d=new a;d.geometryType=c.geometryType;d.materialInfo=g.default.deserialize(b);d.indexFrom=b.readInt32();d.indexCount=b.readInt32();return d};return a}(),p=function(){function a(){this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.serialize=function(a){d.serializeList(a,this.fill);d.serializeList(a,this.line);d.serializeList(a,this.marker);d.serializeList(a,this.text);d.serializeList(a,
this.label);return a};a.deserialize=function(b){var c=new a,p={geometryType:e.WGLGeometryType.FILL},h=d.deserializeList(b,m,p);h.length&&(c.fill=h);p.geometryType=e.WGLGeometryType.LINE;h=d.deserializeList(b,m,p);h.length&&(c.line=h);p.geometryType=e.WGLGeometryType.MARKER;h=d.deserializeList(b,m,p);h.length&&(c.marker=h);p.geometryType=e.WGLGeometryType.TEXT;h=d.deserializeList(b,m,p);h.length&&(c.text=h);p.geometryType=e.WGLGeometryType.LABEL;b=d.deserializeList(b,m,p);b.length&&(c.label=b);return c};
return a}(),q=function(){function a(){this.geometryDPInfo=new p}a.prototype.serialize=function(a){a.writeInt32(this.zLevel);this.geometryDPInfo.serialize(a);return a};a.deserialize=function(b){var c=new a;c.zLevel=b.readInt32();c.geometryDPInfo=p.deserialize(b);return c};return a}(),t=function(){function a(){this.zLevels=[]}a.prototype.serialize=function(a){a.writeInt32(this.symbolLevel);d.serializeList(a,this.zLevels);return a};a.deserialize=function(b){var c=new a;c.symbolLevel=b.readInt32();c.zLevels=
d.deserializeList(b,q);return c};return a}();return k})},"esri/layers/vectorTiles/core/tsSupport/generatorHelper":function(){define([],function(){return function(k,b){function a(a){return function(b){return c([a,b])}}function c(a){if(g)throw new TypeError("Generator is already executing.");for(;e;)try{if(g=1,l&&(d=a[0]&2?l["return"]:a[0]?l["throw"]||((d=l["return"])&&d.call(l),0):l.next)&&!(d=d.call(l,a[1])).done)return d;if(l=0,d)a=[a[0]&2,d.value];switch(a[0]){case 0:case 1:d=a;break;case 4:return e.label++,
{value:a[1],done:!1};case 5:e.label++;l=a[1];a=[0];continue;case 7:a=e.ops.pop();e.trys.pop();continue;default:if(!(d=e.trys,d=0<d.length&&d[d.length-1])&&(6===a[0]||2===a[0])){e=0;continue}if(3===a[0]&&(!d||a[1]>d[0]&&a[1]<d[3]))e.label=a[1];else if(6===a[0]&&e.label<d[1])e.label=d[1],d=a;else if(d&&e.label<d[2])e.label=d[2],e.ops.push(a);else{d[2]&&e.ops.pop();e.trys.pop();continue}}a=b.call(k,e)}catch(p){a=[6,p],l=0}finally{g=d=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var e=
{label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},g,l,d,h;return h={next:a(0),"throw":a(1),"return":a(2)},"function"===typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h}})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLDisplayObject":function(){define("require exports ../../../../core/libs/gl-matrix/vec2 ./WGLDisplayRecord ./collisions/Metric ./util/serializationUtils".split(" "),function(k,b,a,c,e,g){return function(){function b(a){this.yOverflow=this.xOverflow=
this.yBucket=this.xBucket=-1;this.id=a;this.displayRecords=[];this.metrics=[];this.anchor=null}b.prototype.addMetric=function(a,b,c,p){this.metrics.push(new e.default(a,{from:b,count:c},p))};b.prototype.serialize=function(a){a.writeInt32(this.id);g.serializeList(a,this.metrics);g.serializeList(a,this.displayRecords);this.anchor?(a.writeF32(this.anchor[0]),a.writeF32(this.anchor[1]),a.writeInt32(this.xBucket),a.writeInt32(this.yBucket),a.writeInt32(this.xOverflow),a.writeInt32(this.yOverflow)):(a.writeF32(0),
a.writeF32(0));return a};b.deserialize=function(d,h){var m=h.store,p=d.readInt32();h=new b(p);m={id:p,store:m};p=g.deserializeList(d,e.default);p.length&&(h.metrics=p);h.displayRecords=g.deserializeList(d,c,m);m=d.readF32();p=d.readF32();if(m||p)h.anchor=a.fromValues(m,p),h.xBucket=d.readInt32(),h.yBucket=d.readInt32(),h.xOverflow=d.readInt32(),h.yOverflow=d.readInt32();return h};return b}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec2":function(){define(["./common"],function(k){var b={create:function(){var a=
new k.ARRAY_TYPE(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new k.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new k.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,e){a[0]=b;a[1]=e;return a},add:function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];return a},subtract:function(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];return a}};b.sub=b.subtract;b.multiply=function(a,b,e){a[0]=b[0]*e[0];a[1]=b[1]*e[1];return a};b.mul=
b.multiply;b.divide=function(a,b,e){a[0]=b[0]/e[0];a[1]=b[1]/e[1];return a};b.div=b.divide;b.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};b.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};b.min=function(a,b,e){a[0]=Math.min(b[0],e[0]);a[1]=Math.min(b[1],e[1]);return a};b.max=function(a,b,e){a[0]=Math.max(b[0],e[0]);a[1]=Math.max(b[1],e[1]);return a};b.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};b.scale=function(a,b,
e){a[0]=b[0]*e;a[1]=b[1]*e;return a};b.scaleAndAdd=function(a,b,e,g){a[0]=b[0]+e[0]*g;a[1]=b[1]+e[1]*g;return a};b.distance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)};b.dist=b.distance;b.squaredDistance=function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a};b.sqrDist=b.squaredDistance;b.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};b.len=b.length;b.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};b.sqrLen=b.squaredLength;b.negate=function(a,
b){a[0]=-b[0];a[1]=-b[1];return a};b.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};b.normalize=function(a,b){var c=b[0],g=b[1],c=c*c+g*g;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};b.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};b.cross=function(a,b,e){b=b[0]*e[1]-b[1]*e[0];a[0]=a[1]=0;a[2]=b;return a};b.lerp=function(a,b,e,g){var c=b[0];b=b[1];a[0]=c+g*(e[0]-c);a[1]=b+g*(e[1]-b);return a};b.random=function(a,b){b=b||1;var c=2*k.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*
b;return a};b.transformMat2=function(a,b,e){var c=b[0];b=b[1];a[0]=e[0]*c+e[2]*b;a[1]=e[1]*c+e[3]*b;return a};b.transformMat2d=function(a,b,e){var c=b[0];b=b[1];a[0]=e[0]*c+e[2]*b+e[4];a[1]=e[1]*c+e[3]*b+e[5];return a};b.transformMat3=function(a,b,e){var c=b[0];b=b[1];a[0]=e[0]*c+e[3]*b+e[6];a[1]=e[1]*c+e[4]*b+e[7];return a};b.transformMat4=function(a,b,e){var c=b[0];b=b[1];a[0]=e[0]*c+e[4]*b+e[12];a[1]=e[1]*c+e[5]*b+e[13];return a};b.forEach=function(){var a=b.create();return function(b,e,g,l,d,
h){e||(e=2);g||(g=0);for(l=l?Math.min(l*e+g,b.length):b.length;g<l;g+=e)a[0]=b[g],a[1]=b[g+1],d(a,a,h),b[g]=a[0],b[g+1]=a[1];return b}}();b.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};b.equals=function(a,b){var c=a[0];a=a[1];var g=b[0];b=b[1];return Math.abs(c-g)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(a-b)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return b})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require",
"exports","../../../../core/Logger","./MeshData"],function(k,b,a,c){var e=a.getLogger("esri/views/2d/engine/webgl/WGLDisplayRecord");return function(){function a(a,b,c){this.id=a;this.geometryType=b;this._materialInfo=c;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"materialInfo",{get:function(){return"number"===typeof this._materialInfo?(e.warn("Tried to read materialInfo, but found an index! Was materialInfo deserialized correctly?"),null):this._materialInfo},set:function(a){this._materialInfo=a},enumerable:!0,configurable:!0});a.prototype.copy=function(){var b=new a(this.id,this.geometryType,this._materialInfo);b.vertexFrom=this.vertexFrom;b.vertexCount=this.vertexCount;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;b.zOrder=this.zOrder;b.symbolLevel=
this.symbolLevel;b.meshData=this.meshData;return b};a.prototype.setMeshDataFromBuffers=function(a,b,e){var d=new c,p;for(p in b){for(var h=b[p].stride,g=b[p].data,l=[],k=0;k<h*a.vertexCount/4;++k)l[k]=g[k+h*a.vertexFrom/4];d.vertexData.set(p,l)}for(k=d.indexData.length=0;k<a.indexCount;++k)d.indexData[k]=e[k+a.indexFrom]-a.vertexFrom;d.vertexCount=a.vertexCount;this.meshData=d};a.prototype.readMeshDataFromBuffers=function(a,b){this.meshData?this.meshData.clear():this.meshData=new c;for(var d in a){for(var e=
a[d].stride,p=a[d].data,g=[],l=0;l<e*this.vertexCount/4;++l)g[l]=p[l+e*this.vertexFrom/4];this.meshData.vertexData.set(d,g)}for(l=this.meshData.indexData.length=0;l<this.indexCount;++l)this.meshData.indexData[l]=b[l+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};a.prototype.writeMeshDataToBuffers=function(a,b,c,e){for(var d in b)for(var m=b[d].stride,h=this.meshData.vertexData.get(d),g=b[d].data,l=0;l<m*this.meshData.vertexCount/4;++l)g[l+m*a/4]=h[l];for(l=0;l<this.meshData.indexData.length;++l)e[l+
c]=this.meshData.indexData[l]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=c;this.indexCount=this.meshData.indexData.length};a.writeAllMeshDataToBuffers=function(a,b,c){for(var d=0,e=0,h=0;h<a.length;h++){var g=a[h];g.writeMeshDataToBuffers(d,b,e,c);d+=g.vertexCount;e+=g.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.writeInt32(this.geometryType);
a.writeInt32(this._materialInfo);a.writeInt32(this.symbolLevel);a.writeInt32(this.zOrder);a.writeInt32(this.vertexFrom);a.writeInt32(this.vertexCount);a.writeInt32(this.indexFrom);a.writeInt32(this.indexCount);return a};a.deserialize=function(b,c){var d=b.readInt32(),e=c.store&&c.store.get(b.readInt32())||b.readInt32();c=new a(c.id,d,e);c.symbolLevel=b.readInt32();c.zOrder=b.readInt32();c.vertexFrom=b.readInt32();c.vertexCount=b.readInt32();c.indexFrom=b.readInt32();c.indexCount=b.readInt32();return c};
return a}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(k,b){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};a.prototype.update=function(a,b,g){for(var c in a)this.vertexData.set(c,a[c]);for(c in this.vertexData)null===a[c]&&this.vertexData.delete(c);this.vertexCount=b;this.indexData=g};return a}()})},
"esri/layers/vectorTiles/views/2d/engine/webgl/collisions/Metric":function(){define(["require","exports","./BoundingBox"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(a,b,c,d,h){void 0===d&&(d=255);void 0===h&&(h=0);this.bounds=a;this.range=b;this.index=c;this.minZoom=d;this.maxZoom=h}b.prototype.serialize=function(a){this.bounds.serialize(a);a.writeInt32(this.range.from);a.writeInt32(this.range.count);a.writeInt32(this.index);return a};b.deserialize=function(c){var e=
a.default.deserialize(c),l=c.readInt32(),d=c.readInt32(),l={from:l,count:d};c=c.readInt32();return new b(e,l,c)};return b}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/libs/gl-matrix/vec2"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(b,c,l,d){this.width=l;this.height=d;this.center=a.fromValues(b,c)}Object.defineProperty(b.prototype,"x",{get:function(){return this.center[0]},
set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"halfWidth",{get:function(){return this.width/2},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"halfHeight",{get:function(){return this.height/2},enumerable:!0,configurable:!0});b.prototype.serialize=function(a){a.writeF32(this.center[0]);
a.writeF32(this.center[1]);a.writeInt32(this.width);a.writeInt32(this.height);return a};b.deserialize=function(a){var c=a.readF32(),e=a.readF32(),d=a.readInt32();a=a.readInt32();return new b(c,e,d,a)};return b}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../MaterialInfo ../../Utils ../../visualVariablesUtils ../../WGLDisplayObject ../VertexVector ../templates/meshTemplateUtils ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../../util/Matcher ../../util/serializationUtils ../../util/vvFlagUtils ../../util/Writer".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z,f,n,r){Object.defineProperty(b,"__esModule",{value:!0});var B=e.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),C={esriGeometryPoint:"above-center above-left above-right center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:null,esriGeometryMultipoint:null,esriGeometryEnvelope:null},D=function(){function a(){this._materials=[];this._materialsIndex=new Map}
a.prototype.insert=function(a){var b=this._materials.length;this._materials.push(a);return b};a.prototype._hashGlyph=function(a,b,c){return"G-"+b+"-"+c+"-"+a.page};a.prototype._hashSprite=function(a,b,c){return"S-"+b+"-"+c+"-"+(a?a.page:-1)+"-"+(a?a.sdf:!1)};a.prototype.createSpriteMaterial=function(a,b,c){var f=this._hashSprite(a,b,c);if(this._materialsIndex.has(f))return this._materialsIndex.get(f);var n=this._materials.length;a=h.default.fromSprite(a,b,c);this._materials.push(a);this._materialsIndex.set(f,
n);return n};a.prototype.createGlyphMaterial=function(a,b,c){var f=this._hashGlyph(a,b,c);if(this._materialsIndex.has(f))return this._materialsIndex.get(f);var n=this._materials.length;a=h.default.fromGlyph(a,b,c);this._materials.push(a);this._materialsIndex.set(f,n);return n};a.prototype.get=function(a){return this._materials[a]};a.prototype.serialize=function(a){f.serializeList(a,this._materials);return a};a.deserialize=function(b){var c=new a;c._materials=f.deserializeList(b,h.default);return c};
return a}();b.MaterialStore=D;var F=function(){function a(a){this._bucketSize=a;this._rowsLength=l.TILE_SIZE/a;this._colsLength=l.TILE_SIZE/a;this._grid=this._initGrid()}a.prototype.checkOverlap=function(a,b){a=Math.floor(a/this._bucketSize);b=Math.floor(b/this._bucketSize);if(0>a||a>=this._rowsLength||0>b||b>=this._colsLength||this._grid[b][a])return!0;this._grid[b][a]=!0;return!1};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=function(){for(var a=[],b=0;b<this._rowsLength;b++)a.push(Array(this._colsLength));
return a};return a}(),H=function(){function a(a,b,c){this.displayObjects=a;this.vertexVectorsMap=b;this._materials=c;this.grid=new F(l.COLLISION_EARLY_REJECT_BUCKET_SIZE)}a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};a.prototype.encode=function(a,b){var c=f.serializeList(new r.default(Uint32Array,this._guessSize()),this.displayObjects).buffer(),n=this._materials.serialize(new r.default(Uint32Array)).buffer(),d={};
b.push(c);b.push(n);for(var e=0;e<this.vertexVectorsMap.length;e++){var m=this.vertexVectorsMap[e];d[e]={};m.transfer(d[e],b)}a.displayObjects=c;a.materialStore=n;a.vertexBuffersMap=d;this.destroy()};a.prototype.destroy=function(){this.displayObjects=this.vertexVectorsMap=null};a.prototype._guessSize=function(){for(var a=this.displayObjects,b=Math.min(a.length,4),c=0,f=0;f<b;f++)c=Math.max(c,a[f].displayRecords.length);return 2*(12*a.length+a.length*c*40)};return a}(),J=function(){function a(){this._vvMap=
new Map}a.prototype.set=function(a,b){this._vvMap.set(a,b)};a.prototype.getValue=function(a,b,c){return this._vvMap.has(a)?this._vvMap.get(a)(b,c):0};return a}();k=function(){function a(a,b,f,n,d,r,e,m,p,h){var g=this;this._labelsDebugTemplate=null;this._matcher=a;this._materials=f;this._geometryType=n;this._idField=d;this._pixelRatio=p;this._vvMap=null;this._vvFlags=e;this._vvBuf=new ArrayBuffer(16);this._vvBufU32=new Uint32Array(this._vvBuf);this._vvBufF32=new Float32Array(this._vvBuf);this._createVVFunctionMap(r,
b,m);h&&(this._validateLabelingInfo(h)?this._labelTemplates=h.map(function(a){return y.default.fromText(g._materials,0,a.symbol,p,a.labelPlacement)}):B.error(new c("mapview-labeling:unsupported-geometry","LabelingInfo failed validation - unable to create labels for layer.")))}a.from=function(b,f,n,d,r,e,m,p){switch(b.type){case "simple":return a._fromSimpleRenderer(b,f,n,d,r,e,m,p);case "unique-value":case "uniqueValue":return a._fromUniqueValueRenderer(b,f,n,d,r,e,m,p);case "class-breaks":case "classBreaks":return a._fromClassBreaksRenderer(b,
f,n,d,r,e,m,p);default:return B.error(new c("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}};Object.defineProperty(a.prototype,"materials",{get:function(){return this._materials},enumerable:!0,configurable:!0});a.prototype.createMeshData=function(a){var b=Array(5),c=this._matcher.getDefault(),f=!!n.getMarkerVVFlags(this._vvFlags),r=!!n.getFillVVFlags(this._vvFlags),e=!!n.getLineVVFlags(this._vvFlags,"esriGeometryPolyline"!==this._geometryType),m=!!n.getTextVVFlags(this._vvFlags);
!this._labelTemplates&&c&&1===c.length&&c[0]instanceof A.default?(b[d.WGLGeometryType.MARKER]=new t.VertexVectors(d.WGLGeometryType.MARKER,f,a),b[d.WGLGeometryType.FILL]=new t.VertexVectors(d.WGLGeometryType.FILL,r,0),b[d.WGLGeometryType.LINE]=new t.VertexVectors(d.WGLGeometryType.LINE,e,0),b[d.WGLGeometryType.TEXT]=new t.VertexVectors(d.WGLGeometryType.TEXT,m,0),b[d.WGLGeometryType.LABEL]=new t.VertexVectors(d.WGLGeometryType.LABEL,!1,0)):(b[d.WGLGeometryType.MARKER]=new t.VertexVectors(d.WGLGeometryType.MARKER,
f,a),b[d.WGLGeometryType.FILL]=new t.VertexVectors(d.WGLGeometryType.FILL,r,a),b[d.WGLGeometryType.LINE]=new t.VertexVectors(d.WGLGeometryType.LINE,e,a),b[d.WGLGeometryType.TEXT]=new t.VertexVectors(d.WGLGeometryType.TEXT,m,a),b[d.WGLGeometryType.LABEL]=new t.VertexVectors(d.WGLGeometryType.LABEL,!1,this._labelTemplates&&0<this._labelTemplates.length?a:0));return new H([],b,this._materials)};a.prototype.write=function(a,b,c,f,n){var d=1===this._matcher.size()&&this._matcher.getDefault()||this._matcher.match(b,
c),r=b.attributes[this._idField],e=new q(r),m=!!f&&!!this._labelTemplates;this._computeVV(b,c);if(d&&(b.geometry||b.centroid)){c=e.displayRecords;for(var p=0;p<d.length;p++){var h=d[p],g=a.get(h.geometryType);h.writeMesh(c,g,this._geometryType,r,b,this._pixelRatio,this._vvBufU32)}m&&(d=this._getLabelReference(d),this._writeLabelMesh(e,a,r,b,n,f.get(r),d));a.pushDisplayObject(e)}};a.prototype._hasBadLabelClass=function(a,b){var f=a.labelPlacement,n=C[b];if(!n)return B.error(new c("mapview-labeling:unsupported-geometry-type",
"Unable to create labels for WebGL Feature Layer, "+b+" is not supported")),!0;n.some(function(a){return a===f})||(n=n[0],B.warn("Found invalid label placement type "+f+" for "+b+". Defaulting to "+n),a.labelPlacement=n);return!1};a.prototype._validateLabelingInfo=function(a){var b=this;return!a.some(function(a){return b._hasBadLabelClass(a,b._geometryType)})};a.prototype._getLabelReference=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c instanceof A.default)return c}return null};a.prototype._writeLabelMesh=
function(a,b,c,f,n,d,r){for(var e=a.displayRecords,m=0,p=0,h=-1,g=-1,B=0;B<d.labelingInfo.length;B++){var C=d.labelingInfo[B],q=d.text[B],t=this._labelTemplates[C],k=b.get(t.geometryType),D=n.get(t.symbolId).glyphMosaicItems,u=e.length;t.bindReferenceTemplate(r);if(!t.computeGlyphs(D,q)){D=t.computeAnchor(this._geometryType,f);q=t.bounds;if(-1===h&&(h=Math.floor(D[0]/l.COLLISION_BUCKET_SIZE),g=Math.floor(D[1]/l.COLLISION_BUCKET_SIZE),b.grid.checkOverlap(D[0],D[1])))return;t.writeMesh(e,k,this._geometryType,
c,f,this._pixelRatio,this._vvBufU32);a.anchor=D;a.addMetric(q,u,e.length-u,C);C=q.center;m=Math.max(q.halfWidth+Math.abs(C[0]),m);p=Math.max(q.halfHeight+Math.abs(C[1]),p)}}-1!==h&&(c=2.5*Math.max(m,p),b=Math.ceil(Math.abs((c-a.anchor[0]%l.COLLISION_BUCKET_SIZE)/l.COLLISION_BUCKET_SIZE)),c=Math.ceil(Math.abs((c-a.anchor[1]%l.COLLISION_BUCKET_SIZE)/l.COLLISION_BUCKET_SIZE)),a.xBucket=h,a.yBucket=g,a.xOverflow=b,a.yOverflow=c)};a.prototype._debugLabels=function(a,b,c,f,n){f={geometry:{paths:[[[f[0]+
n.center[0]-n.width/2,f[1]+n.center[1]+n.height/2],[0,-n.height],[n.width,0],[0,n.height],[-n.width,0]]]},attributes:{}};n=this._getLabelDebugTemplate();b=b.get(n.geometryType);n.writeMesh(a,b,"esriGeometryPolyline",c,f,this._pixelRatio,this._vvBufU32)};a.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());return this._labelsDebugTemplate};a.prototype._createLabelsDebugTemplate=function(){var a=new g({style:"solid",width:1,
color:[255,0,0,1]});return x.default.fromSimpleLine(this._materials,0,a,null,this._pixelRatio)};a.prototype._isErrorVV=function(a){return null===a||isNaN(a)||Infinity===a};a.prototype._computeVV=function(a,b){if(!this._vvMap)return 0;var c=this._vvMap.getValue(d.VVType.SIZE,a,b),f=this._vvMap.getValue(d.VVType.COLOR,a,b),n=this._vvMap.getValue(d.VVType.OPACITY,a,b);a=this._vvMap.getValue(d.VVType.ROTATION,a,b);this._vvBufF32[d.VVType.SIZE]=this._isErrorVV(c)?NaN:c;this._vvBufF32[d.VVType.COLOR]=this._isErrorVV(f)?
NaN:f;this._vvBufF32[d.VVType.OPACITY]=this._isErrorVV(n)?NaN:n;this._vvBufF32[d.VVType.ROTATION]=this._isErrorVV(a)?NaN:a;return 0};a.prototype._createVVFunctionMap=function(a,b,c){if(a&&a.length)for(var f=0;f<a.length;f++){var n=a[f],d=m.getVVType(n.type);if(n=this._createGetValueFunction(n,b,c))this._vvMap||(this._vvMap=new J),this._vvMap.set(d,n)}};a.prototype._createGetValueFunction=function(a,b,c){if(m.getVVType(a.type)===d.VVType.SIZE){var f=p.getTypeOfSizeVisualVariable(a);return f===d.WGLVVFlag.SIZE_SCALE_STOPS?
null:this._createNormalizedFunction(a,b,c,f===d.WGLVVFlag.SIZE_UNIT_VALUE&&function(b){return p.getVisualVariableSizeValueRepresentationRatio(b,a.valueRepresentation)})}return this._createNormalizedFunction(a,b,c)};a.prototype._createNormalizedFunction=function(a,b,f,n){var d=a.field;if(d){if("string"===typeof d){var e=a.normalizationField;return e?function(a){if(a.attributes[d]&&a.attributes[e])return a=a.attributes[d]/a.attributes[e],n?n(a):a}:n?function(a){return n(a.attributes[d])}:function(a){return a.attributes[d]}}if("function"===
typeof d)return B.error(new c("mapview-rendering:unsupported-feature","Function field types are not currently supported. Please use a valueExpression instead")),function(a){};B.error(new c("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof d));return function(a){}}if(a.valueExpression&&"$view.scale"!==a.valueExpression)return m.createArcadeFunction({valueExpression:a.valueExpression,spatialReference:f,layer:b},n);B.error("Unable to create a normalized function for visual variable: "+
a);return function(a){}};a._fromSimpleRenderer=function(b,c,f,d,e,r,m,p){var h=b.getSymbols();b=b.visualVariables;var g=n.getVVFlags(b),B=new z.default,l=new D;h.length&&B.setDefault(u.createMeshTemplates([],l,h[0],f,g,m));return new a(B,c,l,d,e,b,g,r,m,p)};a._fromUniqueValueRenderer=function(b,c,f,d,e,r,m,p){var h=b.uniqueValueInfos,g=b.visualVariables,B=n.getVVFlags(g),l=[b.field];b.field2&&l.push(b.field2);b.field3&&l.push(b.field3);for(var C=b.valueExpression,l=new z.MapMatcher(l,b.fieldDelimiter,
C?{valueExpression:C,spatialReference:r,layer:c}:null),C=new D,q=b.backgroundFillSymbol,q=q&&u.createMeshTemplates([],C,q,f,B,m),t=0;t<h.length;t++){var k=h[t],F=u.createMeshTemplates([],C,k.symbol,f,B,m);l.add(k.value,q?q.concat(F):F)}if(b=b.defaultSymbol)f=u.createMeshTemplates([],C,b,f,B,m),l.setDefault(q?q.concat(f):f);return new a(l,c,C,d,e,g,B,r,m,p)};a._fromClassBreaksRenderer=function(b,c,f,d,e,r,m,p){for(var h=b.isMaxInclusive,g=b.visualVariables,B=b.valueExpression,l=b.normalizationField,
C=b.normalizationTotal,q=b.normalizationType,t=n.getVVFlags(g),h=new z.IntervalMatcher(b.field,h,B?{valueExpression:B,spatialReference:r,layer:c}:null,{normalizationField:l,normalizationTotal:C,normalizationType:q}),B=new D,l=(l=b.backgroundFillSymbol)&&u.createMeshTemplates([],B,l,f,t,m,!0),C=0,q=b.classBreakInfos;C<q.length;C++){var k=q[C],F=u.createMeshTemplates([],B,k.symbol,f,t,m);h.add({min:k.minValue,max:k.maxValue},l?l.concat(F):F)}if(b=b.defaultSymbol)f=u.createMeshTemplates([],B,b,f,t,m),
h.setDefault(l?l.concat(f):f);return new a(h,c,B,d,e,g,t,r,m,p)};return a}();b.default=k})},"esri/layers/vectorTiles/symbols/SimpleLineSymbol":function(){define(["../core/declare","../core/lang","../core/screenUtils","./LineSymbol"],function(k,b,a,c){var e={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dash-dot",STYLE_DASHDOTDOT:"long-dash-dot-dot",STYLE_NULL:"none",STYLE_SHORTDASH:"short-dash",STYLE_SHORTDOT:"short-dot",STYLE_SHORTDASHDOT:"short-dash-dot",STYLE_SHORTDASHDOTDOT:"short-dash-dot-dot",
STYLE_LONGDASH:"long-dash",STYLE_LONGDASHDOT:"long-dash-dot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},g={color:[0,0,0,1],style:e.STYLE_SOLID,width:.75,cap:e.CAP_BUTT,join:e.JOIN_MITER,miterLimit:7.5},l=k(c,{declaredClass:"esri.symbols.SimpleLineSymbol",properties:{type:"simple-line",style:{value:e.STYLE_SOLID,json:{read:function(a,c){return b.valueOf(this._jsonStyles,a)||void 0},write:function(a,b){b.style=this._jsonStyles[a]}}},
cap:{value:e.CAP_BUTT,json:{read:!1,write:!1}},join:{value:e.JOIN_MITER,json:{read:!1,write:!1}},miterLimit:{value:7.5,cast:a.toPt,json:{read:!1,write:!1}}},_jsonStyles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot","dash-dot":"esriSLSDashDot","long-dash-dot-dot":"esriSLSDashDotDot",none:"esriSLSNull","inside-frame":"esriSLSInsideFrame","short-dash":"esriSLSShortDash","short-dot":"esriSLSShortDot","short-dash-dot":"esriSLSShortDashDot","short-dash-dot-dot":"esriSLSShortDashDotDot","long-dash":"esriSLSLongDash",
"long-dash-dot":"esriSLSLongDashDot"},getDefaults:function(){return b.mixin(this.inherited(arguments),g)},normalizeCtorArgs:function(b,c,e,p,g,l){if(b&&"string"!==typeof b)return b;var d={};null!=b&&(d.style=b);null!=c&&(d.color=c);null!=e&&(d.width=a.toPt(e));null!=p&&(d.cap=p);null!=g&&(d.join=g);null!=l&&(d.miterLimit=a.toPt(l));return d},clone:function(){return new l({color:b.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})}});b.mixin(l,
e);l.defaultProps=g;return l})},"esri/layers/vectorTiles/symbols/LineSymbol":function(){define(["../core/declare","../core/screenUtils","./Symbol"],function(k,b,a){return k(a,{declaredClass:"esri.symbols.LineSymbol",properties:{color:{},type:"simple-line",width:{value:.75,cast:b.toPt,json:{write:!0}}}})})},"esri/layers/vectorTiles/symbols/Symbol":function(){define(["../core/lang","../core/kebabDictionary","../core/JSONSupport","../Color"],function(k,b,a,c){var e=b({esriSMS:"simple-marker",esriPMS:"picture-marker",
esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),g=0;return a.createSubclass({declaredClass:"esri.symbols.Symbol",constructor:function(){this.id="sym"+g++},properties:{type:{type:String,value:null,json:{read:e.fromJSON,write:{ignoreOrigin:!0,writer:function(a,b){b.type=e.toJSON(this.type)}}}},color:{type:c,value:new c([0,
0,0,1]),json:{read:function(a){return a&&k.isDefined(a[0])?[a[0],a[1],a[2],a[3]/255]:a},write:{allowNull:!0}}}}})})},"esri/layers/vectorTiles/core/kebabDictionary":function(){define(["require","exports"],function(k,b){return function(a,b){void 0===b&&(b={});var c=b.ignoreUnknown||!1,g={},l;for(l in a)g[a[l]]=l;var d=function(a){return g.hasOwnProperty(a)?g[a]:c?void 0:a},h=function(b){return a.hasOwnProperty(b)?a[b]:c?void 0:b};return{toJSON:d,fromJSON:h,read:function(a){return h(a)},write:function(a,
b,c){a=d(a);void 0!==a&&(b[c]=a)}}}})},"esri/layers/vectorTiles/Color":function(){define(["./core/declare","./core/accessorSupport/ensureType","dojo/colors"],function(k,b,a){function c(a){return Math.max(0,Math.min(b.ensureInteger(a),255))}var e=k([a],{declaredClass:"esri.Color",toJSON:function(){return[c(this.r),c(this.g),c(this.b),1<this.a?this.a:c(255*this.a)]},clone:function(){return new e(this.toRgba())}});e.toJSON=function(a){return a&&[c(a.r),c(a.g),c(a.b),1<a.a?a.a:c(255*a.a)]};e.fromJSON=
function(a){return a&&new e([a[0],a[1],a[2],a[3]/255])};e.toUnitRGB=function(a){return[a.r/255,a.g/255,a.b/255]};e.toUnitRGBA=function(a){return[a.r/255,a.g/255,a.b/255,null!=a.a?a.a:1]};var g="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(k=0;k<g.length;k++)e[g[k]]=a[g[k]];e.named.rebeccapurple=[102,51,153];return e})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(k,b,a,c){var e={};b.setObject("dojo.colors",e);
var g=function(a,b,c){0>c&&++c;1<c&&--c;var d=6*c;return 1>d?a+(b-a)*d:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a};k.colorFromRgb=a.fromRgb=function(b,e){var d=b.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(d){b=d[2].split(/\s*,\s*/);var p=b.length,d=d[1];if("rgb"==d&&3==p||"rgba"==d&&4==p)return d=b[0],"%"==d.charAt(d.length-1)?(d=c.map(b,function(a){return 2.56*parseFloat(a)}),4==p&&(d[3]=b[3]),a.fromArray(d,e)):a.fromArray(b,e);if("hsl"==d&&3==p||"hsla"==d&&4==p){var d=(parseFloat(b[0])%
360+360)%360/360,h=parseFloat(b[1])/100,l=parseFloat(b[2])/100,h=.5>=l?l*(h+1):l+h-l*h,l=2*l-h,d=[256*g(l,h,d+1/3),256*g(l,h,d),256*g(l,h,d-1/3),1];4==p&&(d[3]=b[3]);return a.fromArray(d,e)}}return null};var l=function(a,b,c){a=Number(a);return isNaN(a)?c:a<b?b:a>c?c:a};a.prototype.sanitize=function(){this.r=Math.round(l(this.r,0,255));this.g=Math.round(l(this.g,0,255));this.b=Math.round(l(this.b,0,255));this.a=l(this.a,0,1);return this};e.makeGrey=a.makeGrey=function(b,c){return a.fromArray([b,b,
b,c])};b.mixin(a.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,
169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,
34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,
250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,
104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,
192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,
222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return a})},"esri/layers/vectorTiles/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.EXTRUDE_SCALE=64;b.PICTURE_FILL_COLOR=4294967295;b.TILE_SIZE=512;b.ANGLE_FACTOR_256=256/360;b.COLLISION_BUCKET_SIZE=128;b.COLLISION_MAX_ZOOM_DELTA=4;b.COLLISION_EARLY_REJECT_BUCKET_SIZE=32})},"esri/layers/vectorTiles/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/screenUtils ./color ./enums ./Utils ../../../3d/layers/support/FastSymbolUpdates".split(" "),
function(k,b,a,c,e,g,l){function d(a){return g.isNumber(a.minDataValue)&&g.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize?e.WGLVVFlag.SIZE_MINMAX_VALUE:(a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops)?e.WGLVVFlag.SIZE_SCALE_STOPS:(null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&Array.isArray(a.stops)?e.WGLVVFlag.SIZE_FIELD_STOPS:(null!=a.field||a.expression&&
"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit?e.WGLVVFlag.SIZE_UNIT_VALUE:e.WGLVVFlag.NONE}function h(b){return{value:b.value,size:a.toPt(b.size)}}function m(a){return a.map(function(a){return h(a)})}function p(b){return"string"===typeof b||"number"===typeof b?a.toPt(b):{type:"size",expression:b.expression,stops:m(b.stops)}}function q(a){var b={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(g.isString(a.field))if(a.stops){if(8<a.stops.length)return null;
a=a.stops;for(var c=0;8>c;++c){var d=a[Math.min(c,a.length-1)];b.values[c]=d.value;b.opacities[c]=d.opacity}}else if(a.opacityValues){if(!g.isDefined(a.minDataValue)||!g.isDefined(a.maxDataValue)||2!==a.opacityValues.length)return null;b.values[0]=a.minDataValue;b.opacities[0]=a.opacityValues[0];b.values[1]=a.maxDataValue;b.opacities[1]=a.opacityValues[1];for(c=2;8>c;++c)b.values[c]=a.maxDataValue,b.opacities[c]=a.opacityValues[1]}else return null;else if(a.stops&&0<=a.stops.length||a.opacityValues&&
0<=a.opacityValues.length)for(a=a.stops&&0<=a.stops.length?a.stops[0].opacity:a.opacityValues[0],c=0;8>c;c++)b.values[c]=Infinity,b.opacities[c]=a;else return null;return b}Object.defineProperty(b,"__esModule",{value:!0});b.getTypeOfSizeVisualVariable=d;b.getVisualVariableSizeValueRepresentationRatio=function(a,b){if(!a||!b)return a;switch(b){case "radius":case "distance":return 2*a;case "area":return Math.sqrt(a)}return a};b.stopToSizeStop=h;b.normalizeSizeStops=m;b.normalizeSizeElement=p;b.getVisualVariablesFields=
function(a){var b=a&&0<a.length?{}:null;b&&a.forEach(function(a){var c=a.type;a.field&&(b[c]=a.field)});return b};b.convertVisualVariables=function(b){var h=b&&0<b.length?{}:null,g=h?{}:null;if(!h)return{vvFields:h,vvRanges:g};for(var k=0;k<b.length;k++){var t=b[k],z=t.type;t.field&&(h[z]=t.field);if("size"===z){g.size||(g.size={});var f=t;switch(d(f)){case e.WGLVVFlag.SIZE_MINMAX_VALUE:g.size.minMaxValue={minDataValue:f.minDataValue,maxDataValue:f.maxDataValue,minSize:p(f.minSize),maxSize:p(f.maxSize)};
break;case e.WGLVVFlag.SIZE_SCALE_STOPS:g.size.scaleStops={stops:m(f.stops)};break;case e.WGLVVFlag.SIZE_FIELD_STOPS:for(var t=[],z=[],f=m(f.stops),n=f.length,r=0;6>r;r++){var B=f[Math.min(r,n-1)];t.push(B.value);z.push(a.pt2px(B.size))}g.size.fieldStops={values:t,sizes:z};break;case e.WGLVVFlag.SIZE_UNIT_VALUE:g.size.unitValue={unit:f.valueUnit,valueRepresentation:f.valueRepresentation}}}else if("color"===z)for(t=l.convertVisualVariables([t],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}),
g.color=t.color,r=0;32>r;r+=4)c.premultiplyAlpha(g.color.colors,r,!0);else"opacity"===z?g.opacity=q(t):"rotation"===z&&(g.rotation={type:t.rotationType})}return{vvFields:h,vvRanges:g}}})},"esri/layers/vectorTiles/views/3d/layers/support/FastSymbolUpdates":function(){define(["require","exports","../../../../renderers/support/utils","../graphics/graphicUtils","../../lib/glMatrix"],function(k,b,a,c,e){function g(a){return null!==a&&void 0!==a}function l(a){return"number"===typeof a}function d(a,b){a&&
a.push(b)}function h(b,c,f,n,e){var r=b.minSize,p=b.maxSize;if(b.expression)return d(e,"Could not convert size info: expression not supported"),!1;if(b.useSymbolValue)return b=n.symbolSize[f],c.minSize[f]=b,c.maxSize[f]=b,c.offset[f]=c.minSize[f],c.factor[f]=0,c.type[f]=1,!0;if(g(b.field)){if(g(b.stops)){if(2===b.stops.length&&l(b.stops[0].size)&&l(b.stops[1].size))return m(b.stops[0].size,b.stops[1].size,b.stops[0].value,b.stops[1].value,c,f),c.type[f]=1,!0;d(e,"Could not convert size info: stops only supported with 2 elements");
return!1}if(l(r)&&l(p)&&g(b.minDataValue)&&g(b.maxDataValue))return m(r,p,b.minDataValue,b.maxDataValue,c,f),c.type[f]=1,!0;if(null!=a.meterIn[b.valueUnit])return c.minSize[f]=-Infinity,c.maxSize[f]=Infinity,c.offset[f]=0,c.factor[f]=1/a.meterIn[b.valueUnit],c.type[f]=1,!0;"unknown"===b.valueUnit?d(e,"Could not convert size info: proportional size not supported"):d(e,"Could not convert size info: scale-dependent size not supported");return!1}if(!g(b.field)){if(b.stops&&b.stops[0]&&l(b.stops[0].size))return c.minSize[f]=
b.stops[0].size,c.maxSize[f]=b.stops[0].size,c.offset[f]=c.minSize[f],c.factor[f]=0,c.type[f]=1,!0;if(l(r))return c.minSize[f]=r,c.maxSize[f]=r,c.offset[f]=r,c.factor[f]=0,c.type[f]=1,!0}d(e,"Could not convert size info: unsupported variant of sizeInfo");return!1}function m(a,b,c,f,n,d){f=0<Math.abs(f-c)?(b-a)/(f-c):0;n.minSize[d]=0<f?a:b;n.maxSize[d]=0<f?b:a;n.offset[d]=a-c*f;n.factor[d]=f}function p(a,b,c,f){if(a.normalizationField||a.valueRepresentation)return d(f,"Could not convert size info: unsupported property"),
null;var n=a.field;if(null!=n&&"string"!==typeof n)return d(f,"Could not convert size info: field is not a string"),null;if(!b.size)b.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=a.field;else if(a.field!==b.size.field)return d(f,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(n=h(a,b.size,0,c,f))?b:null;case "height":return(n=h(a,b.size,2,c,f))?b:null;case "depth":return(n=
h(a,b.size,1,c,f))?b:null;case "width-and-depth":return(n=h(a,b.size,0,c,f))&&h(a,b.size,1,c,f),n?b:null;case null:case void 0:case "all":return(n=(n=(n=h(a,b.size,0,c,f))&&h(a,b.size,1,c,f))&&h(a,b.size,2,c,f))?b:null;default:return d(f,'Could not convert size info: unknown axis "'+a.axis+'""'),null}}function q(a,b,c){for(var f=0;3>f;++f){var n=b.unitInMeters;1===a.type[f]&&(n*=b.modelSize[f],a.type[f]=2);a.minSize[f]/=n;a.maxSize[f]/=n;a.offset[f]/=n;a.factor[f]/=n}if(0!==a.type[0])b=0;else if(0!==
a.type[1])b=1;else if(0!==a.type[2])b=2;else return d(c,"No size axis contains a valid size or scale"),!1;for(f=0;3>f;++f)0===a.type[f]&&(a.minSize[f]=a.minSize[b],a.maxSize[f]=a.maxSize[b],a.offset[f]=a.offset[b],a.factor[f]=a.factor[b],a.type[f]=a.type[b]);return!0}function t(a,b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function u(a,b,c){if(a.normalizationField)return d(c,"Could not convert color info: unsupported property"),null;if("string"===typeof a.field)if(a.stops){if(8<
a.stops.length)return d(c,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};a=a.stops;for(c=0;8>c;++c){var f=a[Math.min(c,a.length-1)];b.color.values[c]=f.value;t(b.color.colors,c,f.color)}}else if(a.colors){if(!g(a.minDataValue)||!g(a.maxDataValue))return d(c,"Could not convert color info: missing data values"),null;if(2!==a.colors.length)return d(c,"Could not convert color info: invalid colors array"),
null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};b.color.values[0]=a.minDataValue;t(b.color.colors,0,a.colors[0]);b.color.values[1]=a.maxDataValue;t(b.color.colors,1,a.colors[1]);for(c=2;8>c;++c)b.color.values[c]=a.maxDataValue,t(b.color.colors,c,a.colors[1])}else return d(c,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length||a.colors&&0<=a.colors.length)for(a=a.stops&&0<=a.stops.length?
a.stops[0].color:a.colors[0],b.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},c=0;8>c;c++)b.color.values[c]=Infinity,t(b.color.colors,c,a);else return d(c,"Could not convert color info: no field and no colors/stops"),null;return b}function y(a,b,c,f){a=2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function x(a,b,c){if("string"!==typeof a.field)return d(c,"Could not convert rotation info: field is not a string"),
null;if(!b.rotation)b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!b.rotation.field)b.rotation.field=a.field;else if(a.field!==b.rotation.field)return d(c,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return y(a,b.rotation,0,c),b;case "roll":return y(a,b.rotation,1,c),b;case null:case void 0:case "heading":return y(a,b.rotation,2,c),b;default:return d(c,'Could not convert rotation info: unknown axis "'+a.axis+
'""'),null}}function A(a,b,c){if(!a)return null;var f=!b.supportedTypes||!!b.supportedTypes.size,n=!b.supportedTypes||!!b.supportedTypes.color,e=!b.supportedTypes||!!b.supportedTypes.rotation;return(a=a.reduce(function(a,r){if(!a)return a;if(r.valueExpression)return d(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(r.type){case "size":return f?p(r,a,b,c):a;case "color":return n?u(r,a,c):a;case "rotation":return e?x(r,a,c):a;default:return d(c,"Could not convert visual variables: unsupported type "+
r.type),null}},{size:null,color:null,rotation:null}))&&a.size&&!q(a.size,b,c)?null:a}function z(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function f(a,b){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvSymbolAnchor:null,vvSymbolRotation:null},
f=a&&null!=a.size;a&&a.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=a.size.minSize,c.vvSizeMaxSize=a.size.maxSize,c.vvSizeOffset=a.size.offset,c.vvSizeFactor=a.size.factor):a&&f&&(c.vvSizeValue=b.transformation.scale);a&&f&&(c.vvSymbolAnchor=b.transformation.anchor,c.vvSymbolRotation=b.transformation.rotation);a&&a.color&&(c.vvColorEnabled=!0,c.vvColorValues=a.color.values,c.vvColorColors=a.color.colors);return c}Object.defineProperty(b,"__esModule",{value:!0});b.convertVisualVariables=A;b.initFastSymbolUpdatesState=
function(a,b,c){return b&&a&&!a.disableFastUpdates?(a=A(a.visualVariables,c))?{enabled:!0,visualVariables:a,materialParameters:f(a,c),customTransformation:a&&null!=a.size}:{enabled:!1}:{enabled:!1}};b.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var n=a.visualVariables;b=A(b.visualVariables,c);if(!(b&&z(n.size,b.size,"size")&&z(n.color,b.color,"color")&&z(n.rotation,b.rotation,"rotation")))return!1;a.visualVariables=b;a.materialParameters=f(b,c);a.customTransformation=b&&
null!=b.size;return!0};b.getMaterialParams=f;var n;(function(a){var b=e.mat4d,f=e.vec3,n=b.create(),d=f.create();a.evaluateModelTransform=function(a,f,e){if(!a.vvSizeEnabled)return e;b.set(e,n);c.computeObjectRotation(a.vvSymbolRotation[2],a.vvSymbolRotation[0],a.vvSymbolRotation[1],n);if(a.vvSizeEnabled){for(e=0;3>e;++e){var r=a.vvSizeOffset[e]+f[0]*a.vvSizeFactor[e],m=e;var p=a.vvSizeMinSize[e],h=a.vvSizeMaxSize[e],r=r<p?p:r>h?h:r;d[m]=r}b.scale(n,d,n)}else b.scale(n,a.vvSizeValue,n);b.translate(n,
a.vvSymbolAnchor,n);return n}})(n||(n={}));b.evaluateModelTransform=n.evaluateModelTransform})},"esri/layers/vectorTiles/renderers/support/utils":function(){define(["dojo/date/locale","../../Color","../../core/lang","../../core/numberUtils","dojo/i18n!dojo/cldr/nls/gregorian"],function(k,b,a,c,e){function g(a){return a&&a.map(function(a){return new b(a)})}function l(a,b,c){var d="";0===b?d=h.lt+" ":b===c&&(d=h.gt+" ");return d+a}var d={},h={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",
ld:"\u2013"},m={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},p={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},
year:{selector:"date",dateOptions:{selector:"year"}}},q={formatLength:"short",fullYear:!0},t={formatLength:"short"};a.mixin(d,{meterIn:{inches:1/.0254,feet:1/.3048,"us-feet":3.28084,yards:1/.9144,miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(b,c){var d=[];null==b||b instanceof Date||(b=new Date(b));
c=c||{};c=a.mixin({},c);var m=c.selector?c.selector.toLowerCase():null,p=!m||-1<m.indexOf("time"),m=!m||-1<m.indexOf("date");p&&(c.timeOptions=c.timeOptions||t,c.timeOptions&&(c.timeOptions=a.mixin({},c.timeOptions),c.timeOptions.selector=c.timeOptions.selector||"time",d.push(c.timeOptions)));m&&(c.dateOptions=c.dateOptions||q,c.dateOptions&&(c.dateOptions=a.mixin({},c.dateOptions),c.dateOptions.selector=c.dateOptions.selector||"date",d.push(c.dateOptions)));d&&d.length?(d=d.map(function(a){return k.format(b,
a)}),c=1==d.length?d[0]:e["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return d[b]})):c=k.format(b);return c},createColorStops:function(a){var b=a.values,e=a.colors,m=a.labelIndexes,p=a.isDate,f=a.dateFormatOptions;a=[];return a=b.map(function(a,r){var n=null;if(!m||-1<m.indexOf(r)){var h;(h=p?d.formatDate(a,f):c.format(a))&&(n=l(h,r,b.length-1))}return{value:a,color:e[r],label:n}})},updateColorStops:function(a){var b=a.stops,e=a.changes,m=a.isDate,p=a.dateFormatOptions,
f=[],n,r=b.map(function(a){return a.value});e.forEach(function(a){f.push(a.index);r[a.index]=a.value});n=c.round(r,{indexes:f});b.forEach(function(a,f){a.value=r[f];if(null!=a.label){var e,h=null;(e=m?d.formatDate(n[f],p):c.format(n[f]))&&(h=l(e,f,b.length-1));a.label=h}})},createClassBreakLabel:function(a){var b=a.minValue,d=a.maxValue,e=a.isFirstBreak?"":h.gt+" ";a="percent-of-total"===a.normalizationType?h.pct:"";b=null==b?"":c.format(b);d=null==d?"":c.format(d);return e+b+a+" "+h.ld+" "+d+a},
setLabelsForClassBreaks:function(a){var b=a.classBreakInfos,e=a.classificationMethod,m=a.normalizationType,p=[];b&&b.length&&("standard-deviation"===e?console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method."):a.round?(p.push(b[0].minValue),b.forEach(function(a){p.push(a.maxValue)}),p=c.round(p),b.forEach(function(a,b){a.label=d.createClassBreakLabel({minValue:0===b?p[0]:p[b],maxValue:p[b+1],isFirstBreak:0===b,normalizationType:m})})):b.forEach(function(a,
b){a.label=d.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===b,normalizationType:m})}))},updateClassBreak:function(a){var b=a.classBreaks,c=a.normalizationType,e=a.change,m=e.index,e=e.value,f=-1,n=-1,r=b.length;"standard-deviation"===a.classificationMethod?console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method."):(0===m?f=m:m===r?n=m-1:(n=m-1,f=m),-1<f&&f<r&&(a=b[f],a.minValue=e,a.label=d.createClassBreakLabel({minValue:a.minValue,
maxValue:a.maxValue,isFirstBreak:0===f,normalizationType:c})),-1<n&&n<r&&(a=b[n],a.maxValue=e,a.label=d.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===n,normalizationType:c})))},calculateDateFormatInterval:function(a){var b,c,d=a.length,e,f,n,r,p,h,g=Infinity,l;a=a.map(function(a){return new Date(a)});for(b=0;b<d-1;b++){e=a[b];n=[];p=Infinity;h="";for(c=b+1;c<d;c++)f=a[c],f=e.getFullYear()!==f.getFullYear()&&"year"||e.getMonth()!==f.getMonth()&&"month"||e.getDate()!==
f.getDate()&&"day"||e.getHours()!==f.getHours()&&"hour"||e.getMinutes()!==f.getMinutes()&&"minute"||e.getSeconds()!==f.getSeconds()&&"second"||"millisecond",r=m[f],r<p&&(p=r,h=f),n.push(f);p<g&&(g=p,l=h)}return l},createUniqueValueLabel:function(a){var b=a.value,e=a.fieldInfo,m=a.domain;a=a.dateFormatInterval;var h=String(b);(m=m&&m.codedValues?m.getName(b):null)?h=m:"number"===typeof b&&(h=e&&"date"===e.type?d.formatDate(b,a&&p[a]):c.format(b));return h},cloneColorVariable:function(c){var d;c&&(d=
a.mixin({},c),d.colors=g(d.colors),d.stops=d.stops&&d.stops.map(function(c){c=a.mixin({},c);c.color&&(c.color=new b(c.color));return c}),d.legendOptions&&(d.legendOptions=a.mixin({},d.legendOptions)));return d},cloneOpacityVariable:function(b){var c;if(b){c=a.mixin({},b);if(b=c.opacityValues)c.opacityValues=b.slice(0);if(b=c.stops)c.stops=b.map(function(b){return a.mixin({},b)});if(b=c.legendOptions)c.legendOptions=a.mixin({},b)}return c},cloneSizeVariable:function(b){var c;b&&(c=a.mixin({},b),c.stops&&
(c.stops=c.stops.map(function(b){return a.mixin({},b)})),(b=c.minSize)&&"object"===typeof b&&(c.minSize=d.cloneSizeVariable(b)),(b=c.maxSize)&&"object"===typeof b&&(c.maxSize=d.cloneSizeVariable(b)),b=c.legendOptions)&&(c.legendOptions=a.mixin({},b),b=b.customValues)&&(c.legendOptions.customValues=b.slice(0));return c}});return d})},"esri/layers/vectorTiles/core/numberUtils":function(){define(["dojo/number","dojo/i18n!dojo/cldr/nls/number"],function(k,b){function a(a,b){return a-b}var c=/^-?(\d+)(\.(\d+))?$/i,
e=new RegExp("\\"+b.decimal+"0+$","g"),g=/(\d)0*$/g,l={numDigits:function(a){var b=String(a),d=b.match(c);a={integer:0,fractional:0};d&&d[1]?(a.integer=d[1].split("").length,a.fractional=d[3]?d[3].split("").length:0):-1<b.toLowerCase().indexOf("e")&&(d=b.split("e"),b=d[0],d=d[1],b&&d&&(b=Number(b),d=Number(d),(a=0<d)||(d=Math.abs(d)),b=l.numDigits(b),a?(b.integer+=d,b.fractional=d>b.fractional?0:b.fractional-d):(b.fractional+=d,b.integer=d>b.integer?1:b.integer-d),a=b));return a},percentChange:function(a,
b,c,e){var d={previous:null,next:null},m;null!=c&&(m=a-c,d.previous=Math.floor(Math.abs(100*(b-c-m)/m)));null!=e&&(m=e-a,d.next=Math.floor(Math.abs(100*(e-b-m)/m)));return d},round:function(b,c){b=b.slice(0);var d,e,h,g,k,y,x,A,z=c&&null!=c.tolerance?c.tolerance:2,f=c&&c.indexes,n=c&&null!=c.strictBounds?c.strictBounds:!1;if(f)f.sort(a);else for(f=[],k=0;k<b.length;k++)f.push(k);for(k=0;k<f.length;k++)if(A=f[k],c=b[A],d=0===A?null:b[A-1],e=A===b.length-1?null:b[A+1],h=l.numDigits(c),h=h.fractional){y=
0;for(x=!1;y<=h&&!x;){g=c;x=y;var r=void 0,B=void 0,r=Number(g.toFixed(x));r<g?B=r+1/Math.pow(10,x):(B=r,r-=1/Math.pow(10,x));r=Number(r.toFixed(x));B=Number(B.toFixed(x));g=[r,B];g=n&&0===k?g[1]:g[0];x=z;var r=l.percentChange(c,g,d,e),C=B=void 0,B=void 0,B=null==r.previous||r.previous<=x,C=null==r.next||r.next<=x;x=B=B&&C||r.previous+r.next<=2*x;y++}x&&(b[A]=g)}return b},format:function(a,b){b=b||{places:20,round:-1};(a=k.format(a,b))&&(a=a.replace(g,"$1").replace(e,""));return a}};return l})},"esri/layers/vectorTiles/views/3d/layers/graphics/graphicUtils":function(){define("require exports ../../../../geometry ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/coordsUtils ../../../../geometry/support/webMercatorUtils ../../../../layers/graphics/dehydratedFeatures ../../lib/glMatrix ../../support/mathUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p){function q(a){var b=a.paths[0];if(!b||0===b.length)return null;b=l.getPointOnPath(b,l.getPathLength(b)/2);return h.makeDehydratedPoint(b[0],b[1],b[2],a.spatialReference)}function t(a){if(Array.isArray(a)){for(var b=0;b<a.length;b++)if(!t(a[b]))return!1;return!0}return null==a||0<=a}Object.defineProperty(b,"__esModule",{value:!0});var u=[1,1,1];b.computeCentroid=function(a){if("point"===a.type)return a;if(h.isHydratedGeometry(a))switch(a.type){case "extent":return a.center;
case "polygon":return a.centroid;case "polyline":return q(a);case "mesh":return a.extent.center}else switch(a.type){case "extent":var b=p.isFinite(a.zmin);return h.makeDehydratedPoint(.5*(a.xmax+a.xmin),.5*(a.ymax+a.ymin),b?.5*(a.zmax+a.zmin):void 0,a.spatialReference);case "polygon":return b=g.ringsCentroid(a.rings,h.hasZ(a)),h.makeDehydratedPoint(b[0],b[1],b[2],a.spatialReference);case "polyline":return q(a)}};b.convertPointSR=function(b,c){var e=b.spatialReference;e.isWebMercator&&c.isWGS84?(d.xyToLngLat(b.x,
b.y,y),b.x=y[0],b.y=y[1],b.spatialReference=a.SpatialReference.WGS84):c.isWebMercator&&e.isWGS84&&(d.lngLatToXY(b.x,b.y,y),b.x=y[0],b.y=y[1],b.spatialReference=a.SpatialReference.WebMercator)};b.enlargeExtent=function(a,b,c){if(a){b||(b=e.create());var f=.5*a.width*(c-1);c=.5*a.height*(c-1);a.width<1E-7*a.height?f+=c/20:a.height<1E-7*a.width&&(c+=f/20);m.vec4d.set4(a.xmin-f,a.ymin-c,a.xmax+f,a.ymax+c,b);return b}return null};b.updateVertexAttributeAuxpos1w=function(a,b){for(var c=0;c<a.geometries.length;++c){var f=
a.geometries[c].data.vertexAttributes.auxpos1;f&&f.data[3]!==b&&(f.data[3]=b,a.geometryVertexAttrsUpdated(c))}};b.mixinColorAndOpacity=function(a,b){var c=[1,1,1,1];null!=a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);null!==b&&void 0!==b?c[3]=b:null!=a&&3<a.length&&(c[3]=a[3]);return c};b.overrideColor=function(a,b,c,f,n,d){void 0===d&&(d=[0,0,0,0]);for(var e=0;3>e;++e)d[e]=a&&null!=a[e]?a[e]:c&&null!=c[e]?c[e]:n[e];d[3]=null!=b?b:null!=f?f:n[3];return d};b.computeObjectScale=function(a,b,c,f){void 0===a&&(a=
u);void 0===f&&(f=1);var n=Array(3);if(null==b||null==c)n[0]=1,n[1]=1,n[2]=1;else{for(var d=void 0,e=0,m=2;0<=m;m--){var p=a[m],h=void 0,g=null!=p,l=0===m&&!d&&!g,q=c[m];"symbolValue"===p||l?h=0!==q?b[m]/q:1:g&&"proportional"!==p&&isFinite(p)&&(h=0!==q?p/q:1);null!=h&&(d=n[m]=h,e=Math.max(e,Math.abs(h)))}for(m=2;0<=m;m--)null==n[m]?n[m]=d:0===n[m]&&(n[m]=.001*e)}for(m=2;0<=m;m--)n[m]/=f;return n};b.computeSizeWithResourceSize=function(a,b){var c=b.width,f=b.depth,n=b.height;b=b.isPrimitive?10:1;if(null==
c&&null==n&&null==f)return[b*a[0],b*a[1],b*a[2]];for(var c=[c,f,n],d,f=0;3>f;f++)if(n=c[f],null!=n){d=n/a[f];break}for(f=0;3>f;f++)null==c[f]&&(c[f]=a[f]*d);return c};b.validateSymbolLayerSize=function(a){null!=a.isPrimitive&&(a=[a.width,a.depth,a.height]);return t(a)?null:"Symbol sizes may not be negative values"};b.computeObjectRotation=function(a,b,c,f){void 0===f&&(f=m.mat4d.identity());a=a||0;b=b||0;c=c||0;0!==a&&m.mat4d.rotateZ(f,-a/180*Math.PI,f);0!==b&&m.mat4d.rotateX(f,b/180*Math.PI,f);0!==
c&&m.mat4d.rotateY(f,c/180*Math.PI,f);return f};b.demResolutionForBoundingBox=function(a,b){return null!=b.minDemResolution?b.minDemResolution:c.isPoint(a)?b.minDemResolutionForPoints:.01*c.maximumDimension(a)};var y=[0,0]})},"esri/layers/vectorTiles/geometry":function(){define("require exports ./geometry/Extent ./geometry/Geometry ./geometry/Mesh ./geometry/Multipoint ./geometry/Point ./geometry/Polygon ./geometry/Polyline ./geometry/ScreenPoint ./geometry/SpatialReference ./geometry/support/jsonUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q){Object.defineProperty(b,"__esModule",{value:!0});b.Extent=a;b.BaseGeometry=c;b.Mesh=e;b.Multipoint=g;b.Point=l;b.Polygon=d;b.Polyline=h;b.ScreenPoint=m;b.SpatialReference=p;b.isGeometry=function(a){return a instanceof b.BaseGeometry};b.fromJSON=q.fromJSON})},"esri/layers/vectorTiles/geometry/Extent":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Geometry ./Point ./SpatialReference ./support/contains ./support/intersects ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t){function u(a,b,c){return null==b?c:null==c?b:a(b,c)}k=function(b){function l(){for(var a=0;a<arguments.length;a++);a=b.call(this)||this;a.type="extent";a.xmin=0;a.ymin=0;a.mmin=void 0;a.zmin=void 0;a.xmax=0;a.ymax=0;a.mmax=void 0;a.zmax=void 0;return a}a(l,b);k=l;l.prototype.normalizeCtorArgs=function(a,b,c,d,e){return!a||"esri.geometry.SpatialReference"!==a.declaredClass&&null==a.wkid?"object"===typeof a?(a.spatialReference=null!=a.spatialReference?a.spatialReference:
h.WGS84,a):{xmin:a,ymin:b,xmax:c,ymax:d,spatialReference:null!=e?e:h.WGS84}:{spatialReference:a,xmin:0,ymin:0,xmax:0,ymax:0}};Object.defineProperty(l.prototype,"center",{get:function(){var a=new d({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});this.hasZ&&(a.z=.5*(this.zmin+this.zmax));this.hasM&&(a.m=.5*(this.mmin+this.mmax));return a},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"extent",{get:function(){return this.clone()},enumerable:!0,
configurable:!0});Object.defineProperty(l.prototype,"hasM",{get:function(){return null!=this.mmin&&null!=this.mmax},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"hasZ",{get:function(){return null!=this.zmin&&null!=this.zmax},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"height",{get:function(){return Math.abs(this.ymax-this.ymin)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"width",{get:function(){return Math.abs(this.xmax-this.xmin)},
enumerable:!0,configurable:!0});l.prototype.centerAt=function(a){var b=this.center;return null!=a.z&&this.hasZ?this.offset(a.x-b.x,a.y-b.y,a.z-b.z):this.offset(a.x-b.x,a.y-b.y)};l.prototype.clone=function(){var a=new k;a.xmin=this.xmin;a.ymin=this.ymin;a.xmax=this.xmax;a.ymax=this.ymax;a.spatialReference=this.spatialReference;null!=this.zmin&&(a.zmin=this.zmin,a.zmax=this.zmax);null!=this.mmin&&(a.mmin=this.mmin,a.mmax=this.mmax);return a};l.prototype.contains=function(a){if(!a)return!1;var b=this.spatialReference,
c=a.spatialReference;b&&c&&!b.equals(c)&&t.canProject(b,c)&&(a=b.isWebMercator?t.geographicToWebMercator(a):t.webMercatorToGeographic(a,!0));return"point"===a.type?m.extentContainsPoint(this,a):"extent"===a.type?m.extentContainsExtent(this,a):!1};l.prototype.equals=function(a){if(!a)return!1;var b=this.spatialReference,c=a.spatialReference;b&&c&&!b.equals(c)&&t.canProject(b,c)&&(a=b.isWebMercator?t.geographicToWebMercator(a):t.webMercatorToGeographic(a,!0));return this.xmin===a.xmin&&this.ymin===
a.ymin&&this.zmin===a.zmin&&this.mmin===a.mmin&&this.xmax===a.xmax&&this.ymax===a.ymax&&this.zmax===a.zmax&&this.mmax===a.mmax};l.prototype.expand=function(a){a=.5*(1-a);var b=this.width*a,c=this.height*a;this.xmin+=b;this.ymin+=c;this.xmax-=b;this.ymax-=c;this.hasZ&&(b=(this.zmax-this.zmin)*a,this.zmin+=b,this.zmax-=b);this.hasM&&(a*=this.mmax-this.mmin,this.mmin+=a,this.mmax-=a);return this};l.prototype.intersects=function(a){if(!a)return!1;var b=this.spatialReference,c=a.spatialReference;b&&c&&
!b.equals(c)&&t.canProject(b,c)&&(a=b.isWebMercator?t.geographicToWebMercator(a):t.webMercatorToGeographic(a,!0));b=p.getExtentIntersector(a.type);return"mesh"!==a.type?b(this,a):b(this,a.extent)};l.prototype.normalize=function(){var a=this._normalize(!1,!0);return Array.isArray(a)?a:[a]};l.prototype.offset=function(a,b,c){this.xmin+=a;this.ymin+=b;this.xmax+=a;this.ymax+=b;null!=c&&(this.zmin+=c,this.zmax+=c);return this};l.prototype.shiftCentralMeridian=function(){return this._normalize(!0)};l.prototype.union=
function(a){this.xmin=Math.min(this.xmin,a.xmin);this.ymin=Math.min(this.ymin,a.ymin);this.xmax=Math.max(this.xmax,a.xmax);this.ymax=Math.max(this.ymax,a.ymax);if(this.hasZ||a.hasZ)this.zmin=u(Math.min,this.zmin,a.zmin),this.zmax=u(Math.max,this.zmax,a.zmax);if(this.hasM||a.hasM)this.mmin=u(Math.min,this.mmin,a.mmin),this.mmax=u(Math.max,this.mmax,a.mmax);return this};l.prototype.intersection=function(a){if(!this.intersects(a))return null;this.xmin=Math.max(this.xmin,a.xmin);this.ymin=Math.max(this.ymin,
a.ymin);this.xmax=Math.min(this.xmax,a.xmax);this.ymax=Math.min(this.ymax,a.ymax);if(this.hasZ||a.hasZ)this.zmin=u(Math.max,this.zmin,a.zmin),this.zmax=u(Math.min,this.zmax,a.zmax);if(this.hasM||a.hasM)this.mmin=u(Math.max,this.mmin,a.mmin),this.mmax=u(Math.min,this.mmax,a.mmax);return this};l.prototype.toJSON=function(a){return this.write(null,a)};l.prototype._shiftCM=function(a){void 0===a&&(a=q.getInfo(this.spatialReference));if(!a||!this.spatialReference)return this;var b=this.spatialReference,
c=this._getCM(a);if(c){var d=b.isWebMercator?t.webMercatorToGeographic(c):c;this.xmin-=c.x;this.xmax-=c.x;b.isWebMercator||(d.x=this._normalizeX(d.x,a).x);this.spatialReference=new h(e.substitute({Central_Meridian:d.x},b.isWGS84?a.altTemplate:a.wkTemplate))}return this};l.prototype._getCM=function(a){var b=null,c=a.valid;a=c[0];var c=c[1],d=this.xmin,e=this.xmax;d>=a&&d<=c&&e>=a&&e<=c||(b=this.center);return b};l.prototype._normalize=function(a,b,c){var f=this.spatialReference;if(!f)return this;c=
c||q.getInfo(f);if(!c)return this;var n=this._getParts(c).map(function(a){return a.extent});if(2>n.length)return n[0]||this;if(2<n.length)return a?this._shiftCM(c):this.set({xmin:c.valid[0],xmax:c.valid[1]});if(a)return this._shiftCM(c);if(b)return n;var d=!0,e=!0;n.forEach(function(a){a.hasZ||(d=!1);a.hasM||(e=!1)});return{rings:n.map(function(a){var b=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(d)for(var c=(a.zmax-a.zmin)/2,f=0;f<b.length;f++)b[f].push(c);
if(e)for(a=(a.mmax-a.mmin)/2,f=0;f<b.length;f++)b[f].push(a);return b}),hasZ:d,hasM:e,spatialReference:f}};l.prototype._getParts=function(a){var b=this.cache._parts;if(!b){var b=[],c=this.ymin,d=this.ymax,e=this.spatialReference,m=this.width,p=this.xmin,h=this.xmax,g=void 0;a=a||q.getInfo(e);var l=a.valid,t=l[0],u=l[1],g=this._normalizeX(this.xmin,a),z=g.x,l=g.frameId,g=this._normalizeX(this.xmax,a),y=g.x;a=g.frameId;g=z===y&&0<m;if(m>2*u){m=new k(p<h?z:y,c,u,d,e);p=new k(t,c,p<h?y:z,d,e);h=new k(0,
c,u,d,e);c=new k(t,c,0,d,e);d=[];e=[];m.contains(h)&&d.push(l);m.contains(c)&&e.push(l);p.contains(h)&&d.push(a);p.contains(c)&&e.push(a);for(t=l+1;t<a;t++)d.push(t),e.push(t);b.push({extent:m,frameIds:[l]},{extent:p,frameIds:[a]},{extent:h,frameIds:d},{extent:c,frameIds:e})}else z>y||g?b.push({extent:new k(z,c,u,d,e),frameIds:[l]},{extent:new k(t,c,y,d,e),frameIds:[a]}):b.push({extent:new k(z,c,y,d,e),frameIds:[l]});this.cache._parts=b}a=this.hasZ;c=this.hasM;if(a||c)for(l={},a&&(l.zmin=this.zmin,
l.zmax=this.zmax),c&&(l.mmin=this.mmin,l.mmax=this.mmax),a=0;a<b.length;a++)b[a].extent.set(l);return b};l.prototype._normalizeX=function(a,b){var c=b.valid;b=c[0];var f=c[1],c=2*f,d=0;a>f?(b=Math.ceil(Math.abs(a-f)/c),a-=b*c,d=b):a<b&&(b=Math.ceil(Math.abs(a-b)/c),a+=b*c,d=-b);return{x:a,frameId:d}};c([g.property({dependsOn:"xmin ymin zmin mmin xmax ymax zmax mmax spatialReference".split(" ")})],l.prototype,"cache",void 0);c([g.property({readOnly:!0,dependsOn:["cache"]})],l.prototype,"center",null);
c([g.property({readOnly:!0,dependsOn:["cache"]})],l.prototype,"extent",null);c([g.property({readOnly:!0,dependsOn:["mmin","mmax"],json:{write:{enabled:!1,overridePolicy:null}}})],l.prototype,"hasM",null);c([g.property({readOnly:!0,dependsOn:["zmin","zmax"],json:{write:{enabled:!1,overridePolicy:null}}})],l.prototype,"hasZ",null);c([g.property({readOnly:!0,dependsOn:["ymin","ymax"]})],l.prototype,"height",null);c([g.property({readOnly:!0,dependsOn:["xmin","xmax"]})],l.prototype,"width",null);c([g.property({type:Number,
json:{write:!0}})],l.prototype,"xmin",void 0);c([g.property({type:Number,json:{write:!0}})],l.prototype,"ymin",void 0);c([g.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],l.prototype,"mmin",void 0);c([g.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],l.prototype,"zmin",void 0);c([g.property({type:Number,json:{write:!0}})],l.prototype,"xmax",void 0);
c([g.property({type:Number,json:{write:!0}})],l.prototype,"ymax",void 0);c([g.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],l.prototype,"mmax",void 0);c([g.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],l.prototype,"zmax",void 0);return l=k=c([g.subclass("esri.geometry.Extent")],l);var k}(g.declared(l));k.prototype.toJSON.isDefaultToJSON=!0;
return k})},"esri/layers/vectorTiles/geometry/support/contains":function(){define(["require","exports"],function(k,b){function a(a,b,c,e){return b>=a.xmin&&b<=a.xmax&&c>=a.ymin&&c<=a.ymax?null!=e&&a.hasZ?e>=a.zmin&&e<=a.zmax:!0:!1}function c(a,b){if(a=a.rings)if(Array.isArray(a[0][0])){for(var c=!1,h=0,m=a.length;h<m;h++)c=e(c,a[h],b);b=c}else b=e(!1,a,b);else b=!1;return b}function e(a,b,c){var d=c[0];c=c[1];for(var e=0,p=0,g=b.length;p<g;p++){e++;e===g&&(e=0);var l=b[p],k=l[0],l=l[1],y=b[e],x=y[0],
y=y[1];(l<c&&y>=c||y<c&&l>=c)&&k+(c-l)/(y-l)*(x-k)<d&&(a=!a)}return a}Object.defineProperty(b,"__esModule",{value:!0});b.extentContainsPoint=function(b,c){return a(b,c.x,c.y,c.z)};b.extentContainsExtent=function(b,c){var d=c.xmin,e=c.ymin,m=c.zmin,p=c.xmax,g=c.ymax,l=c.zmax;return b.hasZ&&c.hasZ?a(b,d,e,m)&&a(b,d,g,m)&&a(b,p,g,m)&&a(b,p,e,m)&&a(b,d,e,l)&&a(b,d,g,l)&&a(b,p,g,l)&&a(b,p,e,l):a(b,d,e)&&a(b,d,g)&&a(b,p,g)&&a(b,p,e)};b.extentContainsCoords2D=function(b,c){return a(b,c[0],c[1])};b.extentContainsCoords3D=
function(b,c){return a(b,c[0],c[1],c[2])};b.polygonContainsPoint=function(a,b){return c(a,[b.x,b.y])};b.polygonContainsCoords=c})},"esri/layers/vectorTiles/geometry/support/intersects":function(){define(["require","exports","./contains"],function(k,b,a){function c(b,c){return a.extentContainsPoint(b,c)}function e(a,b){var c=a.hasZ&&b.hasZ,f;if(a.xmin<=b.xmin){if(f=b.xmin,a.xmax<f)return!1}else if(f=a.xmin,b.xmax<f)return!1;if(a.ymin<=b.ymin){if(f=b.ymin,a.ymax<f)return!1}else if(f=a.ymin,b.ymax<f)return!1;
if(c&&b.hasZ)if(a.zmin<=b.zmin){if(c=b.zmin,a.zmax<c)return!1}else if(c=a.zmin,b.zmax<c)return!1;return!0}function g(b,c){var f=c.hasZ?a.extentContainsCoords3D:a.extentContainsCoords2D,d=0;for(c=c.points;d<c.length;d++)if(f(b,c[d]))return!0;return!1}function l(b,c){p[0]=b.xmin;p[1]=b.ymax;q[0]=b.xmax;q[1]=b.ymax;t[0]=b.xmin;t[1]=b.ymin;u[0]=b.xmax;u[1]=b.ymin;for(var f=0,d=y;f<d.length;f++)if(a.polygonContainsCoords(c,d[f]))return!0;f=0;for(c=c.rings;f<c.length;f++)if(d=c[f],d.length){var e=d[0];
if(a.extentContainsCoords2D(b,e))return!0;for(var m=1;m<d.length;m++){var g=d[m];if(a.extentContainsCoords2D(b,g)||h(e,g,x))return!0;e=g}}return!1}function d(b,c){p[0]=b.xmin;p[1]=b.ymax;q[0]=b.xmax;q[1]=b.ymax;t[0]=b.xmin;t[1]=b.ymin;u[0]=b.xmax;u[1]=b.ymin;c=c.paths;for(var f=0;f<c.length;f++){var d=c[f];if(c.length){var e=d[0];if(a.extentContainsCoords2D(b,e))return!0;for(var m=1;m<d.length;m++){var g=d[m];if(a.extentContainsCoords2D(b,g)||h(e,g,x))return!0;e=g}}}return!1}function h(a,b,c){for(var f=
0;f<c.length;f++)if(m(a,b,c[f][0],c[f][1]))return!0;return!1}function m(a,b,c,d,e){var f=a[0];a=a[1];var n=b[0];b=b[1];var r=c[0],m=c[1];c=d[0]-r;var r=f-r,p=n-f;d=d[1]-m;var m=a-m,h=b-a,g=d*p-c*h;if(0===g)return!1;c=(c*m-d*r)/g;r=(p*m-h*r)/g;return 0<=c&&1>=c&&0<=r&&1>=r?(e&&(e[0]=f+c*(n-f),e[1]=a+c*(b-a)),!0):!1}Object.defineProperty(b,"__esModule",{value:!0});b.extentIntersectsPoint=c;b.extentIntersectsExtent=e;b.extentIntersectsMultipoint=g;var p=[0,0],q=[0,0],t=[0,0],u=[0,0],y=[p,q,t,u],x=[[t,
p],[p,q],[q,u],[u,t]];b.extentIntersectsPolygon=l;b.extentIntersectsPolyline=d;var A=[0,0];b.isSelfIntersecting=function(a){for(var b=0;b<a.length;b++){for(var c=a[b],d=0;d<c.length-1;d++)for(var e=c[d],p=c[d+1],h=b+1;h<a.length;h++)for(var g=0;g<a[h].length-1;g++){var l=a[h][g],q=a[h][g+1],k=m(e,p,l,q,A);if(k&&!(A[0]===e[0]&&A[1]===e[1]||A[0]===l[0]&&A[1]===l[1]||A[0]===p[0]&&A[1]===p[1]||A[0]===q[0]&&A[1]===q[1]))return!0}g=c.length;if(!(4>=g))for(d=0;d<g-3;d++){var t=g-1;0===d&&(t=g-2);e=c[d];
p=c[d+1];for(h=d+2;h<t;h++)if(l=c[h],q=c[h+1],(k=m(e,p,l,q,A))&&!(A[0]===e[0]&&A[1]===e[1]||A[0]===l[0]&&A[1]===l[1]||A[0]===p[0]&&A[1]===p[1]||A[0]===q[0]&&A[1]===q[1]))return!0}}return!1};b.segmentIntersects=m;b.getExtentIntersector=function(a){switch(a){case "esriGeometryEnvelope":case "extent":return e;case "esriGeometryMultipoint":case "multipoint":return g;case "esriGeometryPoint":case "point":return c;case "esriGeometryPolygon":case "polygon":return l;case "esriGeometryPolyline":case "polyline":return d;
case "mesh":return e}}})},"esri/layers/vectorTiles/geometry/Mesh":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Geometry"],function(k,b,a,c){return function(b){function c(a){return b.call(this)||this}a(c,b);c.prototype.clone=function(){return new c};return c}(c)})},"esri/layers/vectorTiles/geometry/Multipoint":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./support/zmUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m){function p(a){return function(b,c){return null==b?c:null==c?b:a(b,c)}}k=function(b){function d(){for(var a=0;a<arguments.length;a++);a=b.call(this)||this;a.points=[];a.type="multipoint";return a}a(d,b);q=d;d.prototype.normalizeCtorArgs=function(a,b){if(!a&&!b)return null;var c={};Array.isArray(a)?(c.points=a,c.spatialReference=b):!a||"esri.geometry.SpatialReference"!==a.declaredClass&&null==a.wkid?(a.points&&(c.points=a.points),a.spatialReference&&(c.spatialReference=
a.spatialReference),a.hasZ&&(c.hasZ=a.hasZ),a.hasM&&(c.hasM=a.hasM)):c.spatialReference=a;if(a=c.points&&c.points[0])void 0===c.hasZ&&void 0===c.hasM?(c.hasZ=2<a.length,c.hasM=!1):void 0===c.hasZ?c.hasZ=3<a.length:void 0===c.hasM&&(c.hasM=3<a.length);return c};Object.defineProperty(d.prototype,"extent",{get:function(){var a=this.points;if(!a.length)return null;for(var b=new l,c=this.hasZ,d=this.hasM,f=c?3:2,n=a[0],e=p(Math.min),m=p(Math.max),h=n[0],g=n[1],q=n[0],n=n[1],k,t,u,G,Q=0,W=a.length;Q<W;Q++){var K=
a[Q],aa=K[0],ba=K[1],h=e(h,aa),g=e(g,ba),q=m(q,aa),n=m(n,ba);c&&2<K.length&&(aa=K[2],k=e(k,aa),u=m(u,aa));d&&K.length>f&&(K=K[f],t=e(t,K),G=m(G,K))}b.xmin=h;b.ymin=g;b.xmax=q;b.ymax=n;b.spatialReference=this.spatialReference;c?(b.zmin=k,b.zmax=u):(b.zmin=null,b.zmax=null);d?(b.mmin=t,b.mmax=G):(b.mmin=null,b.mmax=null);return b},enumerable:!0,configurable:!0});d.prototype.writePoints=function(a,b,c,d){b.points=e.clone(this.points)};d.prototype.addPoint=function(a){this.clearCache();m.updateSupportFromPoint(this,
a);Array.isArray(a)?this.points.push(a):this.points.push(a.toArray());return this};d.prototype.clone=function(){var a={points:e.clone(this.points),spatialReference:this.spatialReference};this.hasZ&&(a.hasZ=!0);this.hasM&&(a.hasM=!0);return new q(a)};d.prototype.getPoint=function(a){if(!this._validateInputs(a))return null;a=this.points[a];var b={x:a[0],y:a[1],spatialReference:this.spatialReference},c=2;this.hasZ&&(b.z=a[2],c=3);this.hasM&&(b.m=a[c]);return new h(b)};d.prototype.removePoint=function(a){if(!this._validateInputs(a))return null;
this.clearCache();return new h(this.points.splice(a,1)[0],this.spatialReference)};d.prototype.setPoint=function(a,b){if(!this._validateInputs(a))return this;this.clearCache();m.updateSupportFromPoint(b);this.points[a]=b.toArray();return this};d.prototype.toJSON=function(a){return this.write(null,a)};d.prototype._validateInputs=function(a){return null!=a&&0<=a&&a<this.points.length};c([g.property({dependsOn:["points","hasZ","hasM","spatialReference"]})],d.prototype,"cache",void 0);c([g.property({dependsOn:["cache"]})],
d.prototype,"extent",null);c([g.property({type:[[Number]],json:{write:{isRequired:!0}}})],d.prototype,"points",void 0);c([g.writer("points")],d.prototype,"writePoints",null);return d=q=c([g.subclass("esri.geometry.Multipoint")],d);var q}(g.declared(d));k.prototype.toJSON.isDefaultToJSON=!0;return k})},"esri/layers/vectorTiles/geometry/support/zmUtils":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});b.updateSupportFromPoint=function(a,b,e){void 0===
e&&(e=!1);var c=a.hasM,l=a.hasZ;Array.isArray(b)?4!==b.length||c||l?3===b.length&&e&&!c?(l=!0,c=!1):3===b.length&&c&&l&&(l=c=!1):l=c=!0:(l=!l&&b.hasZ&&(!c||b.hasM),c=!c&&b.hasM&&(!l||b.hasZ));a.hasZ=l;a.hasM=c}})},"esri/layers/vectorTiles/geometry/Polygon":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/centroid ./support/contains ./support/coordsUtils ./support/intersects ./support/webMercatorUtils ./support/zmUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x){function A(a){return function(b,c){return null==b?c:null==c?b:a(b,c)}}var z=A(Math.min),f=A(Math.max);k=function(b){function n(){for(var a=0;a<arguments.length;a++);a=b.call(this)||this;a.rings=[];a.type="polygon";return a}a(n,b);d=n;n.createEllipse=function(a){var b=a.center.x,c=a.center.y,f=a.center.z,n=a.center.m,e=a.center.hasZ,r=a.center.hasM,m=a.longAxis,p=a.shortAxis,h=a.numberOfPoints;a=a.view;for(var g=[],l=2*Math.PI/h,B=e?3:2,q=0;q<h;q++){var C=
a.toMap(m*Math.cos(q*l)+b,p*Math.sin(q*l)+c),C=[C.x,C.y];e&&(C[2]=f);r&&(C[B]=n);g.push(C)}g.push(g[0]);return new d({rings:[g],spatialReference:a.spatialReference})};n.createCircle=function(a){return d.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,view:a.view})};n.fromExtent=function(a){var b=a.clone().normalize();a=a.spatialReference;var c=!1,f=!1;b.map(function(a){a.hasZ&&(c=!0);a.hasM&&(f=!0)});b={rings:b.map(function(a){var b=[[a.xmin,a.ymin],[a.xmin,
a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(c&&a.hasZ)for(var n=a.zmin+.5*(a.zmax-a.zmin),d=0;d<b.length;d++)b[d].push(n);if(f&&a.hasM)for(a=a.mmin+.5*(a.mmax-a.mmin),d=0;d<b.length;d++)b[d].push(a);return b}),spatialReference:a};c&&(b.hasZ=!0);f&&(b.hasM=!0);return new d(b)};n.prototype.normalizeCtorArgs=function(a,b){var c=null,f,n,d=null;a&&!Array.isArray(a)?(c=a.rings?a.rings:null,b||(a.spatialReference?b=a.spatialReference:a.rings||(b=a)),f=a.hasZ,n=a.hasM):c=a;c=c||[];b=b||m.WGS84;
c.length&&c[0]&&null!=c[0][0]&&"number"===typeof c[0][0]&&(c=[c]);if(d=c[0]&&c[0][0])void 0===f&&void 0===n?(f=2<d.length,n=!1):void 0===f?f=!n&&3<d.length:void 0===n&&(n=!f&&3<d.length);return{rings:c,spatialReference:b,hasZ:f,hasM:n}};Object.defineProperty(n.prototype,"centroid",{get:function(){var a=p.polygonCentroid(this);if(!a||isNaN(a[0])||isNaN(a[1])||this.hasZ&&isNaN(a[2]))return null;var b=new h;b.x=a[0];b.y=a[1];b.spatialReference=this.spatialReference;this.hasZ&&(b.z=a[2]);return b},enumerable:!0,
configurable:!0});Object.defineProperty(n.prototype,"extent",{get:function(){var a=this.hasZ,b=this.hasM,c=this.spatialReference,n=this.rings,d=a?3:2;if(!n.length||!n[0].length)return null;for(var e=n[0][0],r=e[0],e=e[1],m=n[0][0],p=m[0],m=m[1],h=void 0,g=void 0,B=void 0,q=void 0,k=[],t=0;t<n.length;t++){for(var u=n[t],y=u[0],A=y[0],y=y[1],x=u[0],M=x[0],x=x[1],N=void 0,P=void 0,R=void 0,Z=void 0,V=0;V<u.length;V++){var L=u[V],da=L[0],fa=L[1],r=z(r,da),e=z(e,fa),p=f(p,da),m=f(m,fa),A=z(A,da),y=z(y,
fa),M=f(M,da),x=f(x,fa);a&&2<L.length&&(da=L[2],h=z(h,da),g=f(g,da),N=z(N,da),P=f(P,da));b&&L.length>d&&(Z=L[d],B=z(h,Z),q=f(g,Z),R=z(N,Z),Z=f(P,Z))}k.push(new l({xmin:A,ymin:y,zmin:N,mmin:R,xmax:M,ymax:x,zmax:P,mmax:Z,spatialReference:c}))}n=new l;n.xmin=r;n.ymin=e;n.xmax=p;n.ymax=m;n.spatialReference=c;a&&(n.zmin=h,n.zmax=g);b&&(n.mmin=B,n.mmax=q);n.cache._partwise=1<k.length?k:null;return n},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"isSelfIntersecting",{get:function(){return u.isSelfIntersecting(this.rings)},
enumerable:!0,configurable:!0});n.prototype.writePaths=function(a,b,c,f){b.rings=e.clone(this.rings)};n.prototype.addRing=function(a){if(a){this.clearCache();var b=this.rings,c=b.length;if(Array.isArray(a[0]))b[c]=a.concat();else{for(var f=[],n=0,d=a.length;n<d;n++)f[n]=a[n].toArray();b[c]=f}return this}};n.prototype.clone=function(){var a=new d;a.spatialReference=this.spatialReference;a.rings=e.clone(this.rings);a.hasZ=this.hasZ;a.hasM=this.hasM;return a};n.prototype.contains=function(a){if(!a)return!1;
y.canProject(a,this.spatialReference)&&(a=y.project(a,this.spatialReference));return q.polygonContainsPoint(this,a)};n.prototype.isClockwise=function(a){var b=this;a=Array.isArray(a[0])?a:a.map(function(a){return b.hasZ?b.hasM?[a.x,a.y,a.z,a.m]:[a.x,a.y,a.z]:[a.x,a.y]});return t.isClockwise(a,this.hasM,this.hasZ)};n.prototype.getPoint=function(a,b){if(!this._validateInputs(a,b))return null;a=this.rings[a][b];b=this.hasZ;var c=this.hasM;return b&&!c?new h(a[0],a[1],a[2],void 0,this.spatialReference):
c&&!b?new h(a[0],a[1],void 0,a[2],this.spatialReference):b&&c?new h(a[0],a[1],a[2],a[3],this.spatialReference):new h(a[0],a[1],this.spatialReference)};n.prototype.insertPoint=function(a,b,c){if(!this._validateInputs(a,b,!0))return this;this.clearCache();x.updateSupportFromPoint(this,c);Array.isArray(c)||(c=c.toArray());this.rings[a].splice(b,0,c);return this};n.prototype.removePoint=function(a,b){if(!this._validateInputs(a,b))return null;this.clearCache();return new h(this.rings[a].splice(b,1)[0],
this.spatialReference)};n.prototype.removeRing=function(a){if(!this._validateInputs(a,null))return null;this.clearCache();a=this.rings.splice(a,1)[0];var b=this.spatialReference;return a.map(function(a){return new h(a,b)})};n.prototype.setPoint=function(a,b,c){if(!this._validateInputs(a,b))return this;this.clearCache();x.updateSupportFromPoint(this,c);Array.isArray(c)||(c=c.toArray());this.rings[a][b]=c;return this};n.prototype._validateInputs=function(a,b,c){void 0===c&&(c=!1);return null==a||0>
a||a>=this.rings.length||null!=b&&(a=this.rings[a],c&&(0>b||b>a.length)||!c&&(0>b||b>=a.length))?!1:!0};n.prototype.toJSON=function(a){return this.write(null,a)};c([g.property({dependsOn:["hasM","hasZ","rings"]})],n.prototype,"cache",void 0);c([g.property({readOnly:!0,dependsOn:["cache"]})],n.prototype,"centroid",null);c([g.property({dependsOn:["cache"],readOnly:!0})],n.prototype,"extent",null);c([g.property({dependsOn:["cache"],readOnly:!0})],n.prototype,"isSelfIntersecting",null);c([g.property({type:[[[Number]]],
json:{write:{isRequired:!0}}})],n.prototype,"rings",void 0);c([g.writer("rings")],n.prototype,"writePaths",null);return n=d=c([g.subclass("esri.geometry.Polygon")],n);var d}(g.declared(d));k.prototype.toJSON.isDefaultToJSON=!0;return k})},"esri/layers/vectorTiles/geometry/support/centroid":function(){define(["require","exports","../support/coordsUtils"],function(k,b,a){function c(a,b){if(!a||!a.length)return null;for(var c=[],d=[],p=b?[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity]:[Infinity,
-Infinity,Infinity,-Infinity],l=0,k=a.length;l<k;l++){var u=e(a[l],b,p);u&&d.push(u)}d.sort(function(a,c){var d=a[2]-c[2];0===d&&b&&(d=a[4]-c[4]);return d});d.length&&(l=6*d[0][2],c[0]=d[0][0]/l,c[1]=d[0][1]/l,b&&(l=6*d[0][4],c[2]=0!==l?d[0][3]/l:0),c[0]<p[0]||c[0]>p[1]||c[1]<p[2]||c[1]>p[3]||b&&(c[2]<p[4]||c[2]>p[5]))&&(c.length=0);if(!c.length)if(a=a[0]&&a[0].length?g(a[0],b):null)c[0]=a[0],c[1]=a[1],b&&2<a.length&&(c[2]=a[2]);else return null;return c}function e(a,b,c){for(var d=0,e=0,h=0,g=0,
l=0,k=0,x=a.length-1;k<x;k++){var A=a[k],z=A[0],f=A[1],n=A[2],r=a[k+1],B=r[0],C=r[1],D=r[2],F=z*C-B*f,g=g+F,d=d+(z+B)*F,e=e+(f+C)*F;b&&2<A.length&&2<r.length&&(F=z*D-B*n,h+=(n+D)*F,l+=F);z<c[0]&&(c[0]=z);z>c[1]&&(c[1]=z);f<c[2]&&(c[2]=f);f>c[3]&&(c[3]=f);b&&(n<c[4]&&(c[4]=n),n>c[5]&&(c[5]=n))}0<g&&(g*=-1);0<l&&(l*=-1);if(!g)return null;a=[d,e,.5*g];b&&(a[3]=h,a[4]=.5*l);return a}function g(b,c){for(var d=c?[0,0,0]:[0,0],e=c?[0,0,0]:[0,0],p=0,g=0,l=0,k=0,y=0,x=b.length;y<x-1;y++){var A=b[y],z=b[y+
1];if(A&&z){d[0]=A[0];d[1]=A[1];e[0]=z[0];e[1]=z[1];c&&2<A.length&&2<z.length&&(d[2]=A[2],e[2]=z[2]);var f=a.getLength(d,e);f&&(p+=f,A=a.getMidpoint(A,z),g+=f*A[0],l+=f*A[1],c&&2<A.length&&(k+=f*A[2]))}}return 0<p?c?[g/p,l/p,k/p]:[g/p,l/p]:b.length?b[0]:null}Object.defineProperty(b,"__esModule",{value:!0});b.extentCentroid=function(a){return a?a.hasZ?[a.xmax-a.xmin/2,a.ymax-a.ymin/2,a.zmax-a.zmin/2]:[a.xmax-a.xmin/2,a.ymax-a.ymin/2]:null};b.polygonCentroid=function(a){return a?c(a.rings,a.hasZ):null};
b.ringsCentroid=c;b.lineCentroid=g})},"esri/layers/vectorTiles/geometry/support/coordsUtils":function(){define(["require","exports"],function(k,b){function a(a,b){var c=b[0]-a[0],d=b[1]-a[1];return 2<a.length&&2<b.length?(a=a[2]-b[2],Math.sqrt(c*c+d*d+a*a)):Math.sqrt(c*c+d*d)}function c(a,b,c){var d=a[0]+c*(b[0]-a[0]),e=a[1]+c*(b[1]-a[1]);return 2<a.length&&2<b.length?[d,e,a[2]+c*(b[2]-a[2])]:[d,e]}Object.defineProperty(b,"__esModule",{value:!0});b.geometryToCoordinates=function(a){if(!a)return null;
if(Array.isArray(a))return a;var b=a.hasZ,c=a.hasM;if("point"===a.type)return c&&b?[a.x,a.y,a.z,a.m]:b?[a.x,a.y,a.z]:c?[a.x,a.y,a.m]:[a.x,a.y];if("polygon"===a.type)return a.rings.slice(0);if("polyline"===a.type)return a.paths.slice(0);if("multipoint"===a.type)return a.points.slice(0);if("extent"===a.type){a=a.clone().normalize();if(!a)return null;var d=!1,e=!1;a.forEach(function(a){a.hasZ&&(d=!0);a.hasM&&(e=!0)});return a.map(function(a){var b=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,
a.ymin],[a.xmin,a.ymin]];if(d&&a.hasZ)for(var c=.5*(a.zmax-a.zmin),m=0;m<b.length;m++)b[m].push(c);if(e&&a.hasM)for(a=.5*(a.mmax-a.mmin),m=0;m<b.length;m++)b[m].push(a);return b})}return null};b.getLength=a;b.getMidpoint=function(a,b){return c(a,b,.5)};b.getPathLength=function(b){for(var c=b.length,e=0,d=0;d<c-1;++d)e+=a(b[d],b[d+1]);return e};b.getPointOnPath=function(b,g){if(0>=g)return b[0];for(var e=b.length,d=0,h=0;h<e-1;++h){var m=a(b[h],b[h+1]);if(g-d<m)return c(b[h],b[h+1],(g-d)/m);d+=m}return b[e-
1]};b.isClockwise=function(a,b,c){for(var d=a.length,e=0,m=0,p=0,g=0;g<d;g++){var l=a[g],k=a[(g+1)%d],y=2,e=e+(l[0]*k[1]-k[0]*l[1]);2<l.length&&2<k.length&&c&&(m+=l[0]*k[2]-k[0]*l[2],y=3);l.length>y&&k.length>y&&b&&(p+=l[0]*k[y]-k[0]*l[y])}return 0>=e&&0>=m&&0>=p}})},"esri/layers/vectorTiles/geometry/Polyline":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/zmUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p){function q(a){return function(b,c){return null==b?c:null==c?b:a(b,c)}}var t=q(Math.min),u=q(Math.max);k=function(b){function d(){for(var a=0;a<arguments.length;a++);a=b.call(this)||this;a.paths=[];a.type="polyline";return a}a(d,b);q=d;d.prototype.normalizeCtorArgs=function(a,b){var c=null,f,d,e=null;a&&!Array.isArray(a)?(c=a.paths?a.paths:null,b||(a.spatialReference?b=a.spatialReference:a.paths||(b=a)),f=a.hasZ,d=a.hasM):c=a;c=c||[];b=b||m.WGS84;c.length&&c[0]&&null!=
c[0][0]&&"number"===typeof c[0][0]&&(c=[c]);if(e=c[0]&&c[0][0])void 0===f&&void 0===d?(f=2<e.length,d=!1):void 0===f?f=!d&&3<e.length:void 0===d&&(d=!f&&3<e.length);return{paths:c,spatialReference:b,hasZ:f,hasM:d}};Object.defineProperty(d.prototype,"extent",{get:function(){var a=this.hasZ,b=this.hasM,c=this.spatialReference,d=this.paths,e=a?3:2;if(!d.length||!d[0].length)return null;for(var m=d[0][0],p=m[0],m=m[1],h=d[0][0],g=h[0],h=h[1],q=void 0,k=void 0,y=void 0,A=void 0,x=[],K=0;K<d.length;K++){for(var aa=
d[K],ba=aa[0],ca=ba[0],ba=ba[1],ea=aa[0],ha=ea[0],ea=ea[1],U=void 0,X=void 0,Y=void 0,O=void 0,M=0;M<aa.length;M++){var N=aa[M],P=N[0],R=N[1],p=t(p,P),m=t(m,R),g=u(g,P),h=u(h,R),ca=t(ca,P),ba=t(ba,R),ha=u(ha,P),ea=u(ea,R);a&&2<N.length&&(P=N[2],q=t(q,P),k=u(k,P),U=t(U,P),X=u(X,P));b&&N.length>e&&(O=N[e],y=t(q,O),A=u(k,O),Y=t(U,O),O=u(X,O))}x.push(new l({xmin:ca,ymin:ba,zmin:U,mmin:Y,xmax:ha,ymax:ea,zmax:X,mmax:O,spatialReference:c}))}d=new l;d.xmin=p;d.ymin=m;d.xmax=g;d.ymax=h;d.spatialReference=
c;a&&(d.zmin=q,d.zmax=k);b&&(d.mmin=y,d.mmax=A);d.cache._partwise=1<x.length?x:null;return d},enumerable:!0,configurable:!0});d.prototype.writePaths=function(a,b,c,d){b.paths=e.clone(this.paths)};d.prototype.addPath=function(a){if(a){this.clearCache();var b=this.paths,c=b.length;if(Array.isArray(a[0]))b[c]=a.concat();else{for(var d=[],e=0,m=a.length;e<m;e++)d[e]=a[e].toArray();b[c]=d}return this}};d.prototype.clone=function(){var a=new q;a.spatialReference=this.spatialReference;a.paths=e.clone(this.paths);
a.hasZ=this.hasZ;a.hasM=this.hasM;return a};d.prototype.getPoint=function(a,b){if(!this._validateInputs(a,b))return null;a=this.paths[a][b];b=this.hasZ;var c=this.hasM;return b&&!c?new h(a[0],a[1],a[2],void 0,this.spatialReference):c&&!b?new h(a[0],a[1],void 0,a[2],this.spatialReference):b&&c?new h(a[0],a[1],a[2],a[3],this.spatialReference):new h(a[0],a[1],this.spatialReference)};d.prototype.insertPoint=function(a,b,c){if(!this._validateInputs(a,b,!0))return this;this.clearCache();p.updateSupportFromPoint(this,
c);Array.isArray(c)||(c=c.toArray());this.paths[a].splice(b,0,c);return this};d.prototype.removePath=function(a){if(!this._validateInputs(a,null))return null;this.clearCache();a=this.paths.splice(a,1)[0];var b=this.spatialReference;return a.map(function(a){return new h(a,b)})};d.prototype.removePoint=function(a,b){if(!this._validateInputs(a,b))return null;this.clearCache();return new h(this.paths[a].splice(b,1)[0],this.spatialReference)};d.prototype.setPoint=function(a,b,c){if(!this._validateInputs(a,
b))return this;this.clearCache();p.updateSupportFromPoint(this,c);Array.isArray(c)||(c=c.toArray());this.paths[a][b]=c;return this};d.prototype._validateInputs=function(a,b,c){void 0===c&&(c=!1);return null==a||0>a||a>=this.paths.length||null!=b&&(a=this.paths[a],c&&(0>b||b>a.length)||!c&&(0>b||b>=a.length))?!1:!0};d.prototype.toJSON=function(a){return this.write(null,a)};c([g.property({dependsOn:["hasM","hasZ","paths"]})],d.prototype,"cache",void 0);c([g.property({dependsOn:["cache"],readOnly:!0})],
d.prototype,"extent",null);c([g.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],d.prototype,"paths",void 0);c([g.writer("paths")],d.prototype,"writePaths",null);return d=q=c([g.subclass("esri.geometry.Polyline")],d);var q}(g.declared(d));k.prototype.toJSON.isDefaultToJSON=!0;return k})},"esri/layers/vectorTiles/geometry/ScreenPoint":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/accessorSupport/decorators".split(" "),
function(k,b,a,c,e,g){return function(b){function d(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a.x=0;a.y=0;a.z=void 0;return a}a(d,b);e=d;d.prototype.normalizeCtorArgs=function(a,b){return"number"===typeof a?{x:a,y:b}:Array.isArray(a)?{x:a[0],y:a[1]}:a};d.prototype.clone=function(){return new e({x:this.x,y:this.y,z:this.z})};d.prototype.toArray=function(){return null==this.z?[this.x,this.y]:[this.x,this.y,this.z]};c([g.property({type:Number})],d.prototype,
"x",void 0);c([g.property({type:Number})],d.prototype,"y",void 0);c([g.property({type:Number})],d.prototype,"z",void 0);return d=e=c([g.subclass("esri.geometry.ScreenPoint")],d);var e}(g.declared(e))})},"esri/layers/vectorTiles/geometry/support/jsonUtils":function(){define("require exports ../Extent ../Multipoint ../Point ../Polygon ../Polyline".split(" "),function(k,b,a,c,e,g,l){function d(a){return void 0!==a.points}function h(a){return void 0!==a.x&&void 0!==a.y}function m(a){return void 0!==a.paths}
function p(a){return void 0!==a.rings}function q(b){if(b){if(h(b))return e.fromJSON(b);if(m(b))return l.fromJSON(b);if(p(b))return g.fromJSON(b);if(d(b))return c.fromJSON(b);if(void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax)return a.fromJSON(b)}return null}Object.defineProperty(b,"__esModule",{value:!0});b.fromJson=function(a){try{throw Error("fromJson is deprecated, use fromJSON instead");}catch(y){console.warn(y.stack)}return q(a)};b.isMultipoint=d;b.isPoint=h;b.isPolyline=m;
b.isPolygon=p;b.fromJSON=q;b.getJsonType=function(b){return b instanceof e?"esriGeometryPoint":b instanceof l?"esriGeometryPolyline":b instanceof g?"esriGeometryPolygon":b instanceof a?"esriGeometryEnvelope":b instanceof c?"esriGeometryMultipoint":null};var t={esriGeometryPoint:e,esriGeometryPolyline:l,esriGeometryPolygon:g,esriGeometryEnvelope:a,esriGeometryMultipoint:c};b.getGeometryType=function(a){return a&&t[a]||null}})},"esri/layers/vectorTiles/geometry/support/aaBoundingBox":function(){define(["require",
"exports","../Extent","./aaBoundingRect"],function(k,b,a,c){function e(a){void 0===a&&(a=b.ZERO);return[a[0],a[1],a[2],a[3],a[4],a[5]]}function g(a){return a[0]>=a[3]?0:a[3]-a[0]}function l(a){return a[1]>=a[4]?0:a[4]-a[1]}function d(a){return a[2]>=a[5]?0:a[5]-a[2]}function h(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}function m(a){return 6===a.length}Object.defineProperty(b,"__esModule",{value:!0});b.create=e;b.fromValues=function(a,b,c,d,e,m){return[a,b,c,d,e,m]};
b.fromExtent=function(a,b){void 0===b&&(b=e());b[0]=a.xmin;b[1]=a.ymin;b[2]=a.zmin;b[3]=a.xmax;b[4]=a.ymax;b[5]=a.zmax;return b};b.toExtent=function(b,c){return isFinite(b[2])||isFinite(b[5])?new a({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],zmin:b[2],zmax:b[5],spatialReference:c}):new a({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],spatialReference:c})};b.fromMinMax=function(a,b,c){void 0===c&&(c=e());c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=b[0];c[4]=b[1];c[5]=b[2];return c};b.expandPointInPlace=function(a,b){b[0]<
a[0]&&(a[0]=b[0]);b[0]>a[3]&&(a[3]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[4]&&(a[4]=b[1]);b[2]<a[2]&&(a[2]=b[2]);b[2]>a[5]&&(a[5]=b[2])};b.expand=function(a,b,d){void 0===d&&(d=a);m(b)?(d[0]=Math.min(a[0],b[0]),d[1]=Math.min(a[1],b[1]),d[2]=Math.min(a[2],b[2]),d[3]=Math.max(a[3],b[3]),d[4]=Math.max(a[4],b[4]),d[5]=Math.max(a[5],b[5])):c.is(b)?(d[0]=Math.min(a[0],b[0]),d[1]=Math.min(a[1],b[1]),d[3]=Math.max(a[3],b[2]),d[4]=Math.max(a[4],b[3])):2===b.length?(d[0]=Math.min(a[0],b[0]),d[1]=Math.min(a[1],
b[1]),d[3]=Math.max(a[3],b[0]),d[4]=Math.max(a[4],b[1])):3===b.length&&(d[0]=Math.min(a[0],b[0]),d[1]=Math.min(a[1],b[1]),d[2]=Math.min(a[2],b[2]),d[3]=Math.max(a[3],b[0]),d[4]=Math.max(a[4],b[1]),d[5]=Math.max(a[5],b[2]));return d};b.expandWithBuffer=function(a,b,c,d,e){void 0===e&&(e=a);var m=a[0],p=a[1],h=a[2],f=a[3],n=a[4];a=a[5];for(var r=0;r<d;r++)m=Math.min(m,b[c+3*r]),p=Math.min(p,b[c+3*r+1]),h=Math.min(h,b[c+3*r+2]),f=Math.max(f,b[c+3*r]),n=Math.max(n,b[c+3*r+1]),a=Math.max(a,b[c+3*r+2]);
e[0]=m;e[1]=p;e[2]=h;e[3]=f;e[4]=n;e[5]=a;return e};b.expandWithNestedArray=function(a,b,c,d){void 0===d&&(d=a);var e=b.length,m=a[0],p=a[1],h=a[2],f=a[3],n=a[4];a=a[5];if(c)for(c=0;c<e;c++){var r=b[c],m=Math.min(m,r[0]),p=Math.min(p,r[1]),h=Math.min(h,r[2]),f=Math.max(f,r[0]),n=Math.max(n,r[1]);a=Math.max(a,r[2])}else for(c=0;c<e;c++)r=b[c],m=Math.min(m,r[0]),p=Math.min(p,r[1]),f=Math.max(f,r[0]),n=Math.max(n,r[1]);d[0]=m;d[1]=p;d[2]=h;d[3]=f;d[4]=n;d[5]=a;return d};b.allFinite=function(a){for(var b=
0;6>b;b++)if(!isFinite(a[b]))return!1;return!0};b.width=g;b.depth=l;b.height=d;b.diameter=function(a){var b=g(a),c=d(a);a=l(a);return Math.sqrt(b*b+c*c+a*a)};b.center=function(a,b){void 0===b&&(b=[0,0,0]);b[0]=a[0]+g(a)/2;b[1]=a[1]+l(a)/2;b[2]=a[2]+d(a)/2;return b};b.size=function(a,b){void 0===b&&(b=[0,0,0]);b[0]=g(a);b[1]=l(a);b[2]=d(a);return b};b.maximumDimension=function(a){return Math.max(g(a),d(a),l(a))};b.containsPoint=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[0]<=a[3]&&b[1]<=
a[4]&&b[2]<=a[5]};b.containsPointWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[2]>=a[2]-c&&b[0]<=a[3]+c&&b[1]<=a[4]+c&&b[2]<=a[5]+c};b.contains=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[2]>=a[2]&&b[3]<=a[3]&&b[4]<=a[4]&&b[5]<=a[5]};b.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[3],a[3])&&Math.max(b[1],a[1])<=Math.min(b[4],a[4])&&Math.max(b[2],a[2])<=Math.min(b[5],a[5])};b.offset=function(a,b,c,d,e){void 0===e&&(e=a);e[0]=a[0]+b;e[1]=a[1]+c;e[2]=a[2]+d;e[3]=
a[3]+b;e[4]=a[4]+c;e[5]=a[5]+d;return e};b.setMin=function(a,b,c){void 0===c&&(c=a);c[0]=b[0];c[1]=b[1];c[2]=b[2];c!==a&&(c[3]=a[3],c[4]=a[4],c[5]=a[5]);return c};b.setMax=function(a,b,c){void 0===c&&(c=a);c[3]=b[0];c[4]=b[1];c[5]=b[2];c!==a&&(c[0]=a[0],c[1]=a[1],c[2]=a[2]);return a};b.set=h;b.empty=function(a){return a?h(a,b.NEGATIVE_INFINITY):e(b.NEGATIVE_INFINITY)};b.toRect=function(a,b){b||(b=c.create());b[0]=a[0];b[1]=a[1];b[2]=a[3];b[3]=a[4];return b};b.fromRect=function(a,b){a[0]=b[0];a[1]=
b[1];a[3]=b[2];a[4]=b[3];return a};b.is=m;b.isPoint=function(a){return 0===g(a)&&0===l(a)&&0===d(a)};b.equals=function(a,b,c){if(null==a||null==b)return a===b;if(!m(a)||!m(b))return!1;if(c)for(var d=0;d<a.length;d++){if(!c(a[d],b[d]))return!1}else for(d=0;d<a.length;d++)if(a[d]!==b[d])return!1;return!0};b.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];b.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];b.ZERO=[0,0,0,0,0,0]})},"esri/layers/vectorTiles/geometry/support/aaBoundingRect":function(){define(["require",
"exports","../../geometry"],function(k,b,a){function c(a){void 0===a&&(a=b.ZERO);return[a[0],a[1],a[2],a[3]]}function e(a){return a[0]>=a[2]?0:a[2]-a[0]}function g(a){return a[1]>=a[3]?0:a[3]-a[1]}function l(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function d(a){return 4===a.length}function h(a,b,c){return a<b?b:a>c?c:a}Object.defineProperty(b,"__esModule",{value:!0});b.create=c;b.clone=function(a){return[a[0],a[1],a[2],a[3]]};b.fromValues=function(a,b,d,e,h){void 0===h&&(h=c());h[0]=
a;h[1]=b;h[2]=d;h[3]=e;return h};b.fromExtent=function(a,b){void 0===b&&(b=c());b[0]=a.xmin;b[1]=a.ymin;b[2]=a.xmax;b[3]=a.ymax;return b};b.toExtent=function(b,c){return new a.Extent({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:c})};b.expandPointInPlace=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[2]&&(a[2]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[3]&&(a[3]=b[1])};b.expand=function(a,b,c){void 0===c&&(c=a);if("length"in b)if(d(b))c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.max(a[2],
b[2]),c[3]=Math.max(a[3],b[3]);else{if(2===b.length||3===b.length)c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.max(a[2],b[0]),c[3]=Math.max(a[3],b[1])}else switch(b.type){case "extent":c[0]=Math.min(a[0],b.xmin);c[1]=Math.min(a[1],b.ymin);c[2]=Math.max(a[2],b.xmax);c[3]=Math.max(a[3],b.ymax);break;case "point":c[0]=Math.min(a[0],b.x),c[1]=Math.min(a[1],b.y),c[2]=Math.max(a[2],b.x),c[3]=Math.max(a[3],b.y)}return c};b.expandWithNestedArray=function(a,b,c){void 0===c&&(c=a);var d=b.length,
e=a[0],m=a[1],h=a[2];a=a[3];for(var g=0;g<d;g++){var p=b[g],e=Math.min(e,p[0]),m=Math.min(m,p[1]),h=Math.max(h,p[0]);a=Math.max(a,p[1])}c[0]=e;c[1]=m;c[2]=h;c[3]=a;return c};b.allFinite=function(a){for(var b=0;4>b;b++)if(!isFinite(a[b]))return!1;return!0};b.width=e;b.height=g;b.diameter=function(a){var b=e(a);a=g(a);return Math.sqrt(b*b+a*a)};b.area=function(a){return e(a)*g(a)};b.center=function(a,b){void 0===b&&(b=[0,0]);b[0]=a[0]+e(a)/2;b[1]=a[1]+g(a)/2;return b};b.containsPoint=function(a,b){return b[0]>=
a[0]&&b[1]>=a[1]&&b[0]<=a[2]&&b[1]<=a[3]};b.containsPointWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[0]<=a[2]+c&&b[1]<=a[3]+c};b.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[2],a[2])&&Math.max(b[1],a[1])<=Math.min(b[3],a[3])};b.contains=function(a,b){return b[0]>=a[0]&&b[2]<=a[2]&&b[1]>=a[1]&&b[3]<=a[3]};b.intersection=function(a,b,c){void 0===c&&(c=a);var d=b[0],e=b[1],m=b[2];b=b[3];c[0]=h(a[0],d,m);c[1]=h(a[1],e,b);c[2]=h(a[2],d,m);c[3]=h(a[3],e,b);return c};
b.offset=function(a,b,c,d){void 0===d&&(d=a);d[0]=a[0]+b;d[1]=a[1]+c;d[2]=a[2]+b;d[3]=a[3]+c;return d};b.pad=function(a,b,c){void 0===c&&(c=a);c[0]=a[0]-b;c[1]=a[1]-b;c[2]=a[2]+b;c[3]=a[3]+b;return c};b.setMin=function(a,b,c){void 0===c&&(c=a);c[0]=b[0];c[1]=b[1];c!==a&&(c[2]=a[2],c[3]=a[3]);return c};b.setMax=function(a,b,c){void 0===c&&(c=a);c[2]=b[0];c[3]=b[1];c!==a&&(c[0]=a[0],c[1]=a[1]);return a};b.set=l;b.empty=function(a){return a?l(a,b.NEGATIVE_INFINITY):c(b.NEGATIVE_INFINITY)};b.is=d;b.isPoint=
function(a){return(0===e(a)||!isFinite(a[0]))&&(0===g(a)||!isFinite(a[1]))};b.equals=function(a,b,c){if(null==a||null==b)return a===b;if(!d(a)||!d(b))return!1;if(c)for(var e=0;e<a.length;e++){if(!c(a[e],b[e]))return!1}else for(e=0;e<a.length;e++)if(a[e]!==b[e])return!1;return!0};b.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];b.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];b.ZERO=[0,0,0,0]})},"esri/layers/vectorTiles/layers/graphics/dehydratedFeatures":function(){define("require exports ../../Graphic ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ./dehydratedFeatureComparison".split(" "),
function(k,b,a,c,e,g,l){function d(a){switch(a){case "esriGeometryPoint":return"point";case "esriGeometryMultipoint":return"multipoint";case "esriGeometryPolyline":return"polyline";case "esriGeometryPolygon":return"polygon";case "esriGeometryEnvelope":return"extent"}}function h(b,c,f,n){return{uid:a.generateUID(),objectId:n&&b.attributes?b.attributes[n]:null,attributes:b.attributes,geometry:m(b.geometry,c,f),visible:!0}}function m(a,b,c){if(!a)return null;switch(b){case "point":return{x:a.x,y:a.y,
z:a.z,type:b,spatialReference:c};case "polyline":var f=a;return{paths:f.paths,hasZ:f.hasZ,hasM:f.hasM,type:b,spatialReference:c};case "polygon":return{rings:a.rings,hasZ:f.hasZ,hasM:f.hasM,type:b,spatialReference:c};case "multipoint":return{points:a.points,hasZ:f.hasZ,hasM:f.hasM,type:b,spatialReference:c};case "extent":return{xmin:a.xmin,ymin:a.ymin,zmin:a.zmin,mmin:a.mmin,xmax:a.xmax,ymax:a.ymax,zmax:a.zmax,mmax:a.mmax,hasZ:a.hasZ,hasM:a.hasM,type:b,spatialReference:c}}}function p(a){return"point"===
a.type?null!=a.z:"extent"===a.type?null!=a.zmin:a.hasZ}function q(a){return"declaredClass"in a}function t(a,b){e.empty(b);"mesh"===a.type&&(a=a.extent);switch(a.type){case "point":b[0]=b[3]=a.x;b[1]=b[4]=a.y;p(a)&&(b[2]=b[5]=a.z);break;case "polyline":for(var c=0;c<a.paths.length;c++)e.expandWithNestedArray(b,a.paths[c],p(a));break;case "polygon":for(c=0;c<a.rings.length;c++)e.expandWithNestedArray(b,a.rings[c],p(a));break;case "multipoint":e.expandWithNestedArray(b,a.points,p(a));break;case "extent":b[0]=
a.xmin,b[1]=a.ymin,b[3]=a.xmax,b[4]=a.ymax,null!=a.zmin&&(b[2]=a.zmin),null!=a.zmax&&(b[5]=a.zmax)}}function u(a,b){g.empty(b);"mesh"===a.type&&(a=a.extent);switch(a.type){case "point":b[0]=b[2]=a.x;b[1]=b[3]=a.y;break;case "polyline":for(var c=0;c<a.paths.length;c++)g.expandWithNestedArray(b,a.paths[c]);break;case "polygon":for(c=0;c<a.rings.length;c++)g.expandWithNestedArray(b,a.rings[c]);break;case "multipoint":g.expandWithNestedArray(b,a.points);break;case "extent":b[0]=a.xmin,b[1]=a.ymin,b[2]=
a.xmax,b[3]=a.ymax}}Object.defineProperty(b,"__esModule",{value:!0});b.equals=l.equals;b.isPoint=function(a){return"point"===a.type};b.mapJSONGeometryType=d;b.fromFeatureSetJSON=function(a){var b=d(a.geometryType),f=c.fromJSON(a.spatialReference);return a.features.map(function(c){return h(c,b,f,a.objectIdFieldName)})};b.fromJSON=h;b.fromJSONGeometry=m;b.makeDehydratedPoint=function(a,b,c,n){return{x:a,y:b,z:c,spatialReference:n,type:"point"}};b.hasZ=p;b.isHydratedGeometry=function(a){return"declaredClass"in
a};b.isHydratedGraphic=q;b.hydrateGraphic=function(b,c){if(!b||q(b))return b;c=new a({layer:c,sourceLayer:c});c.read(b);return c};b.computeAABB=t;b.expandAABB=function(a,b){t(a,y);e.expand(b,y)};b.computeAABR=u;b.expandAABR=function(a,b){u(a,x);g.expand(b,x)};var y=e.create(),x=g.create()})},"esri/layers/vectorTiles/Graphic":function(){define(["require","exports","esri/graphic","./core/tsSupport/declareExtendsHelper","./core/JSONSupport"],function(k,b,a,c,e){k=function(b){function d(a){return b.call(this)||
this}c(d,b);d.fromJSON=function(b){return new a(b)};return d}(e);var g=0;(function(a){a.generateUID=function(){return g++}})(k||(k={}));return k})},"esri/layers/vectorTiles/layers/graphics/dehydratedFeatureComparison":function(){define(["require","exports"],function(k,b){function a(a,b){if(a===b)return!0;if(null==a||null==b||a.length!==b.length)return!1;for(var c=0;c<a.length;c++){var d=a[c],e=b[c];if(d.length!==e.length)return!1;for(var h=0;h<d.length;h++)if(d[h]!==e[h])return!1}return!0}function c(b,
c){if(b===c)return!0;if(null==b||null==c||b.length!==c.length)return!1;for(var d=0;d<b.length;d++)if(!a(b[d],c[d]))return!1;return!0}function e(a,b){return a===b||a&&b&&a.equals(b)}function g(b,h){if(b===h)return!0;if(!b||!h||b.type!==h.type)return!1;switch(b.type){case "point":return e(b.spatialReference,h.spatialReference)?b.x===h.x&&b.y===h.y&&b.z===h.z&&b.m===h.m:!1;case "extent":return b.hasZ===h.hasZ&&b.hasM===h.hasM&&e(b.spatialReference,h.spatialReference)?b.xmin===h.xmin&&b.ymin===h.ymin&&
b.zmin===h.zmin&&b.xmax===h.xmax&&b.ymax===h.ymax&&b.zmax===h.zmax:!1;case "polyline":return b.hasZ===h.hasZ&&b.hasM===h.hasM&&e(b.spatialReference,h.spatialReference)?c(b.paths,h.paths):!1;case "polygon":return b.hasZ===h.hasZ&&b.hasM===h.hasM&&e(b.spatialReference,h.spatialReference)?c(b.rings,h.rings):!1;case "multipoint":return b.hasZ===h.hasZ&&b.hasM===h.hasM&&e(b.spatialReference,h.spatialReference)?a(b.points,h.points):!1;case "mesh":return!1}}function l(a,b){if(a===b)return!0;if(!a||!b)return!1;
for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(c in b)if(!(c in a))return!1;return!0}Object.defineProperty(b,"__esModule",{value:!0});b.equals=function(a,b){return a===b?!0:null!=a&&null!=b&&a.objectId===b.objectId&&g(a.geometry,b.geometry)&&l(a.attributes,b.attributes)?!0:!1}})},"esri/layers/vectorTiles/views/3d/lib/glMatrix":function(){define([],function(){var k={};(function(b,a){a(b,!0);a(b,!1)})(k,function(b,a){var c={};(function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),
b=new Int32Array(a.buffer);c.invsqrt=function(c){a[0]=c;b[0]=1597463007-(b[0]>>1);var f=a[0];return f*(1.5-.5*c*f*f)}}else c.invsqrt=function(a){return 1/Math.sqrt(a)}})();var e=Array;"undefined"!=typeof Float32Array&&(e=a?Float32Array:Array);var g={create:function(a){var b=new e(3);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2]):b[0]=b[1]=b[2]=0;return b},createFrom:function(a,b,c){var f=new e(3);f[0]=a;f[1]=b;f[2]=c;return f},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},set3:function(a,b,c,d){d[0]=
a;d[1]=b;d[2]=c;return d},add:function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(a,b,c){if(!c||a===c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},multiply:function(a,b,c){if(!c||a===c)return a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a;c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c},max:function(a,b,c){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);c[2]=
Math.max(a[2],b[2]);return c},min:function(a,b,c){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);c[2]=Math.min(a[2],b[2]);return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],f=a[1];a=a[2];var n=Math.sqrt(c*c+f*f+a*a);if(!n)return b[0]=0,b[1]=0,b[2]=0,b;if(1===n)return b[0]=c,b[1]=f,b[2]=a,b;n=1/n;b[0]=c*n;b[1]=
f*n;b[2]=a*n;return b},cross:function(a,b,c){c||(c=a);var f=a[0],n=a[1];a=a[2];var d=b[0],e=b[1];b=b[2];c[0]=n*b-a*e;c[1]=a*d-f*b;c[2]=f*e-n*d;return c},length:function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)},length2:function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var f=a[0]-b[0],n=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(f*f+n*n+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=f*b;c[1]=
n*b;c[2]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d},dist:function(a,b){var c=b[0]-a[0],f=b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*c+f*f+a*a)},dist2:function(a,b){var c=b[0]-a[0],f=b[1]-a[1];a=b[2]-a[2];return c*c+f*f+a*a}},l=null,d=new e(4);g.unproject=function(a,b,c,e,m){m||(m=a);l||(l=y.create());var f=l;d[0]=2*(a[0]-e[0])/e[2]-1;d[1]=2*(a[1]-e[1])/e[3]-1;d[2]=2*a[2]-1;d[3]=1;y.multiply(c,b,f);if(!y.inverse(f))return null;
y.multiplyVec4(f,d);if(0===d[3])return null;m[0]=d[0]/d[3];m[1]=d[1]/d[3];m[2]=d[2]/d[3];return m};var h=g.createFrom(1,0,0),m=g.createFrom(0,1,0),p=g.createFrom(0,0,1);g.rotationTo=function(a,b,c){c||(c=x.create());var f=g.dot(a,b),n=g.create();if(1<=f)x.set(A,c);else if(-.999999>f)g.cross(h,a,n),1E-6>n.length&&g.cross(m,a,n),1E-6>n.length&&g.cross(p,a,n),g.normalize(n),x.fromAxisAngle(n,Math.PI,c);else{var f=Math.sqrt(2*(1+f)),d=1/f;g.cross(a,b,n);c[0]=n[0]*d;c[1]=n[1]*d;c[2]=n[2]*d;c[3]=.5*f;x.normalize(c)}1<
c[3]?c[3]=1:-1>c[3]&&(c[3]=-1);return c};var k=g.create(),t=g.create();g.project=function(a,b,c,d){d||(d=a);g.direction(b,c,k);g.subtract(a,b,t);a=g.dot(k,t);g.scale(k,a,d);g.add(d,b,d)};g.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var u={create:function(a){var b=new e(9);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]):b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=0;return b},createFrom:function(a,b,c,d,m,h,g,p,l){var f=new e(9);f[0]=a;f[1]=
b;f[2]=c;f[3]=d;f[4]=m;f[5]=h;f[6]=g;f[7]=p;f[8]=l;return f},determinant:function(a){var b=a[3],c=a[4],f=a[5],d=a[6],e=a[7],m=a[8];return a[0]*(m*c-f*e)+a[1]*(-m*b+f*d)+a[2]*(e*b-c*d)},inverse:function(a,b){var c=a[0],f=a[1],n=a[2],d=a[3],e=a[4],m=a[5],h=a[6],g=a[7];a=a[8];var p=a*e-m*g,l=-a*d+m*h,k=g*d-e*h,q=c*p+f*l+n*k;if(!q)return null;q=1/q;b||(b=u.create());b[0]=p*q;b[1]=(-a*f+n*g)*q;b[2]=(m*f-n*e)*q;b[3]=l*q;b[4]=(a*c-n*h)*q;b[5]=(-m*c+n*d)*q;b[6]=k*q;b[7]=(-g*c+f*h)*q;b[8]=(e*c-f*d)*q;return b},
multiply:function(a,b,c){c||(c=a);var f=a[0],n=a[1],d=a[2],e=a[3],r=a[4],m=a[5],h=a[6],g=a[7];a=a[8];var p=b[0],l=b[1],k=b[2],q=b[3],t=b[4],u=b[5],y=b[6],z=b[7];b=b[8];c[0]=p*f+l*e+k*h;c[1]=p*n+l*r+k*g;c[2]=p*d+l*m+k*a;c[3]=q*f+t*e+u*h;c[4]=q*n+t*r+u*g;c[5]=q*d+t*m+u*a;c[6]=y*f+z*e+b*h;c[7]=y*n+z*r+b*g;c[8]=y*d+z*m+b*a;return c},add:function(a,b,c){c||(c=a);c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];c[6]=a[6]+b[6];c[7]=a[7]+b[7];c[8]=a[8]+b[8];return c},
subtract:function(a,b,c){c||(c=a);c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];c[6]=a[6]-b[6];c[7]=a[7]-b[7];c[8]=a[8]-b[8];return c},multiplyVec2:function(a,b,c){c||(c=b);var f=b[0];b=b[1];c[0]=f*a[0]+b*a[3]+a[6];c[1]=f*a[1]+b*a[4]+a[7];return c},multiplyVec3:function(a,b,c){c||(c=b);var f=b[0],n=b[1];b=b[2];c[0]=f*a[0]+n*a[3]+b*a[6];c[1]=f*a[1]+n*a[4]+b*a[7];c[2]=f*a[2]+n*a[5]+b*a[8];return c},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];
b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a||(a=u.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a===b){b=a[1];var c=a[2],f=a[5];a[1]=a[3];a[2]=a[6];a[3]=b;a[5]=a[7];a[6]=c;a[7]=f;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},toMat4:function(a,b){b||(b=y.create());b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];
b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},y={create:function(a){var b=new e(16);4===arguments.length?(b[0]=arguments[0],b[1]=arguments[1],b[2]=arguments[2],b[3]=arguments[3],b[4]=arguments[4],b[5]=arguments[5],b[6]=arguments[6],b[7]=arguments[7],b[8]=arguments[8],b[9]=arguments[9],b[10]=arguments[10],b[11]=arguments[11],b[12]=arguments[12],
b[13]=arguments[13],b[14]=arguments[14],b[15]=arguments[15]):a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b},createFrom:function(a,b,c,d,m,h,g,p,l,k,q,t,u,y,z,x){var f=new e(16);f[0]=a;f[1]=b;f[2]=c;f[3]=d;f[4]=m;f[5]=h;f[6]=g;f[7]=p;f[8]=l;f[9]=k;f[10]=q;f[11]=t;f[12]=u;f[13]=y;f[14]=z;f[15]=x;return f},createFromMatrixRowMajor:function(a){var b=new e(16);b[0]=
a[0];b[4]=a[1];b[8]=a[2];b[12]=a[3];b[1]=a[4];b[5]=a[5];b[9]=a[6];b[13]=a[7];b[2]=a[8];b[6]=a[9];b[10]=a[10];b[14]=a[11];b[3]=a[12];b[7]=a[13];b[11]=a[14];b[15]=a[15];return b},createFromMatrix:function(a){var b=new e(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];
b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},setRowMajor:function(a,b){b[0]=a[0];b[4]=a[1];b[8]=a[2];b[12]=a[3];b[1]=a[4];b[5]=a[5];b[9]=a[6];b[13]=a[7];b[2]=a[8];b[6]=a[9];b[10]=a[10];b[14]=a[11];b[3]=a[12];b[7]=a[13];b[11]=a[14];b[15]=a[15];return b},identity:function(a){a||(a=y.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||
a===b){b=a[1];var c=a[2],f=a[3],d=a[6],n=a[7],e=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=b;a[6]=a[9];a[7]=a[13];a[8]=c;a[9]=d;a[11]=a[14];a[12]=f;a[13]=n;a[14]=e;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],c=a[1],f=a[2],d=a[3],e=a[4],m=a[5],h=a[6],g=a[7],p=a[8],l=a[9],k=a[10],q=a[11],t=a[12],u=a[13],y=a[14];a=a[15];return t*
l*h*d-p*u*h*d-t*m*k*d+e*u*k*d+p*m*y*d-e*l*y*d-t*l*f*g+p*u*f*g+t*c*k*g-b*u*k*g-p*c*y*g+b*l*y*g+t*m*f*q-e*u*f*q-t*c*h*q+b*u*h*q+e*c*y*q-b*m*y*q-p*m*f*a+e*l*f*a+p*c*h*a-b*l*h*a-e*c*k*a+b*m*k*a},inverse:function(a,b){b||(b=a);var c=a[0],f=a[1],d=a[2],n=a[3],e=a[4],m=a[5],h=a[6],g=a[7],p=a[8],l=a[9],k=a[10],q=a[11],t=a[12],u=a[13],y=a[14];a=a[15];var z=c*m-f*e,x=c*h-d*e,A=c*g-n*e,X=f*h-d*m,Y=f*g-n*m,O=d*g-n*h,M=p*u-l*t,N=p*y-k*t,P=p*a-q*t,R=l*y-k*u,Z=l*a-q*u,V=k*a-q*y,L=z*V-x*Z+A*R+X*P-Y*N+O*M;if(!L)return null;
L=1/L;b[0]=(m*V-h*Z+g*R)*L;b[1]=(-f*V+d*Z-n*R)*L;b[2]=(u*O-y*Y+a*X)*L;b[3]=(-l*O+k*Y-q*X)*L;b[4]=(-e*V+h*P-g*N)*L;b[5]=(c*V-d*P+n*N)*L;b[6]=(-t*O+y*A-a*x)*L;b[7]=(p*O-k*A+q*x)*L;b[8]=(e*Z-m*P+g*M)*L;b[9]=(-c*Z+f*P-n*M)*L;b[10]=(t*Y-u*A+a*z)*L;b[11]=(-p*Y+l*A-q*z)*L;b[12]=(-e*R+m*N-h*M)*L;b[13]=(c*R-f*N+d*M)*L;b[14]=(-t*X+u*x-y*z)*L;b[15]=(p*X-l*x+k*z)*L;return b},toRotationMat:function(a,b){b||(b=y.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];
b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},toMat3:function(a,b){b||(b=u.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b},toInverseMat3:function(a,b){var c=a[0],f=a[1],d=a[2],n=a[4],e=a[5],m=a[6],h=a[8],g=a[9];a=a[10];var p=a*e-m*g,l=-a*n+m*h,k=g*n-e*h,q=c*p+f*l+d*k;if(!q)return null;q=1/q;b||(b=u.create());b[0]=p*q;b[1]=(-a*f+d*g)*q;b[2]=(m*f-d*e)*q;b[3]=l*q;b[4]=(a*c-d*h)*q;b[5]=(-m*c+d*n)*q;b[6]=k*q;b[7]=
(-g*c+f*h)*q;b[8]=(e*c-f*n)*q;return b},multiply:function(a,b,c){c||(c=a);var f=a[0],d=a[1],n=a[2],e=a[3],r=a[4],m=a[5],h=a[6],g=a[7],p=a[8],l=a[9],k=a[10],q=a[11],t=a[12],u=a[13],y=a[14];a=a[15];var z=b[0],x=b[1],X=b[2],A=b[3],O=b[4],M=b[5],N=b[6],P=b[7],R=b[8],Z=b[9],V=b[10],L=b[11],da=b[12],fa=b[13],ja=b[14];b=b[15];c[0]=z*f+x*r+X*p+A*t;c[1]=z*d+x*m+X*l+A*u;c[2]=z*n+x*h+X*k+A*y;c[3]=z*e+x*g+X*q+A*a;c[4]=O*f+M*r+N*p+P*t;c[5]=O*d+M*m+N*l+P*u;c[6]=O*n+M*h+N*k+P*y;c[7]=O*e+M*g+N*q+P*a;c[8]=R*f+Z*r+
V*p+L*t;c[9]=R*d+Z*m+V*l+L*u;c[10]=R*n+Z*h+V*k+L*y;c[11]=R*e+Z*g+V*q+L*a;c[12]=da*f+fa*r+ja*p+b*t;c[13]=da*d+fa*m+ja*l+b*u;c[14]=da*n+fa*h+ja*k+b*y;c[15]=da*e+fa*g+ja*q+b*a;return c},multiplyVec3:function(a,b,c){c||(c=b);var f=b[0],d=b[1];b=b[2];c[0]=a[0]*f+a[4]*d+a[8]*b+a[12];c[1]=a[1]*f+a[5]*d+a[9]*b+a[13];c[2]=a[2]*f+a[6]*d+a[10]*b+a[14];return c},multiplyVec4:function(a,b,c){c||(c=b);var f=b[0],d=b[1],n=b[2];b=b[3];c[0]=a[0]*f+a[4]*d+a[8]*n+a[12]*b;c[1]=a[1]*f+a[5]*d+a[9]*n+a[13]*b;c[2]=a[2]*
f+a[6]*d+a[10]*n+a[14]*b;c[3]=a[3]*f+a[7]*d+a[11]*n+a[15]*b;return c},translate:function(a,b,c){var f=b[0],d=b[1];b=b[2];var n,e,r,m,h,g,p,l,k,q,t,u;if(!c||a===c)return a[12]=a[0]*f+a[4]*d+a[8]*b+a[12],a[13]=a[1]*f+a[5]*d+a[9]*b+a[13],a[14]=a[2]*f+a[6]*d+a[10]*b+a[14],a[15]=a[3]*f+a[7]*d+a[11]*b+a[15],a;n=a[0];e=a[1];r=a[2];m=a[3];h=a[4];g=a[5];p=a[6];l=a[7];k=a[8];q=a[9];t=a[10];u=a[11];c[0]=n;c[1]=e;c[2]=r;c[3]=m;c[4]=h;c[5]=g;c[6]=p;c[7]=l;c[8]=k;c[9]=q;c[10]=t;c[11]=u;c[12]=n*f+h*d+k*b+a[12];
c[13]=e*f+g*d+q*b+a[13];c[14]=r*f+p*d+t*b+a[14];c[15]=m*f+l*d+u*b+a[15];return c},scale:function(a,b,c){var f=b[0],d=b[1];b=b[2];if(!c||a===c)return a[0]*=f,a[1]*=f,a[2]*=f,a[3]*=f,a[4]*=d,a[5]*=d,a[6]*=d,a[7]*=d,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*f;c[1]=a[1]*f;c[2]=a[2]*f;c[3]=a[3]*f;c[4]=a[4]*d;c[5]=a[5]*d;c[6]=a[6]*d;c[7]=a[7]*d;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},maxScale:function(a){return Math.max(Math.max(Math.sqrt(a[0]*
a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))},rotate:function(a,b,c,d){var f=c[0],n=c[1];c=c[2];var e=Math.sqrt(f*f+n*n+c*c),r,m,h,g,p,l,B,k,q,t,u,y,z,x,A,O,M,N,P,R;if(!e)return null;1!==e&&(e=1/e,f*=e,n*=e,c*=e);r=Math.sin(b);m=Math.cos(b);h=1-m;b=a[0];e=a[1];g=a[2];p=a[3];l=a[4];B=a[5];k=a[6];q=a[7];t=a[8];u=a[9];y=a[10];z=a[11];x=f*f*h+m;A=n*f*h+c*r;O=c*f*h-n*r;M=f*n*h-c*r;N=n*n*h+m;P=c*n*h+f*r;R=f*c*h+n*r;f=n*c*h-f*r;n=c*c*h+m;
d?a!==d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*x+l*A+t*O;d[1]=e*x+B*A+u*O;d[2]=g*x+k*A+y*O;d[3]=p*x+q*A+z*O;d[4]=b*M+l*N+t*P;d[5]=e*M+B*N+u*P;d[6]=g*M+k*N+y*P;d[7]=p*M+q*N+z*P;d[8]=b*R+l*f+t*n;d[9]=e*R+B*f+u*n;d[10]=g*R+k*f+y*n;d[11]=p*R+q*f+z*n;return d},rotateX:function(a,b,c){var f=Math.sin(b);b=Math.cos(b);var d=a[4],n=a[5],e=a[6],m=a[7],r=a[8],h=a[9],g=a[10],p=a[11];c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=
d*b+r*f;c[5]=n*b+h*f;c[6]=e*b+g*f;c[7]=m*b+p*f;c[8]=d*-f+r*b;c[9]=n*-f+h*b;c[10]=e*-f+g*b;c[11]=m*-f+p*b;return c},rotateY:function(a,b,c){var f=Math.sin(b);b=Math.cos(b);var d=a[0],n=a[1],e=a[2],m=a[3],h=a[8],r=a[9],g=a[10],p=a[11];c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=d*b+h*-f;c[1]=n*b+r*-f;c[2]=e*b+g*-f;c[3]=m*b+p*-f;c[8]=d*f+h*b;c[9]=n*f+r*b;c[10]=e*f+g*b;c[11]=m*f+p*b;return c},rotateZ:function(a,b,c){var f=Math.sin(b);b=Math.cos(b);
var d=a[0],n=a[1],e=a[2],m=a[3],h=a[4],r=a[5],g=a[6],p=a[7];c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=d*b+h*f;c[1]=n*b+r*f;c[2]=e*b+g*f;c[3]=m*b+p*f;c[4]=d*-f+h*b;c[5]=n*-f+r*b;c[6]=e*-f+g*b;c[7]=m*-f+p*b;return c},frustum:function(a,b,c,d,e,m,h){h||(h=y.create());var f=b-a,n=d-c,r=m-e;h[0]=2*e/f;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*e/n;h[6]=0;h[7]=0;h[8]=(b+a)/f;h[9]=(d+c)/n;h[10]=-(m+e)/r;h[11]=-1;h[12]=0;h[13]=0;h[14]=-(m*e*2)/
r;h[15]=0;return h},perspective:function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return y.frustum(-b,b,-a,a,c,d,e)},ortho:function(a,b,c,d,e,m,h){h||(h=y.create());var f=b-a,n=d-c,r=m-e;h[0]=2/f;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2/n;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=-2/r;h[11]=0;h[12]=-(a+b)/f;h[13]=-(d+c)/n;h[14]=-(m+e)/r;h[15]=1;return h},lookAt:function(a,b,c,d){d||(d=y.create());var f,e,n,h,m,r,g,p,l=a[0],B=a[1];a=a[2];n=c[0];h=c[1];e=c[2];g=b[0];c=b[1];f=b[2];if(l===g&&B===c&&a===f)return y.identity(d);
b=l-g;c=B-c;g=a-f;p=1/Math.sqrt(b*b+c*c+g*g);b*=p;c*=p;g*=p;f=h*g-e*c;e=e*b-n*g;n=n*c-h*b;(p=Math.sqrt(f*f+e*e+n*n))?(p=1/p,f*=p,e*=p,n*=p):n=e=f=0;h=c*n-g*e;m=g*f-b*n;r=b*e-c*f;(p=Math.sqrt(h*h+m*m+r*r))?(p=1/p,h*=p,m*=p,r*=p):r=m=h=0;d[0]=f;d[1]=h;d[2]=b;d[3]=0;d[4]=e;d[5]=m;d[6]=c;d[7]=0;d[8]=n;d[9]=r;d[10]=g;d[11]=0;d[12]=-(f*l+e*B+n*a);d[13]=-(h*l+m*B+r*a);d[14]=-(b*l+c*B+g*a);d[15]=1;return d},fromRotationTranslation:function(a,b,c){c||(c=y.create());var f=a[0],d=a[1],e=a[2],n=a[3],h=f+f,m=
d+d,r=e+e;a=f*h;var g=f*m,f=f*r,p=d*m,d=d*r,e=e*r,h=n*h,m=n*m,n=n*r;c[0]=1-(p+e);c[1]=g+n;c[2]=f-m;c[3]=0;c[4]=g-n;c[5]=1-(a+e);c[6]=d+h;c[7]=0;c[8]=f+m;c[9]=d-h;c[10]=1-(a+p);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},x={create:function(a){var b=new e(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3]):b[0]=b[1]=b[2]=b[3]=0;return b},createFrom:function(a,b,c,d){var f=new e(4);f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||(a=x.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},A=x.identity();x.calculateW=function(a,b){var c=a[0],f=a[1],d=a[2];if(!b||a===b)return a[3]=-Math.sqrt(Math.abs(1-c*c-f*f-d*d)),a;b[0]=c;b[1]=f;b[2]=d;b[3]=-Math.sqrt(Math.abs(1-c*c-f*f-d*d));return b};x.dot=function(a,b){return a[0]*b[0]+
a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};x.inverse=function(a,b){var c=a[0],f=a[1],d=a[2],e=a[3],c=(c=c*c+f*f+d*d+e*e)?1/c:0;if(!b||a===b)return a[0]*=-c,a[1]*=-c,a[2]*=-c,a[3]*=c,a;b[0]=-a[0]*c;b[1]=-a[1]*c;b[2]=-a[2]*c;b[3]=a[3]*c;return b};x.conjugate=function(a,b){if(!b||a===b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};x.length=function(a){var b=a[0],c=a[1],f=a[2];a=a[3];return Math.sqrt(b*b+c*c+f*f+a*a)};x.normalize=function(a,b){b||(b=a);var c=a[0],f=a[1],
d=a[2];a=a[3];var e=Math.sqrt(c*c+f*f+d*d+a*a);if(0===e)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;e=1/e;b[0]=c*e;b[1]=f*e;b[2]=d*e;b[3]=a*e;return b};x.add=function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};x.multiply=function(a,b,c){c||(c=a);var f=a[0],d=a[1],e=a[2];a=a[3];var n=b[0],h=b[1],m=b[2];b=b[3];c[0]=f*b+a*n+d*m-e*h;c[1]=d*b+a*h+e*n-f*m;c[2]=e*b+a*m+f*h-d*n;c[3]=a*b-f*n-d*h-e*m;return c};x.multiplyVec3=
function(a,b,c){c||(c=b);var f=b[0],d=b[1],e=b[2];b=a[0];var n=a[1],h=a[2];a=a[3];var m=a*f+n*e-h*d,g=a*d+h*f-b*e,r=a*e+b*d-n*f,f=-b*f-n*d-h*e;c[0]=m*a+f*-b+g*-h-r*-n;c[1]=g*a+f*-n+r*-b-m*-h;c[2]=r*a+f*-h+m*-n-g*-b;return c};x.scale=function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};x.toMat3=function(a,b){b||(b=u.create());var c=a[0],f=a[1],d=a[2],e=a[3],n=c+c,h=f+f,m=d+d;a=c*n;var g=c*h,c=c*m,p=f*h,f=f*m,d=d*m,n=e*n,h=e*
h,e=e*m;b[0]=1-(p+d);b[1]=g+e;b[2]=c-h;b[3]=g-e;b[4]=1-(a+d);b[5]=f+n;b[6]=c+h;b[7]=f-n;b[8]=1-(a+p);return b};x.toMat4=function(a,b){b||(b=y.create());var c=a[0],f=a[1],d=a[2],e=a[3],n=c+c,h=f+f,m=d+d;a=c*n;var g=c*h,c=c*m,p=f*h,f=f*m,d=d*m,n=e*n,h=e*h,e=e*m;b[0]=1-(p+d);b[1]=g+e;b[2]=c-h;b[3]=0;b[4]=g-e;b[5]=1-(a+d);b[6]=f+n;b[7]=0;b[8]=c+h;b[9]=f-n;b[10]=1-(a+p);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};x.slerp=function(a,b,c,d){d||(d=a);var f=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],e,
n;if(1<=Math.abs(f))return d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d;e=Math.acos(f);n=Math.sqrt(1-f*f);if(.001>Math.abs(n))return d[0]=.5*a[0]+.5*b[0],d[1]=.5*a[1]+.5*b[1],d[2]=.5*a[2]+.5*b[2],d[3]=.5*a[3]+.5*b[3],d;f=Math.sin((1-c)*e)/n;c=Math.sin(c*e)/n;d[0]=a[0]*f+b[0]*c;d[1]=a[1]*f+b[1]*c;d[2]=a[2]*f+b[2]*c;d[3]=a[3]*f+b[3]*c;return d};x.fromRotationMatrix=function(a,b){b||(b=x.create());var c=a[0]+a[4]+a[8],f;if(0<c)f=Math.sqrt(c+1),b[3]=.5*f,f=.5/f,b[0]=(a[7]-a[5])*f,b[1]=(a[2]-a[6])*
f,b[2]=(a[3]-a[1])*f;else{f=x.fromRotationMatrix.s_iNext=x.fromRotationMatrix.s_iNext||[1,2,0];c=0;a[4]>a[0]&&(c=1);a[8]>a[3*c+c]&&(c=2);var d=f[c],e=f[d];f=Math.sqrt(a[3*c+c]-a[3*d+d]-a[3*e+e]+1);b[c]=.5*f;f=.5/f;b[3]=(a[3*e+d]-a[3*d+e])*f;b[d]=(a[3*d+c]+a[3*c+d])*f;b[e]=(a[3*e+c]+a[3*c+e])*f}return b};u.toQuat4=x.fromRotationMatrix;(function(){var a=u.create();x.fromAxes=function(b,c,f,d){a[0]=c[0];a[3]=c[1];a[6]=c[2];a[1]=f[0];a[4]=f[1];a[7]=f[2];a[2]=b[0];a[5]=b[1];a[8]=b[2];return x.fromRotationMatrix(a,
d)}})();x.identity=function(a){a||(a=x.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};x.fromAngleAxis=function(a,b,c){c||(c=x.create());a*=.5;var f=Math.sin(a);c[3]=Math.cos(a);c[0]=f*b[0];c[1]=f*b[1];c[2]=f*b[2];return c};x.toAngleAxis=function(a,b){b||(b=a);var f=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<f?(b[3]=2*Math.acos(a[3]),f=c.invsqrt(f),b[0]=a[0]*f,b[1]=a[1]*f,b[2]=a[2]*f):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};x.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var z={create:function(a){var b=
new e(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0;return b},createFrom:function(a,b,c,d){var f=new e(4);f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||(a=z.create());a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(!b||a===b)return b=a[1],a[1]=a[2],a[2]=b,a;b[0]=a[0];b[1]=a[2];b[2]=a[1];b[3]=a[3];return b},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,
b){b||(b=a);var c=a[0],f=a[1],d=a[2];a=a[3];var e=c*a-d*f;if(!e)return null;e=1/e;b[0]=a*e;b[1]=-f*e;b[2]=-d*e;b[3]=c*e;return b},multiply:function(a,b,c){c||(c=a);var f=a[0],d=a[1],e=a[2];a=a[3];c[0]=f*b[0]+d*b[2];c[1]=f*b[1]+d*b[3];c[2]=e*b[0]+a*b[2];c[3]=e*b[1]+a*b[3];return c},rotate:function(a,b,c){c||(c=a);var f=a[0],d=a[1],e=a[2];a=a[3];var n=Math.sin(b);b=Math.cos(b);c[0]=f*b+d*n;c[1]=f*-n+d*b;c[2]=e*b+a*n;c[3]=e*-n+a*b;return c},multiplyVec2:function(a,b,c){c||(c=b);var f=b[0];b=b[1];c[0]=
f*a[0]+b*a[1];c[1]=f*a[2]+b*a[3];return c},scale:function(a,b,c){c||(c=a);var f=a[1],d=a[2],e=a[3],n=b[0];b=b[1];c[0]=a[0]*n;c[1]=f*b;c[2]=d*n;c[3]=e*b;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};a=a?"":"d";b["glMath"+a]=c;b["vec2"+a]={create:function(a){var b=new e(2);a?(b[0]=a[0],b[1]=a[1]):(b[0]=0,b[1]=0);return b},createFrom:function(a,b){var c=new e(2);c[0]=a;c[1]=b;return c},add:function(a,b,c){c||(c=b);c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c},subtract:function(a,
b,c){c||(c=b);c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c},multiply:function(a,b,c){c||(c=b);c[0]=a[0]*b[0];c[1]=a[1]*b[1];return c},divide:function(a,b,c){c||(c=b);c[0]=a[0]/b[0];c[1]=a[1]/b[1];return c},scale:function(a,b,c){c||(c=a);c[0]=a[0]*b;c[1]=a[1]*b;return c},dist:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)},dist2:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a},set:function(a,b){b[0]=a[0];b[1]=a[1];return b},set2:function(a,b,c){c[0]=a;c[1]=b;return c},negate:function(a,
b){b||(b=a);b[0]=-a[0];b[1]=-a[1];return b},normalize:function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1];0<c?(c=Math.sqrt(c),b[0]=a[0]/c,b[1]=a[1]/c):b[0]=b[1]=0;return b},cross:function(a,b,c){a=a[0]*b[1]-a[1]*b[0];if(!c)return a;c[0]=c[1]=0;c[2]=a;return c},length:function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},direction:function(a,b,c){c||(c=a);var f=a[0]-b[0];a=a[1]-b[1];b=f*f+a*a;if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/Math.sqrt(b);c[0]=f*
b;c[1]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);return d},str:function(a){return"["+a[0]+", "+a[1]+"]"}};b["vec3"+a]=g;b["vec4"+a]={create:function(a){var b=new e(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):(b[0]=0,b[1]=0,b[2]=0,b[3]=0);return b},createFrom:function(a,b,c,d){var f=new e(4);f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},add:function(a,b,c){c||(c=b);c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c},subtract:function(a,
b,c){c||(c=b);c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c},multiply:function(a,b,c){c||(c=b);c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];c[3]=a[3]*b[3];return c},divide:function(a,b,c){c||(c=b);c[0]=a[0]/b[0];c[1]=a[1]/b[1];c[2]=a[2]/b[2];c[3]=a[3]/b[3];return c},scale:function(a,b,c){c||(c=a);c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];
return b},set4:function(a,b,c,d,e){e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);d[3]=a[3]+c*(b[3]-a[3]);return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};b["mat2"+a]=z;b["mat3"+a]=u;b["mat4"+a]=y;b["quat4"+a]=x});return k})},"esri/layers/vectorTiles/views/3d/support/mathUtils":function(){define(["require",
"exports","../lib/glMatrix"],function(k,b,a){function c(a){return Math.asin(1<a?1:-1>a?-1:a)}function e(a){return Math.acos(1<a?1:-1>a?-1:a)}function g(a,b,c){return a<b?b:a>c?c:a}function l(a){for(var b in a){var c=a[b];c instanceof Function&&(a[b]=c.bind(a))}return a}Object.defineProperty(b,"__esModule",{value:!0});b.deg2rad=function(a){return a*Math.PI/180};b.rad2deg=function(a){return 180*a/Math.PI};b.asin=c;b.acos=e;b.sign=Math.sign||function(a){return+(0<a)-+(0>a)||+a};b.log2=Math.log2||function(a){return Math.log(a)/
Math.LN2};b.fovx2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/b)};b.fovy2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/c)};b.makeOrthonormal=function(b,c,d){d=d||b;var e=a.vec3d.dot(b,c);a.vec3d.set3(b[0]-e*c[0],b[1]-e*c[1],b[2]-e*c[2],d);a.vec3d.normalize(d)};b.tangentFrame=function(b,c,d){Math.abs(b[0])>Math.abs(b[1])?a.vec3d.set3(0,1,0,c):a.vec3d.set3(1,0,0,c);a.vec3d.cross(b,c,d);a.vec3d.normalize(c);a.vec3d.cross(d,b,c);a.vec3d.normalize(d)};b.cartesianToSpherical=function(b,
d){var e=a.vec3d.length(b),h=c(b[2]/e);a.vec3d.set3(e,h,Math.atan2(b[1]/e,b[0]/e),d)};b.sphericalToCartesian=function(b,c){var d=b[0],e=b[1];b=b[2];var h=Math.cos(e);a.vec3d.set3(d*h*Math.cos(b),d*h*Math.sin(b),d*Math.sin(e),c)};b.lerp=function(a,b,c){return a+(b-a)*c};b.bilerp=function(a,b,c,d,e,h){a+=(b-a)*e;return a+(c+(d-c)*e-a)*h};b.slerp=function(b,c,d,e){void 0===e&&(e=b);var g=a.vec3d.length(b),l=a.vec3d.length(c),p=a.vec3d.dot(b,c)/(g*l);if(.9999999999999999>p){var p=Math.acos(p),k=((1-d)*
g+d*l)/Math.sin(p),l=k/l*Math.sin(d*p);a.vec3d.scale(b,k/g*Math.sin((1-d)*p),h);a.vec3d.scale(c,l,m);return a.vec3d.add(h,m,e)}return a.vec3d.lerp(b,c,d,e)};b.angle=function(b,c,g){b=a.vec3d.normalize(b,h);c=a.vec3d.normalize(c,m);var l=e(a.vec3d.dot(b,c));return g&&(b=a.vec3d.cross(b,c,d),0>a.vec3d.dot(b,g))?-l:l};b.clamp=g;b.isFinite=Number.isFinite||function(a){return"number"===typeof a&&window.isFinite(a)};b.isNaN=Number.isNaN||function(a){return a!==a};b.makePiecewiseLinearFunction=function(a){var b=
a.length;return function(c){var d=0;if(c<=a[0][0])return a[0][1];if(c>=a[b-1][0])return a[b-1][1];for(;c>a[d][0];)d++;var e=a[d][0];c=(e-c)/(e-a[d-1][0]);return c*a[d-1][1]+(1-c)*a[d][1]}};b.vectorEquals=function(a,b){if(null==a||null==b)return a!==b;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0};b.floatEqualRelative=function(a,c,d){void 0===d&&(d=1E-6);if(b.isNaN(a)||b.isNaN(c))return!1;if(a===c)return!0;var e=Math.abs(a-c),h=Math.abs(a),m=Math.abs(c);
if(0===a||0===c||1E-12>h&&1E-12>m){if(e>.01*d)return!1}else if(e/(h+m)>d)return!1;return!0};b.floatEqualAbsolute=function(a,c,d){void 0===d&&(d=1E-6);return b.isNaN(a)||b.isNaN(c)?!1:(a>c?a-c:c-a)<=d};k=function(){function a(a,b){this.min=a;this.max=b;this.range=b-a}a.prototype.ndiff=function(a,b){void 0===b&&(b=0);return Math.ceil((a-b)/this.range)*this.range+b};a.prototype._normalize=function(a,b,c,d){void 0===d&&(d=0);c-=d;c<a?c+=this.ndiff(a-c):c>b&&(c-=this.ndiff(c-b));return c+d};a.prototype.normalize=
function(a,b){return this._normalize(this.min,this.max,a,b)};a.prototype.clamp=function(a,b){void 0===b&&(b=0);return g(a-b,this.min,this.max)+b};a.prototype.monotonic=function(a,b,c){return a<b?b:b+this.ndiff(a-b,c)};a.prototype.minimalMonotonic=function(a,b,c){return this._normalize(a,a+this.range,b,c)};a.prototype.center=function(a,b,c){b=this.monotonic(a,b,c);return this.normalize((a+b)/2,c)};a.prototype.diff=function(a,b,c){return this.monotonic(a,b,c)-a};a.prototype.contains=function(a,b,c){b=
this.minimalMonotonic(a,b);c=this.minimalMonotonic(a,c);return c>a&&c<b};return a}();b.Cyclical=k;b.cyclical2PI=l(new k(0,2*Math.PI));b.cyclicalPI=l(new k(-Math.PI,Math.PI));b.cyclicalDeg=l(new k(0,360));var d=a.vec3d.create(),h=a.vec3d.create(),m=a.vec3d.create()})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","../util/Writer"],function(k,b,a,c){Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(a,b){this.data=
a;this.stride=b;this.vertexCount=0}a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();b.default=e;k=function(){function b(b,d,h){this.geometryType=b;this.indexVector=new c.default(Uint32Array,h);this.namedVectors={};b=a.getStrides(b,d);for(var m in b){d=b[m];var g=new c.default(Uint32Array,d/4*h);this.namedVectors[m]=new e(g,d)}}b.prototype.get=function(a){return this.namedVectors[a].data};b.prototype.transfer=
function(a,b){var c=this.indexVector.buffer(),d={};b.push(c);for(var e in this.namedVectors){var g=this.namedVectors[e];d[e]={};g.transfer(d[e],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=d;this.destroy()};b.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return b}();b.VertexVectors=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function a(a,
b){this._pos=0;b=b?this._roundToNearest4(b):40;this._array=new ArrayBuffer(b);this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});a.prototype._roundToNearest4=function(a){a=Math.round(a);return a+(4-a%4)};a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=this._roundToNearest4(1.5*(this._array.byteLength+4*a));a=new ArrayBuffer(a);var b=new this._ctor(a);b.set(this._buffer,
0);this._array=a;this._buffer=b}};a.prototype.writeInt32=function(a){this._ensureSize(1);var b=this._pos;this._buffer[this._pos++]=a;return b};a.prototype.writeF32=function(a){this._ensureSize(1);var b=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return b};a.prototype.writeUint32=function(a){this._ensureSize(1);var b=this._pos;this._buffer[this._pos++]=a;return b};a.prototype.push=function(a){this._ensureSize(1);var b=this._pos;this._buffer[this._pos++]=a;return b};a.prototype.writeRegion=
function(a){this._ensureSize(a.length);var b=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return b};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.destroy=function(){this._buffer=this._array=null};return a}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/templates/meshTemplateUtils":function(){define("require exports ../../../../../../core/Logger ../../enums ../templates/WGLFillTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTextTemplate ../../util/vvFlagUtils".split(" "),
function(k,b,a,c,e,g,l,d,h){Object.defineProperty(b,"__esModule",{value:!0});var m=a.getLogger("esri.views.2d.engine.webgl.mesh.templates.meshTemplateUtils");b.createMeshTemplates=function(a,b,k,u,y,x,A){void 0===A&&(A=!1);if(-1!==k.type.indexOf("3d"))return m.error("3D symbols are not supported with MapView"),a;var p=u.get(k.id);p||m.error("Couldn't find texture resources for symbol: "+k.id+"!");switch(k.type){case c.EsriSymbolTypeKebab.SIMPLE_MARKER:return a.push(l.default.fromSimpleMarker(b,h.getMarkerVVFlags(y),
k,p.spriteMosaicItem,x)),a;case c.EsriSymbolTypeKebab.PICTURE_MARKER:return a.push(l.default.fromPictureMarker(b,h.getMarkerVVFlags(y),k,p.spriteMosaicItem,x)),a;case c.EsriSymbolTypeKebab.SIMPLE_FILL:return a.push(e.default.fromSimpleFill(b,h.getFillVVFlags(y),k,p.spriteMosaicItem,x,A)),k.outline&&(u=u.get(k.outline.id),a.push(g.default.fromSimpleLine(b,h.getLineVVFlags(y,!0),k.outline,u&&u.spriteMosaicItem,x))),a;case c.EsriSymbolTypeKebab.PICTURE_FILL:return a.push(e.default.fromPictureFill(b,
h.getFillVVFlags(y),k,p.spriteMosaicItem,x,A)),k.outline&&(u=u.get(k.outline.id),a.push(g.default.fromSimpleLine(b,h.getLineVVFlags(y,!0),k.outline,u&&u.spriteMosaicItem,x))),a;case c.EsriSymbolTypeKebab.SIMPLE_LINE:return a.push(g.default.fromSimpleLine(b,h.getLineVVFlags(y,!1),k,p.spriteMosaicItem,x)),a;case c.EsriSymbolTypeKebab.TEXT:return a.push(d.default.fromText(b,h.getTextVVFlags(y),k,x,p.glyphMosaicItems)),a;default:return m.error("Unable to create mesh template for unknown symbol type: "+
k.type),a}}})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper dojo/has ../../../../../../core/Logger ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../Tesselator ./WGLMeshTemplate".split(" "),function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y){Object.defineProperty(b,"__esModule",{value:!0});var x=
e.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),A=[],z=[];k=function(b){function f(a,d,f,e,n,m,g,l){var p=b.call(this)||this;p.fillColor=e;p.tl=n;p.br=m;p.aux=g;p.isBFS=l;p.geometryType=h.WGLGeometryType.FILL;p.useLibtess=!1;e=c("esri-featurelayer-webgl");p.useLibtess="libtess"===((e||{}).tesselator||"libtess");p.useLibtess&&(p._tesselator=new u.default);p.vvFlags=d;p._materialStore=a;p.materialId=p._materialStore.createSpriteMaterial(f,p.geometryType,d);p._tileClipper=new q.TileClipper(0,
0,0,1,8);p._tileClipper.setExtent(512);return p}a(f,b);f.fromSimpleFill=function(a,b,c,d,e,n){void 0===n&&(n=!1);c=(e=c.color)&&"none"!==c.style&&l.premultiplyAlphaRGBA(e)||0;if(!d)return new f(a,b,null,c,0,0,0,n);var h=d.rect;e=h.x+1;var m=h.y+1,g=h.x+1+d.width,r=h.y+1+d.height,h=p.i1616to32(e,m),k=p.i1616to32(g,r);e=p.i8888to32(p.nextHighestPowerOfTwo(g-e),p.nextHighestPowerOfTwo(r-m),0,0);return new f(a,b,d,c,h,k,e,n)};f.fromPictureFill=function(a,b,c,e,n,h){void 0===h&&(h=!1);n=d.PICTURE_FILL_COLOR;
var m=e.rect,g=m.x+1+e.width,l=m.y+1+e.height,m=p.i1616to32(m.x+1,m.y+1),g=p.i1616to32(g,l);c=p.i8888to32(p.nextHighestPowerOfTwo(c.width),p.nextHighestPowerOfTwo(c.height),0,0);return new f(a,b,e,n,m,g,c,h)};f.prototype.writeMesh=function(a,b,c,d,f,e,n){A.length=0;if(this.vvFlags&m.WGLVVFlag.COLOR||0!==this.fillColor)if("esriGeometryPolygon"!==c)x.error("Unable to handle geometryType: "+c);else{var h=f.geometry,h=(f=this._isClippingRequired(h))?this._clip(h,!this.useLibtess):h.rings;return this.useLibtess?
this._writeMeshLibtess(a,b,c,d,h,f,e,n):this._writeMeshEarcut(a,b,c,d,h,f,e,n)}};f.prototype._isClippingRequired=function(a){var b=0;for(a=a.rings;b<a.length;b++){var c=a[b],d=c.length;if(!(3>d)){var f=c[0][0],e=c[0][1];if(-8>f||520<f||-8>e||520<e)return!0;for(var n=1;n<d;++n)if(f+=c[n][0],e+=c[n][1],-8>f||520<f||-8>e||520<e)return!0}}return!1};f.prototype._clip=function(a,b){var c;this._tileClipper.reset(3);for(var d=0,f=a.rings;d<f.length;d++){var e=f[d],n=e.length;if(!(3>n)){a=e[0][0];c=e[0][1];
this._tileClipper.moveTo(a,c);for(var h=1;h<n;++h)a+=e[h][0],c+=e[h][1],this._tileClipper.lineTo(a,c);this._tileClipper.close()}}return this._tileClipper.result(b)};f.prototype._writeMeshLibtess=function(a,b,c,d,f,e,n,h){if(f&&f.length){c=this._materialStore.get(this.materialId);n=[];var m=b.indexVector;b=b.get("geometry");var g=new t(d,this.geometryType,this.materialId),l=this._getOffset(b,c);g.vertexFrom=l;g.indexFrom=m.length;a.push(g);this._tesselator.beginPolygon(A,n);for(a=0;a<f.length;a++){var p=
f[a];if(!(3>p.length)){this._tesselator.beginContour();var r=void 0,k=void 0;e?(r=p[0].x,k=p[0].y):(r=p[0][0],k=p[0][1]);var B=[r,k,0];this._tesselator.addVertex(B,B);for(B=1;B<p.length-1;B++){var q=void 0,C=void 0;e?(r=p[B].x,k=p[B].y):(q=p[B][0],C=p[B][1],r+=q,k+=C);q=[r,k,0];this._tesselator.addVertex(q,q)}this._tesselator.endContour()}}this._tesselator.endPolygon();this._writeVerticesLibTess(g,b,d,A,c,h);this._writeIndicesLibTess(g,m,l,n)}};f.prototype._writeMeshEarcut=function(a,b,c,d,f,e,n,
h){if(f&&f.length){c=this._materialStore.get(this.materialId);n=b.indexVector;b=b.get("geometry");var m=new t(d,this.geometryType,this.materialId),g=this._getOffset(b,c);m.vertexFrom=g;m.indexFrom=n.length;a.push(m);for(var l=a=0,p=0;p<f.length;p++){var r=f[p],k=l,B=void 0,q=void 0;e?(B=r[0].x,q=r[0].y):(B=r[0][0],q=r[0][1]);A[l++]=B;A[l++]=q;for(var C=0,u=1;u<r.length;++u){var D=void 0,y=void 0;e?(D=B,y=q,B=r[u].x,q=r[u].y,D=B-D,y=q-y):(D=r[u][0],y=r[u][1],B+=D,q+=y);C-=D*(q+q+y);A[l++]=B;A[l++]=
q}0<C?(0<k-a&&(this._write(m,n,b,g,d,A,z,a,k,c,h),a=k),z.length=0):0>C?0<k-a?z.push(.5*(k-a)):l=k:l=k}0<l-a&&this._write(m,n,b,g,d,A,z,a,l,c,h);A.length=z.length=0}};f.prototype._write=function(a,b,c,d,f,e,n,h,m,l,p){d=g(e.slice(h,m),n,2);d.length&&(h=this._getOffset(c,l),this._writeVertices(a,c,f,e,n,l,p),this._writeIndices(a,b,h,d))};f.prototype._getOffset=function(a,b){b=b.materialKeyInfo.hasVV()?8:6;return a.length/b};f.prototype._writeVertices=function(a,b,c,d,f,e,n){for(f=0;f<d.length;f+=2){var h=
p.i1616to32(d[f],d[f+1]);b.push(h);b.push(c);b.push(this.fillColor);b.push(this.tl);b.push(this.br);b.push(this.aux);this._writeVV(b,n,e);a.vertexCount++}};f.prototype._writeIndices=function(a,b,c,d){for(var f=0;f<d.length;f+=3)b.push(c+d[f]),b.push(c+d[f+1]),b.push(c+d[f+2]),a.indexCount+=3};f.prototype._writeVerticesLibTess=function(a,b,c,d,f,e){for(var n=0;n<d.length;n+=2){var h=p.i1616to32(d[n],d[n+1]);b.push(h);b.push(c);b.push(this.fillColor);b.push(this.tl);b.push(this.br);b.push(this.aux);
this._writeVV(b,e,f);a.vertexCount++}};f.prototype._writeIndicesLibTess=function(a,b,c,d){for(var f=0;f<d.length;f++)b.push(c+d[f]),a.indexCount++};f.prototype._writeVV=function(a,b,c){c.materialKeyInfo.hasVV()&&(this.isBFS?(a.push(4294967295),a.push(4294967295)):(a.push(b[h.VVType.COLOR]),a.push(b[h.VVType.OPACITY])))};return f}(y.default);b.default=k})},"esri/layers/vectorTiles/core/libs/earcut/earcut":function(){define([],function(){function k(d,f,e){e=e||2;n=d.length/e+(f?2*f.length:0);r=!1;var m=
f&&f.length,p=m?f[0]*e:d.length,k=b(d,0,p,e,!0),B=[];if(!k)return B;var q,t,C,u;if(m)a:{var D=e,m=[],z,x,A;u=0;for(z=f.length;u<z;u++)x=f[u]*D,A=u<z-1?f[u+1]*D:d.length,x=b(d,x,A,D,!1),x===x.next&&(x.steiner=!0),m.push(h(x));m.sort(g);for(u=0;u<m.length;u++){if(!k){k=null;break a}f=m[u];D=k;if(D=l(f,D))f=y(D,f),a(f,f.next);k=a(k,k.next)}}if(r)return B;if(d.length>80*e){q=C=d[0];t=m=d[1];for(D=e;D<p;D+=e)u=d[D],f=d[D+1],u<q&&(q=u),f<t&&(t=f),u>C&&(C=u),f>m&&(m=f);C=Math.max(C-q,m-t)}c(k,B,e,q,t,C);
return B}function b(a,b,c,d,e){var n;if(e===0<f(a,b,c,d))for(e=b;e<c;e+=d)n=x(e,a[e],a[e+1],n);else for(e=c-d;e>=b;e-=d)n=x(e,a[e],a[e+1],n);n&&q(n,n.next)&&(A(n),n=n.next);return n}function a(a,b){if(!a)return a;b||(b=a);var c,d=0,f=n*n/2;do{c=!1;if(a.steiner||!q(a,a.next)&&0!==p(a.prev,a,a.next))a=a.next;else{A(a);a=b=a.prev;if(a===a.next)return null;c=!0}if(d++>f)return r=!0,null}while(c||a!==b);return b}function c(b,f,n,h,g,l,k){if(b){if(!k&&l){var B=b,C=B;do null===C.z&&(C.z=d(C.x,C.y,h,g,l)),
C.prevZ=C.prev,C=C.nextZ=C.next;while(C!==B);C.prevZ.nextZ=null;C.prevZ=null;var B=C,D,F,z,x,H,J,I=1;do{C=B;z=B=null;for(x=0;C;){x++;F=C;for(D=H=0;D<I&&(H++,F=F.nextZ,F);D++);for(J=I;0<H||0<J&&F;)0===H?(D=F,F=F.nextZ,J--):0!==J&&F?C.z<=F.z?(D=C,C=C.nextZ,H--):(D=F,F=F.nextZ,J--):(D=C,C=C.nextZ,H--),z?z.nextZ=D:B=D,D.prevZ=z,z=D;C=F}z.nextZ=null;I*=2}while(1<x)}for(B=b;b.prev!==b.next;){C=b.prev;F=b.next;if(l)a:{z=b;J=h;var U=g,X=l;x=z.prev;H=z;I=z.next;if(0<=p(x,H,I))z=!1;else{var Y=x.x>H.x?x.x>I.x?
x.x:I.x:H.x>I.x?H.x:I.x,O=x.y>H.y?x.y>I.y?x.y:I.y:H.y>I.y?H.y:I.y;D=d(x.x<H.x?x.x<I.x?x.x:I.x:H.x<I.x?H.x:I.x,x.y<H.y?x.y<I.y?x.y:I.y:H.y<I.y?H.y:I.y,J,U,X);J=d(Y,O,J,U,X);for(U=z.nextZ;U&&U.z<=J;){if(U!==z.prev&&U!==z.next&&m(x.x,x.y,H.x,H.y,I.x,I.y,U.x,U.y)&&0<=p(U.prev,U,U.next)){z=!1;break a}U=U.nextZ}for(U=z.prevZ;U&&U.z>=D;){if(U!==z.prev&&U!==z.next&&m(x.x,x.y,H.x,H.y,I.x,I.y,U.x,U.y)&&0<=p(U.prev,U,U.next)){z=!1;break a}U=U.prevZ}z=!0}}else z=e(b);if(z)f.push(C.i/n),f.push(b.i/n),f.push(F.i/
n),A(b),B=b=F.next;else{if(r)break;b=F;if(b===B){if(!k)c(a(b),f,n,h,g,l,1);else if(1===k){k=f;B=n;C=b;do F=C.prev,z=C.next.next,!q(F,z)&&t(F,C,C.next,z)&&u(F,z)&&u(z,F)&&(k.push(F.i/B),k.push(C.i/B),k.push(z.i/B),A(C),A(C.next),C=b=z),C=C.next;while(C!==b);b=C;c(b,f,n,h,g,l,2)}else if(2===k)a:{k=b;do{for(B=k.next.next;B!==k.prev;){if(C=k.i!==B.i){C=k;F=B;z=void 0;if(z=C.next.i!==F.i&&C.prev.i!==F.i){z=void 0;b:{z=C;do{if(z.i!==C.i&&z.next.i!==C.i&&z.i!==F.i&&z.next.i!==F.i&&t(z,z.next,C,F)){z=!0;
break b}z=z.next}while(z!==C);z=!1}z=!z}x=void 0;if(x=z&&u(C,F)&&u(F,C)){z=C;x=!1;H=(C.x+F.x)/2;F=(C.y+F.y)/2;do z.y>F!==z.next.y>F&&H<(z.next.x-z.x)*(F-z.y)/(z.next.y-z.y)+z.x&&(x=!x),z=z.next;while(z!==C)}C=x}if(C){b=y(k,B);k=a(k,k.next);b=a(b,b.next);c(k,f,n,h,g,l);c(b,f,n,h,g,l);break a}B=B.next}k=k.next}while(k!==b)}break}}}}}function e(a){var b=a.prev,c=a.next;if(0<=p(b,a,c))return!1;for(var d=a.next.next,f=0;d!==a.prev;){if(m(b.x,b.y,a.x,a.y,c.x,c.y,d.x,d.y)&&0<=p(d.prev,d,d.next))return!1;
d=d.next;if(f++>n)return r=!0,!1}return!0}function g(a,b){return a.x-b.x}function l(a,b){var c=b,d=a.x,f=a.y,e=-Infinity,n;do{if(!c)return null;if(f<=c.y&&f>=c.next.y){var h=c.x+(f-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(h<=d&&h>e){e=h;if(h===d){if(f===c.y)return c;if(f===c.next.y)return c.next}n=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!n)return null;if(d===e)return n.prev;b=n;for(var h=n.x,g=n.y,l=Infinity,p,c=n.next;c!==b;)d>=c.x&&c.x>=h&&m(f<g?d:e,f,h,g,f<g?e:d,f,c.x,c.y)&&(p=Math.abs(f-
c.y)/(d-c.x),(p<l||p===l&&c.x>n.x)&&u(c,a)&&(n=c,l=p)),c=c.next;return n}function d(a,b,c,d,f){a=32767*(a-c)/f;b=32767*(b-d)/f;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function h(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function m(a,b,c,d,f,e,n,h){return 0<=(f-n)*(b-h)-(a-n)*(e-h)&&0<=(a-n)*(d-h)-(c-n)*(b-h)&&0<=(c-n)*(e-h)-(f-n)*(d-h)}function p(a,
b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function q(a,b){return a.x===b.x&&a.y===b.y}function t(a,b,c,d){return q(a,b)&&q(c,d)||q(a,d)&&q(c,b)?!0:0<p(a,b,c)!==0<p(a,b,d)&&0<p(c,d,a)!==0<p(c,d,b)}function u(a,b){return 0>p(a.prev,a,a.next)?0<=p(a,b,a.next)&&0<=p(a,a.prev,b):0>p(a,b,a.prev)||0>p(a,a.next,b)}function y(a,b){var c=new z(a.i,a.x,a.y),d=new z(b.i,b.x,b.y),f=a.next,e=b.prev;a.next=b;b.prev=a;c.next=f;f.prev=c;d.next=c;c.prev=d;e.next=d;d.prev=e;return d}function x(a,b,c,d){a=new z(a,
b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function A(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function z(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function f(a,b,c,d){for(var f=0,e=c-d;b<c;b+=d)f+=(a[e]-a[b])*(a[b+1]+a[e+1]),e=b;return f}var n,r;k.deviation=function(a,b,c,d){var e=b&&b.length,n=Math.abs(f(a,0,e?b[0]*c:a.length,c));
if(e)for(var e=0,h=b.length;e<h;e++)n-=Math.abs(f(a,b[e]*c,e<h-1?b[e+1]*c:a.length,c));for(e=b=0;e<d.length;e+=3){var h=d[e]*c,m=d[e+1]*c,g=d[e+2]*c;b+=Math.abs((a[h]-a[g])*(a[m+1]-a[h+1])-(a[h]-a[m])*(a[g+1]-a[h+1]))}return 0===n&&0===b?0:Math.abs((b-n)/n)};k.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,f=0;f<a.length;f++){for(var e=0;e<a[f].length;e++)for(var n=0;n<b;n++)c.vertices.push(a[f][e][n]);0<f&&(d+=a[f-1].length,c.holes.push(d))}return c};return k})},
"esri/layers/vectorTiles/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./Geometry","./GeometryUtils"],function(k,b,a,c){Object.defineProperty(b,"__esModule",{value:!0});var e=function(){return function(a,b,c){this.ratio=a;this.x=b;this.y=c}}();k=function(){function b(a,b,c,e,g){void 0===e&&(e=8);void 0===g&&(g=8);this.lines=[];this.starts=[];this.pixelRatio=e;this.pixelMargin=g;this.tileSize=512*e;this.dz=a;this.yPos=b;this.xPos=c}b.prototype.setExtent=function(a){this.finalRatio=
this.tileSize/a*(1<<this.dz);var b=this.pixelRatio*this.pixelMargin,b=b/this.finalRatio;a>>=this.dz;b>a&&(b=a);this.margin=b;this.xmin=a*this.xPos-b;this.ymin=a*this.yPos-b;this.xmax=this.xmin+a+2*b;this.ymax=this.ymin+a+2*b};b.prototype.reset=function(a){this.type=a;this.lines=[];this.starts=[];this.line=null;this.start=0};b.prototype.moveTo=function(b,c){this._pushLine();this._prevIsIn=this._isIn(b,c);this._moveTo(b,c,this._prevIsIn);this._prevPt=new a.Point(b,c);this._firstPt=new a.Point(b,c);
this._dist=0};b.prototype.lineTo=function(b,c){var d=this._isIn(b,c),h=new a.Point(b,c),g=a.Point.distance(this._prevPt,h),l,k,y;if(d)this._prevIsIn?this._lineTo(b,c,!0):(l=this._prevPt,k=h,b=this._intersect(k,l),this.start=this._dist+g*(1-this._r),this._lineTo(b.x,b.y,!0),this._lineTo(k.x,k.y,!0));else if(this._prevIsIn)k=this._prevPt,l=h,b=this._intersect(k,l),this._lineTo(b.x,b.y,!0),this._lineTo(l.x,l.y,!1);else{var x=this._prevPt;if(!(x.x<=this.xmin&&h.x<=this.xmin||x.x>=this.xmax&&h.x>=this.xmax||
x.y<=this.ymin&&h.y<=this.ymin||x.y>=this.ymax&&h.y>=this.ymax)){b=[];if(x.x<this.xmin&&h.x>this.xmin||x.x>this.xmin&&h.x<this.xmin)c=(this.xmin-x.x)/(h.x-x.x),y=x.y+c*(h.y-x.y),y<=this.ymin?k=!1:y>=this.ymax?k=!0:b.push(new e(c,this.xmin,y));if(x.x<this.xmax&&h.x>this.xmax||x.x>this.xmax&&h.x<this.xmax)c=(this.xmax-x.x)/(h.x-x.x),y=x.y+c*(h.y-x.y),y<=this.ymin?k=!1:y>=this.ymax?k=!0:b.push(new e(c,this.xmax,y));if(x.y<this.ymin&&h.y>this.ymin||x.y>this.ymin&&h.y<this.ymin)c=(this.ymin-x.y)/(h.y-
x.y),y=x.x+c*(h.x-x.x),y<=this.xmin?l=!1:y>=this.xmax?l=!0:b.push(new e(c,y,this.ymin));if(x.y<this.ymax&&h.y>this.ymax||x.y>this.ymax&&h.y<this.ymax)c=(this.ymax-x.y)/(h.y-x.y),y=x.x+c*(h.x-x.x),y<=this.xmin?l=!1:y>=this.xmax?l=!0:b.push(new e(c,y,this.ymax));if(0===b.length)l?k?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):k?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<b.length&&b[0].ratio>b[1].ratio)this.start=this._dist+g*b[1].ratio,
this._lineTo(b[1].x,b[1].y,!0),this._lineTo(b[0].x,b[0].y,!0);else for(this.start=this._dist+g*b[0].ratio,l=0;l<b.length;l++)this._lineTo(b[l].x,b[l].y,!0)}this._lineTo(h.x,h.y,!1)}this._dist+=g;this._prevIsIn=d;this._prevPt=h};b.prototype.close=function(){if(2<this.line.length){var a=this._firstPt,b=this._prevPt;a.x===b.x&&a.y===b.y||this.lineTo(a.x,a.y);a=this.line;for(b=a.length;4<=b;)if(a[0].x===a[1].x&&a[0].x===a[b-2].x||a[0].y===a[1].y&&a[0].y===a[b-2].y)a.pop(),a[0].x=a[b-2].x,a[0].y=a[b-2].y,
--b;else break}};b.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;3===this.type&&a&&g.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};b.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,b=a.length;if(0===b)return null;for(var c=[],e=0;e<b;e++)c.push({line:a[e],start:this.starts[e]||0});return c};b.prototype._isIn=function(a,b){return a>=
this.xmin&&a<=this.xmax&&b>=this.ymin&&b<=this.ymax};b.prototype._intersect=function(b,c){var d,e,h;if(c.x>=this.xmin&&c.x<=this.xmax)e=c.y<=this.ymin?this.ymin:this.ymax,h=(e-b.y)/(c.y-b.y),d=b.x+h*(c.x-b.x);else if(c.y>=this.ymin&&c.y<=this.ymax)d=c.x<=this.xmin?this.xmin:this.xmax,h=(d-b.x)/(c.x-b.x),e=b.y+h*(c.y-b.y);else{e=c.y<=this.ymin?this.ymin:this.ymax;d=c.x<=this.xmin?this.xmin:this.xmax;var g=(d-b.x)/(c.x-b.x),l=(e-b.y)/(c.y-b.y);g<l?(h=g,e=b.y+g*(c.y-b.y)):(h=l,d=b.x+l*(c.x-b.x))}this._r=
h;return new a.Point(d,e)};b.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};b.prototype._moveTo=function(b,c,e){3!==this.type?e&&(b=Math.round((b-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-
(this.ymin+this.margin))*this.finalRatio),this.line.push(new a.Point(b,c))):(e||(b<this.xmin&&(b=this.xmin),b>this.xmax&&(b=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),b=Math.round((b-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line.push(new a.Point(b,c)),this._is_v=this._is_h=!1)};b.prototype._lineTo=function(b,c,e){if(3!==this.type)if(e){b=Math.round((b-(this.xmin+this.margin))*this.finalRatio);c=Math.round((c-(this.ymin+
this.margin))*this.finalRatio);if(0<this.line.length&&(e=this.line[this.line.length-1],e.equals(b,c)))return;this.line.push(new a.Point(b,c))}else this.line&&0<this.line.length&&this._pushLine();else if(e||(b<this.xmin&&(b=this.xmin),b>this.xmax&&(b=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),b=Math.round((b-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){e=this.line[this.line.length-1];var d=
e.x===b,h=e.y===c;d&&h||(this._is_h&&d?(e.x=b,e.y=c,e=this.line[this.line.length-2],e.x===b&&e.y===c?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(e=this.line[this.line.length-2],this._is_h=e.x===b,this._is_v=e.y===c)):(this._is_h=e.x===b,this._is_v=e.y===c)):this._is_v&&h?(e.x=b,e.y=c,e=this.line[this.line.length-2],e.x===b&&e.y===c?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(e=this.line[this.line.length-2],this._is_h=e.x===b,this._is_v=e.y===c)):(this._is_h=e.x===
b,this._is_v=e.y===c)):(this.line.push(new a.Point(b,c)),this._is_h=d,this._is_v=h))}else this.line.push(new a.Point(b,c))};return b}();b.TileClipper=k;k=function(){function b(){}b.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};b.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null};b.prototype.moveTo=function(b,c){this.line&&this.lines.push(this.line);this.line=[];var d=this._ratio;this.line.push(new a.Point(Math.round(b*d),Math.round(c*d)))};b.prototype.lineTo=function(b,
c){var d=this._ratio;this.line.push(new a.Point(Math.round(b*d),Math.round(c*d)))};b.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};b.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;3===this.type&&1!==this._ratio&&g.simplify(4096,64,this.lines);return this.lines};return b}();b.SimpleBuilder=k;var g=function(){function a(){}a.simplify=function(b,c,e){if(e){var d=-c,h=b+c,m=-c,g=b+c;b=[];c=[];for(var l=
e.length,k=0;k<l;++k){var A=e[k];if(A&&!(2>A.length))for(var z=A[0],f=void 0,n=A.length,r=1;r<n;++r)f=A[r],z.x===f.x&&(z.x<=d&&(z.y>f.y?(b.push(k),b.push(r),b.push(0),b.push(-1)):(c.push(k),c.push(r),c.push(0),c.push(-1))),z.x>=h&&(z.y<f.y?(b.push(k),b.push(r),b.push(1),b.push(-1)):(c.push(k),c.push(r),c.push(1),c.push(-1)))),z.y===f.y&&(z.y<=m&&(z.x<f.x?(b.push(k),b.push(r),b.push(2),b.push(-1)):(c.push(k),c.push(r),c.push(2),c.push(-1))),z.y>=g&&(z.x>f.x?(b.push(k),b.push(r),b.push(3),b.push(-1)):
(c.push(k),c.push(r),c.push(3),c.push(-1)))),z=f}0!==b.length&&0!==c.length&&(a.fillParent(e,c,b),a.fillParent(e,b,c),d=[],a.calcDeltas(d,c,b),a.calcDeltas(d,b,c),a.addDeltas(d,e))}};a.fillParent=function(a,b,e){for(var d=e.length,h=b.length,m=0;m<h;m+=4){for(var g=b[m],l=b[m+1],k=b[m+2],A=a[g][l-1],g=a[g][l],l=8092,z=-1,f=0;f<d;f+=4)if(e[f+2]===k){var n=e[f],r=e[f+1],B=a[n][r-1],n=a[n][r];switch(k){case 0:case 1:c.between(A.y,B.y,n.y)&&c.between(g.y,B.y,n.y)&&(B=Math.abs(n.y-B.y),B<l&&(l=B,z=f));
break;case 2:case 3:c.between(A.x,B.x,n.x)&&c.between(g.x,B.x,n.x)&&(B=Math.abs(n.x-B.x),B<l&&(l=B,z=f))}}b[m+3]=z}};a.calcDeltas=function(b,c,e){for(var d=c.length,h=0;h<d;h+=4){var m=a.calcDelta(h,c,e,[]);b.push(c[h]);b.push(c[h+1]);b.push(c[h+2]);b.push(m)}};a.calcDelta=function(b,c,e,g){b=c[b+3];if(-1===b)return 0;var d=g.length;if(1<d&&g[d-2]===b)return 0;g.push(b);return a.calcDelta(b,e,c,g)+1};a.addDeltas=function(a,b){for(var c=a.length,d=0,e=0;e<c;e+=4){var h=a[e+3];h>d&&(d=h)}for(e=0;e<
c;e+=4){var g=b[a[e]],l=a[e+1],h=d-a[e+3];switch(a[e+2]){case 0:g[l-1].x-=h;g[l].x-=h;1===l&&(g[g.length-1].x-=h);l===g.length-1&&(g[0].x-=h);break;case 1:g[l-1].x+=h;g[l].x+=h;1===l&&(g[g.length-1].x+=h);l===g.length-1&&(g[0].x+=h);break;case 2:g[l-1].y-=h;g[l].y-=h;1===l&&(g[g.length-1].y-=h);l===g.length-1&&(g[0].y-=h);break;case 3:g[l-1].y+=h,g[l].y+=h,1===l&&(g[g.length-1].y+=h),l===g.length-1&&(g[0].y+=h)}}};return a}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/Geometry":function(){define(["require",
"exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function a(a,b){this.x=a;this.y=b}a.prototype.clone=function(){return new a(this.x,this.y)};a.prototype.equals=function(a,b){return a===this.x&&b===this.y};a.prototype.isEqual=function(a){return a.x===this.x&&a.y===this.y};a.prototype.setCoords=function(a,b){this.x=a;this.y=b};a.prototype.normalize=function(){var a=this.x,b=this.y,a=Math.sqrt(a*a+b*b);this.x/=a;this.y/=a};a.prototype.rightPerpendicular=function(){var a=
this.x;this.x=this.y;this.y=-a};a.prototype.move=function(a,b){this.x+=a;this.y+=b};a.prototype.assign=function(a){this.x=a.x;this.y=a.y};a.prototype.assignAdd=function(a,b){this.x=a.x+b.x;this.y=a.y+b.y};a.prototype.assignSub=function(a,b){this.x=a.x-b.x;this.y=a.y-b.y};a.prototype.rotate=function(a,b){var c=this.x,e=this.y;this.x=c*a-e*b;this.y=c*b+e*a};a.prototype.scale=function(a){this.x*=a;this.y*=a};a.prototype.length=function(){var a=this.x,b=this.y;return Math.sqrt(a*a+b*b)};a.distance=function(a,
b){var c=b.x-a.x;a=b.y-a.y;return Math.sqrt(c*c+a*a)};a.add=function(b,e){return new a(b.x+e.x,b.y+e.y)};a.sub=function(b,e){return new a(b.x-e.x,b.y-e.y)};return a}();b.Point=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(k,b,a,c){Object.defineProperty(b,"__esModule",{value:!0});var e=a.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");k=function(){function a(){this._indexCounter=
this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new c.GluTesselator;this.glu.gluTessCallback(c.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(c.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(c.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(c.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(c.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));
this.glu.gluTessCallback(c.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));this.glu.gluTessProperty(c.gluEnum.GLU_TESS_WINDING_RULE,c.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=b};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};
a.prototype.endContour=function(){this.glu.gluTessEndContour()};a.prototype.addVertex=function(a,b){this.glu.gluTessVertex(a,b)};a.prototype._vertexCallback=function(a,b){b[b.length]=a[0];b[b.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};
a.prototype._begincallback=function(a){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){e.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a,b,c){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(a){};return a}();b.default=k})},"esri/layers/vectorTiles/core/libs/libtess/libtess":function(){define([],
function(){var k={DEBUG:!1,assert:function(b,a){if(k.DEBUG&&!b)throw Error("Assertion failed"+(a?": "+a:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,
GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,
GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};k.geom.vertEq=function(b,a){return b.s===a.s&&b.t===a.t};k.geom.vertLeq=function(b,a){return b.s<a.s||b.s===a.s&&b.t<=a.t};k.geom.edgeEval=function(b,a,c){k.assert(k.geom.vertLeq(b,a)&&k.geom.vertLeq(a,c));var e=a.s-b.s,g=c.s-a.s;return 0<e+g?e<g?a.t-b.t+e/(e+g)*(b.t-c.t):a.t-c.t+g/(e+g)*(c.t-b.t):0};k.geom.edgeSign=function(b,a,c){k.assert(k.geom.vertLeq(b,a)&&k.geom.vertLeq(a,c));
var e=a.s-b.s,g=c.s-a.s;return 0<e+g?(a.t-c.t)*e+(a.t-b.t)*g:0};k.geom.transLeq=function(b,a){return b.t<a.t||b.t===a.t&&b.s<=a.s};k.geom.transEval=function(b,a,c){k.assert(k.geom.transLeq(b,a)&&k.geom.transLeq(a,c));var e=a.t-b.t,g=c.t-a.t;return 0<e+g?e<g?a.s-b.s+e/(e+g)*(b.s-c.s):a.s-c.s+g/(e+g)*(c.s-b.s):0};k.geom.transSign=function(b,a,c){k.assert(k.geom.transLeq(b,a)&&k.geom.transLeq(a,c));var e=a.t-b.t,g=c.t-a.t;return 0<e+g?(a.s-c.s)*e+(a.s-b.s)*g:0};k.geom.edgeGoesLeft=function(b){return k.geom.vertLeq(b.dst(),
b.org)};k.geom.edgeGoesRight=function(b){return k.geom.vertLeq(b.org,b.dst())};k.geom.vertL1dist=function(b,a){return Math.abs(b.s-a.s)+Math.abs(b.t-a.t)};k.geom.vertCCW=function(b,a,c){return 0<=b.s*(a.t-c.t)+a.s*(c.t-b.t)+c.s*(b.t-a.t)};k.geom.interpolate_=function(b,a,c,e){b=0>b?0:b;c=0>c?0:c;return b<=c?0===c?(a+e)/2:a+b/(b+c)*(e-a):e+c/(b+c)*(a-e)};k.geom.edgeIntersect=function(b,a,c,e,g){var l,d;k.geom.vertLeq(b,a)||(l=b,b=a,a=l);k.geom.vertLeq(c,e)||(l=c,c=e,e=l);k.geom.vertLeq(b,c)||(l=b,
b=c,c=l,l=a,a=e,e=l);k.geom.vertLeq(c,a)?k.geom.vertLeq(a,e)?(l=k.geom.edgeEval(b,c,a),d=k.geom.edgeEval(c,a,e),0>l+d&&(l=-l,d=-d),g.s=k.geom.interpolate_(l,c.s,d,a.s)):(l=k.geom.edgeSign(b,c,a),d=-k.geom.edgeSign(b,e,a),0>l+d&&(l=-l,d=-d),g.s=k.geom.interpolate_(l,c.s,d,e.s)):g.s=(c.s+a.s)/2;k.geom.transLeq(b,a)||(l=b,b=a,a=l);k.geom.transLeq(c,e)||(l=c,c=e,e=l);k.geom.transLeq(b,c)||(l=b,b=c,c=l,l=a,a=e,e=l);k.geom.transLeq(c,a)?k.geom.transLeq(a,e)?(l=k.geom.transEval(b,c,a),d=k.geom.transEval(c,
a,e),0>l+d&&(l=-l,d=-d),g.t=k.geom.interpolate_(l,c.t,d,a.t)):(l=k.geom.transSign(b,c,a),d=-k.geom.transSign(b,e,a),0>l+d&&(l=-l,d=-d),g.t=k.geom.interpolate_(l,c.t,d,e.t)):g.t=(c.t+a.t)/2};k.mesh={};k.mesh.makeEdge=function(b){var a=k.mesh.makeEdgePair_(b.eHead);k.mesh.makeVertex_(a,b.vHead);k.mesh.makeVertex_(a.sym,b.vHead);k.mesh.makeFace_(a,b.fHead);return a};k.mesh.meshSplice=function(b,a){var c=!1,e=!1;b!==a&&(a.org!==b.org&&(e=!0,k.mesh.killVertex_(a.org,b.org)),a.lFace!==b.lFace&&(c=!0,k.mesh.killFace_(a.lFace,
b.lFace)),k.mesh.splice_(a,b),e||(k.mesh.makeVertex_(a,b.org),b.org.anEdge=b),c||(k.mesh.makeFace_(a,b.lFace),b.lFace.anEdge=b))};k.mesh.deleteEdge=function(b){var a=b.sym,c=!1;b.lFace!==b.rFace()&&(c=!0,k.mesh.killFace_(b.lFace,b.rFace()));b.oNext===b?k.mesh.killVertex_(b.org,null):(b.rFace().anEdge=b.oPrev(),b.org.anEdge=b.oNext,k.mesh.splice_(b,b.oPrev()),c||k.mesh.makeFace_(b,b.lFace));a.oNext===a?(k.mesh.killVertex_(a.org,null),k.mesh.killFace_(a.lFace,null)):(b.lFace.anEdge=a.oPrev(),a.org.anEdge=
a.oNext,k.mesh.splice_(a,a.oPrev()));k.mesh.killEdge_(b)};k.mesh.addEdgeVertex=function(b){var a=k.mesh.makeEdgePair_(b),c=a.sym;k.mesh.splice_(a,b.lNext);a.org=b.dst();k.mesh.makeVertex_(c,a.org);a.lFace=c.lFace=b.lFace;return a};k.mesh.splitEdge=function(b){var a=k.mesh.addEdgeVertex(b).sym;k.mesh.splice_(b.sym,b.sym.oPrev());k.mesh.splice_(b.sym,a);b.sym.org=a.org;a.dst().anEdge=a.sym;a.sym.lFace=b.rFace();a.winding=b.winding;a.sym.winding=b.sym.winding;return a};k.mesh.connect=function(b,a){var c=
!1,e=k.mesh.makeEdgePair_(b),g=e.sym;a.lFace!==b.lFace&&(c=!0,k.mesh.killFace_(a.lFace,b.lFace));k.mesh.splice_(e,b.lNext);k.mesh.splice_(g,a);e.org=b.dst();g.org=a.org;e.lFace=g.lFace=b.lFace;b.lFace.anEdge=g;c||k.mesh.makeFace_(e,b.lFace);return e};k.mesh.zapFace=function(b){var a=b.anEdge,c=a.lNext,e;do if(e=c,c=e.lNext,e.lFace=null,null===e.rFace()){e.oNext===e?k.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,k.mesh.splice_(e,e.oPrev()));var g=e.sym;g.oNext===g?k.mesh.killVertex_(g.org,null):
(g.org.anEdge=g.oNext,k.mesh.splice_(g,g.oPrev()));k.mesh.killEdge_(e)}while(e!==a);a=b.prev;b=b.next;b.prev=a;a.next=b};k.mesh.meshUnion=function(b,a){var c=b.fHead,e=b.vHead,g=b.eHead,l=a.fHead,d=a.vHead;a=a.eHead;l.next!==l&&(c.prev.next=l.next,l.next.prev=c.prev,l.prev.next=c,c.prev=l.prev);d.next!==d&&(e.prev.next=d.next,d.next.prev=e.prev,d.prev.next=e,e.prev=d.prev);a.next!==a&&(g.sym.next.sym.next=a.next,a.next.sym.next=g.sym.next,a.sym.next.sym.next=g,g.sym.next=a.sym.next);return b};k.mesh.deleteMesh=
function(b){};k.mesh.makeEdgePair_=function(b){var a=new k.GluHalfEdge,c=new k.GluHalfEdge,e=b.sym.next;c.next=e;e.sym.next=a;a.next=b;b.sym.next=c;a.sym=c;a.oNext=a;a.lNext=c;c.sym=a;c.oNext=c;return c.lNext=a};k.mesh.splice_=function(b,a){var c=b.oNext,e=a.oNext;c.sym.lNext=a;e.sym.lNext=b;b.oNext=e;a.oNext=c};k.mesh.makeVertex_=function(b,a){var c=a.prev,e=new k.GluVertex(a,c);c.next=e;a.prev=e;a=e.anEdge=b;do a.org=e,a=a.oNext;while(a!==b)};k.mesh.makeFace_=function(b,a){var c=a.prev,e=new k.GluFace(a,
c);c.next=e;a.prev=e;e.anEdge=b;e.inside=a.inside;a=b;do a.lFace=e,a=a.lNext;while(a!==b)};k.mesh.killEdge_=function(b){var a=b.next;b=b.sym.next;a.sym.next=b;b.sym.next=a};k.mesh.killVertex_=function(b,a){var c=b.anEdge,e=c;do e.org=a,e=e.oNext;while(e!==c);a=b.prev;b=b.next;b.prev=a;a.next=b};k.mesh.killFace_=function(b,a){var c=b.anEdge,e=c;do e.lFace=a,e=e.lNext;while(e!==c);a=b.prev;b=b.next;b.prev=a;a.next=b};k.normal={};k.normal.S_UNIT_X_=1;k.normal.S_UNIT_Y_=0;k.normal.projectPolygon=function(b,
a,c,e){var g=!1,l=[a,c,e];0===a&&0===c&&0===e&&(k.normal.computeNormal_(b,l),g=!0);c=k.normal.longAxis_(l);a=b.mesh.vHead;if(k.TRUE_PROJECT){k.normal.normalize_(l);e=[0,0,0];var d=[0,0,0];e[c]=0;e[(c+1)%3]=k.normal.S_UNIT_X_;e[(c+2)%3]=k.normal.S_UNIT_Y_;c=k.normal.dot_(e,l);e[0]-=c*l[0];e[1]-=c*l[1];e[2]-=c*l[2];k.normal.normalize_(e);d[0]=l[1]*e[2]-l[2]*e[1];d[1]=l[2]*e[0]-l[0]*e[2];d[2]=l[0]*e[1]-l[1]*e[0];k.normal.normalize_(d);for(l=a.next;l!==a;l=l.next)l.s=k.normal.dot_(l.coords,e),l.t=k.normal.dot_(l.coords,
d)}else for(e=(c+1)%3,d=(c+2)%3,c=0<l[c]?1:-1,l=a.next;l!==a;l=l.next)l.s=l.coords[e],l.t=c*l.coords[d];g&&k.normal.checkOrientation_(b)};k.normal.dot_=function(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]};k.normal.normalize_=function(b){var a=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];k.assert(0<a);a=Math.sqrt(a);b[0]/=a;b[1]/=a;b[2]/=a};k.normal.longAxis_=function(b){var a=0;Math.abs(b[1])>Math.abs(b[0])&&(a=1);Math.abs(b[2])>Math.abs(b[a])&&(a=2);return a};k.normal.computeNormal_=function(b,a){var c=[-2*k.GLU_TESS_MAX_COORD,
-2*k.GLU_TESS_MAX_COORD,-2*k.GLU_TESS_MAX_COORD],e=[2*k.GLU_TESS_MAX_COORD,2*k.GLU_TESS_MAX_COORD,2*k.GLU_TESS_MAX_COORD],g=[],l=[],d;b=b.mesh.vHead;for(d=b.next;d!==b;d=d.next)for(var h=0;3>h;++h){var m=d.coords[h];m<e[h]&&(e[h]=m,l[h]=d);m>c[h]&&(c[h]=m,g[h]=d)}d=0;c[1]-e[1]>c[0]-e[0]&&(d=1);c[2]-e[2]>c[d]-e[d]&&(d=2);if(e[d]>=c[d])a[0]=0,a[1]=0,a[2]=1;else{c=0;e=l[d];g=g[d];l=[0,0,0];e=[e.coords[0]-g.coords[0],e.coords[1]-g.coords[1],e.coords[2]-g.coords[2]];h=[0,0,0];for(d=b.next;d!==b;d=d.next)h[0]=
d.coords[0]-g.coords[0],h[1]=d.coords[1]-g.coords[1],h[2]=d.coords[2]-g.coords[2],l[0]=e[1]*h[2]-e[2]*h[1],l[1]=e[2]*h[0]-e[0]*h[2],l[2]=e[0]*h[1]-e[1]*h[0],m=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],m>c&&(c=m,a[0]=l[0],a[1]=l[1],a[2]=l[2]);0>=c&&(a[0]=a[1]=a[2]=0,a[k.normal.longAxis_(e)]=1)}};k.normal.checkOrientation_=function(b){for(var a=0,c=b.mesh.fHead,e=c.next;e!==c;e=e.next){var g=e.anEdge;if(!(0>=g.winding)){do a+=(g.org.s-g.dst().s)*(g.org.t+g.dst().t),g=g.lNext;while(g!==e.anEdge)}}if(0>a)for(b=b.mesh.vHead,
a=b.next;a!==b;a=a.next)a.t=-a.t};k.render={};k.render.renderMesh=function(b,a,c){for(var e=!1,g=-1,l=a.fHead.prev;l!==a.fHead;l=l.prev)if(l.inside){e||(b.callBeginCallback(k.primitiveType.GL_TRIANGLES),e=!0);var d=l.anEdge;k.assert(d.lNext.lNext.lNext===d,"renderMesh called with non-triangulated mesh");do{if(c){var h=d.rFace().inside?0:1;g!==h&&(g=h,b.callEdgeFlagCallback(!!g))}b.callVertexCallback(d.org.data);d=d.lNext}while(d!==l.anEdge)}e&&b.callEndCallback()};k.render.renderBoundary=function(b,
a){for(var c=a.fHead.next;c!==a.fHead;c=c.next)if(c.inside){b.callBeginCallback(k.primitiveType.GL_LINE_LOOP);var e=c.anEdge;do b.callVertexCallback(e.org.data),e=e.lNext;while(e!==c.anEdge);b.callEndCallback()}};k.sweep={};k.sweep.SENTINEL_COORD_=4*k.GLU_TESS_MAX_COORD;k.sweep.TOLERANCE_NONZERO_=!1;k.sweep.computeInterior=function(b){b.fatalError=!1;k.sweep.removeDegenerateEdges_(b);k.sweep.initPriorityQ_(b);k.sweep.initEdgeDict_(b);for(var a;null!==(a=b.pq.extractMin());){for(;;){var c=b.pq.minimum();
if(null===c||!k.geom.vertEq(c,a))break;c=b.pq.extractMin();k.sweep.spliceMergeVertices_(b,a.anEdge,c.anEdge)}k.sweep.sweepEvent_(b,a)}a=b.dict.getMin().getKey();b.event=a.eUp.org;k.sweep.doneEdgeDict_(b);k.sweep.donePriorityQ_(b);k.sweep.removeDegenerateFaces_(b.mesh);b.mesh.checkMesh()};k.sweep.addWinding_=function(b,a){b.winding+=a.winding;b.sym.winding+=a.sym.winding};k.sweep.edgeLeq_=function(b,a,c){b=b.event;a=a.eUp;c=c.eUp;if(a.dst()===b)return c.dst()===b?k.geom.vertLeq(a.org,c.org)?0>=k.geom.edgeSign(c.dst(),
a.org,c.org):0<=k.geom.edgeSign(a.dst(),c.org,a.org):0>=k.geom.edgeSign(c.dst(),b,c.org);if(c.dst()===b)return 0<=k.geom.edgeSign(a.dst(),b,a.org);a=k.geom.edgeEval(a.dst(),b,a.org);b=k.geom.edgeEval(c.dst(),b,c.org);return a>=b};k.sweep.deleteRegion_=function(b,a){a.fixUpperEdge&&k.assert(0===a.eUp.winding);a.eUp.activeRegion=null;b.dict.deleteNode(a.nodeUp);a.nodeUp=null};k.sweep.fixUpperEdge_=function(b,a){k.assert(b.fixUpperEdge);k.mesh.deleteEdge(b.eUp);b.fixUpperEdge=!1;b.eUp=a;a.activeRegion=
b};k.sweep.topLeftRegion_=function(b){var a=b.eUp.org;do b=b.regionAbove();while(b.eUp.org===a);b.fixUpperEdge&&(a=k.mesh.connect(b.regionBelow().eUp.sym,b.eUp.lNext),k.sweep.fixUpperEdge_(b,a),b=b.regionAbove());return b};k.sweep.topRightRegion_=function(b){var a=b.eUp.dst();do b=b.regionAbove();while(b.eUp.dst()===a);return b};k.sweep.addRegionBelow_=function(b,a,c){var e=new k.ActiveRegion;e.eUp=c;e.nodeUp=b.dict.insertBefore(a.nodeUp,e);return c.activeRegion=e};k.sweep.isWindingInside_=function(b,
a){switch(b.windingRule){case k.windingRule.GLU_TESS_WINDING_ODD:return 0!==(a&1);case k.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==a;case k.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<a;case k.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>a;case k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=a||-2>=a}k.assert(!1);return!1};k.sweep.computeWinding_=function(b,a){a.windingNumber=a.regionAbove().windingNumber+a.eUp.winding;a.inside=k.sweep.isWindingInside_(b,a.windingNumber)};k.sweep.finishRegion_=
function(b,a){var c=a.eUp,e=c.lFace;e.inside=a.inside;e.anEdge=c;k.sweep.deleteRegion_(b,a)};k.sweep.finishLeftRegions_=function(b,a,c){var e=a;for(a=a.eUp;e!==c;){e.fixUpperEdge=!1;var g=e.regionBelow(),l=g.eUp;if(l.org!==a.org){if(!g.fixUpperEdge){k.sweep.finishRegion_(b,e);break}l=k.mesh.connect(a.lPrev(),l.sym);k.sweep.fixUpperEdge_(g,l)}a.oNext!==l&&(k.mesh.meshSplice(l.oPrev(),l),k.mesh.meshSplice(a,l));k.sweep.finishRegion_(b,e);a=g.eUp;e=g}return a};k.sweep.addRightEdges_=function(b,a,c,e,
g,l){var d=!0;do k.assert(k.geom.vertLeq(c.org,c.dst())),k.sweep.addRegionBelow_(b,a,c.sym),c=c.oNext;while(c!==e);for(null===g&&(g=a.regionBelow().eUp.rPrev());;){e=a.regionBelow();c=e.eUp.sym;if(c.org!==g.org)break;c.oNext!==g&&(k.mesh.meshSplice(c.oPrev(),c),k.mesh.meshSplice(g.oPrev(),c));e.windingNumber=a.windingNumber-c.winding;e.inside=k.sweep.isWindingInside_(b,e.windingNumber);a.dirty=!0;!d&&k.sweep.checkForRightSplice_(b,a)&&(k.sweep.addWinding_(c,g),k.sweep.deleteRegion_(b,a),k.mesh.deleteEdge(g));
d=!1;a=e;g=c}a.dirty=!0;k.assert(a.windingNumber-c.winding===e.windingNumber);l&&k.sweep.walkDirtyRegions_(b,a)};k.sweep.callCombine_=function(b,a,c,e,g){var l=[a.coords[0],a.coords[1],a.coords[2]];a.data=null;a.data=b.callCombineCallback(l,c,e);null===a.data&&(g?b.fatalError||(b.callErrorCallback(k.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),b.fatalError=!0):a.data=c[0])};k.sweep.spliceMergeVertices_=function(b,a,c){var e=[null,null,null,null];e[0]=a.org.data;e[1]=c.org.data;k.sweep.callCombine_(b,
a.org,e,[.5,.5,0,0],!1);k.mesh.meshSplice(a,c)};k.sweep.vertexWeights_=function(b,a,c,e,g){var l=k.geom.vertL1dist(a,b),d=k.geom.vertL1dist(c,b),h=g+1;e[g]=.5*d/(l+d);e[h]=.5*l/(l+d);b.coords[0]+=e[g]*a.coords[0]+e[h]*c.coords[0];b.coords[1]+=e[g]*a.coords[1]+e[h]*c.coords[1];b.coords[2]+=e[g]*a.coords[2]+e[h]*c.coords[2]};k.sweep.getIntersectData_=function(b,a,c,e,g,l){var d=[0,0,0,0],h=[c.data,e.data,g.data,l.data];a.coords[0]=a.coords[1]=a.coords[2]=0;k.sweep.vertexWeights_(a,c,e,d,0);k.sweep.vertexWeights_(a,
g,l,d,2);k.sweep.callCombine_(b,a,h,d,!0)};k.sweep.checkForRightSplice_=function(b,a){var c=a.regionBelow(),e=a.eUp,g=c.eUp;if(k.geom.vertLeq(e.org,g.org)){if(0<k.geom.edgeSign(g.dst(),e.org,g.org))return!1;k.geom.vertEq(e.org,g.org)?e.org!==g.org&&(b.pq.remove(e.org.pqHandle),k.sweep.spliceMergeVertices_(b,g.oPrev(),e)):(k.mesh.splitEdge(g.sym),k.mesh.meshSplice(e,g.oPrev()),a.dirty=c.dirty=!0)}else{if(0>k.geom.edgeSign(e.dst(),g.org,e.org))return!1;a.regionAbove().dirty=a.dirty=!0;k.mesh.splitEdge(e.sym);
k.mesh.meshSplice(g.oPrev(),e)}return!0};k.sweep.checkForLeftSplice_=function(b,a){var c=a.regionBelow();b=a.eUp;var e=c.eUp;k.assert(!k.geom.vertEq(b.dst(),e.dst()));if(k.geom.vertLeq(b.dst(),e.dst())){if(0>k.geom.edgeSign(b.dst(),e.dst(),b.org))return!1;a.regionAbove().dirty=a.dirty=!0;c=k.mesh.splitEdge(b);k.mesh.meshSplice(e.sym,c);c.lFace.inside=a.inside}else{if(0<k.geom.edgeSign(e.dst(),b.dst(),e.org))return!1;a.dirty=c.dirty=!0;c=k.mesh.splitEdge(e);k.mesh.meshSplice(b.lNext,e.sym);c.rFace().inside=
a.inside}return!0};k.sweep.checkForIntersect_=function(b,a){var c=a.regionBelow(),e=a.eUp,g=c.eUp,l=e.org,d=g.org,h=e.dst(),m=g.dst(),p=new k.GluVertex;k.assert(!k.geom.vertEq(m,h));k.assert(0>=k.geom.edgeSign(h,b.event,l));k.assert(0<=k.geom.edgeSign(m,b.event,d));k.assert(l!==b.event&&d!==b.event);k.assert(!a.fixUpperEdge&&!c.fixUpperEdge);if(l===d||Math.min(l.t,h.t)>Math.max(d.t,m.t))return!1;if(k.geom.vertLeq(l,d)){if(0<k.geom.edgeSign(m,l,d))return!1}else if(0>k.geom.edgeSign(h,d,l))return!1;
k.geom.edgeIntersect(h,l,m,d,p);k.assert(Math.min(l.t,h.t)<=p.t);k.assert(p.t<=Math.max(d.t,m.t));k.assert(Math.min(m.s,h.s)<=p.s);k.assert(p.s<=Math.max(d.s,l.s));k.geom.vertLeq(p,b.event)&&(p.s=b.event.s,p.t=b.event.t);var q=k.geom.vertLeq(l,d)?l:d;k.geom.vertLeq(q,p)&&(p.s=q.s,p.t=q.t);if(k.geom.vertEq(p,l)||k.geom.vertEq(p,d))return k.sweep.checkForRightSplice_(b,a),!1;if(!k.geom.vertEq(h,b.event)&&0<=k.geom.edgeSign(h,b.event,p)||!k.geom.vertEq(m,b.event)&&0>=k.geom.edgeSign(m,b.event,p)){if(m===
b.event)return k.mesh.splitEdge(e.sym),k.mesh.meshSplice(g.sym,e),a=k.sweep.topLeftRegion_(a),e=a.regionBelow().eUp,k.sweep.finishLeftRegions_(b,a.regionBelow(),c),k.sweep.addRightEdges_(b,a,e.oPrev(),e,e,!0),!0;if(h===b.event)return k.mesh.splitEdge(g.sym),k.mesh.meshSplice(e.lNext,g.oPrev()),c=a,a=k.sweep.topRightRegion_(a),l=a.regionBelow().eUp.rPrev(),c.eUp=g.oPrev(),g=k.sweep.finishLeftRegions_(b,c,null),k.sweep.addRightEdges_(b,a,g.oNext,e.rPrev(),l,!0),!0;0<=k.geom.edgeSign(h,b.event,p)&&(a.regionAbove().dirty=
a.dirty=!0,k.mesh.splitEdge(e.sym),e.org.s=b.event.s,e.org.t=b.event.t);0>=k.geom.edgeSign(m,b.event,p)&&(a.dirty=c.dirty=!0,k.mesh.splitEdge(g.sym),g.org.s=b.event.s,g.org.t=b.event.t);return!1}k.mesh.splitEdge(e.sym);k.mesh.splitEdge(g.sym);k.mesh.meshSplice(g.oPrev(),e);e.org.s=p.s;e.org.t=p.t;e.org.pqHandle=b.pq.insert(e.org);k.sweep.getIntersectData_(b,e.org,l,h,d,m);a.regionAbove().dirty=a.dirty=c.dirty=!0;return!1};k.sweep.walkDirtyRegions_=function(b,a){for(var c=a.regionBelow();;){for(;c.dirty;)a=
c,c=c.regionBelow();if(!a.dirty&&(c=a,a=a.regionAbove(),null===a||!a.dirty))break;a.dirty=!1;var e=a.eUp,g=c.eUp;e.dst()!==g.dst()&&k.sweep.checkForLeftSplice_(b,a)&&(c.fixUpperEdge?(k.sweep.deleteRegion_(b,c),k.mesh.deleteEdge(g),c=a.regionBelow(),g=c.eUp):a.fixUpperEdge&&(k.sweep.deleteRegion_(b,a),k.mesh.deleteEdge(e),a=c.regionAbove(),e=a.eUp));if(e.org!==g.org)if(e.dst()===g.dst()||a.fixUpperEdge||c.fixUpperEdge||e.dst()!==b.event&&g.dst()!==b.event)k.sweep.checkForRightSplice_(b,a);else if(k.sweep.checkForIntersect_(b,
a))break;e.org===g.org&&e.dst()===g.dst()&&(k.sweep.addWinding_(g,e),k.sweep.deleteRegion_(b,a),k.mesh.deleteEdge(e),a=c.regionAbove())}};k.sweep.connectRightVertex_=function(b,a,c){var e=c.oNext,g=a.regionBelow(),l=a.eUp,d=g.eUp,h=!1;l.dst()!==d.dst()&&k.sweep.checkForIntersect_(b,a);k.geom.vertEq(l.org,b.event)&&(k.mesh.meshSplice(e.oPrev(),l),a=k.sweep.topLeftRegion_(a),e=a.regionBelow().eUp,k.sweep.finishLeftRegions_(b,a.regionBelow(),g),h=!0);k.geom.vertEq(d.org,b.event)&&(k.mesh.meshSplice(c,
d.oPrev()),c=k.sweep.finishLeftRegions_(b,g,null),h=!0);h?k.sweep.addRightEdges_(b,a,c.oNext,e,e,!0):(e=k.geom.vertLeq(d.org,l.org)?d.oPrev():l,e=k.mesh.connect(c.lPrev(),e),k.sweep.addRightEdges_(b,a,e,e.oNext,e.oNext,!1),e.sym.activeRegion.fixUpperEdge=!0,k.sweep.walkDirtyRegions_(b,a))};k.sweep.connectLeftDegenerate_=function(b,a,c){var e=a.eUp;if(k.geom.vertEq(e.org,c))k.assert(k.sweep.TOLERANCE_NONZERO_),k.sweep.TOLERANCE_NONZERO_&&k.sweep.spliceMergeVertices_(b,e,c.anEdge);else if(k.geom.vertEq(e.dst(),
c)){if(k.assert(k.sweep.TOLERANCE_NONZERO_),k.sweep.TOLERANCE_NONZERO_){a=k.sweep.topRightRegion_(a);var e=a.regionBelow(),g=e.eUp.sym,l=g.oNext,d=l;e.fixUpperEdge&&(k.assert(l!==g),k.sweep.deleteRegion_(b,e),k.mesh.deleteEdge(g),g=l.oPrev());k.mesh.meshSplice(c.anEdge,g);k.geom.edgeGoesLeft(l)||(l=null);k.sweep.addRightEdges_(b,a,g.oNext,d,l,!0)}}else k.mesh.splitEdge(e.sym),a.fixUpperEdge&&(k.mesh.deleteEdge(e.oNext),a.fixUpperEdge=!1),k.mesh.meshSplice(c.anEdge,e),k.sweep.sweepEvent_(b,c)};k.sweep.connectLeftVertex_=
function(b,a){var c=new k.ActiveRegion;c.eUp=a.anEdge.sym;var c=b.dict.search(c).getKey(),e=c.regionBelow(),g=c.eUp,l=e.eUp;0===k.geom.edgeSign(g.dst(),a,g.org)?k.sweep.connectLeftDegenerate_(b,c,a):(e=k.geom.vertLeq(l.dst(),g.dst())?c:e,c.inside||e.fixUpperEdge?(g=e===c?k.mesh.connect(a.anEdge.sym,g.lNext):k.mesh.connect(l.dNext(),a.anEdge).sym,e.fixUpperEdge?k.sweep.fixUpperEdge_(e,g):k.sweep.computeWinding_(b,k.sweep.addRegionBelow_(b,c,g)),k.sweep.sweepEvent_(b,a)):k.sweep.addRightEdges_(b,c,
a.anEdge,a.anEdge,null,!0))};k.sweep.sweepEvent_=function(b,a){b.event=a;for(var c=a.anEdge;null===c.activeRegion;)if(c=c.oNext,c===a.anEdge){k.sweep.connectLeftVertex_(b,a);return}a=k.sweep.topLeftRegion_(c.activeRegion);var e=a.regionBelow(),c=e.eUp,e=k.sweep.finishLeftRegions_(b,e,null);e.oNext===c?k.sweep.connectRightVertex_(b,a,e):k.sweep.addRightEdges_(b,a,e.oNext,c,c,!0)};k.sweep.addSentinel_=function(b,a){var c=new k.ActiveRegion,e=k.mesh.makeEdge(b.mesh);e.org.s=k.sweep.SENTINEL_COORD_;e.org.t=
a;e.dst().s=-k.sweep.SENTINEL_COORD_;e.dst().t=a;b.event=e.dst();c.eUp=e;c.windingNumber=0;c.inside=!1;c.fixUpperEdge=!1;c.sentinel=!0;c.dirty=!1;c.nodeUp=b.dict.insert(c)};k.sweep.initEdgeDict_=function(b){b.dict=new k.Dict(b,k.sweep.edgeLeq_);k.sweep.addSentinel_(b,-k.sweep.SENTINEL_COORD_);k.sweep.addSentinel_(b,k.sweep.SENTINEL_COORD_)};k.sweep.doneEdgeDict_=function(b){for(var a=0,c;null!==(c=b.dict.getMin().getKey());)c.sentinel||(k.assert(c.fixUpperEdge),k.assert(1===++a)),k.assert(0===c.windingNumber),
k.sweep.deleteRegion_(b,c);b.dict=null};k.sweep.removeDegenerateEdges_=function(b){for(var a=b.mesh.eHead,c,e=a.next;e!==a;e=c){c=e.next;var g=e.lNext;k.geom.vertEq(e.org,e.dst())&&e.lNext.lNext!==e&&(k.sweep.spliceMergeVertices_(b,g,e),k.mesh.deleteEdge(e),e=g,g=e.lNext);if(g.lNext===e){if(g!==e){if(g===c||g===c.sym)c=c.next;k.mesh.deleteEdge(g)}if(e===c||e===c.sym)c=c.next;k.mesh.deleteEdge(e)}}};k.sweep.initPriorityQ_=function(b){var a=new k.PriorityQ;b.pq=a;b=b.mesh.vHead;var c;for(c=b.next;c!==
b;c=c.next)c.pqHandle=a.insert(c);a.init()};k.sweep.donePriorityQ_=function(b){b.pq.deleteQ();b.pq=null};k.sweep.removeDegenerateFaces_=function(b){for(var a,c=b.fHead.next;c!==b.fHead;c=a)a=c.next,c=c.anEdge,k.assert(c.lNext!==c),c.lNext.lNext===c&&(k.sweep.addWinding_(c.oNext,c),k.mesh.deleteEdge(c))};k.tessmono={};k.tessmono.tessellateMonoRegion_=function(b){b=b.anEdge;for(k.assert(b.lNext!==b&&b.lNext.lNext!==b);k.geom.vertLeq(b.dst(),b.org);b=b.lPrev());for(;k.geom.vertLeq(b.org,b.dst());b=b.lNext);
for(var a=b.lPrev(),c;b.lNext!==a;)if(k.geom.vertLeq(b.dst(),a.org)){for(;a.lNext!==b&&(k.geom.edgeGoesLeft(a.lNext)||0>=k.geom.edgeSign(a.org,a.dst(),a.lNext.dst()));)c=k.mesh.connect(a.lNext,a),a=c.sym;a=a.lPrev()}else{for(;a.lNext!==b&&(k.geom.edgeGoesRight(b.lPrev())||0<=k.geom.edgeSign(b.dst(),b.org,b.lPrev().org));)c=k.mesh.connect(b,b.lPrev()),b=c.sym;b=b.lNext}for(k.assert(a.lNext!==b);a.lNext.lNext!==b;)c=k.mesh.connect(a.lNext,a),a=c.sym};k.tessmono.tessellateInterior=function(b){for(var a,
c=b.fHead.next;c!==b.fHead;c=a)a=c.next,c.inside&&k.tessmono.tessellateMonoRegion_(c)};k.tessmono.discardExterior=function(b){for(var a,c=b.fHead.next;c!==b.fHead;c=a)a=c.next,c.inside||k.mesh.zapFace(c)};k.tessmono.setWindingNumber=function(b,a,c){for(var e,g=b.eHead.next;g!==b.eHead;g=e)e=g.next,g.rFace().inside!==g.lFace.inside?g.winding=g.lFace.inside?a:-a:c?k.mesh.deleteEdge(g):g.winding=0};k.Dict=function(b,a){this.head_=new k.DictNode;this.frame_=b;this.leq_=a};k.Dict.prototype.deleteDict_=
function(){};k.Dict.prototype.insertBefore=function(b,a){do b=b.prev;while(null!==b.key&&!this.leq_(this.frame_,b.key,a));a=new k.DictNode(a,b.next,b);b.next.prev=a;return b.next=a};k.Dict.prototype.insert=function(b){return this.insertBefore(this.head_,b)};k.Dict.prototype.deleteNode=function(b){b.next.prev=b.prev;b.prev.next=b.next};k.Dict.prototype.search=function(b){var a=this.head_;do a=a.next;while(null!==a.key&&!this.leq_(this.frame_,b,a.key));return a};k.Dict.prototype.getMin=function(){return this.head_.next};
k.Dict.prototype.getMax=function(){return this.head_.prev};k.DictNode=function(b,a,c){this.key=b||null;this.next=a||this;this.prev=c||this};k.DictNode.prototype.getKey=function(){return this.key};k.DictNode.prototype.getSuccessor=function(){return this.next};k.DictNode.prototype.getPredecessor=function(){return this.prev};k.GluTesselator=function(){this.state_=k.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=k.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};k.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};k.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(k.GluTesselator.tessState_.T_DORMANT)};k.GluTesselator.prototype.gluTessProperty=function(b,a){switch(b){case k.gluEnum.GLU_TESS_TOLERANCE:return;
case k.gluEnum.GLU_TESS_WINDING_RULE:switch(a){case k.windingRule.GLU_TESS_WINDING_ODD:case k.windingRule.GLU_TESS_WINDING_NONZERO:case k.windingRule.GLU_TESS_WINDING_POSITIVE:case k.windingRule.GLU_TESS_WINDING_NEGATIVE:case k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=a;return}break;case k.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!a;return;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(k.gluEnum.GLU_INVALID_VALUE)};k.GluTesselator.prototype.gluGetTessProperty=
function(b){switch(b){case k.gluEnum.GLU_TESS_TOLERANCE:return 0;case k.gluEnum.GLU_TESS_WINDING_RULE:return b=this.windingRule,k.assert(b===k.windingRule.GLU_TESS_WINDING_ODD||b===k.windingRule.GLU_TESS_WINDING_NONZERO||b===k.windingRule.GLU_TESS_WINDING_POSITIVE||b===k.windingRule.GLU_TESS_WINDING_NEGATIVE||b===k.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),b;case k.gluEnum.GLU_TESS_BOUNDARY_ONLY:return k.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM)}return!1};
k.GluTesselator.prototype.gluTessNormal=function(b,a,c){this.normal_[0]=b;this.normal_[1]=a;this.normal_[2]=c};k.GluTesselator.prototype.gluTessCallback=function(b,a){a=a?a:null;switch(b){case k.gluEnum.GLU_TESS_BEGIN:case k.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=a;break;case k.gluEnum.GLU_TESS_EDGE_FLAG:case k.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=a;break;case k.gluEnum.GLU_TESS_VERTEX:case k.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=a;break;case k.gluEnum.GLU_TESS_END:case k.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
a;break;case k.gluEnum.GLU_TESS_ERROR:case k.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=a;break;case k.gluEnum.GLU_TESS_COMBINE:case k.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=a;break;case k.gluEnum.GLU_TESS_MESH:this.meshCallback_=a;break;default:this.callErrorCallback(k.gluEnum.GLU_INVALID_ENUM)}};k.GluTesselator.prototype.gluTessVertex=function(b,a){var c=!1,e=[0,0,0];this.requireState_(k.GluTesselator.tessState_.T_IN_CONTOUR);for(var g=0;3>g;++g){var l=b[g];l<-k.GLU_TESS_MAX_COORD&&
(l=-k.GLU_TESS_MAX_COORD,c=!0);l>k.GLU_TESS_MAX_COORD&&(l=k.GLU_TESS_MAX_COORD,c=!0);e[g]=l}c&&this.callErrorCallback(k.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(e,a)};k.GluTesselator.prototype.gluTessBeginPolygon=function(b){this.requireState_(k.GluTesselator.tessState_.T_DORMANT);this.state_=k.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new k.GluMesh;this.polygonData_=b};k.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=k.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};k.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=k.GluTesselator.tessState_.T_IN_POLYGON};k.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(k.GluTesselator.tessState_.T_IN_POLYGON);this.state_=k.GluTesselator.tessState_.T_DORMANT;k.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);k.sweep.computeInterior(this);
if(!this.fatalError){var b=this.mesh;this.boundaryOnly_?k.tessmono.setWindingNumber(b,1,!0):k.tessmono.tessellateInterior(b);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?k.render.renderBoundary(this,this.mesh):k.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){k.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}k.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};k.GluTesselator.prototype.requireState_=function(b){this.state_!==b&&this.gotoState_(b)};k.GluTesselator.prototype.gotoState_=function(b){for(;this.state_!==b;)if(this.state_<b)switch(this.state_){case k.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case k.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case k.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case k.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(k.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};k.GluTesselator.prototype.addVertex_=function(b,a){var c=this.lastEdge_;null===c?(c=k.mesh.makeEdge(this.mesh),k.mesh.meshSplice(c,c.sym)):(k.mesh.splitEdge(c),c=c.lNext);c.org.data=a;c.org.coords[0]=b[0];c.org.coords[1]=b[1];c.org.coords[2]=b[2];c.winding=1;c.sym.winding=-1;this.lastEdge_=c};k.GluTesselator.prototype.callBeginCallback=
function(b){this.beginCallback_&&this.beginCallback_(b,this.polygonData_)};k.GluTesselator.prototype.callVertexCallback=function(b){this.vertexCallback_&&this.vertexCallback_(b,this.polygonData_)};k.GluTesselator.prototype.callEdgeFlagCallback=function(b){this.edgeFlagCallback_&&this.edgeFlagCallback_(b,this.polygonData_)};k.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};k.GluTesselator.prototype.callCombineCallback=function(b,a,c){return this.combineCallback_?
this.combineCallback_(b,a,c,this.polygonData_)||null:null};k.GluTesselator.prototype.callErrorCallback=function(b){this.errorCallback_&&this.errorCallback_(b,this.polygonData_)};k.GluFace=function(b,a){this.next=b||this;this.prev=a||this;this.anEdge=null;this.inside=!1};k.GluHalfEdge=function(b){this.next=b||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};k.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};k.GluHalfEdge.prototype.dst=function(){return this.sym.org};
k.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};k.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};k.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};k.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};k.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};k.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};k.GluMesh=function(){this.vHead=new k.GluVertex;this.fHead=new k.GluFace;this.eHead=new k.GluHalfEdge;this.eHeadSym=
new k.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};k.GluMesh.prototype.checkMesh=function(){if(k.DEBUG){var b=this.fHead,a=this.vHead,c=this.eHead,e,g;for(e=e=b;(g=e.next)!==b;e=g){k.assert(g.prev===e);e=g.anEdge;do k.assert(e.sym!==e),k.assert(e.sym.sym===e),k.assert(e.lNext.oNext.sym===e),k.assert(e.oNext.sym.lNext===e),k.assert(e.lFace===g),e=e.lNext;while(e!==g.anEdge)}k.assert(g.prev===e&&null===g.anEdge);for(e=e=a;(b=e.next)!==a;e=b){k.assert(b.prev===e);e=b.anEdge;
do k.assert(e.sym!==e),k.assert(e.sym.sym===e),k.assert(e.lNext.oNext.sym===e),k.assert(e.oNext.sym.lNext===e),k.assert(e.org===b),e=e.oNext;while(e!==b.anEdge)}k.assert(b.prev===e&&null===b.anEdge&&null===b.data);for(a=a=c;(e=a.next)!==c;a=e)k.assert(e.sym.next===a.sym),k.assert(e.sym!==e),k.assert(e.sym.sym===e),k.assert(null!==e.org),k.assert(null!==e.dst()),k.assert(e.lNext.oNext.sym===e),k.assert(e.oNext.sym.lNext===e);k.assert(e.sym.next===a.sym&&e.sym===this.eHeadSym&&e.sym.sym===e&&null===
e.org&&null===e.dst()&&null===e.lFace&&null===e.rFace())}};k.GluVertex=function(b,a){this.next=b||this;this.prev=a||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};k.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new k.PriorityQHeap};k.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};k.PriorityQ.prototype.init=function(){this.order_=[];for(var b=0;b<this.size_;b++)this.order_[b]=b;
b=function(a){return function(b,c){return k.geom.vertLeq(a[b],a[c])?1:-1}}(this.verts_);this.order_.sort(b);this.initialized_=!0;this.heap_.init();if(k.DEBUG)for(var a=0+this.size_-1,b=0;b<a;++b)k.assert(k.geom.vertLeq(this.verts_[this.order_[b+1]],this.verts_[this.order_[b]]))};k.PriorityQ.prototype.insert=function(b){if(this.initialized_)return this.heap_.insert(b);var a=this.size_++;this.verts_[a]=b;return-(a+1)};k.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var b=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var a=this.heap_.minimum();if(k.geom.vertLeq(a,b))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return b};k.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var b=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var a=this.heap_.minimum();if(k.geom.vertLeq(a,b))return a}return b};k.PriorityQ.prototype.remove=function(b){if(0<=
b)this.heap_.remove(b);else for(b=-(b+1),k.assert(b<this.verts_.length&&null!==this.verts_[b]),this.verts_[b]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};k.PriorityQHeap=function(){this.heap_=k.PriorityQHeap.reallocNumeric_([0],k.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=k.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};k.PriorityQHeap.INIT_SIZE_=32;k.PriorityQHeap.reallocNumeric_=
function(b,a){for(var c=Array(a),e=0;e<b.length;e++)c[e]=b[e];for(;e<a;e++)c[e]=0;return c};k.PriorityQHeap.prototype.init=function(){for(var b=this.size_;1<=b;--b)this.floatDown_(b);this.initialized_=!0};k.PriorityQHeap.prototype.insert=function(b){var a=++this.size_;2*a>this.max_&&(this.max_*=2,this.handles_=k.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var c;0===this.freeList_?c=a:(c=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[c]=b;this.handles_[c]=a;
this.heap_[a]=c;this.initialized_&&this.floatUp_(a);return c};k.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};k.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};k.PriorityQHeap.prototype.extractMin=function(){var b=this.heap_,a=this.verts_,c=this.handles_,e=b[1],g=a[e];0<this.size_&&(b[1]=b[this.size_],c[b[1]]=1,a[e]=null,c[e]=this.freeList_,this.freeList_=e,0<--this.size_&&this.floatDown_(1));return g};k.PriorityQHeap.prototype.remove=function(b){var a=
this.heap_,c=this.verts_,e=this.handles_;k.assert(1<=b&&b<=this.max_&&null!==c[b]);var g=e[b];a[g]=a[this.size_];e[a[g]]=g;g<=--this.size_&&(1>=g?this.floatDown_(g):k.geom.vertLeq(c[a[g>>1]],c[a[g]])?this.floatDown_(g):this.floatUp_(g));c[b]=null;e[b]=this.freeList_;this.freeList_=b};k.PriorityQHeap.prototype.floatDown_=function(b){for(var a=this.heap_,c=this.verts_,e=this.handles_,g=a[b];;){var l=b<<1;l<this.size_&&k.geom.vertLeq(c[a[l+1]],c[a[l]])&&(l+=1);k.assert(l<=this.max_);var d=a[l];if(l>
this.size_||k.geom.vertLeq(c[g],c[d])){a[b]=g;e[g]=b;break}a[b]=d;e[d]=b;b=l}};k.PriorityQHeap.prototype.floatUp_=function(b){for(var a=this.heap_,c=this.verts_,e=this.handles_,g=a[b];;){var l=b>>1,d=a[l];if(0===l||k.geom.vertLeq(c[d],c[g])){a[b]=g;e[g]=b;break}a[b]=d;e[d]=b;b=l}};k.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};k.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
k.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});k=function(){return function(){}}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../color ../../definitions ../../enums ../../enums ../../LineTess ../../number ../../TileClipper ../../Utils ../../WGLDisplayRecord ./WGLMeshTemplate".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u){Object.defineProperty(b,"__esModule",{value:!0});var y=c.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate"),x=h.allocTriangles(20),A=h.allocTriangles(20),z=[h.allocExtrudeVectors(),h.allocExtrudeVectors()],f=h.allocExtrudeVectors(),n=g.TILE_SIZE+8,r=new h.Tessellator({distanceAlongCorrection:!0}),B=new p.TileClipper(0,0,0,1,8);B.setExtent(512);k=function(b){function c(a,c,f,d,e,n,h,m,g,p,r){var k=b.call(this)||this;k.capType=n;k.joinType=h;k.fillColor=m;
k.tl=g;k.br=p;k.hasPattern=r;k.geometryType=l.WGLGeometryType.LINE;k.halfWidth=0<d?.5*(d+1/e):0;k._materialStore=a;k.vvFlags=c;k.materialId=k._materialStore.createSpriteMaterial(f,k.geometryType,c);return k}a(c,b);c.fromSimpleLine=function(a,b,f,d,n){var h=f.color,g=q.getCapType("round"),l=q.getJoinType("round"),h=h&&"none"!==f.style&&e.premultiplyAlphaRGBA(h)||0;"none"===f.style&&(h=0);if(!d)return new c(a,b,d,f.width,n,g,l,h,0,0,!1);var p=d.rect,r=p.x+1+d.width,k=p.y+1+d.height,p=m.i1616to32(p.x+
1,p.y+1),r=m.i1616to32(r,k);return new c(a,b,d,f.width,n,g,l,h,p,r,!0)};c.fromPictureLineSymbol=function(a,b,c,f){y.error("PictureLineSymbol support does not exist!");return null};c.prototype.writeMesh=function(a,b,c,f,e,n,h){if(this.vvFlags&d.WGLVVFlag.COLOR||0!==this.fillColor){n=this._materialStore.get(this.materialId);var m=b.indexVector;b=b.get("geometry");var g=this.halfWidth,l=new t(f,this.geometryType,this.materialId),p=this._getOffset(b,n);l.vertexFrom=p;l.indexFrom=m.length;a.push(l);switch(c){case "esriGeometryPolyline":a=
this._clipLines(e.geometry.paths);this._write(l,m,b,p,f,g,a,n,h);break;case "esriGeometryPolygon":a=this._clipLines(e.geometry.rings);this._write(l,m,b,p,f,g,a,n,h);break;default:y.error("Unable to handle geometryType: "+c)}}};c.prototype._clipLines=function(a){for(var b=[],c=!1,f=0;f<a.length;){var d=[],e=a[f];B.reset(2);var h=e[0],m=h[0],h=h[1];if(c)B.moveTo(m,h);else{if(-8>m||m>n||-8>h||h>n){c=!0;continue}d.push({x:m,y:h})}for(var g=!1,l=e.length,p=1;p<l;++p)if(m+=e[p][0],h+=e[p][1],c)B.lineTo(m,
h);else{if(-8>m||m>n||-8>h||h>n){g=!0;break}d.push({x:m,y:h})}if(g)c=!0;else{if(c){if(d=B.resultWithStarts())for(c=0;c<d.length;c++)b.push(d[c])}else b.push({line:d,start:0});f++;c=!1}}return b};c.prototype._getOffset=function(a,b){b=b.materialKeyInfo.hasVV()?11:8;return a.length/b};c.prototype._write=function(a,b,c,d,e,n,m,g,l){for(var p=0,k=0;k<m.length;k++){var q=m[k],B=q.line;if(!(2>B.length))for(var t=B[0],C=B[B.length-1],u=C.x-t.x,t=C.y-t.y,u=1E-6>u*u+t*t,D=q.start%65535,q=z[1],t=0;t<B.length;t++){var y=
B[t],C=q===z[t%2]?z[(t+1)%2]:z[t%2],F=0===t,A=t===B.length-1;A&&u&&!this.hasPattern?h.copyExtrudeVectors(C,f):(this._computeExtrudeVectors(C,t,B,u),p+=this._writeVertices(c,e,n,y.x,y.y,C,D,p,g,l),!C.capCenter||u&&A||this._writePieIndices(a,b,d,C),u&&F&&!this.hasPattern&&h.copyExtrudeVectors(f,C));F||this._writeBridgeIndices(a,b,d,q,C);if(!A){var A=B[t+1],F=[A.x-y.x,A.y-y.y],G=h.length(F),F=[F[0]/G,F[1]/G],G=D+G;if(65535<G){var H=(65535-D)/(G-D),D=y.x+(A.x-y.x)*H,y=y.y+(A.y-y.y)*H,A=q;r.buttCap(A,
F,F);p+=this._writeVertices(c,e,n,D,y,A,65535,p,g,l);r.bridge(x,C,A);this._writeBridgeIndices(a,b,d,C,A);r.buttCap(A,F,F);D=G-65535}else D=G,q=C}}}a.vertexCount=p};c.prototype._writeVertices=function(a,b,c,f,d,e,n,h,g,l){var p=0,r=m.i1616to32(f,d),k=e.vectors;e=k.items;for(k=k.count;p<k;++p){var q=e[p].vector,B=q[0],q=q[1],t=e[p].texCoords,C=t[0],u=t[1],D=e[p].direction,t=D[0],y=D[1],D=m.i1616to32(n,31*c),B=m.i8888to32(Math.round(31*B),Math.round(31*q),Math.round(31*C),Math.round(31*u)),q=m.i8888to32(Math.round(31*
t),Math.round(31*y),0,0);a.push(r);a.push(b);a.push(this.fillColor);a.push(B);a.push(D);a.push(this.tl);a.push(this.br);a.push(q);this._writeVV(a,l,g);e[p].base={index:h+p,point:[f,d]}}return p};c.prototype._writeVV=function(a,b,c){c.materialKeyInfo.hasVV()&&(a.push(b[l.VVType.SIZE]),a.push(b[l.VVType.COLOR]),a.push(b[l.VVType.OPACITY]))};c.prototype._writeBridgeIndices=function(a,b,c,f,d){r.bridge(x,f,d);for(f=0;f<x.count;++f)d=x.items[f],b.push(c+d.v1.base.index),b.push(c+d.v2.base.index),b.push(c+
d.v3.base.index),a.indexCount+=3};c.prototype._writePieIndices=function(a,b,c,f){r.pie(A,f);for(f=0;f<A.count;++f){var d=A.items[f];b.push(c+d.v1.base.index);b.push(c+d.v2.base.index);b.push(c+d.v3.base.index);a.indexCount+=3}};c.prototype._computeExtrudeVectors=function(a,b,c,f){var d=c[b],e=[void 0,void 0],n=[void 0,void 0];if(0<b&&b<c.length-1){var m=c[(b+c.length-1)%c.length],g=c[(b+1)%c.length];h.normalize(e,[d.x-m.x,d.y-m.y]);h.normalize(n,[g.x-d.x,g.y-d.y])}else if(0===b)g=c[(b+1)%c.length],
h.normalize(n,[g.x-d.x,g.y-d.y]),f?(m=c[c.length-2],h.normalize(e,[d.x-m.x,d.y-m.y])):e=n;else if(b===c.length-1)m=c[(b+c.length-1)%c.length],h.normalize(e,[d.x-m.x,d.y-m.y]),f?(m=c[1],h.normalize(n,[m.x-d.x,m.y-d.y])):n=e;else{console.error("Vertex index 'i' out of range.");return}f||0!==b?f||b!==c.length-1?this._computeJoinExtrudeVectors(a,e,n):this._computeCapExtrudeVectors(a,e,n,h.CapPosition.END):this._computeCapExtrudeVectors(a,e,n,h.CapPosition.START)};c.prototype._computeCapExtrudeVectors=
function(a,b,c,f){switch(this.capType){case l.CapType.BUTT:r.buttCap(a,b,c);break;case l.CapType.ROUND:var d=h.getNumberOfSlices(Math.PI);r.roundCap(a,b,c,f,d,f===h.CapPosition.START?-1:1);break;case l.CapType.SQUARE:r.squareCap(a,b,c,f);break;default:y.error("Encountered unknown cap type: "+this.capType+", defaulting to BUTT"),r.buttCap(a,b,c)}};c.prototype._computeJoinExtrudeVectors=function(a,b,c){var f=h.getRads(b,c);if(f>Math.PI-.05)r.rectJoin(a,b,c);else if(this.joinType===l.JoinType.MITER||
.1>f).05>f?r.fastMiterJoin(a,b,c):f<h.MITER_SAFE_RADS?r.miterJoin(a,b,c):r.bevelJoin(a,b,c,h.SYSTEM_MAG_LIMIT);else if(this.joinType===l.JoinType.BEVEL)r.bevelJoin(a,b,c,1);else if(this.joinType===l.JoinType.ROUND){var d=h.getNumberOfSlices(f);2.3>f?2>d||.5>f?r.bevelJoin(a,b,c,1):r.roundJoin(a,b,c,d):r.unitRoundJoin(a,b,c,d)}};return c}(u.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/LineTess":function(){define(["require","exports"],function(k,b){function a(a){var b={items:[],
count:0},c;for(c=0;c<a;++c)b.items.push(void 0);return b}function c(a,b){n.vector[0]=a.vector[0];n.vector[1]=a.vector[1];n.texCoords[0]=a.texCoords[0];n.texCoords[1]=a.texCoords[1];n.direction[0]=a.direction[0];n.direction[1]=a.direction[1];n.base=a.base;a.vector[0]=b.vector[0];a.vector[1]=b.vector[1];a.texCoords[0]=b.texCoords[0];a.texCoords[1]=b.texCoords[1];a.direction[0]=b.direction[0];a.direction[1]=b.direction[1];a.base=b.base;b.vector[0]=n.vector[0];b.vector[1]=n.vector[1];b.texCoords[0]=n.texCoords[0];
b.texCoords[1]=n.texCoords[1];b.direction[0]=n.direction[0];b.direction[1]=n.direction[1];b.base=n.base}function e(a,b){return a[0]*b[0]+a[1]*b[1]}function g(a){return Math.sqrt(e(a,a))}function l(a,b){var c=g(b);a[0]=b[0]/c;a[1]=b[1]/c;return a}function d(a,b){a[0]=-b[1];a[1]=b[0];return a}function h(a,b){return a[0]*b[1]-a[1]*b[0]}function m(a,b){a[0]=-b[0];a[1]=-b[1];return a}function p(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a}function q(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a}function t(a,
b){a=e(a,b);return.999<a?0:-.999>a?Math.PI:Math.acos(a)}function u(a,b,c,f,d){if(0===f)a.count=0;else{var e=g(b),n=p(r[0],b,1/e);c=p(r[1],c,1/e);n=t(n,c);n=(d?-1:1)*n/f;d=Math.cos(n);n=Math.sin(n);c=b[0];var h=b[1];for(b=0;b<f-1;++b)e=c,c=d*e-n*h,h=n*e+d*h,a.items[b][0]=c,a.items[b][1]=h;a.count=f-1}}function y(a){var b=a.count,c=Math.floor(b/2),f;for(f=0;f<c;++f){var d=a.items[f];a.items[f]=a.items[b-f-1];a.items[b-f-1]=d}}Object.defineProperty(b,"__esModule",{value:!0});var x;(function(a){a[a.ENTRY=
1]="ENTRY";a[a.EXIT=2]="EXIT";a[a.CAP=3]="CAP"})(x=b.VectorRole||(b.VectorRole={}));var A;(function(a){a[a.START=1]="START";a[a.END=2]="END"})(A=b.CapPosition||(b.CapPosition={}));b.SYSTEM_MAG_LIMIT=3.8;b.MITER_SAFE_RADS=2*Math.acos(1/b.SYSTEM_MAG_LIMIT);var z=b.SYSTEM_MAG_LIMIT*b.SYSTEM_MAG_LIMIT,f=16/(2*Math.PI);b.allocTriangles=function(a){var b={items:[],count:0},c;for(c=0;c<a;++c)b.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,
void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return b};b.allocExtrudeVectors=function(){var b={items:[],count:0},c;for(c=0;30>c;++c)b.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});c={};c[x.ENTRY]=a(20);c[x.EXIT]=a(20);c[x.CAP]=a(20);return{vectors:b,lists:c}};b.copyExtrudeVectors=function(a,b){var c;for(c=0;c<b.vectors.count;++c)a.vectors.items[c].vector[0]=
b.vectors.items[c].vector[0],a.vectors.items[c].vector[1]=b.vectors.items[c].vector[1],a.vectors.items[c].texCoords[0]=b.vectors.items[c].texCoords[0],a.vectors.items[c].texCoords[1]=b.vectors.items[c].texCoords[1],a.vectors.items[c].direction[0]=b.vectors.items[c].direction[0],a.vectors.items[c].direction[1]=b.vectors.items[c].direction[1],a.vectors.items[c].base=b.vectors.items[c].base;a.vectors.count=b.vectors.count;var f=b.lists[x.ENTRY],d=a.lists[x.ENTRY],e=b.lists[x.EXIT],n=a.lists[x.EXIT],
h=b.lists[x.CAP],m=a.lists[x.CAP];for(c=0;c<f.count;++c)d.items[c]=f.items[c];d.count=f.count;for(c=0;c<e.count;++c)n.items[c]=e.items[c];n.count=e.count;for(c=0;c<h.count;++c)m.items[c]=h.items[c];m.count=h.count;a.capCenter=b.capCenter};var n={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};b.swapExtrudeVectors=c;var r=[];for(k=0;32>k;++k)r.push([void 0,void 0]);var B=function(a){var b={items:[],count:0},c;for(c=0;c<a;++c)b.items.push([void 0,void 0]);return b}(16);
b.length=g;b.normalize=l;b.getNumberOfSlices=function(a){return Math.max(Math.round(a*f),1)};b.getRads=t;b.reverse=y;var C=[void 0,void 0],D=[void 0,void 0],F=[0,0],H=[0,0],J=[0,0],I=[0,0],G=Math.cos(Math.PI/4),Q=Math.sin(Math.PI/4),W=Math.sqrt(2);k=function(){function a(a){this._distanceAlongCorrection=a.distanceAlongCorrection}a.prototype.bridge=function(a,b,f){var d=b.vectors;b=b.lists[x.EXIT];var e=f.vectors,n=f.lists[x.ENTRY],h,m;if(b.count===n.count+1)f=b.items,h=d.items,m=n.items,e=e.items;
else if(n.count===b.count+1)f=n.items,h=e.items,m=b.items,e=d.items;else if(b.count===n.count)f=n.items,h=e.items,m=b.items,e=d.items;else{console.error("Cannot bridge "+b.count+" to "+n.count+".");a.count=0;return}d=b.count+n.count-2;a.count=d;C[0]=f;C[1]=m;D[0]=h;D[1]=e;for(b=0;b<d;++b)f=a.items[b],h=(b+0)%2,h=D[h][C[h][Math.floor((b+0)/2)]],f.v1.vector[0]=h.vector[0],f.v1.vector[1]=h.vector[1],f.v1.texCoords[0]=h.texCoords[0],f.v1.texCoords[1]=h.texCoords[1],f.v1.direction[0]=h.direction[0],f.v1.direction[1]=
h.direction[1],f.v1.base=h.base,h=(b+1)%2,h=D[h][C[h][Math.floor((b+1)/2)]],f.v2.vector[0]=h.vector[0],f.v2.vector[1]=h.vector[1],f.v2.texCoords[0]=h.texCoords[0],f.v2.texCoords[1]=h.texCoords[1],f.v2.direction[0]=h.direction[0],f.v2.direction[1]=h.direction[1],f.v2.base=h.base,h=(b+2)%2,h=D[h][C[h][Math.floor((b+2)/2)]],f.v3.vector[0]=h.vector[0],f.v3.vector[1]=h.vector[1],f.v3.texCoords[0]=h.texCoords[0],f.v3.texCoords[1]=h.texCoords[1],f.v3.direction[0]=h.direction[0],f.v3.direction[1]=h.direction[1],
f.v3.base=h.base,h=f.v1.base&&f.v1.base.point||F,m=f.v2.base&&f.v2.base.point||F,e=f.v3.base&&f.v3.base.point||F,H[0]=h[0]+f.v1.vector[0],H[1]=h[1]+f.v1.vector[1],J[0]=m[0]+f.v2.vector[0],J[1]=m[1]+f.v2.vector[1],I[0]=e[0]+f.v3.vector[0],I[1]=e[1]+f.v3.vector[1],0>(J[0]-H[0])*(I[1]-H[1])-(I[0]-H[0])*(J[1]-H[1])||c(f.v2,f.v3)};a.prototype.pie=function(a,b){if(0===b.lists[x.CAP].count)a.count=0;else if(1===b.lists[x.CAP].count)console.error("A single vector is not enough to define a pie."),a.count=
0;else{a.count=b.lists[x.CAP].count-1;var f;for(f=0;f<a.count;++f){var d=a.items[f],e=b.vectors.items[b.lists[x.CAP].items[f]];d.v1.vector[0]=e.vector[0];d.v1.vector[1]=e.vector[1];d.v1.texCoords[0]=e.texCoords[0];d.v1.texCoords[1]=e.texCoords[1];d.v1.direction[0]=e.direction[0];d.v1.direction[1]=e.direction[1];d.v1.base=e.base;e=b.vectors.items[b.lists[x.CAP].items[f+1]];d.v2.vector[0]=e.vector[0];d.v2.vector[1]=e.vector[1];d.v2.texCoords[0]=e.texCoords[0];d.v2.texCoords[1]=e.texCoords[1];d.v2.direction[0]=
e.direction[0];d.v2.direction[1]=e.direction[1];d.v2.base=e.base;e=b.vectors.items[b.capCenter];d.v3.vector[0]=e.vector[0];d.v3.vector[1]=e.vector[1];d.v3.texCoords[0]=e.texCoords[0];d.v3.texCoords[1]=e.texCoords[1];d.v3.direction[0]=e.direction[0];d.v3.direction[1]=e.direction[1];d.v3.base=e.base;var e=d.v1.base&&d.v1.base.point||F,n=d.v2.base&&d.v2.base.point||F,h=d.v3.base&&d.v3.base.point||F;H[0]=e[0]+d.v1.vector[0];H[1]=e[1]+d.v1.vector[1];J[0]=n[0]+d.v2.vector[0];J[1]=n[1]+d.v2.vector[1];I[0]=
h[0]+d.v3.vector[0];I[1]=h[1]+d.v3.vector[1];0>(J[0]-H[0])*(I[1]-H[1])-(I[0]-H[0])*(J[1]-H[1])||c(d.v2,d.v3)}}};a.prototype.buttCap=function(a,b,c){this.fastMiterJoin(a,b,c)};a.prototype.roundCap=function(a,b,c,f,d,e){void 0===e&&(e=0);this.fastMiterJoin(a,b,c);c=f===A.START?0:1;f=f===A.START?1:0;a.capCenter=a.vectors.count;b=a.vectors.items[a.capCenter];b.vector[0]=0;b.vector[1]=0;b.texCoords[0]=0;b.texCoords[1]=0;b.direction[0]=0;b.direction[1]=0;++a.vectors.count;u(B,a.vectors.items[c].vector,
a.vectors.items[f].vector,d,!1);d=a.vectors.count;b=a.lists[x.CAP];b.items[0]=c;c=a.vectors.items[c].texCoords[1];var n=a.vectors.items[f].texCoords[1],h;for(h=0;h<B.count;++h){var m=e*(1-Math.abs(B.count/2-h)/(B.count/2)),g=c+h/(B.count-1)*(n-c),l=B.items[h],p=a.vectors.items[d+h];p.vector[0]=l[0];p.vector[1]=l[1];p.texCoords[0]=m;p.texCoords[1]=g;p.direction[0]=0;p.direction[1]=0;b.items[h+1]=d+h}b.items[B.count+1]=f;b.count=B.count+2;a.vectors.count=d+B.count};a.prototype.squareCap=function(a,
b,c,f){this.fastMiterJoin(a,b,c);b=f===A.START?0:1;c=f===A.START?1:0;var d=r[0],e=r[1],n=r[2],h=r[3];f=r[4];var m=a.vectors.items[b].vector;d[0]=G*m[0]-Q*m[1];d[1]=Q*m[0]+G*m[1];p(h,d,W);e[0]=G*d[0]-Q*d[1];e[1]=Q*d[0]+G*d[1];n[0]=G*e[0]-Q*e[1];n[1]=Q*e[0]+G*e[1];p(f,n,W);b=a.vectors.items[b];b.vector[0]=h[0];b.vector[1]=h[1];a=a.vectors.items[c];a.vector[0]=f[0];a.vector[1]=f[1]};a.prototype.fastMiterJoin=function(a,b,c){c=d(r[0],c);b=m(r[1],c);var f=a.vectors.items[0];f.vector[0]=c[0];f.vector[1]=
c[1];f.texCoords[0]=0;f.texCoords[1]=-1;f.direction[0]=0;f.direction[1]=0;c=a.vectors.items[1];c.vector[0]=b[0];c.vector[1]=b[1];c.texCoords[0]=0;c.texCoords[1]=1;c.direction[0]=0;c.direction[1]=0;a.vectors.count=2;b=a.lists[x.ENTRY];b.items[0]=0;b.items[1]=1;b.count=2;b=a.lists[x.EXIT];b.items[0]=0;b.items[1]=1;b.count=2;a.lists[x.CAP].count=0;a.capCenter=void 0};a.prototype.miterJoin=function(a,b,c){var f=d(r[0],b),n=d(r[1],c),h=r[2];h[0]=f[0]+n[0];h[1]=f[1]+n[1];n=l(r[3],h);f=e(n,f);n=p(r[4],n,
1/f);f=m(r[5],n);this._distanceAlongCorrection?(h=a.vectors.items[0],h.vector[0]=n[0],h.vector[1]=n[1],h.texCoords[0]=0,h.texCoords[1]=-1,h.direction[0]=b[0],h.direction[1]=b[1],h=a.vectors.items[1],h.vector[0]=f[0],h.vector[1]=f[1],h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=b[0],h.direction[1]=b[1],b=a.vectors.items[2],b.vector[0]=n[0],b.vector[1]=n[1],b.texCoords[0]=0,b.texCoords[1]=-1,b.direction[0]=c[0],b.direction[1]=c[1],b=a.vectors.items[3],b.vector[0]=f[0],b.vector[1]=f[1],b.texCoords[0]=
0,b.texCoords[1]=1,b.direction[0]=c[0],b.direction[1]=c[1],a.vectors.count=4,c=a.lists[x.ENTRY],c.items[0]=0,c.items[1]=1,c.count=2,c=a.lists[x.EXIT],c.items[0]=2,c.items[1]=3):(h=a.vectors.items[0],h.vector[0]=n[0],h.vector[1]=n[1],h.texCoords[0]=0,h.texCoords[1]=-1,h.direction[0]=0,h.direction[1]=0,h=a.vectors.items[1],h.vector[0]=f[0],h.vector[1]=f[1],h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=0,h.direction[1]=0,a.vectors.count=2,c=a.lists[x.ENTRY],c.items[0]=0,c.items[1]=1,c.count=2,c=a.lists[x.EXIT],
c.items[0]=0,c.items[1]=1);c.count=2;a.lists[x.CAP].count=0;a.capCenter=void 0};a.prototype.bevelJoin=function(a,b,c,f){var n=f*f;f=h(b,c);var g=0<f?[-1,1]:[1,-1],k=g[0],g=g[1],B=0<f?m(r[0],d(r[1],b)):d(r[2],b),t=0<f?m(r[3],d(r[4],c)):d(r[5],c),C=r[6];C[0]=B[0]+t[0];C[1]=B[1]+t[1];var u=l(r[7],C),D=m(r[8],u),F=e(u,B),C=h(u,B),A=Math.abs(C/F),C=1+A*A,G=C<z?[A,this._distanceAlongCorrection]:[Math.sqrt(z-1),!0],H=G[0],G=G[1],I=C<n?[A,this._distanceAlongCorrection]:[Math.sqrt(n-1),!0],A=I[0];(I=I[1])&&
G?(G=a.vectors.items[0],q(G.vector,m(r[9],B),p(r[10],m(r[11],b),H)),G.texCoords[0]=0,G.texCoords[1]=k,G.direction[0]=this._distanceAlongCorrection?b[0]:0,G.direction[1]=this._distanceAlongCorrection?b[1]:0,D=a.vectors.items[1],q(D.vector,m(r[12],t),p(r[13],c,H)),D.texCoords[0]=0,D.texCoords[1]=k,D.direction[0]=this._distanceAlongCorrection?c[0]:0,D.direction[1]=this._distanceAlongCorrection?c[1]:0,k=a.vectors.items[2],k.vector[0]=0,k.vector[1]=0,k.texCoords[0]=0,k.texCoords[1]=0,k.direction[0]=0,
k.direction[1]=0,k=a.vectors.items[3],q(k.vector,B,p(r[14],b,A)),k.texCoords[0]=0,k.texCoords[1]=g,k.direction[0]=this._distanceAlongCorrection?b[0]:0,k.direction[1]=this._distanceAlongCorrection?b[1]:0,b=a.vectors.items[4],q(b.vector,t,p(r[15],m(r[16],c),A)),b.texCoords[0]=0,b.texCoords[1]=g,b.direction[0]=this._distanceAlongCorrection?c[0]:0,b.direction[1]=this._distanceAlongCorrection?c[1]:0,a.vectors.count=5,c=a.lists[x.ENTRY],c.items[0]=0,c.items[1]=2,c.items[2]=3,c.count=3,c=a.lists[x.EXIT],
c.items[0]=1,c.items[1]=2,c.items[2]=4,c.count=3,C<n?(n=a.lists[x.CAP],n.count=0,a.capCenter=void 0):(n=a.lists[x.CAP],n.items[0]=3,n.items[1]=4,n.count=2,a.capCenter=2)):!I&&G?(G=a.vectors.items[0],q(G.vector,m(r[9],B),p(r[10],m(r[11],b),H)),G.texCoords[0]=0,G.texCoords[1]=k,G.direction[0]=this._distanceAlongCorrection?b[0]:0,G.direction[1]=this._distanceAlongCorrection?b[1]:0,D=a.vectors.items[1],q(D.vector,m(r[12],t),p(r[13],c,H)),D.texCoords[0]=0,D.texCoords[1]=k,D.direction[0]=this._distanceAlongCorrection?
c[0]:0,D.direction[1]=this._distanceAlongCorrection?c[1]:0,k=a.vectors.items[2],k.vector[0]=0,k.vector[1]=0,k.texCoords[0]=0,k.texCoords[1]=0,k.direction[0]=0,k.direction[1]=0,k=a.vectors.items[3],p(k.vector,u,1/F),k.texCoords[0]=0,k.texCoords[1]=g,k.direction[0]=0,k.direction[1]=0,a.vectors.count=4,c=a.lists[x.ENTRY],c.items[0]=0,c.items[1]=2,c.items[2]=3,c.count=3,c=a.lists[x.EXIT],c.items[0]=1,c.items[1]=2,c.items[2]=3,c.count=3,a.lists[x.CAP].count=0,a.capCenter=void 0):I&&!G?(G=a.vectors.items[0],
p(G.vector,D,1/F),G.texCoords[0]=0,G.texCoords[1]=k,G.direction[0]=0,G.direction[1]=0,D=a.vectors.items[1],D.vector[0]=0,D.vector[1]=0,D.texCoords[0]=0,D.texCoords[1]=0,D.direction[0]=0,D.direction[1]=0,k=a.vectors.items[2],q(k.vector,B,p(r[9],b,A)),k.texCoords[0]=0,k.texCoords[1]=g,k.direction[0]=this._distanceAlongCorrection?b[0]:0,k.direction[1]=this._distanceAlongCorrection?b[1]:0,k=a.vectors.items[3],q(k.vector,t,p(r[10],m(r[11],c),A)),k.texCoords[0]=0,k.texCoords[1]=g,k.direction[0]=this._distanceAlongCorrection?
c[0]:0,k.direction[1]=this._distanceAlongCorrection?c[1]:0,a.vectors.count=4,c=a.lists[x.ENTRY],c.items[0]=0,c.items[1]=1,c.items[2]=2,c.count=3,c=a.lists[x.EXIT],c.items[0]=0,c.items[1]=1,c.items[2]=3,c.count=3,C<n?(n=a.lists[x.CAP],n.count=0,a.capCenter=void 0):(n=a.lists[x.CAP],n.items[0]=2,n.items[1]=3,n.count=2,a.capCenter=1)):I||G||(G=a.vectors.items[0],p(G.vector,D,1/F),G.texCoords[0]=0,G.texCoords[1]=k,G.direction[0]=0,G.direction[1]=0,D=a.vectors.items[1],p(D.vector,u,1/F),D.texCoords[0]=
0,D.texCoords[1]=g,D.direction[0]=0,D.direction[1]=0,a.vectors.count=2,c=a.lists[x.ENTRY],c.items[0]=0,c.items[1]=1,c.count=2,c=a.lists[x.EXIT],c.items[0]=0,c.items[1]=1,c.count=2,a.lists[x.CAP].count=0,a.capCenter=void 0);0>f&&(y(a.lists[x.ENTRY]),y(a.lists[x.EXIT]))};a.prototype.roundJoin=function(a,b,c,f){var n=h(b,c),g=0<n?[-1,1]:[1,-1],k=g[0],g=g[1],t=0<n?m(r[0],d(r[1],b)):d(r[2],b),C=0<n?m(r[3],d(r[4],c)):d(r[5],c),D=r[6];D[0]=t[0]+C[0];D[1]=t[1]+C[1];var F=l(r[7],D),D=m(r[8],F),A=e(F,t),F=
h(F,t),F=Math.abs(F/A),G=1+F*F<z?[F,this._distanceAlongCorrection]:[Math.sqrt(z-1),!0],F=G[0];G[1]?(G=a.vectors.items[0],G.vector[0]=t[0],G.vector[1]=t[1],G.texCoords[0]=0,G.texCoords[1]=g,G.direction[0]=0,G.direction[1]=0,G=a.vectors.items[1],G.vector[0]=C[0],G.vector[1]=C[1],G.texCoords[0]=0,G.texCoords[1]=g,G.direction[0]=0,G.direction[1]=0,G=a.vectors.items[2],q(G.vector,m(r[9],t),p(r[10],m(r[11],b),F)),G.texCoords[0]=0,G.texCoords[1]=k,G.direction[0]=this._distanceAlongCorrection?b[0]:0,G.direction[1]=
this._distanceAlongCorrection?b[1]:0,b=a.vectors.items[3],q(b.vector,m(r[12],C),p(r[13],c,F)),b.texCoords[0]=0,b.texCoords[1]=k,b.direction[0]=this._distanceAlongCorrection?c[0]:0,b.direction[1]=this._distanceAlongCorrection?c[1]:0,c=a.vectors.items[4],c.vector[0]=0,c.vector[1]=0,c.texCoords[0]=0,c.texCoords[1]=0,c.direction[0]=0,c.direction[1]=0,a.vectors.count=5,c=a.lists[x.ENTRY],c.items[0]=2,c.items[1]=4,c.items[2]=0,c.count=3,c=a.lists[x.EXIT],c.items[0]=3,c.items[1]=4,c.items[2]=1,c.count=3,
a.capCenter=4):(G=a.vectors.items[0],G.vector[0]=t[0],G.vector[1]=t[1],G.texCoords[0]=0,G.texCoords[1]=g,G.direction[0]=0,G.direction[1]=0,G=a.vectors.items[1],G.vector[0]=C[0],G.vector[1]=C[1],G.texCoords[0]=0,G.texCoords[1]=g,G.direction[0]=0,G.direction[1]=0,G=a.vectors.items[2],p(G.vector,D,1/A),G.texCoords[0]=0,G.texCoords[1]=k,G.direction[0]=0,G.direction[1]=0,b=a.vectors.items[3],b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,a.vectors.count=
4,c=a.lists[x.ENTRY],c.items[0]=2,c.items[1]=3,c.items[2]=0,c.count=3,c=a.lists[x.EXIT],c.items[0]=2,c.items[1]=3,c.items[2]=1,c.count=3,a.capCenter=3);u(B,t,C,f,0>n);f=a.vectors.count;t=a.lists[x.CAP];for(C=t.items[0]=0;C<B.count;++C)c=B.items[C],k=a.vectors.items[f+C],k.vector[0]=c[0],k.vector[1]=c[1],k.texCoords[0]=0,k.texCoords[1]=g,k.direction[0]=0,k.direction[1]=0,t.items[C+1]=f+C;t.items[B.count+1]=1;t.count=B.count+2;a.vectors.count=f+B.count;0>n&&(y(a.lists[x.ENTRY]),y(a.lists[x.EXIT]))};
a.prototype.unitRoundJoin=function(a,b,c,f){var e=h(b,c),n=0<e?[-1,1]:[1,-1],g=n[0],n=n[1];b=0<e?m(r[0],d(r[1],b)):d(r[2],b);c=0<e?m(r[3],d(r[4],c)):d(r[5],c);var l=a.vectors.items[0];l.vector[0]=b[0];l.vector[1]=b[1];l.texCoords[0]=0;l.texCoords[1]=n;l.direction[0]=0;l.direction[1]=0;l=a.vectors.items[1];l.vector[0]=c[0];l.vector[1]=c[1];l.texCoords[0]=0;l.texCoords[1]=n;l.direction[0]=0;l.direction[1]=0;l=a.vectors.items[2];m(l.vector,b);l.texCoords[0]=0;l.texCoords[1]=g;l.direction[0]=0;l.direction[1]=
0;l=a.vectors.items[3];m(l.vector,c);l.texCoords[0]=0;l.texCoords[1]=g;l.direction[0]=0;l.direction[1]=0;g=a.vectors.items[4];g.vector[0]=0;g.vector[1]=0;g.texCoords[0]=0;g.texCoords[1]=0;g.direction[0]=0;g.direction[1]=0;a.vectors.count=5;g=a.lists[x.ENTRY];g.items[0]=2;g.items[1]=0;g.count=2;g=a.lists[x.EXIT];g.items[0]=3;g.items[1]=1;g.count=2;a.capCenter=4;u(B,b,c,f,0>e);f=a.vectors.count;b=a.lists[x.CAP];for(g=b.items[0]=0;g<B.count;++g)c=B.items[g],l=a.vectors.items[f+g],l.vector[0]=c[0],l.vector[1]=
c[1],l.texCoords[0]=0,l.texCoords[1]=n,l.direction[0]=0,l.direction[1]=0,b.items[g+1]=f+g;b.items[B.count+1]=1;b.count=B.count+2;a.vectors.count=f+B.count;0>e&&(y(a.lists[x.ENTRY]),y(a.lists[x.EXIT]))};a.prototype.rectJoin=function(a,b,c){b=d(r[0],b);c=d(r[1],c);var f=a.vectors.items[0];f.vector[0]=b[0];f.vector[1]=b[1];f.texCoords[0]=0;f.texCoords[1]=-1;f.direction[0]=0;f.direction[1]=0;f=a.vectors.items[1];f.vector[0]=c[0];f.vector[1]=c[1];f.texCoords[0]=0;f.texCoords[1]=-1;f.direction[0]=0;f.direction[1]=
0;f=a.vectors.items[2];m(f.vector,b);f.texCoords[0]=0;f.texCoords[1]=1;f.direction[0]=0;f.direction[1]=0;b=a.vectors.items[3];m(b.vector,c);b.texCoords[0]=0;b.texCoords[1]=1;b.direction[0]=0;b.direction[1]=0;a.vectors.count=4;b=a.lists[x.ENTRY];b.items[0]=0;b.items[1]=2;b.count=2;b=a.lists[x.EXIT];b.items[0]=1;b.items[1]=3;b.count=2;a.capCenter=void 0};return a}();b.Tessellator=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix/mat2d ../../../../../../core/libs/gl-matrix/vec2 ../../color ../../definitions ../../enums ../../number ../../WGLDisplayRecord ./WGLMeshTemplate".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t){Object.defineProperty(b,"__esModule",{value:!0});var u=c.getLogger("esri.views.2d.engine.webgl.WGLMeshTemplate");k=function(b){function c(a,c,f,d,e,h,k,q,t,y,x){if(255<k||255<q)u.error("mapview-oversized-resource","Marker size was clamped to the maximum allowed value of 200x200 pixels"),k>q?(q*=255/k,k=255):(k*=255/q,q=255);var n=b.call(this)||this;n.geometryType=m.WGLGeometryType.MARKER;var r=l.create(),B=g.create(),C=x.sdf?.5:1;g.translate(B,B,new Float32Array([C*
f,C*-d]));e&&g.rotate(B,B,3.14159265359/180*e);n._materialStore=a;n.vvFlags=c;n._materialId=a.createSpriteMaterial(x,n.geometryType,c);n._fillColor=h;n._outlineColor=t;n._sizeOutlineWidth=p.i8888to32(k,q,y,0);a=Math.round(x.rect.x/4);c=Math.round(x.rect.y/4);e=a+Math.round(x.rect.width/4);x=c+Math.round(x.rect.height/4);r.set([-.5*k,-.5*q]);l.transformMat2d(r,r,B);n._offsetUpperLeft=p.i1616to32(r[0],r[1]);n._texUpperLeft=p.i8888to32(a,c,0,0);r.set([.5*k,-.5*q]);l.transformMat2d(r,r,B);n._offsetUpperRight=
p.i1616to32(r[0],r[1]);n._texUpperRight=p.i8888to32(e,c,0,0);r.set([-.5*k,.5*q]);l.transformMat2d(r,r,B);n._offsetBottomLeft=p.i1616to32(r[0],r[1]);n._texBottomLeft=p.i8888to32(a,x,0,0);r.set([.5*k,.5*q]);l.transformMat2d(r,r,B);n._offsetBottomRight=p.i1616to32(r[0],r[1]);n._texBottomRight=p.i8888to32(e,x,0,0);n.height=q;n.width=k;n.xOffset=f;n.yOffset=d;return n}a(c,b);c.fromPictureMarker=function(a,b,f,d,m){m=Math.round(e.pt2px(f.width));var n=Math.round(e.pt2px(f.height)),g=h.PICTURE_FILL_COLOR,
l=Math.round(e.pt2px(f.xoffset||0)),p=Math.round(e.pt2px(f.yoffset||0));return new c(a,b,l,p,f.angle,g,m,n,0,0,d)};c.fromSimpleMarker=function(a,b,f,n,h){h=d.premultiplyAlphaRGBA(f.color);var m=Math.round(e.pt2px(f.size)),g=Math.round(e.pt2px(f.xoffset||0)),l=Math.round(e.pt2px(f.yoffset||0)),p=f.outline,r=(p&&p.color&&d.premultiplyAlphaRGBA(p.color))|0,p=(p&&p.width&&Math.round(e.pt2px(p.width)))|0;return new c(a,b,g,l,f.angle,h,m,m,r,p,n)};c.prototype.writeMesh=function(a,b,c,d,e,h,m){h=this._materialStore.get(this._materialId);
var f=b.indexVector;b=b.get("geometry");var n=new q(d,this.geometryType,this._materialId),g=this._getOffset(b,h);a.push(n);n.vertexFrom=g;n.indexFrom=f.length;switch(c){case "esriGeometryPoint":c=e.geometry;a=c.x;c=c.y;this._writeVertices(n,b,d,this._getPos(a,c),h,m);this._writeIndices(n,f,g);break;case "esriGeometryPolyline":this._writeMany(n,f,b,g,d,e.geometry.paths[0],h,m);break;case "esriGeometryPolygon":(c=e.centroid)?(a=c.x,c=c.y,this._writeVertices(n,b,d,this._getPos(a,c),h,m),this._writeIndices(n,
f,g)):u.error("Tried to render polygon geometries as markers, but found no centroid!");break;case "esriGeometryMultipoint":this._writeMany(n,f,b,g,d,e.geometry.points,h,m);break;default:u.error("Unable to handle geometryType: "+c)}};c.prototype._getPos=function(a,b){return p.i1616to32(a,b)};c.prototype._writeMany=function(a,b,c,d,e,h,m,g){for(var f=0,n=0,l=0,p=0;p<h.length;p++){var r=h[p],k=r[0],r=r[1];this._writeVertices(a,c,e,this._getPos(k+f,r+n),m,g);this._writeIndices(a,b,d+l);f+=k;n+=r;l+=4}};
c.prototype._getOffset=function(a,b){b=b.materialKeyInfo.hasVV()?11:7;return a.length/b};c.prototype._writeVertices=function(a,b,c,d,e,h){b.push(d);b.push(this._offsetUpperLeft);b.push(this._texUpperLeft);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);this._writeVV(b,h,e);b.push(d);b.push(this._offsetUpperRight);b.push(this._texUpperRight);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);this._writeVV(b,h,e);b.push(d);
b.push(this._offsetBottomLeft);b.push(this._texBottomLeft);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);this._writeVV(b,h,e);b.push(d);b.push(this._offsetBottomRight);b.push(this._texBottomRight);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);this._writeVV(b,h,e);a.vertexCount+=4};c.prototype._writeVV=function(a,b,c){c.materialKeyInfo.hasVV()&&(a.push(b[m.VVType.SIZE]),a.push(b[m.VVType.COLOR]),a.push(b[m.VVType.OPACITY]),
a.push(b[m.VVType.ROTATION]))};c.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return c}(t.default);b.default=k})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat2d":function(){define(["./common"],function(k){var b={create:function(){var a=new k.ARRAY_TYPE(6);a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},clone:function(a){var b=new k.ARRAY_TYPE(6);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b},
copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a},fromValues:function(a,b,e,g,l,d){var c=new k.ARRAY_TYPE(6);c[0]=a;c[1]=b;c[2]=e;c[3]=g;c[4]=l;c[5]=d;return c},set:function(a,b,e,g,l,d,h){a[0]=b;a[1]=e;a[2]=g;a[3]=l;a[4]=d;a[5]=h;return a},invert:function(a,b){var c=b[0],g=b[1],l=b[2],d=b[3],h=b[4];b=b[5];var m=c*d-g*l;if(!m)return null;m=1/m;a[0]=d*m;a[1]=-g*m;a[2]=-l*m;a[3]=c*m;a[4]=
(l*b-d*h)*m;a[5]=(g*h-c*b)*m;return a},determinant:function(a){return a[0]*a[3]-a[1]*a[2]},multiply:function(a,b,e){var c=b[0],l=b[1],d=b[2],h=b[3],m=b[4];b=b[5];var p=e[0],k=e[1],t=e[2],u=e[3],y=e[4];e=e[5];a[0]=c*p+d*k;a[1]=l*p+h*k;a[2]=c*t+d*u;a[3]=l*t+h*u;a[4]=c*y+d*e+m;a[5]=l*y+h*e+b;return a}};b.mul=b.multiply;b.rotate=function(a,b,e){var c=b[0],l=b[1],d=b[2],h=b[3],m=b[4];b=b[5];var p=Math.sin(e);e=Math.cos(e);a[0]=c*e+d*p;a[1]=l*e+h*p;a[2]=c*-p+d*e;a[3]=l*-p+h*e;a[4]=m;a[5]=b;return a};b.scale=
function(a,b,e){var c=b[1],l=b[2],d=b[3],h=b[4],m=b[5],p=e[0];e=e[1];a[0]=b[0]*p;a[1]=c*p;a[2]=l*e;a[3]=d*e;a[4]=h;a[5]=m;return a};b.translate=function(a,b,e){var c=b[0],l=b[1],d=b[2],h=b[3],m=b[4];b=b[5];var p=e[0];e=e[1];a[0]=c;a[1]=l;a[2]=d;a[3]=h;a[4]=c*p+d*e+m;a[5]=l*p+h*e+b;return a};b.fromRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=-c;a[3]=b;a[4]=0;a[5]=0;return a};b.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=0;return a};b.fromTranslation=
function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a};b.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};b.add=function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];a[2]=b[2]+e[2];a[3]=b[3]+e[3];a[4]=b[4]+e[4];a[5]=b[5]+e[5];return a};b.subtract=function(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];a[2]=b[2]-e[2];
a[3]=b[3]-e[3];a[4]=b[4]-e[4];a[5]=b[5]-e[5];return a};b.sub=b.subtract;b.multiplyScalar=function(a,b,e){a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;a[3]=b[3]*e;a[4]=b[4]*e;a[5]=b[5]*e;return a};b.multiplyScalarAndAdd=function(a,b,e,g){a[0]=b[0]+e[0]*g;a[1]=b[1]+e[1]*g;a[2]=b[2]+e[2]*g;a[3]=b[3]+e[3]*g;a[4]=b[4]+e[4]*g;a[5]=b[5]+e[5]*g;return a};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]};b.equals=function(a,b){var c=a[0],g=a[1],l=a[2],
d=a[3],h=a[4];a=a[5];var m=b[0],p=b[1],q=b[2],t=b[3],u=b[4];b=b[5];return Math.abs(c-m)<=k.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(g-p)<=k.EPSILON*Math.max(1,Math.abs(g),Math.abs(p))&&Math.abs(l-q)<=k.EPSILON*Math.max(1,Math.abs(l),Math.abs(q))&&Math.abs(d-t)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(t))&&Math.abs(h-u)<=k.EPSILON*Math.max(1,Math.abs(h),Math.abs(u))&&Math.abs(a-b)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return b})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../color ../../definitions ../../enums ../../Geometry ../../number ../../TextShaping ../../WGLDisplayRecord ../../collisions/BoundingBox ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y){Object.defineProperty(b,"__esModule",{value:!0});var x=c.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),A=24*1.2,z=function(){function a(a,b,c,f,d,e,h,m,g){this.materialId=a;this.vertexOffsetUpperLeft=b;this.vertexOffsetUpperRight=c;this.vertexOffsetLowerLeft=f;this.vertexOffsetLowerRight=d;this.texFontSizeUpperLeft=e;this.texFontSizeUpperRight=h;this.texFontSizeLowerLeft=m;this.texFontSizeLowerRight=g}a.from=function(b,c,f,d,e){var n=b.glyphMosaicItem,
g=n.rect,l=n.metrics,p=Math.round(g.x/4),r=Math.round(g.y/4),n=p+Math.round(g.width/4),k=r+Math.round(g.height/4);if(b.codePoint){var q=b.x+0+l.left;b=b.y+-17-l.top;b=new h.Point(q-4,b-4);g=new h.Point(b.x+g.width,b.y+g.height)}else q=b.x,b=b.y,b=new h.Point(q,b),g=new h.Point(b.x+l.width,b.y+l.height);l=new h.Point(b.x,g.y);q=new h.Point(g.x,b.y);if(f){var B=Math.cos(f);f=Math.sin(f);b.rotate(B,f);g.rotate(B,f);l.rotate(B,f);q.rotate(B,f)}f=m.i1616to32(8*b.x,8*b.y);b=m.i1616to32(8*q.x,8*q.y);l=m.i1616to32(8*
l.x,8*l.y);g=m.i1616to32(8*g.x,8*g.y);q=m.i8888to32(p,r,d,e);r=m.i8888to32(n,r,d,e);p=m.i8888to32(p,k,d,e);d=m.i8888to32(n,k,d,e);return new a(c,f,b,l,g,q,r,p,d)};return a}();b.ComputedGlyph=z;k=function(b){function c(a,c,f){var n=b.call(this)||this;n.geometryType=d.WGLGeometryType.TEXT;var h=f.haloColor;n.color=(f.color&&g.premultiplyAlphaRGBA(f.color))|0;n.textSize=e.pt2px(f.font.size);var m=f.yoffset/f.font.size;n.shapingXOffset=f.xoffset/f.font.size*24;n.shapingYOffset=24*m;n.haloColor=(h&&g.premultiplyAlphaRGBA(h))|
0;n.haloSize=10*e.pt2px(e.toPt(f.haloSize||0));n.textPropColor=n.color||l.PICTURE_FILL_COLOR;n.textPropSize=e.pt2px(f.font.size);n.textPropAngle=f.angle*Math.PI/180;n.xOffset=e.pt2px(f.xoffset);n.yOffset=e.pt2px(f.yoffset);n.textPropHAnchor="left"===f.horizontalAlignment?0:"right"===f.horizontalAlignment?1:.5;n.textPropVAnchor="top"===f.verticalAlignment?0:"bottom"===f.verticalAlignment?1:.5;n.textPropHaloColor=n.haloColor||4294967295;n.textPropHaloSize=e.pt2px(e.toPt(f.haloSize||0));n._materialStore=
a;n.vvFlags=c;return n}a(c,b);c.fromText=function(a,b,f,d,e){a=new c(a,b,f);a.computeGlyphs(e,f.text,!1);return a};c.prototype.writeMesh=function(a,b,c,f,d,e,n){e=b.indexVector;var h=b.get("geometry");b=b.get("visibility");var m=this._getOffset(h);switch(c){case "esriGeometryPoint":d=d.geometry;c=d.x;d=d.y;this._writeVertices(a,e,h,b,m,f,c,d,n);break;case "esriGeometryPolygon":if(d.centroid){d=d.centroid;c=d.x;d=d.y;this._writeVertices(a,e,h,b,m,f,c,d,n);break}default:x.error("Unable to handle geometryType: "+
c)}};c.prototype.computeGlyphs=function(a,b,c){if(!b||!b.length)return this._computedGlyphs=[],null;a=this._computeShaping(a,240,A,0,this.shapingXOffset,this.shapingYOffset,this.textPropHAnchor,this.textPropVAnchor,.5);b=y.bidiText(b);b=a.getShaping(b[0],b[1]);a=Array(b.length);for(var f=0;f<b.length;f++){var e=this.textPropAngle,n=this.textSize,h=this.haloSize,m=this._materialStore.createGlyphMaterial(b[f].glyphMosaicItem,d.WGLGeometryType.TEXT,this.vvFlags);a[f]=z.from(b[f],m,e,n,h)}this._computedGlyphs=
a;if(!c)return null;c=p.getBox(b);c.width*=this.textSize/24;c.height*=this.textSize/24;return new t.default(c.x,c.y,c.width,c.height)};c.prototype._computeShaping=function(a,b,c,f,d,e,n,h,m){return this._shaping=new p([a],240,A,0,[d,e],n,h,.5)};c.prototype._getOffset=function(a){return a.length/(this.vvFlags?9:5)};c.prototype._writeVertices=function(a,b,c,f,d,e,n,h,g){var l=this._computedGlyphs,p=m.i1616to32(2*n,2*h);n=m.i1616to32(2*n+1,2*h);h=0;if(this.haloSize)for(var r=0;r<l.length;r++,h+=4){var k=
l[r].materialId,B=this._materialStore.get(k),k=new q(e,this.geometryType,k);k.vertexFrom=d;k.indexFrom=b.length;this._writeVertex(k,c,f,e,n,this.haloColor,l[r],B,g);this._writeIndices(k,b,d+h);a.push(k)}for(r=0;r<l.length;r++,h+=4)k=l[r].materialId,B=this._materialStore.get(k),k=new q(e,this.geometryType,k),k.vertexFrom=d,k.indexFrom=b.length,this._writeVertex(k,c,f,e,p,this.color,l[r],B,g),this._writeIndices(k,b,d+h),a.push(k)};c.prototype._writeVertex=function(a,b,c,f,d,e,n,h,m){b.push(d);b.push(f);
b.push(e);b.push(n.vertexOffsetUpperLeft);b.push(n.texFontSizeUpperLeft);this._writeVV(b,m,h);b.push(d);b.push(f);b.push(e);b.push(n.vertexOffsetUpperRight);b.push(n.texFontSizeUpperRight);this._writeVV(b,m,h);b.push(d);b.push(f);b.push(e);b.push(n.vertexOffsetLowerLeft);b.push(n.texFontSizeLowerLeft);this._writeVV(b,m,h);b.push(d);b.push(f);b.push(e);b.push(n.vertexOffsetLowerRight);b.push(n.texFontSizeLowerRight);this._writeVV(b,m,h);c.push(4294967295);a.vertexCount+=4};c.prototype._writeVV=function(a,
b,c){c.materialKeyInfo.hasVV()&&(a.push(b[d.VVType.SIZE]),a.push(b[d.VVType.COLOR]),a.push(b[d.VVType.OPACITY]),a.push(b[d.VVType.ROTATION]))};c.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return c}(u.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/TextShaping":function(){define(["require","exports","./Rect"],function(k,b,a){return function(){function b(a,b,c,d,h,m,p,k){this._glyphItems=a;this._maxWidth=
b;this._lineHeight=c;this._letterSpacing=d;this._offset=h;this._hAnchor=m;this._vAnchor=p;this._justify=k}b.prototype.getShaping=function(a,b){for(var c=this._letterSpacing,d=this._lineHeight,e=this._justify,m=this._maxWidth,g=[],k=0,t=0,u=0,y=0,x=-1,A=0,z=-1,f=a.length,n=0;n<f;n++){var r=a.charCodeAt(n);if(10===r){if(n!==f-1){if(x>=y){var k=g[x],B=k.x+k.glyphMosaicItem.metrics.advance,A=Math.max(B,A);e&&this._applyJustification(g,y,x);y=g.length}t=b?t-d:t+d;k=0;++u}}else{for(var B=void 0,C=0,D=this._glyphItems;C<
D.length&&!(B=D[C][r]);C++);if(B){g.push({codePoint:r,x:k,y:t,glyphMosaicItem:B});k+=B.metrics.advance+c;if(0<m&&k>m&&0<=z){C=z+1;B=g[C].x;A=Math.max(B,A);for(D=C;D<g.length;D++)g[D].y=b?g[D].y-d:g[D].y+d,g[D].x-=B;e&&this._applyJustification(g,y,z);t=b?t-d:t+d;k-=B;++u;y=C;z=-1}++x;32===r&&(z=g.length-1)}}}x>=y&&(k=g[x],A=Math.max(A,k.x+k.glyphMosaicItem.metrics.advance),e&&this._applyJustification(g,y,x));if(0<g.length)for(a=(e-this._hAnchor)*A,c=(-this._vAnchor*(u+1)+.5)*d,b&&u&&(c+=u*d),a+=this._offset[0],
c+=this._offset[1],b=0;b<g.length;b++)d=g[b],d.x+=a,d.y+=c;return g};b.getBox=function(a){var b=a.length;if(0!==b){for(var c=a[0].x+a[0].glyphMosaicItem.metrics.left,d=c,e=a[0].y,m=e,p=e,k=1;k<b;k++){var t=a[k],u=t.x+t.glyphMosaicItem.metrics.left;u<c&&(c=u);u>d&&(d=u);t=t.y;t<e&&(e=t);t>m&&(m=t);t!==p&&(d=Math.max(d,a[k-1].x+a[k-1].glyphMosaicItem.metrics.left+a[k-1].glyphMosaicItem.metrics.width),p=t)}d=Math.max(d,a[b-1].x+a[b-1].glyphMosaicItem.metrics.left+a[b-1].glyphMosaicItem.metrics.width);
m+=12;return{x:c,y:m,width:d-c,height:m-(e-12)}}};b.addDecoration=function(b,c){var e=b.length;if(0!==e){for(var d=b[0].x+b[0].glyphMosaicItem.metrics.left,h=b[0].y,m=1;m<e;m++){var g=b[m];if(g.y!==h){var k=b[m-1].x+b[m-1].glyphMosaicItem.metrics.left+b[m-1].glyphMosaicItem.metrics.width;b.push({codePoint:0,x:d,y:h+c-3,glyphMosaicItem:{rect:new a(4,0,4,8),metrics:{width:k-d,height:8,left:0,top:0,advance:0},page:0}});h=g.y;d=g.x+g.glyphMosaicItem.metrics.left}}e=b[e-1].x+b[e-1].glyphMosaicItem.metrics.left+
b[e-1].glyphMosaicItem.metrics.width;b.push({codePoint:0,x:d,y:h+c-3,glyphMosaicItem:{rect:new a(4,0,4,8),metrics:{width:e-d,height:8,left:0,top:0,advance:0},page:0}})}};b.prototype._applyJustification=function(a,b,c){for(var d=a[c],d=(d.x+d.glyphMosaicItem.metrics.advance)*this._justify;b<=c;b++)a[b].x-=d};return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(k,b){return function(){function a(a,b,g,l){void 0===a&&(a=0);void 0===b&&(b=
0);void 0===g&&(g=0);void 0===l&&(l=0);this.x=a;this.y=b;this.width=g;this.height=l}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","dojox/string/BidiEngine"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});var c=new a;b.bidiText=function(a){if(!c.hasBidiChar(a))return[a,!1];var b;b="rtl"===
c.checkContextual(a)?"IDNNN":"ICNNN";return[c.bidiTransform(a,b,"VLYSN"),!0]}})},"dojox/string/BidiEngine":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/Stateful"],function(k,b,a){function c(a,b,f,n,h){var m=a;void 0===b&&(b=h.defInFormat);void 0===f&&(f=h.defOutFormat);void 0===n&&(n=h.defSwap);if(b!==f){var l,p=b.substring(0,1);l=b.substring(1,4);var r=f.substring(0,1),k=f.substring(1,4);"C"===l.charAt(0)&&(l=e(m),l="ltr"===l||"rtl"===l?l.toUpperCase():"L"===b.charAt(2)?"LTR":
"RTL",b=p+l);"C"===k.charAt(0)&&(l=e(m),"rtl"===l?k="RTL":"ltr"===l?(m=m.split(""),m.reverse(),l=e(m.join("")),k=l.toUpperCase()):k="L"===f.charAt(2)?"LTR":"RTL",f=r+k)}if(b===f)return a;r=b.substring(0,1);m=b.substring(1,4);p=f.substring(0,1);k=f.substring(1,4);h.inFormat=b;h.outFormat=f;h.swap=n;if("L"===r&&"VLTR"===f){if("LTR"===m)return h.dir=D,g(a,h);if("RTL"===m)return h.dir=F,g(a,h)}if("V"===r&&"V"===p)return h.dir="RTL"===m?F:D,d(a,h);if("L"===r&&"VRTL"===f)return h.dir="LTR"===m?D:F,a=g(a,
h),d(a);if("VLTR"===b&&"LLTR"===f)return h.dir=D,g(a,h);if("V"===r&&"L"===p&&m!==k)return a=d(a),"RTL"===m?c(a,"LLTR","VLTR",n,h):c(a,"LRTL","VRTL",n,h);if("VRTL"===b&&"LRTL"===f)return c(a,"LRTL","VRTL",n,h);if("L"===r&&"L"===p)return b=h.swap,h.swap=b.substr(0,1)+"N","RTL"===m?(h.dir=F,a=g(a,h),h.swap="N"+b.substr(1,2),h.dir=D,a=g(a,h)):(h.dir=D,a=g(a,h),h.swap="N"+b.substr(1,2),a=c(a,"VLTR","LRTL",h.swap,h)),a}function e(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?
"z">=a[0]?"ltr":"rtl":""}function g(a,b){a=a.split("");var c=[];l(a,c,b);if(0!==b.hiLevel&&b.swap.substr(0,1)!==b.swap.substr(1,2))for(var f=0;f<a.length;f++)if(1===c[f]){var d=f,e;b:{e=a[f];for(var h=void 0,m=0,g=I.length-1;m<=g;)if(h=Math.floor((m+g)/2),e<I[h][0])g=h-1;else if(e>I[h][0])m=h+1;else{e=I[h][1];break b}}a[d]=e}p(2,a,c,b);p(1,a,c,b);n=c;return a.join("")}function l(a,b,c){var f=a.length,d=c.dir?M:O,e=null,n=null,h=null,e=0,n=n=null,m=-1,g=n=null,l=[],p=[];c.hiLevel=c.dir;c.lastArabic=
!1;c.hasUbatAl=!1;c.hasUbatB=!1;c.hasUbatS=!1;for(n=0;n<f;n++){var g=n,h=a[n].charCodeAt(0),r=pa[h>>8];l[g]=r<ka?r:qa[r-ka][h&255]}for(g=0;g<f;g++){p[g]=n=q(a,l,p,g,c);e=d[e][n];n=e&240;e&=15;b[g]=h=d[e][B];if(0<n){if(16===n)for(n=m;n<g;n++)b[n]=1;m=-1}if(n=d[e][C])-1===m&&(m=g);else if(-1<m){for(n=m;n<g;n++)b[n]=h;m=-1}l[g]===L&&(b[g]=0);c.hiLevel|=h}if(c.hasUbatS)for(a=0;a<f;a++)if(l[a]===da)for(b[a]=c.dir,d=a-1;0<=d;d--)if(l[d]===ja)b[d]=c.dir;else break}function d(a,b){a=a.split("");if(b){var c=
[];l(a,c,b);n=c}a.reverse();z.reverse();return a.join("")}function h(a){for(var b=0;b<X.length;b++)if(a>=X[b]&&a<=Y[b])return!0;return!1}function m(a,b,c,f){for(;b*c<f&&u(a[b]);)b+=c;return b*c<f&&h(a[b])?!0:!1}function p(a,b,c,f){if(!(f.hiLevel<a))if(1!==a||f.dir!==F||f.hasUbatB){f=b.length;for(var d=0,e,n,h;d<f;){if(c[d]>=a){for(e=d+1;e<f&&c[e]>=a;)e++;for(n=e-1;d<n;d++,n--)h=b[d],b[d]=b[n],b[n]=h,h=z[d],z[d]=z[n],z[n]=h;d=e}d++}}else b.reverse(),z.reverse()}function q(a,b,c,f,d){return{UBAT_L:function(){d.lastArabic=
!1;return N},UBAT_R:function(){d.lastArabic=!1;return P},UBAT_ON:function(){return V},UBAT_AN:function(){return Z},UBAT_EN:function(){return d.lastArabic?Z:R},UBAT_AL:function(){d.lastArabic=!0;d.hasUbatAl=!0;return P},UBAT_WS:function(){return V},UBAT_CS:function(){var a,e;if(1>f||f+1>=b.length||(a=c[f-1])!==R&&a!==Z||(e=b[f+1])!==R&&e!==Z)return V;d.lastArabic&&(e=Z);return e===a?e:V},UBAT_ES:function(){return(0<f?c[f-1]:L)===R&&f+1<b.length&&b[f+1]===R?R:V},UBAT_ET:function(){if(0<f&&c[f-1]===
R)return R;if(d.lastArabic)return V;for(var a=f+1,e=b.length;a<e&&b[a]===na;)a++;return a<e&&b[a]===R?R:V},UBAT_NSM:function(){if("VLTR"===d.inFormat){for(var e=b.length,n=f+1;n<e&&b[n]===oa;)n++;if(n<e&&(e=a[f],n=b[n],(1425<=e&&2303>=e||64286===e)&&(n===P||n===fa)))return P}return 1>f||b[f-1]===L?V:c[f-1]},UBAT_B:function(){d.lastArabic=!0;d.hasUbatB=!0;return d.dir},UBAT_S:function(){d.hasUbatS=!0;return V},UBAT_LRE:function(){d.lastArabic=!1;return V},UBAT_RLE:function(){d.lastArabic=!1;return V},
UBAT_LRO:function(){d.lastArabic=!1;return V},UBAT_RLO:function(){d.lastArabic=!1;return V},UBAT_PDF:function(){d.lastArabic=!1;return V},UBAT_BN:function(){return V}}[ra[b[f]]]()}function t(a,b){for(var c=0;c<K.length;c++)if(a===K[c])return b[c];return a}function u(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function y(a){if("L"===a)return"LTR";if("R"===a)return"RTL";if("C"===a)return"CLR";if("D"===a)return"CRL"}function x(a,b){for(var c=0;c<G.length;c++)if(a===G[c])return b[c];return a}function A(a,
b,c,f){for(var d=0;d<a.length;d++)if(a[d]>b||!c&&a[d]===b)a[d]+=f}k.getObject("string",!0,dojox);k=b("dojox.string.BidiEngine",a,{inputFormat:"ILYNN",outputFormat:"VLNNN",sourceToTarget:[],targetToSource:[],levels:[],bidiTransform:function(a,b,d){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var e=this.sourceToTarget,g=this.targetToSource,l=a.length;z=[];n=[];for(var p=0;p<l;p++)e[p]=p,g[p]=p,z[p]=p;if(!this.checkParameters(b,d))return a;b=this.inputFormat;d=this.outputFormat;var e=
a,e=r,p=y(b.charAt(1)),g=y(d.charAt(1)),k="I"===b.charAt(0)?"L":b.charAt(0),l="I"===d.charAt(0)?"L":d.charAt(0),p=k+p,g=l+g,l=b.charAt(2)+d.charAt(2);e.defInFormat=p;e.defOutFormat=g;e.defSwap=l;a=c(a,p,g,l,e);e=!1;if("R"===d.charAt(1))e=!0;else if("C"===d.charAt(1)||"D"===d.charAt(1))e=this.checkContextual(a);g=this.sourceToTarget=z;l=Array(g.length);for(p=0;p<g.length;p++)l[g[p]]=p;f=this.targetToSource=l;if(b.charAt(3)===d.charAt(3))e=a;else if("S"===d.charAt(3))if(b=e,d=!0,0===a.length)e=void 0;
else{void 0===b&&(b=!0);void 0===d&&(d=!0);a=String(a);a=a.split("");var q=0,g=1,e=a.length;b||(q=a.length-1,g=-1,e=1);for(var l=e,p=d,B=0,e=[],k=0;q*g<l;q+=g)if(h(a[q])||u(a[q])){var C;if(C="\u0644"===a[q])b:{for(var D=a,F=q+g,v=g,w=l;F*v<w&&u(D[F]);)F+=v;C=" ";if(F*v<w)for(C=D[F],D=0;D<G.length;D++)if(G[D]===C){C=!0;break b}C=!1}if(C){a[q]=0===B?x(a[q+g],Q):x(a[q+g],W);q+=g;B=a;C=q;D=g;for(F=l;C*D<F&&u(B[C]);)C+=D;C*D<F&&(B[C]=" ");p&&(e[k]=q,k++);B=0}else{C=a[q];if(1===B){D=q;if(m(a,q+g,g,l))b:for(F=
a[q],v=0;v<K.length;v++){if(F===K[v]){F=ca[v];break b}}else F=t(a[q],ba);a[D]=F}else!0===m(a,q+g,g,l)?a[q]=t(a[q],ea):a[q]=t(a[q],aa);u(C)||(B=1);b:{for(D=0;D<ha.length;D++)if(ha[D]===C){C=!0;break b}C=!1}!0===C&&(B=0)}}else B=0;g="";for(l=0;l<a.length;l++){if(p=d){b:{for(p=0;p<e.length;p++)if(e[p]===l)break b;p=-1}p=-1<p}p?(A(f,l,!b,-1),z.splice(l,1)):g+=a[l]}e=g}else if(b=a,d=e,a=!0,0===b.length)e=void 0;else for(void 0===a&&(a=!0),void 0===d&&(d=!0),b=String(b),e="",g=[],g=b.split(""),l=0;l<b.length;l++)p=
!1,"\ufe70"<=g[l]&&"\ufeff">g[l]?(k=b.charCodeAt(l),"\ufef5"<=g[l]&&"\ufefc">=g[l]?(d?(0<l&&a&&" "===g[l-1]?e=e.substring(0,e.length-1)+"\u0644":(e+="\u0644",p=!0),e+=G[(k-65269)/2]):(e+=G[(k-65269)/2],e+="\u0644",l+1<b.length&&a&&" "===g[l+1]?l++:p=!0),p&&(A(f,l,!0,1),z.splice(l,0,z[l]))):e+=U[k-65136]):e+=g[l];this.sourceToTarget=z;this.targetToSource=f;this.levels=n;return e},_inputFormatSetter:function(a){if(!H.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=
a},_outputFormatSetter:function(a){if(!H.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a},checkParameters:function(a,b){a?this.set("inputFormat",a):a=this.inputFormat;b?this.set("outputFormat",b):b=this.outputFormat;return a===b?!1:!0},checkContextual:function(a){a=e(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(sa){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a},hasBidiChar:function(a){return J.test(a)}});var z=[],f=[],n=[],r={dir:0,
defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1},B=5,C=6,D=0,F=1,H=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,J=/[\u0591-\u06ff\ufb1d-\ufefc]/,I=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],
["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],G=["\u0622","\u0623","\u0625","\u0627"],Q=["\ufef5","\ufef7","\ufef9","\ufefb"],W=["\ufef6","\ufef8","\ufefa","\ufefc"],K="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split(""),
aa="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split(""),ba="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split(""),
ca="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split(""),ea="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split(""),
ha="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split(""),U="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split(""),
X=["\u0621","\u0641"],Y=["\u063a","\u064a"],O=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],M=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],N=0,P=1,R=2,Z=3,V=4,L=5,da=6,fa=7,ja=8,na=11,oa=12,ra="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" "),ka=100;b=N;a=P;var T=R,ga=Z,v=V,la=L,ma=da,w=fa,ia=ja,S=na,E=oa,
pa=[ka+0,b,b,b,b,ka+1,ka+2,ka+3,a,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,ka+4,v,v,v,b,v,b,v,b,v,v,v,b,b,v,v,b,b,b,b,b,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,b,b,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,b,b,v,v,b,b,v,v,b,b,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,
v,v,v,v,v,v,v,b,b,b,ka+5,w,w,ka+6,ka+7],qa=[[18,18,18,18,18,18,18,18,18,ma,la,ma,ia,la,18,18,18,18,18,18,18,18,18,18,18,18,18,18,la,la,la,ma,ia,v,v,S,S,S,v,v,v,v,v,10,9,10,9,9,T,T,T,T,T,T,T,T,T,T,9,v,v,v,v,v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,v,v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,v,18,18,18,18,18,18,la,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,v,S,S,S,S,v,v,v,v,b,v,v,18,v,v,S,S,T,T,v,b,v,v,v,T,b,v,v,v,v,v,b,b,
b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,b,b,b,b,b,b,b,b],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,v,v,v,v,v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,b,b,b,b,b,b,b,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,b,v,v,v,v,v,v,v,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,
E,E,a,E,a,E,E,a,E,E,a,E,v,v,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,v,v,v,v,v,a,a,a,a,a,v,v,v,v,v,v,v,v,v,v,v],[ga,ga,ga,ga,v,v,v,v,w,S,S,w,9,w,v,v,E,E,E,E,E,E,E,E,E,E,E,w,v,v,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,ga,ga,ga,ga,ga,ga,ga,ga,ga,ga,S,ga,ga,w,w,w,E,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,
w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,E,E,E,E,E,E,E,ga,v,E,E,E,E,E,E,w,w,E,E,v,E,E,E,E,w,w,T,T,T,T,T,T,T,T,T,T,w,w,w,w,w,w],[w,w,w,w,w,w,w,w,w,w,w,w,w,w,v,w,w,E,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,v,v,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,E,
E,E,E,E,E,E,E,E,E,E,w,v,v,v,v,v,v,v,v,v,v,v,v,v,v,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,E,E,E,E,E,E,E,E,E,a,a,v,v,v,v,a,v,v,v,v,v],[ia,ia,ia,ia,ia,ia,ia,ia,ia,ia,ia,18,18,18,b,a,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,ia,la,13,14,15,16,17,9,S,S,S,S,S,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,9,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,ia,18,18,18,18,18,v,v,v,v,v,18,18,18,18,18,18,T,b,v,v,T,T,T,T,T,T,10,10,v,v,v,b,T,T,T,T,T,T,T,T,T,T,10,10,v,v,
v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[b,b,b,b,b,b,b,v,v,v,v,v,v,v,v,v,v,v,v,b,b,b,b,b,v,v,v,v,v,a,E,a,a,a,a,a,a,a,a,a,a,10,a,a,a,a,a,a,a,a,a,a,a,a,a,v,a,a,a,a,a,v,a,v,a,a,v,a,a,v,a,a,a,a,a,a,a,a,a,a,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,
w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,E,E,E,E,E,E,E,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,9,v,9,v,v,9,v,v,v,v,v,v,v,v,v,S,v,v,10,10,v,v,v,v,v,S,S,v,v,v,v,v,w,w,w,w,w,v,w,w,w,w,w,w,w,w,w,w,
w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,v,v,18],[v,v,v,S,S,S,v,v,v,v,v,10,9,10,9,9,T,T,T,T,T,T,T,T,T,T,9,v,v,v,v,v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,v,v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,v,v,v,v,v,v,v,v,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,
b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,v,v,v,b,b,b,b,b,b,v,v,b,b,b,b,b,b,v,v,b,b,b,b,b,b,v,v,b,b,b,v,v,v,S,S,v,v,v,S,S,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]];return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(k,b,a,c){function e(b,c){void 0===c&&(c=!1);var d=a.WGLVVFlag.SIZE_FIELD_STOPS|
a.WGLVVFlag.SIZE_MINMAX_VALUE|a.WGLVVFlag.SIZE_SCALE_STOPS|a.WGLVVFlag.SIZE_UNIT_VALUE;b=(b&(a.WGLVVTarget.FIELD_TARGETS_OUTLINE|a.WGLVVTarget.MINMAX_TARGETS_OUTLINE|a.WGLVVTarget.SCALE_TARGETS_OUTLINE|a.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return c?d&b:d&~b}function g(b){var c=e(b,!1);return b&(a.WGLVVFlag.COLOR|a.WGLVVFlag.OPACITY|a.WGLVVFlag.ROTATION|c)}Object.defineProperty(b,"__esModule",{value:!0});b.getVVFlags=function(b){if(!b)return a.WGLVVFlag.NONE;for(var d=0,e=0;e<b.length;e++){var g=
b[e];if("size"===g.type){var l=c.getTypeOfSizeVisualVariable(g),d=d|l;"outline"===g.target&&(d|=l<<4)}else"color"===g.type?d|=a.WGLVVFlag.COLOR:"opacity"===g.type?d|=a.WGLVVFlag.OPACITY:"rotation"===g.type&&(d|=a.WGLVVFlag.ROTATION)}return d};b.getSizeFlagsMask=e;b.getMarkerVVFlags=g;b.getFillVVFlags=function(b){return b&(a.WGLVVFlag.COLOR|a.WGLVVFlag.OPACITY)};b.getLineVVFlags=function(b,c){if(c)return c=e(b,!0),b&c;c=e(b,!1);return b&(a.WGLVVFlag.COLOR|a.WGLVVFlag.OPACITY|c)};b.getTextVVFlags=function(a){return g(a)}})},
"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix/mat2d ../../../../../../core/libs/gl-matrix/vec2 ../../../../../../geometry/support/centroid ../../color ../../enums ../../fontUtils ../../number ../../TextShaping ../../WGLDisplayRecord ../../collisions/BoundingBox ./WGLMeshTemplate ./WGLTextTemplate".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A){Object.defineProperty(b,"__esModule",{value:!0});var z=c.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),f=24*1.2,n=q.i8888to32(255,255,255,255),r={xOffset:0,yOffset:0,width:0,height:0};k=function(b){function c(a,c,f){var d=b.call(this)||this;d.geometryType=m.WGLGeometryType.LABEL;d.vvFlags=0;d._textBoxVerticalOffset=0;d._textBoxHorizontalOffset=0;d._refTemplate=r;d._xOffset=c.xoffset;d._yOffset=-c.yoffset;d._decorationOffset=p.getFontDecorationOffset(c.font);
var n=c.haloColor;d._color=(c.color&&h.premultiplyAlphaRGBA(c.color))|0;var g=c.yoffset/c.font.size;d._shapingXOffset=c.xoffset/c.font.size*24;d._shapingYOffset=24*g;d._haloColor=(n&&h.premultiplyAlphaRGBA(n))|0;d._haloSize=10*e.pt2px(e.toPt(c.haloSize||0));d._textPropSize=e.pt2px(c.font.size);d._textPropAngle=c.angle*Math.PI/180;d._textPropHJustification="left"===c.horizontalAlignment?0:"right"===c.horizontalAlignment?1:.5;n=0;g=.5;switch(f){case "above-center":case "above-left":case "above-right":n=
-.5;g=0;break;case "below-center":case "below-left":case "below-right":n=.5,g=1}var k=0,q=.5;switch(f){case "above-left":case "center-left":case "below-left":k=-.5;q=1;break;case "above-right":case "center-right":case "below-right":k=.5,q=0}d._textPropHAnchorPlacement=q;d._textPropVAnchorPlacement=g;d._placementDirection=[k,n];d._materialStore=a;d.symbolId=c.id;d.anchor=l.create();return d}a(c,b);c.fromText=function(a,b,f,d,e,n){return new c(a,f,e)};Object.defineProperty(c.prototype,"bounds",{get:function(){return this._bounds},
enumerable:!0,configurable:!0});c.prototype.computeGlyphs=function(a,b){var c=b.text;if(!c||!c.length)return this._computedGlyphs=[],1;a=this._computeShaping(a,240,f,0,this._shapingXOffset,this._shapingYOffset,this._textPropHAnchorPlacement,this._textPropVAnchorPlacement,this._textPropHJustification).getShaping(c,b.rtl);isNaN(this._decorationOffset)||t.addDecoration(a,this._decorationOffset);b=Array(a.length);for(c=0;c<a.length;c++){var d=this._textPropAngle,e=this._textPropSize,n=this._haloSize,
h=this._materialStore.createGlyphMaterial(a[c].glyphMosaicItem,m.WGLGeometryType.LABEL,this.vvFlags);b[c]=A.ComputedGlyph.from(a[c],h,d,e,n)}this._computedGlyphs=b;if(!a||0===a.length)return 2;a=t.getBox(a);b=this._textPropSize/24;a.width*=b;a.height*=b;a.x*=b;a.y*=b;0>this._placementDirection[0]?this._textBoxHorizontalOffset=-a.x-a.width:0<this._placementDirection[0]&&(this._textBoxHorizontalOffset=-a.x);0>this._placementDirection[1]?this._textBoxVerticalOffset=-a.y:0<this._placementDirection[1]&&
(this._textBoxVerticalOffset=-a.y+a.height);c=a.width/2;d=a.height/2;this._textPropAngle&&(b=l.fromValues(-c,-d),c=l.fromValues(c,d),d=g.create(),g.rotate(d,d,this._textPropAngle),l.transformMat2d(b,b,d),l.transformMat2d(c,c,d),d=Math.abs(c[1]-b[1]),a.width=Math.abs(c[0]-b[0]),a.height=d);this._bounds=new y.default(a.x,a.y,a.width+10,a.height+10);a=this._placementDirection[1]*(this._refTemplate.height+this._bounds.height);this._bounds.center[0]=this._placementDirection[0]*(this._refTemplate.width+
this._bounds.width)+this._xOffset;this._bounds.center[1]=a+this._yOffset;return 0};c.prototype.bindReferenceTemplate=function(a){this._refTemplate=a?a:r};c.prototype.computeAnchor=function(a,b){var c=this._refTemplate.xOffset,f=this._refTemplate.yOffset;switch(a){case "esriGeometryPoint":b=b.geometry;a=b.x;b=b.y;this._setAnchor(a,b);break;case "esriGeometryMultipoint":a=b.geometry;b=this._computeAnchorMultipoint(a.points);a=b.x;b=b.y;this._setAnchor(a,b);break;case "esriGeometryPolygon":if(b.centroid){a=
b.centroid;this._setAnchor(a.x,a.y);break}a=b.geometry;b=this._computeAnchorRings(a.rings);if(!b)break;a=b.x;b=b.y;this._setAnchor(a,b);break;case "esriGeometryPolyline":a=b.geometry;b=this._computeAnchorRings(a.paths);if(!b)break;a=b.x;b=b.y;this._setAnchor(a,b);break;default:z.error("Unable to handle geometryType: "+a)}return l.fromValues(this.anchor[0]+c,this.anchor[1]+f)};c.prototype.writeMesh=function(a,b,c,f,d,e,n){c=b.indexVector;d=b.get("geometry");e=b.get("visibility");b=b.get("visibilityRange");
n=this._getOffset(d);var h=q.i8888to32(this._refTemplate.xOffset,-this._refTemplate.yOffset,this._placementDirection[0]*(this._refTemplate.width+10)+this._textBoxHorizontalOffset,this._placementDirection[1]*(this._refTemplate.height+10)+this._textBoxVerticalOffset);this._writeVertices(a,c,d,e,b,f,n,h,this.anchor[0],this.anchor[1])};c.prototype._setAnchor=function(a,b){this.anchor[0]=a;this.anchor[1]=b};c.prototype._computeAnchorMultipoint=function(a){return a.length&&a[0].length?{x:a[0][0],y:a[0][1]}:
null};c.prototype._computeAnchorRings=function(a){if(!a.length||!a[0].length||!a[0][0].length)return null;a=d.ringsCentroid(a,!1);return{x:a[0],y:a[1]}};c.prototype._computeShaping=function(a,b,c,d,e,n,h,g,m){return this._shaping=new t([a],240,f,0,[e,n],h,g,m)};c.prototype._getOffset=function(a){return a.length/5};c.prototype._writeVertices=function(a,b,c,f,d,e,n,h,g,m){var l=this._computedGlyphs,p=q.i1616to32(2*g,2*m);g=q.i1616to32(2*g+1,2*m);m=0;var r=q.i8888to32(0,(e&16711680)>>16,(e&65280)>>8,
e&255);if(this._haloSize)for(var k=0;k<l.length;k++,m+=4){var B=l[k].materialId,t=this._materialStore.get(B),B=new u(e,this.geometryType,B);B.vertexFrom=n+m;B.indexFrom=b.length;this._writeGlyph(B,c,f,d,r,g,this._haloColor,h,l[k],t);this._writeIndices(B,b,n+m);a.push(B)}for(k=0;k<l.length;k++,m+=4)B=l[k].materialId,t=this._materialStore.get(B),B=new u(e,this.geometryType,B),B.vertexFrom=n+m,B.indexFrom=b.length,this._writeGlyph(B,c,f,d,r,p,this._color,h,l[k],t),this._writeIndices(B,b,n+m),a.push(B)};
c.prototype._writeGlyph=function(a,b,c,f,d,e,h,g,m,l){b.push(e);b.push(h);b.push(m.vertexOffsetUpperLeft);b.push(m.texFontSizeUpperLeft);b.push(g);b.push(e);b.push(h);b.push(m.vertexOffsetUpperRight);b.push(m.texFontSizeUpperRight);b.push(g);b.push(e);b.push(h);b.push(m.vertexOffsetLowerLeft);b.push(m.texFontSizeLowerLeft);b.push(g);b.push(e);b.push(h);b.push(m.vertexOffsetLowerRight);b.push(m.texFontSizeLowerRight);b.push(g);c.push(4294967295);f.push(n);f.push(n);a.vertexCount+=4};c.prototype._writeIndices=
function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return c}(x.default);b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(k,b){function a(a){a=a.toLowerCase().split(" ").join("-");switch(a){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return a}}
Object.defineProperty(b,"__esModule",{value:!0});b.getFullyQualifiedFontName=function(b){var c;a:{if(b.weight)switch(b.weight.toLowerCase()){case "bold":case "bolder":c="-bold";break a}c=""}var g;a:{if(b.style)switch(b.style.toLowerCase()){case "italic":case "oblic":g="-italic";break a}g=""}c+=g;return a(b.family)+(0<c.length?c:"-regular")};b.getFontDecorationOffset=function(a){switch(a.decoration.toLowerCase()){case "underline":return 8;case "line-through":return-3}return NaN}})},"esri/layers/vectorTiles/views/2d/engine/webgl/util/Matcher":function(){define(["require",
"exports","../../../../../core/tsSupport/extendsHelper","../../../../../core/Logger","../Utils"],function(k,b,a,c,e){Object.defineProperty(b,"__esModule",{value:!0});var g=c.getLogger("esri/views/2d/engine/webgl/util/Matcher");k=function(){function a(){this._defaultResult=null}a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=function(a,b){return this.getDefault()};return a}();
b.default=k;c=function(b){function c(a,c,d,g){var h=b.call(this)||this;h._intervals=[];h._isMaxInclusive=c;d?h._getValue=e.createArcadeFunction(d):a&&a.length?"function"===typeof a?(h._field=null,h._getValue=a):(h._field=a,h._normalizationInfo=g,h._getValue=h._getValueFromField.bind(h)):h._field=null;return h}a(c,b);c.prototype.add=function(a,b){this._intervals.push({interval:a,result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};c.prototype.size=function(){return b.prototype.size.call(this)+
this._intervals.length};c.prototype.match=function(a,b){if(!this._getValue)return this.getDefault();a=this._getValue(a,b);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++){var c=this._intervals[b],d=c.interval,c=c.result,e=this._isMaxInclusive?a<=d.max:a<d.max;if(a>=d.min&&e)return c}return this.getDefault()};c.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};
c.prototype._getValueFromField=function(a){var b=a.attributes[this._field];if(!this._needsNormalization())return b;var c=this._normalizationInfo,d=c.normalizationField,e=c.normalizationTotal,c=c.normalizationType;a=!!d&&a.attributes[d];if(c)switch(c){case "field":return(a||void 0)&&b/a;case "log":return Math.log(b)*Math.LOG10E;case "percent-of-total":return b/e*100;default:g.error("Found unknown normalization type: "+c)}else g.error("Normalization is required, but no type was set!")};return c}(k);
b.IntervalMatcher=c;k=function(b){function c(a,c,d){var h=b.call(this)||this;h._resultsMap=new Map;d?h._getValue=e.createArcadeFunction(d):a&&a.length?"function"===typeof a[0]?(h._fields=null,h._getValue=a[0]):(h._fields=a,h._seperator=c||"",h._getValue=h._getValueFromFields.bind(h)):h._fields=null;return h}a(c,b);c.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};c.prototype.size=function(){return b.prototype.size.call(this)+this._resultsMap.size};c.prototype.match=function(a,b){if(!this._getValue)return this.getDefault();
a=this._getValue(a,b);if(!a&&(null===a||void 0===a))return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};c.prototype._getValueFromFields=function(a){for(var b=[],c=0,d=this._fields;c<d.length;c++)b.push(a.attributes[d[c]]);return b.join(this._seperator)};return c}(k);b.MapMatcher=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",
{value:!0});var a=function(){function a(a,b,c){this.data=a;this.stride=b;this.vertexCount=c}a.decode=function(b){var c=new Uint32Array(b.data);return new a(c,b.stride,b.vertexCount)};return a}();b.default=a;k=function(){function b(a,b,c){this.geometryType=a;this.indexBuffer=new Uint32Array(b);this.namedBuffers=c}b.decode=function(c){var e=c.geometryType,l=c.indexBuffer,d={},h;for(h in c.namedBuffers)d[h]=a.decode(c.namedBuffers[h]);return new b(e,l,d)};return b}();b.VertexBuffers=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/util/Reader":function(){define(["require",
"exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../config ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ./CIMSymbolHelper ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFHelper ./SpriteMosaic ./Utils ../../../3d/support/imageUtils ../../../support/screenshotUtils ./SDFConverter".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x){function A(a){if(a.type){switch(t.normalizeSymbolType(a.type)){case "simple-marker":return a.path?"simple-marker"+a.style+a.path:"simple-marker"+a.style;case "simple-line":return"simple-line"+a.style}if(t.isPictureSymbol(a))return a.url?a.url:a.imageData+(""+a.width+a.height)}return JSON.stringify(a)}var z=e.getLogger("esri.views.2d.engine.webgl.TextureManager");return function(){function b(){this._invalidFontsMap=new Map;this._spriteMosaic=new q(1024,1024,
500);this._glyphSource=new m(a.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new h(1024,1024,this._glyphSource);this._sdfConverter=new x.default(126)}Object.defineProperty(b.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});b.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizationCanvas=
null};b.prototype.rasterizeItem=function(a,b){void 0===b&&(b=null);return a?a.type&&-1!==a.type.toLowerCase().indexOf("3d")?(z.error(new c("mapview-invalid-type","Mapviewer does not support 3d symbol type: "+a.type,a)),g.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!a.type||"text"!==a.type&&"esriTS"!==a.type?this._rasterizeSpriteSymbol(a).then(function(a){return{spriteMosaicItem:a}}):this._rasterizeTextSymbol(a,b).then(function(a){return{glyphMosaicItems:a}}):(z.error(new c("mapview-null-resource",
"Unable to rasterize null resource")),g.resolve(null))};b.prototype.bindSpritePage=function(a,b,c,f){f||(f=9729);this._spriteMosaic.bind(a,f,b,c)};b.prototype.bindGlyphsPage=function(a,b,c){this._glyphMosaic.bind(a,9729,b,c)};b.prototype._rasterizeTextSymbol=function(a,b){var f=this,e=d.getFullyQualifiedFontName(a.font);a=this._invalidFontsMap.has(e);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":e,b).catch(function(a){z.error(new c("mapview-invalid-resource","Couldn't find font "+
e+". Falling back to Arial Unicode MS Regular"));f._invalidFontsMap.set(e,!0);return f._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",b)})};b.prototype._rasterizeSpriteSymbol=function(a){var b=this;if(a&&(t.isFillSymbol(a)||t.isLineSymbol(a))&&"style"in a&&("solid"===a.style||"esriSFSSolid"===a.style||"esriSLSSolid"===a.style||"none"===a.style||"esriSFSNull"===a.style||"esriSLSNull"===a.style))return g.resolve(null);var c=A(a);if(this._spriteMosaic.has(c))return g.resolve(this._spriteMosaic.getSpriteItem(c));
if("simple-marker"!==a.type&&"esriSMS"!==a.type||!a.path){if(a.url||a.imageData)return u.requestImage(a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url).then(function(f){f=b._rasterizeResource(f);return b._addItemToMosaic(c,f.size,f.anchor,f.image,!t.isMarkerSymbol(a),f.sdf)});var f=this._rasterizeResource(a);return g.resolve(this._addItemToMosaic(c,f.size,f.anchor,f.image,!t.isMarkerSymbol(a),f.sdf))}var d=[126,126],e=this;return this._sdfConverter.draw(a.path).then(function(a){return e._addItemToMosaic(c,
d,[0,0],new Uint32Array(a.buffer),!1,!0)})};b.prototype._rasterizeResource=function(a){if(a instanceof HTMLImageElement){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var b=this._rasterizationCanvas.getContext("2d");b.drawImage(a,0,0,a.width,a.height);for(var b=b.getImageData(0,0,a.width,a.height),b=new Uint8Array(b.data),c=void 0,f=0;f<b.length;f+=4)c=b[f+3]/255,b[f]*=c,b[f+
1]*=c,b[f+2]*=c;var c=a.width,f=a.height,d=b;if(500<=c||500<=f)d=a.width/a.height,1<d?(c=500,f=Math.round(500/d)):(f=500,c=Math.round(500*d)),d=new Uint8Array(4*c*f),y.resampleHermite(b,a.width,a.height,new Uint8ClampedArray(d.buffer),c,f,!1);return{size:[c,f],anchor:[0,0],image:new Uint32Array(d.buffer),sdf:!1}}return this._rasterizeJSON(a)};b.prototype._addItemToMosaic=function(a,b,c,f,d,e){return this._spriteMosaic.addSpriteItem(a,b,c,f,d,e)};b.prototype._rasterizeJSON=function(a){this._rasterizationCanvas||
(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type){var b=l.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,a.style);a=b[0];var c=b[1],b=b[2];return{size:[c,b],anchor:[0,0],image:new Uint32Array(a.buffer),sdf:!1}}if("simple-line"===a.type||"esriSLS"===a.type)return b=l.SymbolHelper.rasterizeSimpleLine(this._rasterizationCanvas,a.style),a=b[0],c=b[1],b=b[2],{size:[c,b],anchor:[0,0],image:new Uint32Array(a.buffer),sdf:!0};"simple-marker"===
a.type||"esriSMS"===a.type?(a=l.CIMSymbolHelper.fromSimpleMarker(a),c=!0):c=p.SDFHelper.checkSDF(a);if(c)return c=(new p.SDFHelper).buildSDF(a),a=c[0],{size:[c[1],c[2]],anchor:[0,0],image:new Uint32Array(a.buffer),sdf:!0};var f=l.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a);a=f[0];c=f[1];b=f[2];return{size:[c,b],anchor:[f[3],f[4]],image:new Uint32Array(a.buffer),sdf:!1}};return b}()})},"esri/layers/vectorTiles/config":function(){define(["require","exports","esri/config"],function(k,b,a){Object.defineProperty(a,
"workers",{get:function(){return a.defaults.workers},set:function(b){return a.defaults.workers=b}});return a})},"esri/layers/vectorTiles/views/2d/engine/webgl/CIMSymbolHelper":function(){define("require exports ../../../../core/Logger ./CIMSymbolDrawHelper ./SDFHelper ../../../vectorTiles/GeometryUtils".split(" "),function(k,b,a,c,e,g){Object.defineProperty(b,"__esModule",{value:!0});var l=a.getLogger("esri/views/2d/engine/webgl/CIMSymbolHelper");k=function(){function a(){}a.getEnvelope=function(a){if("CIMPointSymbol"!==
a.type)return null;var b=new c.EnvDrawHelper;b.drawSymbol(a,{type:"point",x:0,y:0});return b.envelope()};a.rasterize=function(a,b){var d=this.getEnvelope(b);if(!d||0>=d.width||0>=d.height)return[null,0,0,0,0];var e=96/72,h=(d.x+.5*d.width)*e,g=-(d.y+.5*d.height)*e;a.width=d.width*e+2;a.height=d.height*e+2;d=a.getContext("2d");e=c.Transformation.createScale(e,-e);e.translate(.5*a.width-h,.5*a.height-g);(new c.CanvasDrawHelper(d,e)).drawSymbol(b,{type:"point",x:0,y:0});b=d.getImageData(0,0,a.width,
a.height);b=new Uint8Array(b.data);for(d=0;d<b.length;d+=4)e=b[d+3]/255,b[d]*=e,b[d+1]*=e,b[d+2]*=e;return[b,a.width,a.height,h/a.width,g/a.height]};a.fromSimpleMarker=function(a){var b,c,d=a.style;if("circle"===d||"esriSMSCircle"===d){b=Math.acos(.995);c=Math.ceil(g.C_PI/b/4);0===c&&(c=1);b=g.C_PI_BY_2/c;c*=4;d=[];d.push([50,0]);for(var e=1;e<c;e++)d.push([50*Math.cos(e*b),-50*Math.sin(e*b)]);d.push([50,0]);b={rings:[d]};c={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===d||"esriSMSCross"===
d)b=0,b={rings:[[[b,50],[b,b],[50,b],[50,-b],[b,-b],[b,-50],[-b,-50],[-b,-b],[-50,-b],[-50,b],[-b,b],[-b,50],[b,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===d||"esriSMSDiamond"===d)b={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===d||"esriSMSSquare"===d)b={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===d||"esriSMSX"===d)b=0,b={rings:[[[0,b],[50-b,50],[50,50-
b],[b,0],[50,b-50],[50-b,-50],[0,-b],[b-50,-50],[-50,b-50],[-b,0],[-50,50-b],[b-50,50],[0,b]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===d||"esriSMSTriangle"===d)c=2/3*100,d=c-100,b={rings:[[[-57.735026918962575,d],[0,c],[57.735026918962575,d],[-57.735026918962575,d]]]},c={xmin:-57.735026918962575,ymin:d,xmax:57.735026918962575,ymax:c};var h;b&&c&&(h=[{type:"CIMSolidFill",enable:!0,color:a.color}],a.outline&&h.push({type:"CIMSolidStroke",enable:!0,width:a.outline.width,color:a.outline.color}),
h={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:a.angle,size:a.size,offsetX:a.xoffset,offsetY:a.yoffset,frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:b,symbol:{type:"CIMPolygonSymbol",symbolLayers:h}}]}]});return h};return a}();b.CIMSymbolHelper=k;k=function(){function a(){}a.rasterizeSimpleFill=function(a,b){"solid"!==b&&"none"!==b&&"esriSFSSolid"!==b&&"esriSFSNull"!==b||console.error("Unexpected: style does not require rasterization");a.width=8;a.height=
8;var c=a.getContext("2d");c.strokeStyle="#FFFFFF";c.beginPath();if("vertical"===b||"cross"===b||"esriSFSCross"===b||"esriSFSVertical"===b)c.moveTo(0,0),c.lineTo(0,8);if("horizontal"===b||"cross"===b||"esriSFSCross"===b||"esriSFSHorizontal"===b)c.moveTo(0,0),c.lineTo(8,0);if("forward-diagonal"===b||"diagonal-cross"===b||"esriSFSDiagonalCross"===b||"esriSFSForwardDiagonal"===b)c.moveTo(0,0),c.lineTo(8,8);if("backward-diagonal"===b||"diagonal-cross"===b||"esriSFSBackwardDiagonal"===b||"esriSFSDiagonalCross"===
b)c.moveTo(8,0),c.lineTo(0,8);c.stroke();b=c.getImageData(0,0,a.width,a.height);b=new Uint8Array(b.data);for(var d=0;d<b.length;d+=4)c=b[d+3]/255,b[d]*=c,b[d+1]*=c,b[d+2]*=c;return[b,a.width,a.height]};a.rasterizeSimpleLine=function(a,b){var c;switch(b){case "dash":case "esriSLSDash":c=[3,2];break;case "dash-dot":case "esriSLSDashDot":c=[2,2,0,2];break;case "dot":case "esriSLSDot":c=[0,3];break;case "long-dash":case "esriSLSLongDash":c=[6,3];break;case "long-dash-dot":case "esriSLSLongDashDot":c=
[6,3,0,3];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":c=[2,2,0,2,0,2];break;case "short-dash":case "esriSLSShortDash":c=[2,2];break;case "short-dash-dot":case "esriSLSShortDashDot":c=[2,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":c=[2,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":c=[0,2];break;case "solid":case "esriSLSSolid":case "none":l.error("Unexpected: style does not require rasterization");c=[0,0];break;default:l.error("Tried to rasterize SLS, but found an unexpected style: "+
b+"!"),c=[0,0]}b=a=0;for(var d=c;b<d.length;b++){var h=d[b];a+=h}a*=16;d=31*a;b=new Float32Array(d);for(h=0;h<d;++h)b[h]=257;for(var g=d=.5,m=!0,k=0;k<c.length;k++){for(var h=c[k],d=g,g=g+16*h,A=d;A<g;){for(var z=.5;31>z;){var h=(31-z+1.5)*a+A-.5,f=(z-15.5)*(z-15.5);b[h]=m?f:Math.min((A-d)*(A-d)+f,(A-g)*(A-g)+f);z++}A++}m=!m}c=b.length;d=new Uint8Array(4*c);for(h=0;h<c;++h)e.packFloat(Math.sqrt(b[h])/15,d,4*h);return[d,a,31]};return a}();b.SymbolHelper=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/CIMSymbolDrawHelper":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ./GeometryUtils ./Rect".split(" "),
function(k,b,a,c,e,g){Object.defineProperty(b,"__esModule",{value:!0});var l=function(){function a(a){this._t=a}a.createIdentity=function(){return new a([1,0,0,0,1,0])};a.prototype.clone=function(){return new a(this._t.slice())};a.prototype.transform=function(a){var b=this._t;return[b[0]*a[0]+b[1]*a[1]+b[2],b[3]*a[0]+b[4]*a[1]+b[5]]};a.createScale=function(b,c){return new a([b,0,0,0,c,0])};a.prototype.scale=function(a,b){var c=this._t;c[0]*=a;c[1]*=a;c[2]*=a;c[3]*=b;c[4]*=b;c[5]*=b;return this};a.prototype.scaleRatio=
function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};a.createTranslate=function(b,c){return new a([0,0,b,0,0,c])};a.prototype.translate=function(a,b){var c=this._t;c[2]+=a;c[5]+=b;return this};a.createRotate=function(b){var c=Math.cos(b);b=Math.sin(b);return new a([c,-b,0,b,c,0])};a.prototype.rotate=function(b){return this.multiply(a.createRotate(b))};a.prototype.multiply=function(a){var b=this._t;a=a._t;var c=b[1]*a[0]+b[4]*a[1],d=b[2]*a[0]+b[5]*a[1]+a[2],e=b[0]*a[3]+b[3]*a[4],
h=b[1]*a[3]+b[4]*a[4],g=b[2]*a[3]+b[5]*a[4]+a[5];b[0]=b[0]*a[0]+b[3]*a[1];b[1]=c;b[2]=d;b[3]=e;b[4]=h;b[5]=g;return this};return a}();b.Transformation=l;k=function(){function a(a){this._transfos=[];this._sizeTransfos=[];this._transfos.push(a||l.createIdentity());this._sizeTransfos.push(a?a.scaleRatio():1)}a.prototype.transformPt=function(a){return this._transfos[this._transfos.length-1].transform(a)};a.prototype.transformSize=function(a){return a*this._sizeTransfos[this._sizeTransfos.length-1]};a.prototype.back=
function(){return this._transfos[this._transfos.length-1]};a.prototype.push=function(a){var b=a.scaleRatio();a.multiply(this.back());this._transfos.push(a);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*b)};a.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};a.prototype.drawSolidFill=function(a,b){};a.prototype.drawSolidStroke=function(a,b,c){};a.prototype.drawSymbol=function(a,b){if(a)switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(a,
b)}};a.prototype.drawMultiLayerSymbol=function(a,b){if(a&&(a=a.symbolLayers))for(var c=a.length;c--;){var d=a[c];if(d&&d.enable)switch(d.type){case "CIMSolidFill":this.drawSolidFill(b,d.color);break;case "CIMSolidStroke":this.drawSolidStroke(b,d.color,d.width);break;case "CIMVectorMarker":this.drawVectorMarker(d,b)}}};a.prototype.drawVectorMarker=function(a,b){if(a){var c=a.markerGraphics;if(c){var d=a.size,g=a.frame,h=g?g.ymax-g.ymin:0,h=d&&h?d/h:1,m=l.createIdentity();g&&m.translate(.5*-(g.xmax+
g.xmin),.5*-(g.ymax+g.ymin));var k=a.anchorPt;if(k){var A=k.x,k=k.y;"relative"===a.anchorPtUnits&&g&&(A*=(g.xmax-g.xmin)*h,k*=d);m.translate(-A,-k)}1!==h&&m.scale(h,h);a.rotation&&m.rotate(a.rotation*e.C_DEG_TO_RAD);m.translate(a.offsetX||0,a.offsetY||0);m.translate(b.x,b.y);this.push(m);for(a=0;a<c.length;a++)(b=c[a])&&this.drawSymbol(b.symbol,b.geometry);this.pop()}}};return a}();b.CIMSymbolDrawHelper=k;c=function(b){function c(){var a=b.call(this)||this;a._xmin=a._ymin=Infinity;a._xmax=a._ymax=
-Infinity;return a}a(c,b);c.prototype.envelope=function(){return new g(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};c.prototype._merge=function(a,b){a[0]-b<this._xmin&&(this._xmin=a[0]-b);a[0]+b>this._xmax&&(this._xmax=a[0]+b);a[1]-b<this._ymin&&(this._ymin=a[1]-b);a[1]+b>this._ymax&&(this._ymax=a[1]+b)};c.prototype.drawSolidFill=function(a,b){b=0;for(a=a.rings;b<a.length;b++){var c=a[b],d=c?c.length:0;if(2<d){this._merge(this.transformPt(c[0]),0);for(var e=1;e<d;++e)this._merge(this.transformPt(c[e]),
0)}}};c.prototype.drawSolidStroke=function(a,b,c){b=.5*this.transformSize(c);c=0;for(a=a.rings||a.paths;c<a.length;c++){var d=a[c],e=d?d.length:0;if(1<e){this._merge(this.transformPt(d[0]),b);for(var g=1;g<e;++g)this._merge(this.transformPt(d[g]),b)}}};return c}(k);b.EnvDrawHelper=c;k=function(b){function c(a,c){c=b.call(this,c)||this;c._ctx=a;return c}a(c,b);c.prototype.drawSolidFill=function(a,b){var c=this._ctx;c.fillStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+
b[3]/255+")";c.beginPath();b=0;for(a=a.rings;b<a.length;b++){var d=a[b],e=d?d.length:0;if(2<e){var g=this.transformPt(d[0]);c.moveTo(g[0],g[1]);for(var h=1;h<e;++h)g=this.transformPt(d[h]),c.lineTo(g[0],g[1]);c.closePath()}}c.fill("evenodd")};c.prototype.drawSolidStroke=function(a,b,c){var d=this._ctx;d.strokeStyle="rgba("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+","+b[3]/255+")";d.lineWidth=this.transformSize(c)+.5;d.beginPath();b=!!a.rings;c=0;for(a=a.rings||a.paths;c<a.length;c++){var e=
a[c],g=e?e.length:0;if(1<g){var h=this.transformPt(e[0]);d.moveTo(h[0],h[1]);for(var m=1;m<g;++m)h=this.transformPt(e[m]),d.lineTo(h[0],h[1]);b&&d.closePath()}}d.stroke()};return c}(k);b.CanvasDrawHelper=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/SDFHelper":function(){define(["require","exports","./Geometry","./Rect","../../../3d/webgl-engine/lib/Util"],function(k,b,a,c,e){function g(a,b,c){e.packFloatRGBA(a,b,c)}Object.defineProperty(b,"__esModule",{value:!0});b.packFloat=g;k=function(){function b(){}
b.checkSDF=function(a){return!0};b.prototype._extractGeometry=function(b){if(!b)return null;b=b.symbolLayers;if(!b||1!==b.length)return null;b=b[0];if(!b)return null;b=b.markerGraphics;if(!b||1!==b.length)return null;b=b[0];if(!b)return null;var c=b.geometry;if(!c||!c.rings)return null;b=[];for(var d=0,c=c.rings;d<c.length;d++){for(var e=[],g=0,l=c[d];g<l.length;g++){var k=l[g];e.push(new a.Point(k[0],k[1]))}b.push(e)}return b};b.prototype._getEnvelope=function(a){for(var b=Infinity,d=-Infinity,e=
Infinity,g=-Infinity,l=0;l<a.length;l++)for(var k=0,y=a[l];k<y.length;k++){var x=y[k];x.x<b&&(b=x.x);x.x>d&&(d=x.x);x.y<e&&(e=x.y);x.y>g&&(g=x.y)}return new c(b,e,d-b,g-e)};b.prototype.buildSDF=function(a){a=this._extractGeometry(a);if(!a)return null;var b=this._getEnvelope(a);if(0>=b.width||0>=b.height)return null;for(var c=Math.floor(31.5),d=(128-2*(c+0+1))/Math.max(b.width,b.height),e=Math.round(b.width*d),g=Math.round(b.height*d),l=e+2*c,k=g+2*c,x=0;x<a.length;x++)for(var A=0,z=a[x];A<z.length;A++){var f=
z[A];f.x-=b.x;f.y-=b.y;f.x*=d;f.y*=d;f.x+=c-.5;f.y+=c-.5}b=this._dist_map(a,l,k,c);this._sign_dist_map(a,l,k,c,b);return[this._encodeDistMap(b,c),l,k,e,g,d]};b.prototype._dist_map=function(a,b,c,e){for(var d=b*c,g=new Float32Array(d),h=e*e+1,m=0;m<d;++m)g[m]=h;for(h=0;h<a.length;h++)for(var l=a[h],k=l.length,m=1;m<k;++m){var p=l[m-1],f=l[m],n=void 0,r=void 0;p.x<f.x?(n=p.x,r=f.x):(n=f.x,r=p.x);var B=void 0,C=void 0;p.y<f.y?(B=p.y,C=f.y):(B=f.y,C=p.y);var D=Math.floor(n)-e,r=Math.floor(r)+e,B=Math.floor(B)-
e,C=Math.floor(C)+e;0>D&&(D=0);r>b&&(r=b);0>B&&(B=0);C>c&&(C=c);for(var n=f.x-p.x,F=f.y-p.y,H=n*n+F*F;D<r;D++)for(var J=B;J<C;J++){var I=(D-p.x)*n+(J-p.y)*F,G=void 0,Q=void 0;0>I?(G=p.x,Q=p.y):I>H?(G=f.x,Q=f.y):(I/=H,G=p.x+I*n,Q=p.y+I*F);I=(D-G)*(D-G)+(J-Q)*(J-Q);G=(c-J-1)*b+D;I<g[G]&&(g[G]=I)}}for(m=0;m<d;++m)g[m]=Math.sqrt(g[m]);return g};b.prototype._sign_dist_map=function(a,b,c,e,g){for(var d=0;d<a.length;d++)for(var h=a[d],m=h.length,l=1;l<m;++l){var p=h[l-1],k=h[l],f=void 0,n=void 0;p.x<k.x?
(f=p.x,n=k.x):(f=k.x,n=p.x);var r=void 0,q=void 0;p.y<k.y?(r=p.y,q=k.y):(r=k.y,q=p.y);f=Math.floor(f);n=Math.floor(n)+1;r=Math.floor(r);q=Math.floor(q)+1;f<e&&(f=e);n>b-e&&(n=b-e);r<e&&(r=e);for(q>c-e&&(q=c-e);r<q;++r)if(p.y>r!==k.y>r){for(var C=(c-r-1)*b,D=f;D<n;++D)D<(k.x-p.x)*(r-p.y)/(k.y-p.y)+p.x&&(g[C+D]=-g[C+D]);for(D=e;D<f;++D)g[C+D]=-g[C+D]}}};b.prototype._encodeDistMap=function(a,b){b*=2;for(var c=a.length,d=new Uint8Array(4*c),e=0;e<c;++e)g(.5-a[e]/b,d,4*e);return d};return b}();b.SDFHelper=
k})},"esri/layers/vectorTiles/views/3d/webgl-engine/lib/Util":function(){define(["require","exports","../../support/geometryUtils","./gl-matrix"],function(k,b,a,c){function e(a,b){if(!a)throw a=Error("dummy"),a.stack&&console.log(a.stack),new ba(b);}function g(a,b,c){return a<b?b:a>c?c:a}function l(a){return a/180*Math.PI}function d(a){return 180*a/Math.PI}function h(a,b,f){c.mat4d.multiply(b,a,x);c.mat4d.inverse(x);for(a=0;8>a;++a)c.mat4d.multiplyVec4(x,A[a],z),c.vec3d.set3(z[0]/z[3],z[1]/z[3],z[2]/
z[3],f[a])}function m(b,c){a.plane.fromPoints(b[4],b[0],b[3],c[0]);a.plane.fromPoints(b[1],b[5],b[6],c[1]);a.plane.fromPoints(b[4],b[5],b[1],c[2]);a.plane.fromPoints(b[3],b[2],b[6],c[3]);a.plane.fromPoints(b[0],b[1],b[2],c[4]);a.plane.fromPoints(b[5],b[4],b[7],c[5])}function p(a,c,f,d){var e=6378137/Math.sqrt(1-b.ECCENTRICITY_SQUARED*Math.pow(Math.sin(a),2)),n=Math.cos(a);d[0]=(e+f)*Math.cos(c)*n;d[1]=(e*(1-b.ECCENTRICITY_SQUARED)+f)*Math.sin(a);d[2]=-(e+f)*Math.sin(c)*n}function q(a){for(var b in a)return b}
function t(a,b){a[12]=b[0];a[13]=b[1];a[14]=b[2]}function u(a,b){void 0===b&&(b=0);for(var c=0,f=0;4>f;f++)c+=a[b+f]*ha[f];return c}function y(a){return a-Math.floor(a)}Object.defineProperty(b,"__esModule",{value:!0});var x=c.mat4d.create(),A=[c.vec4d.createFrom(-1,-1,-1,1),c.vec4d.createFrom(1,-1,-1,1),c.vec4d.createFrom(1,1,-1,1),c.vec4d.createFrom(-1,1,-1,1),c.vec4d.createFrom(-1,-1,1,1),c.vec4d.createFrom(1,-1,1,1),c.vec4d.createFrom(1,1,1,1),c.vec4d.createFrom(-1,1,1,1)],z=c.vec4d.create(),f=
[c.vec3d.create(),c.vec3d.create(),c.vec3d.create(),c.vec3d.create(),c.vec3d.create(),c.vec3d.create(),c.vec3d.create(),c.vec3d.create()],n=c.vec3d.create(),r=c.vec3d.create(),B=c.vec3d.create(),C=c.vec3d.create(),D=c.vec3d.create(),F=c.vec3d.create(),H=c.vec3d.create(),J=c.vec3d.create(),I=c.vec3d.create(),G=c.vec3d.create(),Q=c.vec3d.create(),W=c.vec3d.create(),K=c.vec3d.create(),aa=c.vec3d.createFrom(0,0,0),ba=function(){function a(a){this.message=a}a.prototype.toString=function(){return"AssertException: "+
this.message};return a}();b.AssertException=ba;b.EARTH_RADIUS=6378137;b.METER2FEET=3.28084;b.ECCENTRICITY_SQUARED=.0066943799901414;b.VertexAttrConstants={POSITION:"position",NORMAL:"normal",NORMALCOMPRESSED:"normalCompressed",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region",COMPONENTINDEX:"componentIndex"};b.assert=e;b.verify=function(a,b){a||(console.log("Verify failed: "+b),console.log(Error("dummy").stack))};b.isPowerOfTwo=function(a){return 0===
(a&a-1)};b.lerp=function(a,b,c){return a+(b-a)*c};b.clamp=g;b.encodeInt16=function(a){return g(Math.round(32767*a),-32767,32767)};b.encodeNormal=function(a,b){var c=Math.abs(a[0]),f=Math.abs(a[1]),d=1/(c+f+Math.abs(a[2])),c=c*d,f=f*d,d=Math.min(a[2]*d,0);b[0]=ca(a[0])*(c-d);b[1]=ca(a[1])*(f-d)};var ca="function"===typeof Math.sign?Math.sign:function(a){return+(0<a)-+(0>a)||0};b.fallbackIfUndefined=function(a,b){return void 0===a?b:a};b.hex2rgb=function(a){a=Math.floor(a);return[(a>>16&255)/255,(a>>
8&255)/255,(a&255)/255]};b.rgb2hex=function(a){var b=g(Math.round(255*a[0]),0,255),c=g(Math.round(255*a[1]),0,255);a=g(Math.round(255*a[2]),0,255);return"0x"+((b<<16)+(c<<8)+a).toString(16)};b.dec2hex=function(a){a=a.toString(16);return"00000000".substr(0,8-a.length)+a};b.deg2rad=l;b.rad2deg=d;b.azimuthElevationAngle2Direction=function(a,b){a=1.5*Math.PI-a;b=.5*Math.PI-b;return[Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b)]};b.raySphere=function(a,b,f,d,e){f=f||aa;var g=c.vec3d.subtract(a,
f,n);f=c.vec3d.dot(b,b);var h=2*c.vec3d.dot(b,g);d=c.vec3d.dot(g,g)-d*d;d=h*h-4*f*d;if(0>d)return!1;g=Math.sqrt(d);d=(-h-g)/(2*f);f=(-h+g)/(2*f);if(0>d||f<d&&0<f)d=f;return 0<d?(e&&c.vec3d.add(a,c.vec3d.scale(b,d,K),e),!0):!1};b.rayTriangle3D=function(a,b,f,d,e,n,g,h,m){void 0===m&&(m=c.vec3d.create());var l=d[g]-f[n],r=d[g+1]-f[n+1],p=d[g+2]-f[n+2];d=e[h]-f[n];g=e[h+1]-f[n+1];e=e[h+2]-f[n+2];var k=b[1]*e-g*b[2],q=b[2]*d-e*b[0],B=b[0]*g-d*b[1];h=l*k+r*q+p*B;if(-1E-5<h&&1E-5>h)return!1;h=1/h;var t=
a[0]-f[n],C=a[1]-f[n+1];a=a[2]-f[n+2];m[1]=h*(t*k+C*q+a*B);if(0>m[1]||1<m[1])return!1;f=C*p-r*a;a=a*l-p*t;l=t*r-l*C;m[2]=h*(b[0]*f+b[1]*a+b[2]*l);if(0>m[2]||1<m[1]+m[2])return!1;m[0]=h*(d*f+g*a+e*l);return!0};b.rayBoxTest=function(a,b,c,f){var d,e=(c[0]-a[0])/b[0],n=(f[0]-a[0])/b[0];e>n&&(d=e,e=n,n=d);var g=(c[1]-a[1])/b[1],h=(f[1]-a[1])/b[1];g>h&&(d=g,g=h,h=d);if(e>h||g>n)return!1;g>e&&(e=g);h<n&&(n=h);c=(c[2]-a[2])/b[2];a=(f[2]-a[2])/b[2];c>a&&(d=c,c=a,a=d);if(e>a||c>n)return!1;a<n&&(n=a);return 0>
n?!1:!0};b.rayRay2D=function(a,b,f,d,e,n){void 0===n&&(n=c.vec2d.create());var g=(d[e]-f[e])*(b[0]-a[0])-(d[0]-f[0])*(b[e]-a[e]);if(0===g)return!1;f=((d[0]-f[0])*(a[e]-f[e])-(d[e]-f[e])*(a[0]-f[0]))/g;n[0]=a[0]+f*(b[0]-a[0]);n[1]=a[e]+f*(b[e]-a[e]);return!0};b.matrixToFrustumPoints=h;b.matrixToFrustumPlanes=function(a,b,c,d){void 0===d&&(d=c,c=f);h(a,b,c);m(c,d)};b.frustumPointsToPlanes=m;b.project=function(a,b,f,d,n){n||(n=a);z[0]=a[0];z[1]=a[1];z[2]=a[2];z[3]=1;c.mat4d.multiplyVec4(b,z);2<n.length&&
(n[2]=-z[2]);c.mat4d.multiplyVec4(f,z);e(0!==z[3]);n[0]=z[0]/z[3];n[1]=z[1]/z[3];n[2]=z[2]/z[3];n[0]=(.5*n[0]+.5)*d[2]+d[0];n[1]=(.5*n[1]+.5)*d[3]+d[1]};b.geodeticToGeocentricLatidude=function(a){return Math.atan((1-b.ECCENTRICITY_SQUARED)*Math.tan(a))};b.latLon2positionWGS84Ellipsoid=p;b.pos2latLon=function(a,b){var f=c.vec3d.length(a);b[0]=Math.asin(g(a[1]/f,-1,1));b[1]=(0>a[2]?1:-1)*Math.acos(g(a[0]/(Math.cos(b[0])*f),-1,1));b[0]=d(b[0]);b[1]=d(b[1]);b[2]=f};b.pos2latLonWGS84Ellipsoid=function(a,
c){var f=a[0],d=-a[2],e=a[1],n=Math.sqrt(Math.pow(6378137,2)*(1-b.ECCENTRICITY_SQUARED));a=Math.sqrt(Math.pow(f,2)+Math.pow(d,2));var g=Math.atan2(6378137*e,n*a),f=Math.atan2(d,f),d=Math.atan2(e+Math.pow(Math.sqrt((Math.pow(6378137,2)-Math.pow(n,2))/Math.pow(n,2)),2)*n*Math.pow(Math.sin(g),3),a-6378137*b.ECCENTRICITY_SQUARED*Math.pow(Math.cos(g),3));a=a/Math.cos(d)-6378137/Math.sqrt(1-b.ECCENTRICITY_SQUARED*Math.pow(Math.sin(d),2))+b.EARTH_RADIUS;c[0]=d;c[1]=f;c[2]=a};b.computeGlobeTransformation=
function(a,b,f){var d=l(a[0]);a=l(a[1]);p(d,a,b,r);c.mat4d.translate(f,r);c.mat4d.rotateY(f,.5*Math.PI+a);c.mat4d.rotateX(f,.5*Math.PI-d);return f};b.readUInt16=function(a,b){return a[b]+(a[b+1]<<8)};b.readUInt32=function(a,b){return a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24)};b.setIfDefined=function(a,b,c){void 0!==b[a]&&(c[a]=b[a])};b.array2object=function(a,b){var c={};if(void 0!==b)for(var f=0;f<a.length;f++){var d=a[f];c[b(d)]=d}else for(b=0;b<a.length;b++)d=a[b],c[d]=d;return c};b.object2array=
function(a){var b=[],c;for(c in a)b.push(a[c]);return b};b.mergeObjects=function(a,b,c){void 0===c&&(c={});if(c!==a)for(var f in a)c[f]=a[f];if(c!==b)for(var d in b)c[d]=b[d];return c};b.subtractObjects=function(a,b){var c={},f;for(f in a)void 0===b[f]&&(c[f]=a[f]);return c};b.intersectObjects=function(a,b){var c={},f;for(f in a)void 0!==b[f]&&(c[f]=a[f]);return c};b.getFirstObjectKey=q;b.getFirstObjectValue=function(a){return a[q(a)]};b.objectEmpty=function(a){for(var b in a)return!1;return!0};b.byteBuffer2base64image=
function(a,b,c,f,d){var n=4*b;e(a.length===n*c,"buffer length must match image resolution");var g=document.createElement("canvas");g.width=b;g.height=c;var h=g.getContext("2d");b=h.getImageData(0,0,b,c);for(var m=b.data,l=0;l<c;++l)for(var r=l*n,p=(c-1-l)*n,k=0;k<n;++k)m[r++]=a[p++];h.putImageData(b,0,0);return g.toDataURL(f,d)};b.cround=function(a){return Math.round(100*a)/100};b.logWithBase=function(a,b){return Math.log(a)/Math.log(b)};b.setMatrixTranslation=t;b.setMatrixTranslation3=function(a,
b,c,f){a[12]=b;a[13]=c;a[14]=f};b.getMatrixTranslation=function(a,b){void 0===b&&(b=c.vec3d.create());b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};b.createTranslationMatrix=function(a,b){a=c.mat4d.identity(a);t(a,b);return a};b.isTranslationMatrix=function(a){return 1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&0===a[4]&&1===a[5]&&0===a[6]&&0===a[7]&&0===a[8]&&0===a[9]&&1===a[10]&&0===a[11]&&1===a[15]};b.fovx2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/b)};b.fovy2fovx=function(a,b,c){return 2*
Math.atan(b*Math.tan(.5*a)/c)};b.fovx2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/b)};b.fovy2fovd=function(a,b,c){return 2*Math.atan(Math.sqrt(b*b+c*c)*Math.tan(.5*a)/c)};b.fovd2fovx=function(a,b,c){return 2*Math.atan(b*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};b.fovd2fovy=function(a,b,c){return 2*Math.atan(c*Math.tan(.5*a)/Math.sqrt(b*b+c*c))};b.nextHighestPowerOfTwo=function(a){--a;for(var b=1;32>b;b<<=1)a|=a>>b;return a+1};b.nextHighestPowerOfTen=function(a){return Math.pow(10,
Math.ceil(Math.LOG10E*Math.log(a)))};b.lineLineDistanceSquared3D=function(a,b,f,d,e){B[0]=a[0]-f[0];B[1]=a[1]-f[1];B[2]=a[2]-f[2];C[0]=d[0]-f[0];C[1]=d[1]-f[1];C[2]=d[2]-f[2];if(1E-4>Math.abs(C[0])&&1E-4>Math.abs(C[1])&&1E-4>Math.abs(C[2]))return e.success=!1,e;D[0]=b[0]-a[0];D[1]=b[1]-a[1];D[2]=b[2]-a[2];if(1E-4>Math.abs(D[0])&&1E-4>Math.abs(D[1])&&1E-4>Math.abs(D[2]))return e.success=!1,e;b=B[0]*C[0]+B[1]*C[1]+B[2]*C[2];d=C[0]*D[0]+C[1]*D[1]+C[2]*D[2];var n=B[0]*D[0]+B[1]*D[1]+B[2]*D[2],h=C[0]*
C[0]+C[1]*C[1]+C[2]*C[2],m=(D[0]*D[0]+D[1]*D[1]+D[2]*D[2])*h-d*d;if(1E-4>Math.abs(m))return e.success=!1,e;n=g((b*d-n*h)/m,0,1);b=g((b+d*n)/h,0,1);F[0]=a[0]+n*D[0];F[1]=a[1]+n*D[1];F[2]=a[2]+n*D[2];H[0]=f[0]+b*C[0];H[1]=f[1]+b*C[1];H[2]=f[2]+b*C[2];a=c.vec3d.dist2(F,H);e.success=!0;e.dist2=a;e.pa=F;e.pb=H;return e};b.pointLineSegmentDistanceSquared2D=function(a,b,f){Q[0]=b[0]-a[0];Q[1]=b[1]-a[1];Q[2]=0;W[0]=f[0]-a[0];W[1]=f[1]-a[1];W[2]=0;K[0]=f[0];K[1]=f[1];K[2]=0;b=c.vec2d.dot(W,Q);f=c.vec2d.dot(Q,
Q);b=g(b/f,0,1);G[0]=Q[0]*b;G[1]=Q[1]*b;J[0]=a[0]+G[0];J[1]=a[1]+G[1];c.vec2d.subtract(K,J,I);a=c.vec2d.dot(I,I);b=c.vec2d.dot(W,W);f=c.vec2d.dot(Q,Q);var d=c.vec2d.dot(G,G);if(d>b||d>f)a=Number.MAX_VALUE;return a};b.packFloatRGBA=function(a,b,c){void 0===c&&(c=0);a=g(a,0,U);for(var f=0;4>f;f++)b[c+f]=Math.floor(256*y(a*ea[f]))};b.unpackFloatRGBA=u;var ea=[1,256,65536,16777216],ha=[1/256,1/65536,1/16777216,1/4294967296],U=u(new Uint8ClampedArray([255,255,255,255]));b.inverseProjectionInfo=function(a,
b,f,d,e){0===a[11]?(d[0]=2/(b*a[0]),d[1]=2/(f*a[5]),d[2]=(1+a[12])/a[0],d[3]=(1+a[13])/a[5],c.vec2d.set2(0,1,e)):(d[0]=-2/(b*a[0]),d[1]=-2/(f*a[5]),d[2]=(1-a[8])/a[0],d[3]=(1-a[9])/a[5],c.vec2d.set2(1,0,e))}})},"esri/layers/vectorTiles/views/3d/support/geometryUtils":function(){define(["require","exports","./geometryUtils/lineSegment","./geometryUtils/plane","./geometryUtils/triangle"],function(k,b,a,c,e){Object.defineProperty(b,"__esModule",{value:!0});b.plane=c;b.triangle=e;b.lineSegment=a})},"esri/layers/vectorTiles/views/3d/support/geometryUtils/lineSegment":function(){define(["require",
"exports","../../lib/glMatrix","../mathUtils"],function(k,b,a,c){function e(b,c){void 0===b&&(b=a.vec3d.create());void 0===c&&(c=a.vec3d.create());return{origin:b,vector:c}}Object.defineProperty(b,"__esModule",{value:!0});b.create=e;b.fromOriginAndVector=function(b,c,g){void 0===g&&(g=e());a.vec3d.set(b,g.origin);a.vec3d.set(c,g.vector);return g};b.distance2=function(b,d){d=a.vec3d.subtract(d,b.origin);var e=a.vec3d.dot(b.vector,d),m=a.vec3d.dot(b.vector,b.vector),e=c.clamp(e/m,0,1);b=a.vec3d.subtract(a.vec3d.scale(b.vector,
e,g),d,g);return a.vec3d.dot(b,b)};var g=a.vec3d.create()})},"esri/layers/vectorTiles/views/3d/support/geometryUtils/plane":function(){define(["require","exports","../../lib/glMatrix"],function(k,b,a){function c(a){void 0===a&&(a=b.UP);return[a[0],a[1],a[2],a[3]]}function e(b,d,e){void 0===e&&(e=c());a.vec3d.set(d,e);e[3]=-a.vec3d.dot(d,b);return e}function g(b,d,g,l){void 0===l&&(l=c());a.vec3d.cross(d,b,h);return e(g,a.vec3d.normalize(h),l)}Object.defineProperty(b,"__esModule",{value:!0});b.create=
c;b.fromValues=function(a,b,d,e,g){void 0===g&&(g=c());g[0]=a;g[1]=b;g[2]=d;g[3]=e;return g};b.fromNormalAndOffset=function(b,d,e){void 0===e&&(e=c());a.vec3d.set(b,e);e[3]=d;return e};b.fromPositionAndNormal=e;b.projectVector=function(b,c,e){void 0===e&&(e=c);return a.vec3d.cross(b,a.vec3d.cross(c,b,d),e)};b.distance=function(b,c){return a.vec3d.dot(b,c)+b[3]};b.fromPoints=function(b,e,h,k){void 0===k&&(k=c());return g(a.vec3d.subtract(b,e,l),a.vec3d.subtract(h,e,d),b,k)};b.set=function(a,b){a[0]=
b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};b.negate=function(a,b){void 0===b&&(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};b.fromVectorsAndPoint=g;b.intersectRay=function(b,c,d,e){var g=a.vec3d.dot(b,d);if(0===g)return!1;b=-(a.vec3d.dot(b,c)+b[3])/g;a.vec3d.add(c,a.vec3d.scale(d,b,e),e);return!0};b.UP=[0,0,1,0];var l=a.vec3d.create(),d=a.vec3d.create(),h=a.vec3d.create()})},"esri/layers/vectorTiles/views/3d/support/geometryUtils/triangle":function(){define(["require","exports","../../lib/glMatrix",
"./lineSegment"],function(k,b,a,c){function e(b,c,d){var e=a.vec2d.dist(b,c);c=a.vec2d.dist(c,d);b=a.vec2d.dist(d,b);d=(e+c+b)/2;return Math.sqrt(d*(d-e)*(d-c)*(d-b))}Object.defineProperty(b,"__esModule",{value:!0});b.create=function(b,c,d){void 0===b&&(b=a.vec3d.create());void 0===c&&(c=a.vec3d.create());void 0===d&&(d=a.vec3d.create());return{p0:b,p1:c,p2:d}};b.distance2=function(b,e){var k=b.p0,u=b.p1;b=b.p2;var y=a.vec3d.subtract(u,k,g),f=a.vec3d.subtract(b,u,l),n=a.vec3d.subtract(k,b,d),r=a.vec3d.subtract(e,
k,h),B=a.vec3d.subtract(e,u,m),C=a.vec3d.subtract(e,b,p),D=a.vec3d.cross(y,n),F=a.vec3d.dot(a.vec3d.cross(y,D,q),r),B=a.vec3d.dot(a.vec3d.cross(f,D,q),B),C=a.vec3d.dot(a.vec3d.cross(n,D,q),C);if(0<F&&0<B&&0<C)return e=a.vec3d.dot(D,r),e*e/a.vec3d.dot(D,D);k=c.distance2(c.fromOriginAndVector(k,y,t),e);u=c.distance2(c.fromOriginAndVector(u,f,t),e);e=c.distance2(c.fromOriginAndVector(b,n,t),e);return Math.min(k,u,e)};b.areaPoints2d=e;b.area2d=function(a){return e(a.p0,a.p1,a.p2)};var g=a.vec3d.create(),
l=a.vec3d.create(),d=a.vec3d.create(),h=a.vec3d.create(),m=a.vec3d.create(),p=a.vec3d.create(),q=a.vec3d.create(),t=c.create()})},"esri/layers/vectorTiles/views/3d/webgl-engine/lib/gl-matrix":function(){define([],function(){var k={};(function(b,a){a(b,!0);a(b,!1)})(k,function(b,a){var c={};(function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),b=new Int32Array(a.buffer);c.invsqrt=function(c){a[0]=c;b[0]=1597463007-(b[0]>>1);var f=a[0];return f*(1.5-.5*c*f*f)}}else c.invsqrt=function(a){return 1/
Math.sqrt(a)}})();var e=Array;"undefined"!=typeof Float32Array&&(e=a?Float32Array:Array);var g={create:function(a){var b=new e(3);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2]):b[0]=b[1]=b[2]=0;return b},createFrom:function(a,b,c){var f=new e(3);f[0]=a;f[1]=b;f[2]=c;return f},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},set3:function(a,b,c,d){d[0]=a;d[1]=b;d[2]=c;return d},add:function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},
subtract:function(a,b,c){if(!c||a===c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},multiply:function(a,b,c){if(!c||a===c)return a[0]*=b[0],a[1]*=b[1],a[2]*=b[2],a;c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c},max:function(a,b,c){c[0]=Math.max(a[0],b[0]);c[1]=Math.max(a[1],b[1]);c[2]=Math.max(a[2],b[2]);return c},min:function(a,b,c){c[0]=Math.min(a[0],b[0]);c[1]=Math.min(a[1],b[1]);c[2]=Math.min(a[2],b[2]);return c},negate:function(a,b){b||
(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],f=a[1];a=a[2];var d=Math.sqrt(c*c+f*f+a*a);if(!d)return b[0]=0,b[1]=0,b[2]=0,b;if(1===d)return b[0]=c,b[1]=f,b[2]=a,b;d=1/d;b[0]=c*d;b[1]=f*d;b[2]=a*d;return b},cross:function(a,b,c){c||(c=a);var f=a[0],d=a[1];a=a[2];var e=b[0],n=b[1];b=b[2];c[0]=d*b-a*n;c[1]=a*e-f*b;c[2]=f*n-d*e;return c},length:function(a){var b=
a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)},length2:function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0],f=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+f*f+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=f*b;c[2]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d},dist:function(a,b){var c=b[0]-a[0],d=
b[1]-a[1];a=b[2]-a[2];return Math.sqrt(c*c+d*d+a*a)},dist2:function(a,b){var c=b[0]-a[0],d=b[1]-a[1];a=b[2]-a[2];return c*c+d*d+a*a}},l=null,d=new e(4);g.unproject=function(a,b,c,e,g){g||(g=a);l||(l=y.create());var f=l;d[0]=2*(a[0]-e[0])/e[2]-1;d[1]=2*(a[1]-e[1])/e[3]-1;d[2]=2*a[2]-1;d[3]=1;y.multiply(c,b,f);if(!y.inverse(f))return null;y.multiplyVec4(f,d);if(0===d[3])return null;g[0]=d[0]/d[3];g[1]=d[1]/d[3];g[2]=d[2]/d[3];return g};var h=g.createFrom(1,0,0),m=g.createFrom(0,1,0),k=g.createFrom(0,
0,1);g.rotationTo=function(a,b,c){c||(c=x.create());var d=g.dot(a,b),f=g.create();if(1<=d)x.set(A,c);else if(-.999999>d)g.cross(h,a,f),1E-6>f.length&&g.cross(m,a,f),1E-6>f.length&&g.cross(k,a,f),g.normalize(f),x.fromAxisAngle(f,Math.PI,c);else{var d=Math.sqrt(2*(1+d)),e=1/d;g.cross(a,b,f);c[0]=f[0]*e;c[1]=f[1]*e;c[2]=f[2]*e;c[3]=.5*d;x.normalize(c)}1<c[3]?c[3]=1:-1>c[3]&&(c[3]=-1);return c};var q=g.create(),t=g.create();g.project=function(a,b,c,d){d||(d=a);g.direction(b,c,q);g.subtract(a,b,t);a=g.dot(q,
t);g.scale(q,a,d);g.add(d,b,d)};g.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var u={create:function(a){var b=new e(9);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]):b[0]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=0;return b},createFrom:function(a,b,c,d,g,h,l,m,k){var f=new e(9);f[0]=a;f[1]=b;f[2]=c;f[3]=d;f[4]=g;f[5]=h;f[6]=l;f[7]=m;f[8]=k;return f},determinant:function(a){var b=a[3],c=a[4],d=a[5],f=a[6],e=a[7],g=a[8];return a[0]*(g*c-d*e)+
a[1]*(-g*b+d*f)+a[2]*(e*b-c*f)},inverse:function(a,b){var c=a[0],d=a[1],f=a[2],e=a[3],n=a[4],g=a[5],h=a[6],l=a[7];a=a[8];var m=a*n-g*l,k=-a*e+g*h,p=l*e-n*h,q=c*m+d*k+f*p;if(!q)return null;q=1/q;b||(b=u.create());b[0]=m*q;b[1]=(-a*d+f*l)*q;b[2]=(g*d-f*n)*q;b[3]=k*q;b[4]=(a*c-f*h)*q;b[5]=(-g*c+f*e)*q;b[6]=p*q;b[7]=(-l*c+d*h)*q;b[8]=(n*c-d*e)*q;return b},multiply:function(a,b,c){c||(c=a);var d=a[0],f=a[1],e=a[2],n=a[3],g=a[4],h=a[5],l=a[6],m=a[7];a=a[8];var k=b[0],p=b[1],r=b[2],q=b[3],t=b[4],u=b[5],
y=b[6],x=b[7];b=b[8];c[0]=k*d+p*n+r*l;c[1]=k*f+p*g+r*m;c[2]=k*e+p*h+r*a;c[3]=q*d+t*n+u*l;c[4]=q*f+t*g+u*m;c[5]=q*e+t*h+u*a;c[6]=y*d+x*n+b*l;c[7]=y*f+x*g+b*m;c[8]=y*e+x*h+b*a;return c},multiplyVec2:function(a,b,c){c||(c=b);var d=b[0];b=b[1];c[0]=d*a[0]+b*a[3]+a[6];c[1]=d*a[1]+b*a[4]+a[7];return c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],f=b[1];b=b[2];c[0]=d*a[0]+f*a[3]+b*a[6];c[1]=d*a[1]+f*a[4]+b*a[7];c[2]=d*a[2]+f*a[5]+b*a[8];return c},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=
a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a||(a=u.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a===b){b=a[1];var c=a[2],d=a[5];a[1]=a[3];a[2]=a[6];a[3]=b;a[5]=a[7];a[6]=c;a[7]=d;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},toMat4:function(a,b){b||(b=y.create());b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=
a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},y={create:function(a){var b=new e(16);4===arguments.length?(b[0]=arguments[0],b[1]=arguments[1],b[2]=arguments[2],b[3]=arguments[3],b[4]=arguments[4],b[5]=arguments[5],b[6]=arguments[6],b[7]=arguments[7],b[8]=arguments[8],b[9]=arguments[9],b[10]=arguments[10],b[11]=arguments[11],b[12]=arguments[12],
b[13]=arguments[13],b[14]=arguments[14],b[15]=arguments[15]):a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b},createFrom:function(a,b,c,d,g,h,l,m,k,p,q,t,u,y,x,z){var f=new e(16);f[0]=a;f[1]=b;f[2]=c;f[3]=d;f[4]=g;f[5]=h;f[6]=l;f[7]=m;f[8]=k;f[9]=p;f[10]=q;f[11]=t;f[12]=u;f[13]=y;f[14]=x;f[15]=z;return f},createFromMatrixRowMajor:function(a){var b=new e(16);b[0]=
a[0];b[4]=a[1];b[8]=a[2];b[12]=a[3];b[1]=a[4];b[5]=a[5];b[9]=a[6];b[13]=a[7];b[2]=a[8];b[6]=a[9];b[10]=a[10];b[14]=a[11];b[3]=a[12];b[7]=a[13];b[11]=a[14];b[15]=a[15];return b},createFromMatrix:function(a){var b=new e(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];
b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},setRowMajor:function(a,b){b[0]=a[0];b[4]=a[1];b[8]=a[2];b[12]=a[3];b[1]=a[4];b[5]=a[5];b[9]=a[6];b[13]=a[7];b[2]=a[8];b[6]=a[9];b[10]=a[10];b[14]=a[11];b[3]=a[12];b[7]=a[13];b[11]=a[14];b[15]=a[15];return b},identity:function(a){a||(a=y.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||
a===b){b=a[1];var c=a[2],d=a[3],f=a[6],e=a[7],n=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=b;a[6]=a[9];a[7]=a[13];a[8]=c;a[9]=f;a[11]=a[14];a[12]=d;a[13]=e;a[14]=n;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],c=a[1],d=a[2],f=a[3],e=a[4],g=a[5],h=a[6],l=a[7],m=a[8],k=a[9],p=a[10],q=a[11],t=a[12],u=a[13],y=a[14];a=a[15];return t*
k*h*f-m*u*h*f-t*g*p*f+e*u*p*f+m*g*y*f-e*k*y*f-t*k*d*l+m*u*d*l+t*c*p*l-b*u*p*l-m*c*y*l+b*k*y*l+t*g*d*q-e*u*d*q-t*c*h*q+b*u*h*q+e*c*y*q-b*g*y*q-m*g*d*a+e*k*d*a+m*c*h*a-b*k*h*a-e*c*p*a+b*g*p*a},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],n=a[4],g=a[5],h=a[6],l=a[7],m=a[8],k=a[9],p=a[10],q=a[11],t=a[12],u=a[13],y=a[14];a=a[15];var x=c*g-d*n,z=c*h-e*n,A=c*l-f*n,X=d*h-e*g,Y=d*l-f*g,O=e*l-f*h,M=m*u-k*t,N=m*y-p*t,P=m*a-q*t,R=k*y-p*u,Z=k*a-q*u,V=p*a-q*y,L=x*V-z*Z+A*R+X*P-Y*N+O*M;if(!L)return null;
L=1/L;b[0]=(g*V-h*Z+l*R)*L;b[1]=(-d*V+e*Z-f*R)*L;b[2]=(u*O-y*Y+a*X)*L;b[3]=(-k*O+p*Y-q*X)*L;b[4]=(-n*V+h*P-l*N)*L;b[5]=(c*V-e*P+f*N)*L;b[6]=(-t*O+y*A-a*z)*L;b[7]=(m*O-p*A+q*z)*L;b[8]=(n*Z-g*P+l*M)*L;b[9]=(-c*Z+d*P-f*M)*L;b[10]=(t*Y-u*A+a*x)*L;b[11]=(-m*Y+k*A-q*x)*L;b[12]=(-n*R+g*N-h*M)*L;b[13]=(c*R-d*N+e*M)*L;b[14]=(-t*X+u*z-y*x)*L;b[15]=(m*X-k*z+p*x)*L;return b},toRotationMat:function(a,b){b||(b=y.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];
b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},toMat3:function(a,b){b||(b=u.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b},toInverseMat3:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[4],g=a[5],n=a[6],h=a[8],l=a[9];a=a[10];var m=a*g-n*l,k=-a*f+n*h,p=l*f-g*h,q=c*m+d*k+e*p;if(!q)return null;q=1/q;b||(b=u.create());b[0]=m*q;b[1]=(-a*d+e*l)*q;b[2]=(n*d-e*g)*q;b[3]=k*q;b[4]=(a*c-e*h)*q;b[5]=(-n*c+e*f)*q;b[6]=p*q;b[7]=
(-l*c+d*h)*q;b[8]=(g*c-d*f)*q;return b},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],n=a[4],h=a[5],l=a[6],m=a[7],k=a[8],p=a[9],r=a[10],q=a[11],t=a[12],u=a[13],y=a[14];a=a[15];var x=b[0],z=b[1],A=b[2],Y=b[3],O=b[4],M=b[5],N=b[6],P=b[7],R=b[8],Z=b[9],V=b[10],L=b[11],da=b[12],fa=b[13],ja=b[14];b=b[15];c[0]=x*d+z*n+A*k+Y*t;c[1]=x*e+z*h+A*p+Y*u;c[2]=x*f+z*l+A*r+Y*y;c[3]=x*g+z*m+A*q+Y*a;c[4]=O*d+M*n+N*k+P*t;c[5]=O*e+M*h+N*p+P*u;c[6]=O*f+M*l+N*r+P*y;c[7]=O*g+M*m+N*q+P*a;c[8]=R*d+Z*n+
V*k+L*t;c[9]=R*e+Z*h+V*p+L*u;c[10]=R*f+Z*l+V*r+L*y;c[11]=R*g+Z*m+V*q+L*a;c[12]=da*d+fa*n+ja*k+b*t;c[13]=da*e+fa*h+ja*p+b*u;c[14]=da*f+fa*l+ja*r+b*y;c[15]=da*g+fa*m+ja*q+b*a;return c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c},multiplyVec4:function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*b;c[2]=a[2]*
d+a[6]*e+a[10]*f+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*b;return c},translate:function(a,b,c){var d=b[0],e=b[1];b=b[2];var f,g,n,h,l,m,k,p,r,q,t,u;if(!c||a===c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;f=a[0];g=a[1];n=a[2];h=a[3];l=a[4];m=a[5];k=a[6];p=a[7];r=a[8];q=a[9];t=a[10];u=a[11];c[0]=f;c[1]=g;c[2]=n;c[3]=h;c[4]=l;c[5]=m;c[6]=k;c[7]=p;c[8]=r;c[9]=q;c[10]=t;c[11]=u;c[12]=f*d+l*e+r*b+a[12];
c[13]=g*d+m*e+q*b+a[13];c[14]=n*d+k*e+t*b+a[14];c[15]=h*d+p*e+u*b+a[15];return c},scale:function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a===c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},maxScale:function(a){return Math.max(Math.max(Math.sqrt(a[0]*
a[0]+a[4]*a[4]+a[8]*a[8]),Math.sqrt(a[1]*a[1]+a[5]*a[5]+a[9]*a[9])),Math.sqrt(a[2]*a[2]+a[6]*a[6]+a[10]*a[10]))},rotate:function(a,b,c,d){var e=c[0],f=c[1];c=c[2];var g=Math.sqrt(e*e+f*f+c*c),n,h,l,m,k,p,r,q,t,B,u,y,x,z,A,O,M,N,P,R;if(!g)return null;1!==g&&(g=1/g,e*=g,f*=g,c*=g);n=Math.sin(b);h=Math.cos(b);l=1-h;b=a[0];g=a[1];m=a[2];k=a[3];p=a[4];r=a[5];q=a[6];t=a[7];B=a[8];u=a[9];y=a[10];x=a[11];z=e*e*l+h;A=f*e*l+c*n;O=c*e*l-f*n;M=e*f*l-c*n;N=f*f*l+h;P=c*f*l+e*n;R=e*c*l+f*n;e=f*c*l-e*n;f=c*c*l+h;
d?a!==d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*z+p*A+B*O;d[1]=g*z+r*A+u*O;d[2]=m*z+q*A+y*O;d[3]=k*z+t*A+x*O;d[4]=b*M+p*N+B*P;d[5]=g*M+r*N+u*P;d[6]=m*M+q*N+y*P;d[7]=k*M+t*N+x*P;d[8]=b*R+p*e+B*f;d[9]=g*R+r*e+u*f;d[10]=m*R+q*e+y*f;d[11]=k*R+t*e+x*f;return d},rotateX:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],f=a[5],g=a[6],n=a[7],h=a[8],l=a[9],m=a[10],k=a[11];c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=
e*b+h*d;c[5]=f*b+l*d;c[6]=g*b+m*d;c[7]=n*b+k*d;c[8]=e*-d+h*b;c[9]=f*-d+l*b;c[10]=g*-d+m*b;c[11]=n*-d+k*b;return c},rotateY:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],f=a[1],g=a[2],n=a[3],h=a[8],l=a[9],m=a[10],k=a[11];c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+h*-d;c[1]=f*b+l*-d;c[2]=g*b+m*-d;c[3]=n*b+k*-d;c[8]=e*d+h*b;c[9]=f*d+l*b;c[10]=g*d+m*b;c[11]=n*d+k*b;return c},rotateZ:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);
var e=a[0],f=a[1],g=a[2],n=a[3],h=a[4],l=a[5],m=a[6],k=a[7];c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+h*d;c[1]=f*b+l*d;c[2]=g*b+m*d;c[3]=n*b+k*d;c[4]=e*-d+h*b;c[5]=f*-d+l*b;c[6]=g*-d+m*b;c[7]=n*-d+k*b;return c},frustum:function(a,b,c,d,e,g,h){h||(h=y.create());var f=b-a,n=d-c,l=g-e;h[0]=2*e/f;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*e/n;h[6]=0;h[7]=0;h[8]=(b+a)/f;h[9]=(d+c)/n;h[10]=-(g+e)/l;h[11]=-1;h[12]=0;h[13]=0;h[14]=-(g*e*2)/
l;h[15]=0;return h},perspective:function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return y.frustum(-b,b,-a,a,c,d,e)},ortho:function(a,b,c,d,e,g,h){h||(h=y.create());var f=b-a,n=d-c,l=g-e;h[0]=2/f;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2/n;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=-2/l;h[11]=0;h[12]=-(a+b)/f;h[13]=-(d+c)/n;h[14]=-(g+e)/l;h[15]=1;return h},lookAt:function(a,b,c,d){d||(d=y.create());var e,f,g,h,n,l,m,k,p=a[0],r=a[1];a=a[2];g=c[0];h=c[1];f=c[2];m=b[0];c=b[1];e=b[2];if(p===m&&r===c&&a===e)return y.identity(d);
b=p-m;c=r-c;m=a-e;k=1/Math.sqrt(b*b+c*c+m*m);b*=k;c*=k;m*=k;e=h*m-f*c;f=f*b-g*m;g=g*c-h*b;(k=Math.sqrt(e*e+f*f+g*g))?(k=1/k,e*=k,f*=k,g*=k):g=f=e=0;h=c*g-m*f;n=m*e-b*g;l=b*f-c*e;(k=Math.sqrt(h*h+n*n+l*l))?(k=1/k,h*=k,n*=k,l*=k):l=n=h=0;d[0]=e;d[1]=h;d[2]=b;d[3]=0;d[4]=f;d[5]=n;d[6]=c;d[7]=0;d[8]=g;d[9]=l;d[10]=m;d[11]=0;d[12]=-(e*p+f*r+g*a);d[13]=-(h*p+n*r+l*a);d[14]=-(b*p+c*r+m*a);d[15]=1;return d},fromRotationTranslation:function(a,b,c){c||(c=y.create());var d=a[0],e=a[1],f=a[2],g=a[3],h=d+d,n=
e+e,l=f+f;a=d*h;var m=d*n,d=d*l,k=e*n,e=e*l,f=f*l,h=g*h,n=g*n,g=g*l;c[0]=1-(k+f);c[1]=m+g;c[2]=d-n;c[3]=0;c[4]=m-g;c[5]=1-(a+f);c[6]=e+h;c[7]=0;c[8]=d+n;c[9]=e-h;c[10]=1-(a+k);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},x={create:function(a){var b=new e(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3]):b[0]=b[1]=b[2]=b[3]=0;return b},createFrom:function(a,b,c,d){var f=new e(4);f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||(a=x.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},A=x.identity();x.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a===b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};x.dot=function(a,b){return a[0]*b[0]+
a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};x.inverse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],c=(c=c*c+d*d+e*e+f*f)?1/c:0;if(!b||a===b)return a[0]*=-c,a[1]*=-c,a[2]*=-c,a[3]*=c,a;b[0]=-a[0]*c;b[1]=-a[1]*c;b[2]=-a[2]*c;b[3]=a[3]*c;return b};x.conjugate=function(a,b){if(!b||a===b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};x.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};x.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],
e=a[2];a=a[3];var f=Math.sqrt(c*c+d*d+e*e+a*a);if(0===f)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;b[3]=a*f;return b};x.add=function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a[3]+=b[3],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};x.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];a=a[3];var g=b[0],h=b[1],n=b[2];b=b[3];c[0]=d*b+a*g+e*n-f*h;c[1]=e*b+a*h+f*g-d*n;c[2]=f*b+a*n+d*h-e*g;c[3]=a*b-d*g-e*h-f*n;return c};x.multiplyVec3=
function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];b=a[0];var g=a[1],h=a[2];a=a[3];var n=a*d+g*f-h*e,l=a*e+h*d-b*f,m=a*f+b*e-g*d,d=-b*d-g*e-h*f;c[0]=n*a+d*-b+l*-h-m*-g;c[1]=l*a+d*-g+m*-b-n*-h;c[2]=m*a+d*-h+n*-g-l*-b;return c};x.scale=function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};x.toMat3=function(a,b){b||(b=u.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,n=e+e;a=c*g;var l=c*h,c=c*n,m=d*h,d=d*n,e=e*n,g=f*g,h=f*
h,f=f*n;b[0]=1-(m+e);b[1]=l+f;b[2]=c-h;b[3]=l-f;b[4]=1-(a+e);b[5]=d+g;b[6]=c+h;b[7]=d-g;b[8]=1-(a+m);return b};x.toMat4=function(a,b){b||(b=y.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,n=e+e;a=c*g;var l=c*h,c=c*n,m=d*h,d=d*n,e=e*n,g=f*g,h=f*h,f=f*n;b[0]=1-(m+e);b[1]=l+f;b[2]=c-h;b[3]=0;b[4]=l-f;b[5]=1-(a+e);b[6]=d+g;b[7]=0;b[8]=c+h;b[9]=d-g;b[10]=1-(a+m);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};x.slerp=function(a,b,c,d){d||(d=a);var e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],f,
g;if(1<=Math.abs(e))return d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d;f=Math.acos(e);g=Math.sqrt(1-e*e);if(.001>Math.abs(g))return d[0]=.5*a[0]+.5*b[0],d[1]=.5*a[1]+.5*b[1],d[2]=.5*a[2]+.5*b[2],d[3]=.5*a[3]+.5*b[3],d;e=Math.sin((1-c)*f)/g;c=Math.sin(c*f)/g;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};x.fromRotationMatrix=function(a,b){b||(b=x.create());var c=a[0]+a[4]+a[8],d;if(0<c)d=Math.sqrt(c+1),b[3]=.5*d,d=.5/d,b[0]=(a[7]-a[5])*d,b[1]=(a[2]-a[6])*
d,b[2]=(a[3]-a[1])*d;else{d=x.fromRotationMatrix.s_iNext=x.fromRotationMatrix.s_iNext||[1,2,0];c=0;a[4]>a[0]&&(c=1);a[8]>a[3*c+c]&&(c=2);var e=d[c],f=d[e];d=Math.sqrt(a[3*c+c]-a[3*e+e]-a[3*f+f]+1);b[c]=.5*d;d=.5/d;b[3]=(a[3*f+e]-a[3*e+f])*d;b[e]=(a[3*e+c]+a[3*c+e])*d;b[f]=(a[3*f+c]+a[3*c+f])*d}return b};u.toQuat4=x.fromRotationMatrix;(function(){var a=u.create();x.fromAxes=function(b,c,d,e){a[0]=c[0];a[3]=c[1];a[6]=c[2];a[1]=d[0];a[4]=d[1];a[7]=d[2];a[2]=b[0];a[5]=b[1];a[8]=b[2];return x.fromRotationMatrix(a,
e)}})();x.identity=function(a){a||(a=x.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};x.fromAngleAxis=function(a,b,c){c||(c=x.create());a*=.5;var d=Math.sin(a);c[3]=Math.cos(a);c[0]=d*b[0];c[1]=d*b[1];c[2]=d*b[2];return c};x.toAngleAxis=function(a,b){b||(b=a);var d=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<d?(b[3]=2*Math.acos(a[3]),d=c.invsqrt(d),b[0]=a[0]*d,b[1]=a[1]*d,b[2]=a[2]*d):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};x.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var z={create:function(a){var b=
new e(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):b[0]=b[1]=b[2]=b[3]=0;return b},createFrom:function(a,b,c,d){var f=new e(4);f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||(a=z.create());a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,b){if(!b||a===b)return b=a[1],a[1]=a[2],a[2]=b,a;b[0]=a[0];b[1]=a[2];b[2]=a[1];b[3]=a[3];return b},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,
b){b||(b=a);var c=a[0],d=a[1],e=a[2];a=a[3];var f=c*a-e*d;if(!f)return null;f=1/f;b[0]=a*f;b[1]=-d*f;b[2]=-e*f;b[3]=c*f;return b},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];a=a[3];c[0]=d*b[0]+e*b[2];c[1]=d*b[1]+e*b[3];c[2]=f*b[0]+a*b[2];c[3]=f*b[1]+a*b[3];return c},rotate:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];a=a[3];var g=Math.sin(b);b=Math.cos(b);c[0]=d*b+e*g;c[1]=d*-g+e*b;c[2]=f*b+a*g;c[3]=f*-g+a*b;return c},multiplyVec2:function(a,b,c){c||(c=b);var d=b[0];b=b[1];c[0]=
d*a[0]+b*a[1];c[1]=d*a[2]+b*a[3];return c},scale:function(a,b,c){c||(c=a);var d=a[1],e=a[2],f=a[3],g=b[0];b=b[1];c[0]=a[0]*g;c[1]=d*b;c[2]=e*g;c[3]=f*b;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};a=a?"":"d";b["glMath"+a]=c;b["vec2"+a]={create:function(a){var b=new e(2);a?(b[0]=a[0],b[1]=a[1]):(b[0]=0,b[1]=0);return b},createFrom:function(a,b){var c=new e(2);c[0]=a;c[1]=b;return c},add:function(a,b,c){c||(c=b);c[0]=a[0]+b[0];c[1]=a[1]+b[1];return c},subtract:function(a,
b,c){c||(c=b);c[0]=a[0]-b[0];c[1]=a[1]-b[1];return c},multiply:function(a,b,c){c||(c=b);c[0]=a[0]*b[0];c[1]=a[1]*b[1];return c},divide:function(a,b,c){c||(c=b);c[0]=a[0]/b[0];c[1]=a[1]/b[1];return c},scale:function(a,b,c){c||(c=a);c[0]=a[0]*b;c[1]=a[1]*b;return c},dist:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)},dist2:function(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a},set:function(a,b){b[0]=a[0];b[1]=a[1];return b},set2:function(a,b,c){c[0]=a;c[1]=b;return c},negate:function(a,
b){b||(b=a);b[0]=-a[0];b[1]=-a[1];return b},normalize:function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1];0<c?(c=Math.sqrt(c),b[0]=a[0]/c,b[1]=a[1]/c):b[0]=b[1]=0;return b},cross:function(a,b,c){a=a[0]*b[1]-a[1]*b[0];if(!c)return a;c[0]=c[1]=0;c[2]=a;return c},length:function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0];a=a[1]-b[1];b=d*d+a*a;if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/Math.sqrt(b);c[0]=d*
b;c[1]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);return d},str:function(a){return"["+a[0]+", "+a[1]+"]"}};b["vec3"+a]=g;b["vec4"+a]={create:function(a){var b=new e(4);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]):(b[0]=0,b[1]=0,b[2]=0,b[3]=0);return b},createFrom:function(a,b,c,d){var f=new e(4);f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},add:function(a,b,c){c||(c=b);c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c},subtract:function(a,
b,c){c||(c=b);c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c},multiply:function(a,b,c){c||(c=b);c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];c[3]=a[3]*b[3];return c},divide:function(a,b,c){c||(c=b);c[0]=a[0]/b[0];c[1]=a[1]/b[1];c[2]=a[2]/b[2];c[3]=a[3]/b[3];return c},scale:function(a,b,c){c||(c=a);c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];
return b},set4:function(a,b,c,d,e){e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);d[3]=a[3]+c*(b[3]-a[3]);return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};b["mat2"+a]=z;b["mat3"+a]=u;b["mat4"+a]=y;b["quat4"+a]=x});return k})},"esri/layers/vectorTiles/views/vectorTiles/GeometryUtils":function(){define(["require",
"exports"],function(k,b){function a(a,b){a%=b;return 0<=a?a:a+b}Object.defineProperty(b,"__esModule",{value:!0});b.C_INFINITY=Number.POSITIVE_INFINITY;b.C_PI=Math.PI;b.C_2PI=2*b.C_PI;b.C_PI_BY_2=b.C_PI/2;b.C_RAD_TO_256=128/b.C_PI;b.C_256_TO_RAD=b.C_PI/128;b.C_DEG_TO_256=256/360;b.C_DEG_TO_RAD=b.C_PI/180;b.C_SQRT2=1.414213562;b.C_SQRT2_INV=1/b.C_SQRT2;var c=1/Math.LN2;b.positiveMod=a;b.radToByte=function(c){return a(c*b.C_RAD_TO_256,256)};b.degToByte=function(c){return a(c*b.C_DEG_TO_256,256)};b.log2=
function(a){return Math.log(a)*c};b.sqr=function(a){return a*a};b.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};b.interpolate=function(a,b,c){return a*(1-c)+b*c};b.between=function(a,b,c){return a>=b&&a<=c||a>=c&&a<=b}})},"esri/layers/vectorTiles/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports dojo/has dojo/promise/all ./Rect ./RectangleBinPack ../../../webgl/Texture".split(" "),function(k,b,a,c,e,g,l){var d;a("stable-symbol-rendering")&&(d=new Set);return function(){function b(a,
b,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=c;this._binPack=new g(a-4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0);this._addDecorationGlyph()}b.prototype.getGlyphItems=function(b,e){for(var g=this,h=[],l=this._glyphSource,
m=new Set,k=1/256,p=0;p<e.length;p++)m.add(Math.floor(e[p]*k));var z=[];m.forEach(function(a){if(256>=a){var c=b+a;g._rangePromises.has(c)?z.push(g._rangePromises.get(c)):(a=l.getRange(b,a).then(function(){g._rangePromises["delete"](c)}).catch(function(){g._rangePromises["delete"](c);throw Error("Unable to query resource");}),g._rangePromises.set(c,a),z.push(a))}});return c(z).then(function(c){c=g._glyphIndex[b];c||(c={},g._glyphIndex[b]=c);var f;if(a("stable-symbol-rendering")){d.clear();for(var k=
0;k<e.length;k++)f=e[k],d.add(f);var p=[];m.forEach(function(a){p.push(a)});p.sort();f=[];for(k=0;k<p.length;k++)for(var q=p[k],t=0;256>t;++t)f.push(256*q+t)}else f=e;k=0;for(q=f;k<q.length;k++)if(f=q[k],t=c[f]){if(!a("stable-symbol-rendering")||d.has(f))h[f]={rect:t.rect,metrics:t.metrics,page:t.page}}else if((t=l.getGlyph(b,f))&&t.metrics){var u=g._recordGlyph(t,f);c[f]={rect:u,metrics:t.metrics,tileIDs:null,page:g._currentPage};if(!a("stable-symbol-rendering")||d.has(f))h[f]={rect:u,metrics:t.metrics,
page:g._currentPage};g._dirties[g._currentPage]=!0}return h})};b.prototype._recordGlyph=function(a,b){var c=a.metrics;if(0===c.width)c=new e(0,0,0,0);else{b=c.width+6;var d=c.height+6,h=b%4?4-b%4:4,l=d%4?4-d%4:4;1===h&&(h=5);1===l&&(l=5);c=this._binPack.allocate(b+h,d+l);c.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),
this._binPack=new g(this.width-4,this.height-4),c=this._binPack.allocate(b+h,d+l));h=this._glyphData[this._currentPage];a=a.bitmap;var m=l=void 0;if(a)for(var k=0;k<d;k++)for(var l=b*k,m=this.width*(c.y+k+1)+c.x,p=0;p<b;p++)h[m+p+1]=a[l+p]}return c};b.prototype._addDecorationGlyph=function(){for(var a=[117,149,181,207,207,181,149,117],b=[],c=0;c<a.length;c++)for(var d=a[c],e=0;11>e;e++)b.push(d);a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(b)};this._recordGlyph(a,0)};
b.prototype.bind=function(a,b,c,d){this._textures[c]||(this._textures[c]=new l(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var e=this._textures[c];e.setSamplingMode(b);this._dirties[c]&&e.setData(this._glyphData[c]);a.bindTexture(e,d);this._dirties[c]=!1};b.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._glyphData.length=0};return b}()})},
"esri/layers/vectorTiles/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(k,b,a){return function(){function b(b,c){this._height=this._width=0;this._free=[];this._width=b;this._height=c;this._free.push(new a(0,0,b,c))}Object.defineProperty(b.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});b.prototype.allocate=
function(b,c){if(b>this._width||c>this._height)return new a;for(var e=null,d=-1,g=0;g<this._free.length;++g){var m=this._free[g];b<=m.width&&c<=m.height&&(null===e||m.y<=e.y&&m.x<=e.x)&&(e=m,d=g)}if(null===e)return new a;this._free.splice(d,1);e.width<e.height?(e.width>b&&this._free.push(new a(e.x+b,e.y,e.width-b,c)),e.height>c&&this._free.push(new a(e.x,e.y+c,e.width,e.height-c))):(e.width>b&&this._free.push(new a(e.x+b,e.y,e.width-b,e.height)),e.height>c&&this._free.push(new a(e.x,e.y+c,b,e.height-
c)));return new a(e.x,e.y,b,c)};b.prototype.release=function(a){for(var b=0;b<this._free.length;++b){var c=this._free[b];if(c.y===a.y&&c.height===a.height&&c.x+c.width===a.x)c.width+=a.width;else if(c.x===a.x&&c.width===a.width&&c.y+c.height===a.y)c.height+=a.height;else if(a.y===c.y&&a.height===c.height&&a.x+a.width===c.x)c.x=a.x,c.width+=a.width;else if(a.x===c.x&&a.width===c.width&&a.y+a.height===c.y)c.y=a.y,c.height+=a.height;else continue;this._free.splice(b,1);this.release(a)}this._free.push(a)};
return b}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/GlyphSource":function(){define(["require","exports","../../../../request","../../../../core/pbf","../../../../core/promiseUtils"],function(k,b,a,c,e){var g=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),d=void 0,e=void 0,g=void 0,h=void 0,l=void 0,k=void 0,z=void 0;c.next();)switch(c.tag()){case 1:d=c.getUInt32();
break;case 2:e=c.getBytes();break;case 3:g=c.getUInt32();break;case 4:h=c.getUInt32();break;case 5:l=c.getSInt32();break;case 6:k=c.getSInt32();break;case 7:z=c.getUInt32();break;default:c.skip()}d&&(this._metrics[d]={width:g,height:h,left:l,top:k,advance:z},this._bitmaps[d]=e);break;default:b.skip()}break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),l=function(){function a(){this._ranges=[]}a.prototype.getRange=
function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function b(a){this._glyphInfo={};this._baseURL=a}b.prototype.getRange=function(b,d){var h=this._getFontStack(b);if(h.getRange(d))return e.resolve();var l=256*d,m=l+255;b=this._baseURL.replace("{fontstack}",b).replace("{range}",l+"-"+m);return a(b,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){h.addRange(d,new g(new c(new Uint8Array(a.data),new DataView(a.data))))})};
b.prototype.getGlyph=function(a,b){if(a=this._getFontStack(a)){var c=Math.floor(b/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(b),bitmap:a.getBitmap(b)}}};b.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new l);return b};return b}()})},"esri/layers/vectorTiles/request":function(){define(["require","exports","esri/request","dojo/_base/lang","dojo/Deferred"],function(k,b,a,c,e){return function(b,l){b=c.mixin({},{url:b,failOk:!0},l);"array-buffer"===
l.responseType?(b.handleAs="arraybuffer",delete b.responseType):l.responseType&&(b.handleAs=l.responseType,delete b.responseType);null!==l.query&&(b.content=b.query,delete b.query);var d;l.hasOwnProperty("allowImageDataAccess")&&(d={allowImageDataAccess:l.allowImageDataAccess},delete b.allowImageDataAccess);var g,m=new e(function(){g.isFulfilled()||g.cancel()});g=a(b,d).then(function(a){m.resolve({data:a})}).catch(function(a){a&&null!=a.httpCode&&(a.details=a.details||{},a.details.httpStatus=a.httpCode);
m.reject(a)});return m.promise}})},"esri/layers/vectorTiles/core/pbf":function(){define(["require","exports"],function(k,b){return function(){function a(a,b,g,l){this._tag=0;this._dataType=99;this._data=a;this._dataView=b;this._pos=g||0;this._end=l||a.byteLength}a.prototype.clone=function(){return new a(this._data,this._dataView,this._pos,this._end)};a.prototype.pos=function(){return this._pos};a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var b=this._decodeVarint();this._tag=
b>>3;this._dataType=b&7;if(!a||a===this._tag)break;this.skip()}return!0};a.prototype.empty=function(){return this._pos>=this._end};a.prototype.tag=function(){return this._tag};a.prototype.getInt32=function(){return this._decodeVarint()};a.prototype.getInt64=function(){return this._decodeVarint()};a.prototype.getUInt32=function(){var a=4294967295,a=(this._data[this._pos]&127)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&127)<<7)>>>0;if(128>this._data[this._pos++])return a;
a=(a|(this._data[this._pos]&127)<<14)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&127)<<21)>>>0;if(128>this._data[this._pos++])return a;a=(a|(this._data[this._pos]&15)<<28)>>>0;if(128>this._data[this._pos++])return a};a.prototype.getUInt64=function(){return this._decodeVarint()};a.prototype.getSInt32=function(){var a=this.getUInt32();return a>>>1^-(a&1)|0};a.prototype.getSInt64=function(){return this._decodeSVarint()};a.prototype.getBool=function(){var a=0!==this._data[this._pos];
this._skip(1);return a};a.prototype.getEnum=function(){return this._decodeVarint()};a.prototype.getFixed64=function(){var a=this._dataView,b=this._pos,a=a.getUint32(b,!0)+4294967296*a.getUint32(b+4,!0);this._skip(8);return a};a.prototype.getSFixed64=function(){var a=this._dataView,b=this._pos,a=a.getUint32(b,!0)+4294967296*a.getInt32(b+4,!0);this._skip(8);return a};a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);this._skip(8);return a};a.prototype.getFixed32=function(){var a=
this._dataView.getUint32(this._pos,!0);this._skip(4);return a};a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);this._skip(4);return a};a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};a.prototype.getString=function(){var a=this._getLength(),b=this._pos,b=this._toString(this._data,b,b+a);this._skip(a);return b};a.prototype.getBytes=function(){var a=this._getLength(),b=this._pos,b=this._toBytes(this._data,b,b+a);this._skip(a);
return b};a.prototype.getMessage=function(){var b=this._getLength(),e=this._pos,e=new a(this._data,this._dataView,e,e+b);this._skip(b);return e};a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a};a.prototype._decodeVarint=
function(){var a=this._data,b=this._pos,g=0,l;if(10<=this._end-b){if(l=a[b++],g|=l&127,0!==(l&128)&&(l=a[b++],g|=(l&127)<<7,0!==(l&128)&&(l=a[b++],g|=(l&127)<<14,0!==(l&128)&&(l=a[b++],g|=(l&127)<<21,0!==(l&128)&&(l=a[b++],g+=268435456*(l&127),0!==(l&128)&&(l=a[b++],g+=34359738368*(l&127),0!==(l&128)&&(l=a[b++],g+=4398046511104*(l&127),0!==(l&128)&&(l=a[b++],g+=562949953421312*(l&127),0!==(l&128)&&(l=a[b++],g+=72057594037927936*(l&127),0!==(l&128)&&(l=a[b++],g+=0x7fffffffffffffff*(l&127),0!==(l&128)))))))))))throw Error("Varint too long!");
}else{for(var d=1;b!==this._end;){l=a[b];if(0===(l&128))break;++b;g+=(l&127)*d;d*=128}if(b===this._end)throw Error("Varint overrun!");++b;g+=l*d}this._pos=b;return g};a.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%2?-(a+1)/2:a/2};a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};a.prototype._toString=function(a,b,g){var c="",d="";for(g=Math.min(this._end,g);b<g;++b){var e=a[b];e&128?d+="%"+e.toString(16):
(c+=decodeURIComponent(d)+String.fromCharCode(e),d="")}d.length&&(c+=decodeURIComponent(d));return c};a.prototype._toBytes=function(a,b,g){g=Math.min(this._end,g);return new Uint8Array(a.buffer,b,g-b)};return a}()})},"esri/layers/vectorTiles/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ./GeometryUtils ./Rect ./RectangleBinPack ../../../webgl/Texture".split(" "),function(k,b,a,c,e,g){return function(){function b(a,b,c){void 0===c&&(c=0);this._size=[];this._mosaicsData=[];
this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=b)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=b;0<c&&(this._maxItemSize=c);this.pixelRatio=window.devicePixelRatio|1;this._binPack=new e(this._pageWidth,this._pageHeight);this._mosaicsData[0]=new Uint32Array(Math.floor(this._pageWidth)*
Math.floor(this._pageHeight));this._dirties.push(!0);this._size.push([this._pageWidth,this._pageHeight]);this._textures.push(void 0)}b.prototype.getWidth=function(a){return a>=this._size.length?-1:this._size[a][0]};b.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]};b.prototype.getPage=function(a){return a<this._textures.length?this._textures[a]:null};b.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(b.prototype,"itemCount",{get:function(){return this._mosaicRects.size},
enumerable:!0,configurable:!0});b.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};b.prototype.addSpriteItem=function(a,b,c,e,g,l){if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var d=this._allocateImage(b[0],b[1]),h=d[0],m=d[1],d=d[2];if(0>=h.width||0>=h.height)return null;c={rect:h,width:b[0],height:b[1],anchorX:c[0],anchorY:c[1],sdf:l,pixelRatio:1,page:m};this._mosaicRects.set(a,c);this._copy({rect:h,spriteSize:b,spriteData:e,page:m,pageSize:d,repeat:g,sdf:l});
return c};b.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};b.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};b.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};b.prototype.getMosaicItemPosition=function(a,b){b=(a=this.getSpriteItem(a))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;return{size:[a.width,a.height],tl:[(b.x+1)/this._size[a.page][0],
(b.y+1)/this._size[a.page][1]],br:[(b.x+1+a.width)/this._size[a.page][0],(b.y+1+a.height)/this._size[a.page][1]],page:a.page}};b.prototype.bind=function(a,b,c,e){void 0===c&&(c=0);void 0===e&&(e=0);this._textures[c]||(this._textures[c]=new g(a,{pixelFormat:6408,dataType:5121,width:this._size[c][0],height:this._size[c][1]},new Uint8Array(this._mosaicsData[c].buffer)));var d=this._textures[c];d.setSamplingMode(b);this._dirties[c]&&(d.setData(new Uint8Array(this._mosaicsData[c].buffer)),d.generateMipmap());
a.bindTexture(d,e);this._dirties[c]=!1};b._copyBits=function(a,b,c,e,g,l,k,y,x,A,z){var d=e*b+c;k=y*l+k;if(z)for(k-=l,z=-1;z<=A;z++,d=((z+A)%A+e)*b+c,k+=l)for(y=-1;y<=x;y++)g[k+y]=a[d+(y+x)%x];else for(z=0;z<A;z++){for(y=0;y<x;y++)g[k+y]=a[d+y];d+=b;k+=l}};b.prototype._copy=function(a){if(!(a.page>=this._mosaicsData.length)){var c=a.spriteData,d=this._mosaicsData[a.page];d&&c||console.error("Source or target images are uninitialized!");b._copyBits(c,a.spriteSize[0],0,0,d,a.pageSize[0],a.rect.x+1,
a.rect.y+1,a.spriteSize[0],a.spriteSize[1],a.repeat);this._dirties[a.page]=!0}};b.prototype._allocateImage=function(b,g){b+=2;g+=2;var d=Math.max(b,g);if(this._maxItemSize&&this._maxItemSize<d){var d=Math.pow(2,Math.ceil(a.log2(b))),h=Math.pow(2,Math.ceil(a.log2(g)));b=new c(0,0,b,g);this._mosaicsData.push(new Uint32Array(d*h));this._dirties.push(!0);this._size.push([d,h]);this._textures.push(void 0);return[b,this._mosaicsData.length-1,[d,h]]}d=this._binPack.allocate(b+(b%4?4-b%4:0),g+(g%4?4-g%4:
0));return 0>=d.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new e(this._pageWidth,this._pageHeight),this._allocateImage(b,g)):[d,this._currentPage,[this._pageWidth,this._pageHeight]]};b.prototype.dispose=function(){this._binPack=
null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._mosaicsData.length=0;this._mosaicRects.clear()};return b}()})},"esri/layers/vectorTiles/views/3d/support/imageUtils":function(){define(["require","exports","../../../request"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.dataURItoBlob=function(a){var b=atob(a.split(",")[1]);a=a.split(",")[0].split(":")[1].split(";")[0];for(var c=new ArrayBuffer(b.length),l=new Uint8Array(c),
d=0;d<b.length;d++)l[d]=b.charCodeAt(d);return new Blob([c],{type:a})};b.requestImage=function(b){return a(b,{responseType:"image",allowImageDataAccess:!0}).then(function(a){return a.data})}})},"esri/layers/vectorTiles/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(k,b,a,c,e){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(a){this.size=a;this.canvas=document.createElement("canvas");
this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");this._gridOuter=new Float64Array(a*a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a);a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");document.body.appendChild(a);this._svg=a}b.prototype.draw=function(b,
d,g){var h=this;void 0===g&&(g=31);var l=this._createSVGString(b);return a.create(function(a,b){var m=new Image;m.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(l);m.onload=function(){h.context.clearRect(0,0,h.size,h.size);h.context.drawImage(m,0,0,h.size,h.size);for(var b=h.context.getImageData(0,0,h.size,h.size),c=new Uint8Array(h.size*h.size*4),d=0;d<h.size*h.size;d++){var f=b.data[4*d+3]/255;h._gridOuter[d]=1===f?0:0===f?1E20:Math.pow(Math.max(0,.5-f),2);h._gridInner[d]=1===f?
1E20:0===f?0:Math.pow(Math.max(0,f-.5),2)}h._edt(h._gridOuter,h.size,h.size);h._edt(h._gridInner,h.size,h.size);for(d=0;d<h.size*h.size;d++)e.packFloatRGBA(.5-(h._gridOuter[d]-h._gridInner[d])/(2*g),c,4*d);a(c)};var k=d&&d.signal;if(k)c.onAbort(k,function(){return b(c.createAbortError())})})};b.prototype._createSVGString=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d",a);this._svg.appendChild(b);a=b.getBBox();var c=a.width/a.height,e=this.size/2,
g,l,k;1<c?(l=g=e/a.width,k=this.size/4,c=e-1/c*e/2):(g=l=e/a.height,k=e-e*c/2,c=this.size/4);b.setAttribute("style","transform: matrix("+g+", 0, 0, "+l+", "+(-a.x*g+k)+", "+(-a.y*l+c)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(b);return a};b.prototype._edt=function(a,b,c){for(var d=this._f,e=this._d,g=this._v,h=this._z,l=0;l<b;l++){for(var k=0;k<c;k++)d[k]=
a[k*b+l];this._edt1d(d,e,g,h,c);for(k=0;k<c;k++)a[k*b+l]=e[k]}for(k=0;k<c;k++){for(l=0;l<b;l++)d[l]=a[k*b+l];this._edt1d(d,e,g,h,b);for(l=0;l<b;l++)a[k*b+l]=Math.sqrt(e[l])}};b.prototype._edt1d=function(a,b,c,e,g){c[0]=0;e[0]=-1E20;e[1]=1E20;for(var d=1,h=0;d<g;d++){for(var l=(a[d]+d*d-(a[c[h]]+c[h]*c[h]))/(2*d-2*c[h]);l<=e[h];)h--,l=(a[d]+d*d-(a[c[h]]+c[h]*c[h]))/(2*d-2*c[h]);h++;c[h]=d;e[h]=l;e[h+1]=1E20}for(h=d=0;d<g;d++){for(;e[h+1]<d;)h++;b[d]=(d-c[h])*(d-c[h])+a[c[h]]}};return b}();b.default=
k})},"esri/layers/vectorTiles/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(k,b){function a(a){return a-Math.floor(a)}Object.defineProperty(b,"__esModule",{value:!0});var c=[1,256,65536,16777216],e=[1/256,1/65536,1/16777216,1/4294967296],g=function(a,b){void 0===b&&(b=0);for(var c=0,d=0;4>d;d++)c+=a[b+d]*e[d];return c}(new Uint8ClampedArray([255,255,255,255]));b.packFloatRGBA=function(b,d,e){void 0===e&&(e=0);b=0>b?0:b>g?g:b;for(var h=0;4>h;h++)d[e+h]=Math.floor(256*
a(b*c[h]))}})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/screenUtils ../../../../geometry/support/scaleUtils ../../../../renderers/support/utils ./color ./Utils".split(" "),function(k,b,a,c,e,g,l){function d(a,b){var c=b.length;if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}return function(){function b(){this.symbolLevels=
[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.vvSizeFieldStopsValues=new Float32Array(6);this.vvSizeFieldStopsSizes=new Float32Array(6);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this.symbolLevels.push(0)}Object.defineProperty(b.prototype,"vvMaterialParameters",
{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"heatmapParameters",{get:function(){return this._heatmapParameters},enumerable:!0,configurable:!0});b.prototype.updateHeatmapParameters=function(a){var b=a.blurRadius,c=Math.round(4.5*a.blurRadius),d=2*c+1;this._heatmapParameters||(this._heatmapParameters={radius:b,blurRadius:c,kernelSize:d,refreshIntensityKernel:!0,intensityKernel:null,color:null,maxPixelIntensity:a.maxPixelIntensity,
minPixelIntensity:a.minPixelIntensity});for(var e=this._heatmapParameters,h=a.colorStops,l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k,f=0;16>f;f++){var n=h[Math.min(f,h.length-1)];l[f]=n.ratio;k=4*f;m[k+0]=n.color[0]/255;m[k+1]=n.color[1]/255;m[k+2]=n.color[2]/255;m[k+3]=1<n.color[3]?n.color[3]/255:n.color[3];g.premultiplyAlpha(m,k,!0)}e.color={values:l,colors:m,refreshColorRamp:!0};
1E-6<Math.abs(e.radius-a.radius)&&(e.radius=b,e.blurRadius=c,e.kernelSize=d,e.refreshIntensityKernel=!0);e.maxPixelIntensity=a.maxPixelIntensity;e.minPixelIntensity=a.minPixelIntensity};b.prototype.updateVisualVariables=function(b,g){var h=this._vvMaterialParameters;h.vvOpacityEnabled=!1;h.vvSizeEnabled=!1;h.vvColorEnabled=!1;h.vvRotationEnabled=!1;if(b){var m=b.size;if(m){h.vvSizeEnabled=!0;if(m.minMaxValue){var k=m.minMaxValue,p=void 0,x=void 0;l.isDefined(k.minSize)&&l.isDefined(k.maxSize)&&(l.isNumber(k.minSize)&&
l.isNumber(k.maxSize)?(p=a.pt2px(k.minSize),x=a.pt2px(k.maxSize)):(x=g.scale,p=a.pt2px(d(x,k.minSize.stops)),x=a.pt2px(d(x,k.maxSize.stops))));this.vvSizeMinMaxValue.set([k.minDataValue,k.maxDataValue,p,x])}m.scaleStops&&(this.vvSizeScaleStopsValue=a.pt2px(d(g.scale,m.scaleStops.stops)));m.unitValue&&(this.vvSizeUnitValueToPixelsRatio=c.getMetersPerUnitForSR(g.spatialReference)/e.meterIn[m.unitValue.unit]/g.resolution);m.fieldStops&&(this.vvSizeFieldStopsValues.set(m.fieldStops.values),this.vvSizeFieldStopsSizes.set(m.fieldStops.sizes))}if(g=
b.color)h.vvColorEnabled=!0,this.vvColorValues.set(g.values),this.vvColors.set(g.colors);if(g=b.opacity)h.vvOpacityEnabled=!0,this.vvOpacityValues.set(g.values),this.vvOpacities.set(g.opacities);if(b=b.rotation)h.vvRotationEnabled=!0,h.vvRotationType=b.type}};return b}()})},"esri/layers/vectorTiles/geometry/support/scaleUtils":function(){define(["require","exports","../../config","../../core/kebabDictionary","./WKIDUnitConversion"],function(k,b,a,c,e){function g(a){return t.fromJSON(a.toLowerCase())||
null}function l(a){return d(a)||b.decDegToMeters}function d(a){var b,c,d;a&&("object"===typeof a?(b=a.wkid,c=a.wkt):"number"===typeof a?b=a:"string"===typeof a&&(c=a));b?d=q.values[q[b]]:c&&-1!==c.search(/^PROJCS/i)&&(a=p.exec(c))&&a[1]&&(d=parseFloat(a[1].split(",")[1]));return d}function h(a){var b,c,d;a&&("object"===typeof a?(b=a.wkid,c=a.wkt):"number"===typeof a?b=a:"string"===typeof a&&(c=a));b?d=q.units[q[b]]:c&&-1!==c.search(/^PROJCS/i)&&(a=p.exec(c))&&a[1]&&(d=(a=/[\\"\\']{1}([^\\"\\']+)/.exec(a[1]))&&
a[1]);return d?g(d):null}function m(c,d){d=l(d);return c/(d*b.inchesPerMeter*a.screenDPI)}Object.defineProperty(b,"__esModule",{value:!0});b.inchesPerMeter=39.37;b.decDegToMeters=20015077/180;var p=/UNIT\[([^\]]+)\]\]$/i,q=e,t=c({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",
yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"},{ignoreUnknown:!0});b.unitFromRESTJSON=g;b.unitToRESTJSON=function(a){return t.toJSON(a)||null};b.getMetersPerVerticalUnitForSR=function(a){a=l(a);return 1E5<a?1:a};b.getVerticalUnitStringForSR=function(a){return 1E5<l(a)?"meters":h(a)};b.getMetersPerUnitForSR=l;b.getMetersPerUnit=d;b.getUnitString=h;b.getScale=
function(c,e){e=e||c.extent;c=c.width;var g=d(e&&e.spatialReference);return e&&c?e.width/c*(g||b.decDegToMeters)*b.inchesPerMeter*a.screenDPI:0};b.getResolutionForScale=m;b.getExtentForScale=function(a,b){var c=a.extent;a=a.width;b=m(b,c.spatialReference);return c.clone().expand(b*a/c.width)}})},"esri/layers/vectorTiles/views/2d/layers/features/processors/SymbolProcessor":function(){define("require exports ../../../../../renderers ../../../../../core/executeAsync ../../../../../core/MapPool ../../../../../core/promiseUtils ../../../../../core/SetPool ../../../../../renderers/support/jsonUtils ../../../engine/webgl/rendererInfoUtils ../../../engine/webgl/Utils ../../../engine/webgl/mesh/factories/WGLMeshFactory".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p){function q(a,b){m.isMarkerSymbol(a)||m.isLineSymbol(a)?b.add(a):m.isFillSymbol(a)&&(b.add(a),a.outline&&"none"!==a.outline.style&&b.add(a.outline))}function t(a,b){b.has(a)||b.set(a,new Set);var c=a.text;a=b.get(a);b=c.length;for(var d=0;d<b;d++){var e=c.charCodeAt(d);a.add(e)}}Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(a){this.type="symbol";this._symbolToMosaicItemMap=new Map;this._symbolToMosaicItemMap.clear();this.configuration=a.configuration;
this.service=a.service;this.spatialReference=a.spatialReference;this.tileRenderer=a.tileRenderer}b.prototype.destroy=function(){this._symbolToMosaicItemMap.clear()};b.prototype.getMeshData=function(a,b){return b&&b.features&&0!==b.features.length?this._processFeatures(a,b.features).then(function(b){return{tileKey:a.id,data:b}}):g.resolve({tileKey:a.id,data:null})};b.prototype.setConfiguration=function(a){this.configuration=a;this.factory=this.renderer=this.rendererInfo=null};b.prototype.getFactory=
function(){this.factory||(this.factory=this._createFactory());return this.factory};b.prototype.getRenderer=function(){this.renderer||(this.renderer=this._createRenderer());return this.renderer};b.prototype.getRendererInfo=function(){this.rendererInfo||(this.rendererInfo=this._createRendererInfo());return this.rendererInfo};b.prototype._createFactory=function(){if(!this.configuration)return null;var a={fields:this.service.fields,typeIdField:this.service.typeIdField,types:this.service.types};return p.default.from(this.getRenderer(),
a,this._symbolToMosaicItemMap,this.service.geometryType,this.service.objectIdField,this.spatialReference,this.configuration.devicePixelRatio)};b.prototype._createRenderer=function(){return this.configuration?d.fromJSON(this.configuration.renderer):null};b.prototype._createRendererInfo=function(){return this.configuration?h.createRendererInfo(d.fromJSON(this.configuration.renderer),this.spatialReference,{fields:this.service.fields}):null};b.prototype._processFeatures=function(a,b){var c=this;return b&&
b.length?this._getMosaicItems(b).then(function(){return c._writeFeatures(a,b)}):g.resolve(null)};b.prototype._writeFeatures=function(a,b){var d=this,e=0,f=this.getFactory(),g=f.createMeshData(b.length),h={viewingMode:"",scale:a.scale};return c(function(){var a=b[e++],c=e===b.length;f.write(g,a,h);return c}).then(function(){return d._encodeDisplayData(g)})};b.prototype._encodeDisplayData=function(a){var b={};a.encode(b,[]);return b};b.prototype._getReturnCentroid=function(a){function b(a){if(!a)return!1;
a=a.type;return"simple-marker"===a||"picture-marker"===a||"text"===a}if("esriGeometryPolygon"!==this.service.geometryType)return!1;switch(a.type){case "simple":return b(a.symbol);case "unique-value":return b(a.defaultSymbol)||a.uniqueValueInfos.some(function(a){return b(a.symbol)});case "class-breaks":return b(a.defaultSymbol)||a.classBreakInfos.some(function(a){return b(a.symbol)});default:return!0}};b.prototype._getMosaicItems=function(b){b=l.acquire();for(var c=e.acquire(),d=this.getRenderer(),
h=0,f=d.getSymbols();h<f.length;h++){var n=f[h];m.isTextSymbol(n)?t(n,c):q(n,b)}(d instanceof a.UniqueValueRenderer||d instanceof a.ClassBreaksRenderer)&&(d=d.backgroundFillSymbol)&&q(d,b);var k=this._symbolToMosaicItemMap,p=e.acquire(),u=[],y=0;b.forEach(function(a){k.has(a.id)||(p.set(y,a),u.push({symbol:a.toJSON(),id:y}),y++)});c.forEach(function(a,b){if(k.has(b.id)){var c=k.get(b.id).glyphMosaicItems,d=[];a.forEach(function(a){if(c&&c.length<a||!c[a])d[a]=a});0<d.length&&(p.set(y,b),u.push({symbol:b.toJSON(),
id:y,glyphIds:d}),y++)}else{p.set(y,b);var e=[];a.forEach(function(a){return e.push(a)});u.push({symbol:b.toJSON(),id:y,glyphIds:e});y++}});if(0<u.length)return this.tileRenderer.getMaterialItems(u).then(function(a){for(var b=0;b<a.length;b++){var c=a[b],d=p.get(c.id);if(d)if(m.isTextSymbol(d))if(k.has(d.id)){if(d=k.get(d.id).glyphMosaicItems,c=c.mosaicItem.glyphMosaicItems)for(var f=0;f<c.length;f++)null!=c[f]&&(d[f]=c[f])}else k.set(d.id,c.mosaicItem);else k.set(d.id,c.mosaicItem)}e.release(p)});
l.release(b);e.release(c);return g.resolve()};return b}();b.SymbolProcessor=k})},"esri/layers/vectorTiles/renderers":function(){define("require exports ./renderers/ClassBreaksRenderer ./renderers/HeatmapRenderer ./renderers/Renderer ./renderers/SimpleRenderer ./renderers/UniqueValueRenderer ./renderers/support/jsonUtils".split(" "),function(k,b,a,c,e,g,l,d){Object.defineProperty(b,"__esModule",{value:!0});b.ClassBreaksRenderer=a;b.HeatmapRenderer=c;b.BaseRenderer=e;b.SimpleRenderer=g;b.UniqueValueRenderer=
l;b.isRenderer=function(a){return a instanceof b.BaseRenderer};b.fromJSON=d.fromJSON})},"esri/layers/vectorTiles/renderers/ClassBreaksRenderer":function(){define("../core/declare ../core/lang ../core/kebabDictionary ../core/Error ../core/Logger ../core/accessorSupport/ensureType ../support/arcadeUtils ../symbols/Symbol ../symbols/PolygonSymbol3D ../symbols/support/jsonUtils ../symbols/support/typeUtils ./Renderer ./support/LegendOptions ./support/ClassBreakInfo".split(" "),function(k,b,a,c,e,g,l,
d,h,m,p,q,t,u){var y=e.getLogger("esri.renderers.ClassBreaksRenderer");t=t.LegendOptions;u=u.ClassBreakInfo;var x=a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),A=g.ensureType(u),z=k(q,{declaredClass:"esri.renderers.ClassBreaksRenderer",properties:{backgroundFillSymbol:{types:{base:d,key:"type",typeMap:{"simple-fill":p.types.typeMap["simple-fill"],"picture-fill":p.types.typeMap["picture-fill"],"polygon-3d":p.types.typeMap["polygon-3d"]}},
value:null,json:{origins:{"web-scene":{read:m.read,write:{target:{backgroundFillSymbol:{type:h}},writer:m.writeTarget}}},read:m.read,write:m.writeTarget}},classBreakInfos:{type:[u],json:{read:function(a,b,c){if(Array.isArray(a)){var d=b.minValue;return a.map(function(a){var b=new u;b.read(a,c);null==b.minValue&&(b.minValue=d);null==b.maxValue&&(b.maxValue=b.minValue);d=b.maxValue;return b})}},write:function(a,b,c,d){a=a.map(function(a){return a.write({},d)});this._areClassBreaksConsecutive()&&a.forEach(function(a){delete a.classMinValue});
b[c]=a}}},minValue:{type:Number,readOnly:!0,dependsOn:["classBreakInfos"],get:function(){return this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}},defaultLabel:{type:String,value:null,json:{write:!0}},defaultSymbol:{types:p.rendererTypes,value:null,json:{origins:{"web-scene":{read:m.read,write:{target:{defaultSymbol:{types:p.rendererTypes3D}},
writer:m.writeTarget}}},read:m.read,write:m.writeTarget}},valueExpression:{type:String,value:null,json:{write:!0}},valueExpressionTitle:{type:String,value:null,json:{write:!0}},compiledFunc:{dependsOn:["valueExpression"],get:function(){return l.createFunction(this.valueExpression)}},legendOptions:{type:t,value:null,json:{write:!0}},field:{value:null,cast:function(a){return null==a?a:"function"===typeof a?a:g.ensureString(a)},json:{type:String,write:function(a,b,d,e){"string"===typeof a?b[d]=a:e&&
e.messages?e.messages.push(new c("property:unsupported","ClassBreaksRenderer.field set to a function cannot be written to JSON")):y.error(".field: cannot write field to JSON since it's not a string value")}}},isMaxInclusive:!0,normalizationField:{type:String,value:null,json:{write:!0}},normalizationTotal:{type:Number,value:null,json:{write:!0}},normalizationType:{type:String,value:null,dependsOn:["normalizationField","normalizationTotal"],get:function(){var a=this._get("normalizationType"),b=!!this.normalizationField,
c=null!=this.normalizationTotal;if(b||c)a=b&&"field"||c&&"percent-of-total",b&&c&&console.warn("warning: both normalizationField and normalizationTotal are set!");else if("field"===a||"percent-of-total"===a)a=null;return a},json:{read:x.fromJSON,write:function(a,b){if(a=x.toJSON(a))b.normalizationType=a}}},requiredFields:{dependsOn:["field","normalizationField","valueExpression"]},type:{value:"class-breaks",json:{write:function(a,b){b.type="classBreaks"}}}},constructor:function(){this.classBreakInfos=
[]},addClassBreakInfo:function(a,c,d){a="number"===typeof a?new u({minValue:a,maxValue:c,symbol:d}):A(b.clone(a));this.classBreakInfos.push(a);1===this.classBreakInfos.length&&this.notifyChange("minValue")},removeClassBreakInfo:function(a,b){var c,d,e=this.classBreakInfos.length;for(d=0;d<e;d++)if(c=[this.classBreakInfos[d].minValue,this.classBreakInfos[d].maxValue],c[0]==a&&c[1]==b){this.classBreakInfos.splice(d,1);break}},getBreakIndex:function(a,b){var c=this.field,d=a.attributes,e=this.classBreakInfos.length,
f=this.isMaxInclusive;if(this.valueExpression)a=l.executeFunction(this.compiledFunc,l.createExecContext(a,l.getViewInfo(b)));else if("function"===typeof c)a=c(a);else if(a=parseFloat(d[c]),b=this.normalizationType)if(c=parseFloat(this.normalizationTotal),d=parseFloat(d[this.normalizationField]),"log"===b)a=Math.log(a)*Math.LOG10E;else if("percent-of-total"===b&&!isNaN(c))a=a/c*100;else if("field"===b&&!isNaN(d)){if(isNaN(a)||isNaN(d))return-1;a/=d}if(null!=a&&!isNaN(a)&&"number"===typeof a)for(d=
0;d<e;d++)if(b=[this.classBreakInfos[d].minValue,this.classBreakInfos[d].maxValue],b[0]<=a&&(f?a<=b[1]:a<b[1]))return d;return-1},getClassBreakInfo:function(a,b){a=this.getBreakIndex(a,b);return-1!==a?this.classBreakInfos[a]:null},getSymbol:function(a,b){a=this.getBreakIndex(a,b);return-1<a?this.classBreakInfos[a].symbol:this.defaultSymbol},getSymbols:function(){var a=[];this.classBreakInfos.forEach(function(b){b.symbol&&a.push(b.symbol)});this.defaultSymbol&&a.push(this.defaultSymbol);return a},
clone:function(){return new z({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:b.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,
visualVariables:b.clone(this.visualVariables),legendOptions:b.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})},collectRequiredFields:function(a){this.inherited(arguments);[this.field,this.normalizationField].forEach(function(b){b&&(a[b]=!0)});this.valueExpression&&l.extractFieldNames(this.valueExpression).forEach(function(b){a[b]=!0})},_areClassBreaksConsecutive:function(){for(var a=this.classBreakInfos,b=1;b<a.length;b++)if(a[b-1].maxValue!==a[b].minValue)return!1;
return!0}});return z})},"esri/layers/vectorTiles/symbols/PolygonSymbol3D":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3D"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/Symbol3D":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,
arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/support/jsonUtils":function(){define("require exports ../../core/Error ../../core/Warning ../LabelSymbol3D ../LineSymbol3D ../MeshSymbol3D ../PictureFillSymbol ../PictureMarkerSymbol ../PointSymbol3D ../PolygonSymbol3D ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../Symbol3D ../TextSymbol ../WebStyleSymbol ../callouts/LineCallout3D ./symbolConversion".split(" "),function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z,f){function n(a,
b,d){b=a?B[a.type]||null:null;if(b)return b=new b,b.read(a,d),b;d&&d.messages&&a&&d.messages.push(new c("symbol:unsupported","Symbols of type '"+(a.type||"unknown")+"' are not supported",{definition:a,context:d}));return null}function r(b,c,d){if(!b)return null;if(!d||"web-scene"!==d.origin||b.isInstanceOf(y)||b.isInstanceOf(A))return b.write(c,d);var e=f.to3D(b);if(e.symbol)return e.symbol.write(c,d);d.messages&&d.messages.push(new a("symbol:unsupported","Symbols of type '"+b.declaredClass+"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView",
{symbol:b,context:d,error:e.error}));return null}Object.defineProperty(b,"__esModule",{value:!0});var B={esriSMS:u,esriPMS:h,esriTS:x,esriSLS:t,esriSFS:q,esriPFS:d,PointSymbol3D:m,LineSymbol3D:g,PolygonSymbol3D:p,MeshSymbol3D:l,LabelSymbol3D:e,styleSymbolReference:A};b.read=n;b.writeTarget=function(a,b,c,d){(a=r(a,{},d))&&(b[c]=a)};b.write=r;b.fromJSON=function(a,b){return n(a,null,b)};b.readCallout3D=function(a,b){if(!a||!a.type)return null;var c=null;switch(a.type){case "line":c=new z}c&&c.read(a,
b);return c}})},"esri/layers/vectorTiles/core/Warning":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(k,b,a,c,e){k=function(b){function c(a,e,g){var d=b.call(this,a,e,g)||this;return d instanceof c?d:new c(a,e,g)}a(c,b);return c}(e);k.prototype.type="warning";return k})},"esri/layers/vectorTiles/symbols/LabelSymbol3D":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3D"],function(k,b,a,c){return function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/LineSymbol3D":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3D"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/MeshSymbol3D":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3D"],function(k,b,a,c){return function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/PictureFillSymbol":function(){define(["../core/declare","../core/lang","../core/screenUtils","./FillSymbol","./support/urlUtils"],function(k,b,a,c,e){var g={xscale:1,yscale:1,xoffset:0,yoffset:0,width:12,height:12},l=k(c,{declaredClass:"esri.symbols.PictureFillSymbol",properties:{type:"picture-fill",url:e.urlPropertyDefinition,xscale:{value:1,json:{write:!0}},yscale:{value:1,json:{write:!0}},width:{value:12,cast:a.toPt,
json:{write:!0}},height:{value:12,cast:a.toPt,json:{write:!0}},xoffset:{value:0,cast:a.toPt,json:{write:!0}},yoffset:{value:0,cast:a.toPt,json:{write:!0}},source:e.sourcePropertyDefinition},getDefaults:function(){return b.mixin(this.inherited(arguments),g)},normalizeCtorArgs:function(b,c,e,g){if(b&&"string"!==typeof b&&null==b.imageData)return b;var d={};b&&(d.url=b);c&&(d.outline=c);null!=e&&(d.width=a.toPt(e));null!=g&&(d.height=a.toPt(g));return d},clone:function(){var a=new l({color:b.clone(this.color),
height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});a._set("source",b.clone(this.source));return a}});l.defaultProps=g;return l})},"esri/layers/vectorTiles/symbols/FillSymbol":function(){define(["./Symbol","./SimpleLineSymbol"],function(k,b){return k.createSubclass({declaredClass:"esri.symbols.FillSymbol",properties:{outline:{type:b,json:{read:{default:null},write:!0}},type:null}})})},
"esri/layers/vectorTiles/symbols/support/urlUtils":function(){define(["require","exports","../../core/urlUtils"],function(k,b,a){function c(b,c,g){return c.imageData?a.makeData({mediaType:c.contentType||"image/png",isBase64:!0,data:c.imageData}):e(c.url,g)}function e(b,c){return!c||"service"!==c.origin&&"portal-item"!==c.origin||!c.layer||"feature"!==c.layer.type&&"stream"!==c.layer.type||a.isAbsolute(b)||!c.layer.parsedUrl?a.read(b,c):a.join(c.layer.parsedUrl.path,"images",b)}function g(b,c,e,g){a.isDataProtocol(b)?
(b=a.dataComponents(b),c.contentType=b.mediaType,c.imageData=b.data,e&&e.imageData===c.imageData&&e.url&&(c.url=l(e.url,g))):c.url=l(b,g)}function l(b,c){return a.write(b,c)}Object.defineProperty(b,"__esModule",{value:!0});b.readImageDataOrUrl=c;b.read=e;b.writeImageDataAndUrl=g;b.write=l;b.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:c},write:{writer:function(a,b,c,e){g(a,b,this.source,e)}}}};b.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(a,
b,c){a={};b.imageData&&(a.imageData=b.imageData);b.contentType&&(a.contentType=b.contentType);b.url&&(a.url=e(b.url,c));return a}}}}})},"esri/layers/vectorTiles/core/urlUtils":function(){define(["require","exports","esri/urlUtils","dojo/_base/url"],function(k,b,a,c){function e(b){return a.normalize(b)}function g(a){return"data:"===a.slice(0,5)}function l(a){return d(a)||z.test(a)}function d(a){return a&&"/"===a[0]&&"/"===a[1]}function h(b){return a.urlToObject(b)}function m(a){if("string"===typeof a)return new c(q(a));
a.scheme||(a.scheme=b.appUrl.scheme);return a}function p(a){if(g(a))return null;var b=a.indexOf("://");if(-1===b&&d(a))b=2;else if(-1!==b)b+=3;else return null;b=a.indexOf("/",b);return-1===b?a:a.slice(0,b)}function q(a,c,e){void 0===c&&(c=b.appBaseUrl);if(d(a))return e&&e.preserveProtocolRelative?a:"http"===b.appUrl.scheme&&b.appUrl.authority===p(a).slice(2)?"http:"+a:"https:"+a;if(z.test(a))return a;e=u;if("/"===a[0]){var f=c.indexOf("//"),f=c.indexOf("/",f+2);c=-1===f?c:c.slice(0,f)}return e(c,
a)}function t(a,b,c){void 0===c&&(c=!1);a=m(a);b=m(b);return c||a.scheme===b.scheme?a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port:!1}function u(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(a&&a.length){b=[];if(l(a[0])){var c=a[0],d=c.indexOf("//");b.push(c.slice(0,d+1));A.test(a[0])&&(b[0]+="/");a[0]=c.slice(d+2)}else"/"===a[0][0]&&b.push("");a=a.reduce(function(a,b){return b?a.concat(b.split("/")):a},[]);for(c=0;c<a.length;c++)d=a[c],".."===d&&0<b.length?b.pop():
!d||"."===d&&0!==b.length||b.push(d);return b.join("/")}}function y(a,b,c){if(!(b&&c&&a&&l(a)))return a;var d=a.indexOf("//"),e=a.indexOf("/",d+2),f=a.indexOf(":",d+2),e=Math.min(0>e?a.length:e,0>f?a.length:f);if(a.slice(d+2,e).toLowerCase()!==b.toLowerCase())return a;b=a.slice(0,d+2);a=a.slice(e);return""+b+c+a}function x(a,c,d){void 0===c&&(c=b.appBaseUrl);if(!l(a))return a;var f=e(a),g=f.toLowerCase();c=e(c).toLowerCase().replace(/\/+$/,"");if((d=d?e(d).toLowerCase().replace(/\/+$/,""):null)&&
0!==c.indexOf(d))return a;for(var h=function(a,b,c){c=a.indexOf(b,c);return-1===c?a.length:c},m=h(g,"/",g.indexOf("//")+2),k=-1;g.slice(0,m+1)===c.slice(0,m)+"/";){k=m+1;if(m===g.length)break;m=h(g,"/",m+1)}if(-1===k||d&&k<d.length)return a;a=f.slice(k);f=c.slice(k-1).replace(/[^/]+/g,"").length;if(0<f)for(g=0;g<f;g++)a="../"+a;else a="./"+a;return a}Object.defineProperty(b,"__esModule",{value:!0});b.normalize=e;b.canUseXhr=function(b){return a.canUseXhr(b)};b.removeTrailingSlash=function(a){return a.replace(/\/+$/,
"")};k=Function("return this")();b.appUrl=new c(k.location);b.appBaseUrl=function(){var a=b.appUrl.path,a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]));return""+(b.appUrl.scheme+"://"+b.appUrl.host+(null!=b.appUrl.port?":"+b.appUrl.port:""))+a}();var A=/^\s*file:/i,z=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;b.isDataProtocol=g;b.isAbsolute=l;b.isProtocolRelative=d;b.urlToObject=h;b.getOrigin=p;b.makeAbsolute=q;b.hasSameOrigin=t;b.join=u;b.removeFile=function(a){var b=0;if(l(a)){var c=a.indexOf("//");
-1!==c&&(b=c+2)}c=a.lastIndexOf("/");return c<b?a:a.slice(0,c+1)};b.addProxy=function(b){return a.addProxy(b)};b.makeData=function(a){return a.isBase64?"data:"+a.mediaType+";base64,"+a.data:"data:"+a.mediaType+","+a.data};var f=/^data:(.*?)(;base64)?,(.*)$/;b.dataComponents=function(a){return(a=a.match(f))?{mediaType:a[1],isBase64:!!a[2],data:a[3]}:null};b.changeDomain=y;b.read=function(a,c){var d=c&&c.url&&c.url.path;a&&d&&(a=q(a,d,{preserveProtocolRelative:!0}));(c=c&&c.portal)&&!c.isPortal&&c.urlKey&&
c.customBaseUrl?(d=c.urlKey+"."+c.customBaseUrl,c=t(b.appUrl,b.appUrl.scheme+"://"+d)?y(a,c.portalHostname,d):y(a,d,c.portalHostname)):c=a;return c};b.write=function(a,b){if(!a)return a;!l(a)&&b&&b.blockedRelativeUrls&&b.blockedRelativeUrls.push(a);var c=q(a);if(b){var d=b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.rootPath||b.url&&b.url.path;d&&(c=x(c,d,d),c!==a&&b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.writtenUrls.push(c))}a=c;c=(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?
y(a,b.urlKey+"."+b.customBaseUrl,b.portalHostname):a;return c};b.makeRelative=x;b.removeQueryParameters=function(a){a=h(a);Object.keys(a.query||{});return a.path}})},"esri/layers/vectorTiles/symbols/PictureMarkerSymbol":function(){define(["../core/declare","../core/lang","../core/screenUtils","./MarkerSymbol","./support/urlUtils"],function(k,b,a,c,e){var g={width:12,height:12,angle:0,xoffset:0,yoffset:0},l=k(c,{declaredClass:"esri.symbols.PictureMarkerSymbol",properties:{color:{json:{write:!1}},type:"picture-marker",
url:e.urlPropertyDefinition,source:e.sourcePropertyDefinition,height:{json:{read:{source:["height","size"],reader:function(a,b){return b.size||a}},write:!0},cast:a.toPt},width:{json:{read:{source:["width","size"],reader:function(a,b){return b.size||a}},write:!0},cast:a.toPt},size:{json:{write:!1}}},getDefaults:function(){return b.mixin(this.inherited(arguments),g)},normalizeCtorArgs:function(b,c,e){if(b&&"string"!==typeof b&&null==b.imageData)return b;var d={};b&&(d.url=b);null!=c&&(d.width=a.toPt(c));
null!=e&&(d.height=a.toPt(e));return d},clone:function(){var a=new l({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});a._set("source",b.clone(this.source));return a}});l.defaultProps=g;return l})},"esri/layers/vectorTiles/symbols/MarkerSymbol":function(){define(["../core/declare","../core/screenUtils","./Symbol"],function(k,b,a){return k(a,{declaredClass:"esri.symbols.MarkerSymbol",properties:{angle:{value:0,json:{read:function(a){return a&&
-1*a},write:function(a,b){b.angle=a&&-1*a}}},type:{},xoffset:{value:0,cast:b.toPt,json:{write:!0}},yoffset:{value:0,cast:b.toPt,json:{write:!0}},size:{value:9,cast:function(a){return"auto"===a?a:b.toPt(a)},json:{write:!0}}}})})},"esri/layers/vectorTiles/symbols/PointSymbol3D":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3D"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/SimpleFillSymbol":function(){define(["../core/declare",
"../core/lang","./FillSymbol","./SimpleLineSymbol"],function(k,b,a,c){var e={style:"solid",outline:new c,color:[0,0,0,.25]},g=k(a,{declaredClass:"esri.symbols.SimpleFillSymbol",properties:{color:{},type:"simple-fill",style:{value:"solid",type:String,json:{read:function(a){return b.valueOf(this._styles,a)||void 0},write:function(a,b){b.style=this._styles[a]}}}},_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical","forward-diagonal":"esriSFSForwardDiagonal",
"backward-diagonal":"esriSFSBackwardDiagonal",cross:"esriSFSCross","diagonal-cross":"esriSFSDiagonalCross"},getDefaults:function(){return b.mixin(this.inherited(arguments),e)},normalizeCtorArgs:function(a,b,c){if(a&&"string"!==typeof a)return a;var d={};a&&(d.style=a);b&&(d.outline=b);c&&(d.color=c);return d},clone:function(){return new g({color:b.clone(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}});b.mixin(g,{STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",
STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forward-diagonal",STYLE_BACKWARD_DIAGONAL:"backward-diagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonal-cross"});g.defaultProps=e;return g})},"esri/layers/vectorTiles/symbols/SimpleMarkerSymbol":function(){define(["../core/declare","../core/lang","../core/screenUtils","./MarkerSymbol","./SimpleLineSymbol"],function(k,b,a,c,e){var g={style:"circle",color:[255,255,255,.25],outline:new e,size:12,angle:0,xoffset:0,yoffset:0},l=k(c,{declaredClass:"esri.symbols.SimpleMarkerSymbol",
properties:{color:{json:{write:function(a,b){a&&"x"!==this.style&&"cross"!==this.style&&(b.color=a.toJSON())}}},type:"simple-marker",size:{value:12},style:{type:String,value:"circle",json:{read:function(a){return b.valueOf(this._styles,a)},write:function(a,b){b.style=this._styles[a]}}},path:{type:String,value:null,set:function(a){this.style="path";this._set("path",a)},json:{write:!0}},outline:{type:e,json:{write:!0}}},_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",
diamond:"esriSMSDiamond",path:"esriSMSPath"},getDefaults:function(){return b.mixin(this.inherited(arguments),g)},normalizeCtorArgs:function(b,c,e,g){if(b&&"string"!==typeof b)return b;var d={};b&&(d.style=b);null!=c&&(d.size=a.toPt(c));e&&(d.outline=e);g&&(d.color=g);return d},clone:function(){return new l({angle:this.angle,color:b.clone(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})},read:function h(a,
c){return this.getInherited(h,arguments).call(this,b.mixin({outline:null},a),c)}});b.mixin(l,{STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"});l.defaultProps=g;return l})},"esri/layers/vectorTiles/symbols/TextSymbol":function(){define("../core/declare ../core/lang ../core/screenUtils ../Color ./Symbol ./Font".split(" "),function(k,b,a,c,e,g){var l={text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:{},angle:0,
xoffset:0,yoffset:0,horizontalAlignment:"center"},d=k(e,{declaredClass:"esri.symbols.TextSymbol",properties:{backgroundColor:{type:c,json:{write:!0}},borderLineColor:{type:c,json:{write:!0}},borderLineSize:{type:Number,json:{write:!0}},color:{},font:{type:g,json:{write:!0}},horizontalAlignment:{value:"center",json:{write:!0}},kerning:{value:!0,json:{write:!0}},haloColor:{type:c,json:{write:!0}},haloSize:{type:Number,cast:a.toPt,json:{write:!0}},rightToLeft:{json:{write:!0}},rotated:{value:!1,json:{write:!0}},
text:{type:String,json:{write:!0}},type:"text",verticalAlignment:{type:String,json:{write:!0}},xoffset:{value:0,type:Number,cast:a.toPt,json:{write:!0}},yoffset:{value:0,type:Number,cast:a.toPt,json:{write:!0}},angle:{type:Number,value:0,json:{read:function(a){return a&&-1*a},write:function(a,b){b.angle=a&&-1*a}}},width:{json:{write:!0}}},getDefaults:function(){return b.mixin(this.inherited(arguments),l)},normalizeCtorArgs:function(a,b,c){if(a&&"string"!==typeof a)return a;var d={};a&&(d.text=a);
b&&(d.font=b);c&&(d.color=c);return d},clone:function(){return new d({angle:this.angle,backgroundColor:b.clone(this.backgroundColor),borderLineColor:b.clone(this.borderLineColor),borderLineSize:this.borderLineSize,color:b.clone(this.color),font:this.font&&this.font.clone(),haloColor:b.clone(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,
width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}});b.mixin(d,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});d.defaultProps=l;return d})},"esri/layers/vectorTiles/symbols/Font":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators ../core/accessorSupport/write".split(" "),
function(k,b,a,c,e,g,l,d){return function(b){function e(a){a=b.call(this)||this;a.decoration="none";a.family="sans-serif";a.size=9;a.style="normal";a.weight="normal";return a}a(e,b);h=e;e.prototype.castSize=function(a){return g.toPt(a)};e.prototype.clone=function(){return new h({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})};var h;c([l.property({type:String,json:{write:{overridePolicy:d.disableWriteDefaultPolicy("none")}}})],e.prototype,"decoration",
void 0);c([l.property({type:String,json:{write:!0}})],e.prototype,"family",void 0);c([l.property({type:Number,json:{write:{overridePolicy:function(a,b,c){return{enabled:!c||!c.textSymbol3D}}}}})],e.prototype,"size",void 0);c([l.cast("size")],e.prototype,"castSize",null);c([l.property({type:String,json:{write:{overridePolicy:d.disableWriteDefaultPolicy("normal")}}})],e.prototype,"style",void 0);c([l.property({type:String,json:{write:{overridePolicy:d.disableWriteDefaultPolicy("normal")}}})],e.prototype,
"weight",void 0);return e=h=c([l.subclass("esri.symbols.Font")],e)}(l.declared(e))})},"esri/layers/vectorTiles/symbols/WebStyleSymbol":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/callouts/LineCallout3D":function(){define(["require","exports","../../core/tsSupport/declareExtendsHelper","./Callout3D"],
function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/callouts/Callout3D":function(){define(["require","exports","../../core/tsSupport/declareExtendsHelper","../../core/JSONSupport"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/support/symbolConversion":function(){define("require exports ../../Color ../../symbols ../../core/Error ../../core/lang ../FillSymbol3DLayer ../Font ../IconSymbol3DLayer ../LabelSymbol3D ../LineSymbol3D ../LineSymbol3DLayer ../PictureMarkerSymbol ../PointSymbol3D ../PolygonSymbol3D ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../TextSymbol ../TextSymbol3DLayer ../WebStyleSymbol".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z,f,n,r){function B(b){var c=b.color?b.color.clone():new a([255,255,255]),d,e,f;b instanceof t?(b.color&&0===b.color.r&&0===b.color.g&&0===b.color.b&&(c=new a([255,255,255])),d={href:b.url},e=b.width<=b.height?b.height:b.width):(d=b.style,d in C?d=C[d]:(console.log(d+' cannot be mapped to Icon symbol. Fallback to "circle"'),d="circle"),d={primitive:d},e=b.size,b.outline&&b.outline.color&&0<b.outline.width&&(f={size:b.outline.width,color:b.outline.color.clone()}));
return new u(new h({size:e,resource:d,material:{color:c},outline:f}))}Object.defineProperty(b,"__esModule",{value:!0});var C={};C[z.STYLE_CIRCLE]="circle";C[z.STYLE_CROSS]="cross";C[z.STYLE_DIAMOND]="kite";C[z.STYLE_SQUARE]="square";C[z.STYLE_X]="x";b.to3D=function(a,b,h,k){void 0===b&&(b=!1);void 0===h&&(h=!1);void 0===k&&(k=!0);if(!a)return{symbol:null};if(c.isSymbol3D(a)||a instanceof r)k=a.clone();else if(a instanceof A)k=new p(new q({size:a.width||1,material:{color:a.color?a.color.clone():[255,
255,255]}}));else if(a instanceof z)k=B(a);else if(a instanceof t)k=B(a);else if(a instanceof x)k=new l({material:{color:a.color?a.color.clone():[255,255,255]}}),a.outline&&a.outline.color&&(k.outline={size:a.outline.width||0,color:a.outline.color}),k=new y(k);else if(a instanceof f){var C;C=a.haloColor;var G=a.haloSize;C=C&&0<G?{color:g.clone(C),size:G}:null;G=a.font?a.font.clone():new d;k=new (k?m:u)(new n({size:G.size,font:G,halo:C,material:{color:a.color.clone()},text:a.text}))}else return{error:new e("symbol-conversion:unsupported-2d-symbol",
"2D symbol of type '"+(a.type||a.declaredClass)+"' is unsupported in 3D",{symbol:a})};b&&(k.id=a.id);if(h&&c.isSymbol3D(k))for(a=0;a<k.symbolLayers.length;++a)k.symbolLayers.getItemAt(a)._ignoreDrivers=!0;return{symbol:k}}})},"esri/layers/vectorTiles/symbols":function(){define("require exports ./symbols/ExtrudeSymbol3DLayer ./symbols/FillSymbol ./symbols/FillSymbol3DLayer ./symbols/Font ./symbols/IconSymbol3DLayer ./symbols/LabelSymbol3D ./symbols/LineSymbol3D ./symbols/LineSymbol3DLayer ./symbols/MarkerSymbol ./symbols/MeshSymbol3D ./symbols/ObjectSymbol3DLayer ./symbols/PathSymbol3DLayer ./symbols/PictureFillSymbol ./symbols/PictureMarkerSymbol ./symbols/PointSymbol3D ./symbols/PolygonSymbol3D ./symbols/SimpleFillSymbol ./symbols/SimpleLineSymbol ./symbols/SimpleMarkerSymbol ./symbols/Symbol ./symbols/Symbol3D ./symbols/Symbol3DLayer ./symbols/TextSymbol ./symbols/TextSymbol3DLayer ./symbols/WebStyleSymbol ./symbols/support/jsonUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z,f,n,r,B,C,D,F,H,J,I){Object.defineProperty(b,"__esModule",{value:!0});b.ExtrudeSymbol3DLayer=a;b.BaseFillSymbol=c;b.FillSymbol3DLayer=e;b.Font=g;b.IconSymbol3DLayer=l;b.LabelSymbol3D=d;b.LineSymbol3D=h;b.LineSymbol3DLayer=m;b.BaseMarkerSymbol=p;b.MeshSymbol3D=q;b.ObjectSymbol3DLayer=t;b.PathSymbol3DLayer=u;b.PictureFillSymbol=y;b.PictureMarkerSymbol=x;b.PointSymbol3D=A;b.PolygonSymbol3D=z;b.SimpleFillSymbol=f;b.SimpleLineSymbol=n;b.SimpleMarkerSymbol=r;
b.BaseSymbol=B;b.BaseSymbol3D=C;b.BaseSymbol3DLayer=D;b.TextSymbol=F;b.TextSymbol3DLayer=H;b.WebStyleSymbol=J;b.fromJSON=I.fromJSON;b.isSymbol=function(a){return a instanceof b.BaseSymbol};b.isSymbol2D=function(a){if(!a)return!1;switch(a.type){case "picture-fill":case "picture-marker":case "simple-fill":case "simple-line":case "simple-marker":case "text":return!0;default:return!1}};b.isSymbol3D=function(a){if(!a)return!1;switch(a.type){case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return!0;
default:return!1}}})},"esri/layers/vectorTiles/symbols/ExtrudeSymbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3DLayer"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/Symbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","../core/JSONSupport"],function(k,b,a,c){return function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/FillSymbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3DLayer"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/IconSymbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3DLayer"],function(k,b,a,c){return function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/LineSymbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3DLayer"],function(k,b,a,c){(function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c})(c);return c})},"esri/layers/vectorTiles/symbols/ObjectSymbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3DLayer"],function(k,b,a,c){return function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/PathSymbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3DLayer"],function(k,b,a,c){return function(b){function c(){return null!==b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/TextSymbol3DLayer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Symbol3DLayer"],function(k,b,a,c){return function(b){function c(){return null!==
b&&b.apply(this,arguments)||this}a(c,b);return c}(c)})},"esri/layers/vectorTiles/symbols/support/typeUtils":function(){define("require exports ../../core/accessorSupport/ensureType ../LabelSymbol3D ../LineSymbol3D ../MeshSymbol3D ../PictureFillSymbol ../PictureMarkerSymbol ../PointSymbol3D ../PolygonSymbol3D ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../Symbol ../TextSymbol ../WebStyleSymbol".split(" "),function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x){Object.defineProperty(b,"__esModule",
{value:!0});b.types={base:u,key:"type",typeMap:{"simple-fill":p,"picture-fill":l,"picture-marker":d,"simple-line":q,"simple-marker":t,text:y,"label-3d":c,"line-3d":e,"mesh-3d":g,"point-3d":h,"polygon-3d":m,"web-style":x}};b.rendererTypes={base:u,key:"type",typeMap:{"simple-fill":p,"picture-fill":l,"picture-marker":d,"simple-line":q,"simple-marker":t,text:y,"line-3d":e,"mesh-3d":g,"point-3d":h,"polygon-3d":m,"web-style":x}};b.labelTypes={base:u,key:"type",typeMap:{text:y,"label-3d":c}};b.types3D={base:u,
key:"type",typeMap:{"label-3d":c,"line-3d":e,"mesh-3d":g,"point-3d":h,"polygon-3d":m,"web-style":x}};b.rendererTypes3D={base:u,key:"type",typeMap:{"line-3d":e,"mesh-3d":g,"point-3d":h,"polygon-3d":m,"web-style":x}};b.labelTypes3D={base:u,key:"type",typeMap:{"label-3d":c}};b.ensureType=a.ensureOneOfType(b.types)})},"esri/layers/vectorTiles/renderers/Renderer":function(){define("../core/declare ../core/Accessor ../core/JSONSupport ../core/kebabDictionary ../core/screenUtils ../core/lang ../core/Error ../support/arcadeUtils ../webdoc/support/opacityUtils ../Color ./support/utils ./support/AuthoringInfo".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q){var t=c({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),u=c({widthAndDepth:"width-and-depth"}),y=c({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});c({classedSize:"classed-size",classedColor:"classed-color",univariateColorSize:"univariate-color-size"});
c({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"});c({percentTotal:"percent-of-total"});var x=Math.PI,A=h.opacityToTransparency,z=h.transparencyToOpacity;return k([b,a],{declaredClass:"esri.renderers.Renderer",properties:{authoringInfo:{type:q,value:null,json:{write:!0}},requiredFields:{dependsOn:["visualVariables"],get:function(){var a=Object.create(null);
this.collectRequiredFields(a);return Object.keys(a).sort()}},type:{type:String,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}},visualVariables:{json:{read:{source:["visualVariables","rotationType","rotationExpression"],reader:function(a,b){return this._readVariables(a,b)}},write:function(a,b,c,d){var e=[];a.forEach(function(a,b){"size"===a.type?e.push(this._writeSizeInfo(a,d,b)):"color"===a.type?e.push(this._writeColorInfo(a,d,b)):"opacity"===a.type?e.push(this._writeOpacityInfo(a,d,b)):"rotation"===
a.type&&e.push(this._writeRotationInfo(a,d,b))},this);b.visualVariables=e}}}},constructor:function(){this._cache={}},_rotationRE:/^\[([^\]]+)\]$/i,_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_visualVariablesSetter:function(a){var b=this._cache;this.visualVariables&&this.visualVariables.forEach(function(a,c){b.hasOwnProperty(c)&&(b[c]=null)},this);a&&a.some(function(a){return!!a.target})&&a.sort(function(a,b){return a.target===b.target?0:a.target?1:-1});a&&a.forEach(function(a,c){"color"===
a.type?b[c]=this._processColorInfo(a):"opacity"===a.type?b[c]=this._processOpacityInfo(a):"size"===a.type?b[c]=this._processSizeInfo(a):"rotation"===a.type&&(b[c]=this._processRotationInfo(a))},this);this._set("visualVariables",a)},getSymbol:function(a,b){},getVisualVariableValues:function(a,b){var c=this.visualVariables,d;c&&(d=c.map(function(c){var d,e=c.type,f=e+"Info";b=g.mixin({},b);b[f]=c;switch(e){case "size":d=this.getSize(a,b);break;case "color":d=this.getColor(a,b);break;case "opacity":d=
this.getOpacity(a,b);break;case "rotation":d=this.getRotationAngle(a,b)}return{variable:c,value:d}},this).filter(function(a){return null!=a.value},this));return d},hasVisualVariables:function(a,b){return a?!!this.getVisualVariablesForType(a,b):!!(this.getVisualVariablesForType("size",b)||this.getVisualVariablesForType("color",b)||this.getVisualVariablesForType("opacity",b)||this.getVisualVariablesForType("rotation",b))},getVisualVariablesForType:function(a,b){var c=this.visualVariables,d;c&&(d=c.filter(function(c){return c.type===
a&&("string"===typeof b?c.target===b:!1===b?!c.target:!0)}))&&0===d.length&&(d=void 0);return d},getSize:function(a,b){var c=this._getVarInfo(b&&b.sizeInfo,"size"),d=c.variable,c=this._cache[c.cacheKey],e=null;if(d)var f=d.minSize,e=d.maxSize,f="object"===typeof f&&f?this._getSize(a,f,c&&c.minSize,b):f,e="object"===typeof e&&e?this._getSize(a,e,c&&c.maxSize,b):e,e=this._getSize(a,d,c&&c.root,b,[f,e]);return e},getSizeRangeAtScale:function(a,b){var c;a=this._getVarInfo(a,"size");var d=this._cache[a.cacheKey],
e={scale:b};if((a=a.variable)&&b){b=a.minSize;var f=a.maxSize;a="object"===typeof b&&b?this._getSize({},b,d&&d.minSize,e):b;d="object"===typeof f&&f?this._getSize({},f,d&&d.maxSize,e):f;if(null!=a||null!=d)a>d&&(c=d,d=a,a=c),c={minSize:a,maxSize:d}}return c},getColor:function(a,b){var c=this._getVarInfo(b&&b.colorInfo,"color");return this._getColorComponent(a,c.variable,this._cache[c.cacheKey],b)},getOpacity:function(a,b){var c=this._getVarInfo(b&&b.opacityInfo,"opacity");return this._getColorComponent(a,
c.variable,this._cache[c.cacheKey],b,!0)},getRotationAngle:function(a,b){var c=this._getVarInfo(b&&b.rotationInfo,"rotation"),e=c.variable,f=this._cache[c.cacheKey],g=e.axis||"heading",c="heading"===g&&"arithmetic"===e.rotationType?90:0,g="heading"===g&&"arithmetic"===e.rotationType?-1:1,e=e.field,f=f&&f.compiledFunc,h=a.attributes,l=0;if(e||f)f?l=d.executeFunction(f,d.createExecContext(a,d.getViewInfo(b))):"function"===typeof e?l=e.apply(this,arguments):h&&(l=h[e]||0),l="number"!==typeof l||isNaN(l)?
null:c+g*l;return l},collectRequiredFields:function(a){var b=[];this.visualVariables&&(b=b.concat(this.visualVariables));b.forEach(function(b){b&&(b.field&&(a[b.field]=!0),b.normalizationField&&(a[b.normalizationField]=!0),b.valueExpression&&d.extractFieldNames(b.valueExpression).forEach(function(b){a[b]=!0}))})},_getVarInfo:function(a,b){var c;a&&a.type===b&&this.visualVariables?(c=this.visualVariables.indexOf(a),a=this.visualVariables[c]):this.visualVariables&&(a=(a=this.getVisualVariablesForType(b))&&
a[0],c=this.visualVariables.indexOf(a));return{variable:a,cacheKey:c}},_readSizeInfo:function(a){a.axis&&(a.axis=u.fromJSON(a.axis));a.valueUnit&&(a.valueUnit=y.fromJSON(a.valueUnit));return a},_readColorInfo:function(a){a&&(a.colors&&a.colors.forEach(function(b,c){Array.isArray(b)?a.colors[c]=m.fromJSON(b):a.colors[c]=new m(b)}),a.stops&&a.stops.forEach(function(b,c){b.color&&Array.isArray(b.color)?a.stops[c].color=m.fromJSON(b.color):b.color&&(a.stops[c].color=new m(b.color))}));return a},_readOpacityInfo:function(a){var b;
a&&(b=g.mixin({},a),b.transparencyValues&&(b.opacityValues=b.transparencyValues.map(z),delete b.transparencyValues),b.stops&&(b.stops=b.stops.map(function(a){a=g.mixin({},a);a.opacity=z(a.transparency);delete a.transparency;return a})));return b},_readVariables:function(a,b){a&&(a=a.map(function(a){a=g.clone(a);a.type=t.fromJSON(a.type);"size"===a.type?a=this._readSizeInfo(a):"color"===a.type?a=this._readColorInfo(a):"opacity"===a.type&&(a=this._readOpacityInfo(a));return a},this));var c=b.rotationType;
if(b=b.rotationExpression)c={type:"rotation",rotationType:c},(b=b.match(this._rotationRE))&&b[1]&&(c.field=b[1],a||(a=[]),a.push(c));return a},_createCache:function(a){var b=a&&a.valueExpression,c=d.createSyntaxTree(b),c=d.createFunction(c),e=!(!a||!a.expression)||this._viewScaleRE.test(b);return{ipData:this._interpolateData(a),hasExpr:!!b,compiledFunc:c,isScaleDriven:e}},_processColorInfo:function(a){a&&(a.colors&&a.colors.forEach(function(b,c){b instanceof m||(a.colors[c]=new m(b))}),a.stops&&a.stops.forEach(function(b,
c){!b.color||b.color instanceof m||(a.stops[c].color=new m(b.color))}),this._sortStops(a.stops));return this._createCache(a)},_processOpacityInfo:function(a){this._sortStops(a&&a.stops);return this._createCache(a)},_processSizeInfo:function(a){a.stops&&Array.isArray(a.stops)?a.stops=this._processSizeInfoStops(a.stops):(a.minSize=a.minSize&&this._processSizeInfoSize(a.minSize),a.maxSize=a.maxSize&&this._processSizeInfoSize(a.maxSize));return{root:this._createCache(a),minSize:this._createCache(a.minSize),
maxSize:this._createCache(a.maxSize)}},_processSizeInfoSize:function(a){"object"===typeof a?a.stops=this._processSizeInfoStops(a.stops):a=e.toPt(a);return a},_processSizeInfoStops:function(a){a&&Array.isArray(a)&&(a.forEach(function(a){a.size=e.toPt(a.size)}),this._sortStops(a));return a},_sortStops:function(a){a&&Array.isArray(a)&&a.sort(function(a,b){return a.value-b.value})},_processRotationInfo:function(a){return this._createCache(a)},_getSize:function(a,b,c,e,g){var f=a.attributes,h=b.field,
l=b.stops,m=0,k=c&&c.hasExpr,n=c&&c.compiledFunc,q=c&&c.ipData,t=c&&c.isScaleDriven,r="number"===typeof a,u=r?a:null;if(h||t||k){var B=e&&e.scale,y=g?g[0]:b.minSize,z=g?g[1]:b.maxSize,A=b.minDataValue,C=b.maxDataValue,X=b.valueUnit||"unknown",Y=b.valueRepresentation,m=b.scaleBy,O=b.normalizationField,M=f?parseFloat(f[O]):void 0,N=e&&e.shape;t?u=null==B?this._getAverageValue(b):B:"number"!==typeof u&&(k?u=d.executeFunction(n,d.createExecContext(a,d.getViewInfo(e))):"function"===typeof h?u=h.apply(this,
arguments):f&&(u=f[h]));if(null==u||O&&!r&&(isNaN(M)||0===M))return null;isNaN(M)||r||(u/=M);if(l)z=this._lookupData(u,q),u=z[0],y=z[1],u===y?m=l[u].size:(u=l[u].size,l=l[y].size,m=u+(l-u)*z[2]);else if(null!=y&&null!=z&&null!=A&&null!=C)u<=A?m=y:u>=C?m=z:(l=(u-A)/(C-A),"area"===m&&N?(y=(u="circle"===N)?x*Math.pow(y/2,2):y*y,l=y+l*((u?x*Math.pow(z/2,2):z*z)-y),m=u?2*Math.sqrt(l/x):Math.sqrt(l)):m=y+l*(z-y));else if("unknown"===X)null!=y&&null!=A?(y&&A?(l=u/A,m="circle"===N?2*Math.sqrt(l*Math.pow(y/
2,2)):"square"===N||"diamond"===N||"image"===N?Math.sqrt(l*Math.pow(y,2)):l*y):m=u+(y||A),m=m<y?y:m,null!=z&&m>z&&(m=z)):m=u;else{l=(e&&e.resolution?e.resolution:1)*p.meterIn[X];if("area"===Y)m=Math.sqrt(u/x)/l,m*=2;else if(m=u/l,"radius"===Y||"distance"===Y)m*=2;null!=y&&m<y&&(m=y);null!=z&&m>z&&(m=z)}}else b&&(m=l&&l[0]&&l[0].size,null==m&&(m=b.minSize));return m=isNaN(m)?0:m},_getAverageValue:function(a){var b=a.stops,c;b?(c=b[0].value,a=b[b.length-1].value):(c=a.minDataValue||0,a=a.maxDataValue||
0);return(c+a)/2},_getColorComponent:function(a,b,c,e,g,h){var f=a.attributes,l=b&&b.field,m="number"===typeof a,k=m?a:null,n=c&&c.hasExpr,p=c&&c.compiledFunc,q=c&&c.ipData,t;if(l||n){var r=b.normalizationField,u=f?parseFloat(f[r]):void 0;"number"!==typeof k&&(n?k=d.executeFunction(p,d.createExecContext(a,d.getViewInfo(e))):"function"===typeof l?k=l.apply(this,arguments):f&&(k=f[l]));null==k||r&&!m&&(isNaN(u)||0===u)||(isNaN(u)||m||(k/=u),t=g?this._getOpacity(k,b,q):this._getColor(k,b,q))}else b&&
(f=b.stops,g?(t=f&&f[0]&&f[0].opacity,null==t&&(t=b.opacityValues&&b.opacityValues[0])):t=f&&f[0]&&f[0].color||b.colors&&b.colors[0]);h&&(h.data=k,h.value=t);return h||t},_interpolateData:function(a){var b;if(a)if(a.colors||a.opacityValues){var c=(a.colors||a.opacityValues).length,d=a.minDataValue,e=(a.maxDataValue-d)/(c-1);b=[];for(a=0;a<c;a++)b[a]=d+a*e}else a.stops&&(b=a.stops.map(function(a){return a.value||0}));return b},_getOpacity:function(a,b,c){a=this._lookupData(a,c);var d;b=b||this.opacityInfo;
a&&(c=a[0],d=a[1],c===d?d=this._getOpacValue(b,c):(c=this._getOpacValue(b,c),b=this._getOpacValue(b,d),d=c+(b-c)*a[2]));return d},_getOpacValue:function(a,b){return a.opacityValues?a.opacityValues[b]:a.stops[b].opacity},_getColor:function(a,b,c){a=this._lookupData(a,c);var d;b=b||this.colorInfo;a&&(d=a[0],c=a[1],d=d===c?this._getColorObj(b,d):m.blendColors(this._getColorObj(b,d),this._getColorObj(b,c),a[2]),d=new m(d));return d},_getColorObj:function(a,b){return a.colors?a.colors[b]:a.stops[b].color},
_lookupData:function(a,b){var c;if(b){var d=0,e=b.length-1;b.some(function(b,c){if(a<b)return e=c,!0;d=c;return!1});c=[d,e,(a-b[d])/(b[e]-b[d])]}return c},_processForContext:function(a,b,c){if(b&&"web-scene"===b.origin){var d=null!=a.expression,e=null!=a.valueExpressionTitle&&"rotation"===a.type;b.messages&&(d&&b.messages.push(new l("property:unsupported",a.type+"VisualVariable.expression is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:c+
".expression",context:b})),e&&b.messages.push(new l("property:unsupported",a.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:c+".valueExpressionTitle",context:b})));d&&delete a.expression;e&&delete a.valueExpressionTitle}else"size"===a.type&&this._convertExpressionToArcade(a)},_writeRotationInfo:function(a,b,c){a&&(a=g.mixin({},a),this._processForContext(a,b,"visualVariables["+c+"]"),a.type=t.toJSON(a.type),
a=g.fixJson(a,!0));return a},_convertExpressionToArcade:function(a){a&&a.expression&&(a.valueExpression="$view.scale")},_writeSizeInfo:function(a,b,c){if(a){a=g.mixin({},a);this._processForContext(a,b,"string"===typeof c?c:"visualVariables["+c+"]");var d=a.minSize,e=a.maxSize;d&&(a.minSize="number"===typeof d?d:this._writeSizeInfo(d,b,"visualVariables["+c+"].minSize"));e&&(a.maxSize="number"===typeof e?e:this._writeSizeInfo(e,b,"visualVariables["+c+"].maxSize"));b=a.legendOptions;c=a.axis;a.type=
t.toJSON(a.type);c&&(a.axis=u.toJSON(c));b&&(a.legendOptions=g.mixin({},b),b=b.customValues)&&(a.legendOptions.customValues=b.slice(0));a.stops&&(a.stops=a.stops.map(function(a){a=g.mixin({},a);null===a.label&&delete a.label;return a}));a=g.fixJson(a,!0)}return a},_writeColorInfo:function(a,b,c){a&&(a=g.mixin({},a),this._processForContext(a,b,"visualVariables["+c+"]"),a.type=t.toJSON(a.type),a.colors&&(a.colors=a.colors.map(function(a){return m.toJSON(a)})),a.stops&&(a.stops=a.stops.map(function(a){a=
g.mixin({},a);a.color&&(a.color=m.toJSON(a.color));null==a.value&&(a.value=0);null===a.label&&delete a.label;return a})),a.legendOptions&&(a.legendOptions=g.mixin({},a.legendOptions)),a=g.fixJson(a,!0));return a},_writeOpacityInfo:function(a,b,c){var d;a&&(d=g.mixin({},a),this._processForContext(d,b,"visualVariables["+c+"]"),d.type=t.toJSON(d.type),d.opacityValues&&(d.transparencyValues=d.opacityValues.map(A),delete d.opacityValues),d.stops&&(d.stops=d.stops.map(function(a){a=g.mixin({},a);a.transparency=
A(a.opacity);delete a.opacity;null===a.label&&delete a.label;return a})),d.legendOptions&&(d.legendOptions=g.mixin({},d.legendOptions)),d=g.fixJson(d,!0));return d}})})},"esri/layers/vectorTiles/webdoc/support/opacityUtils":function(){define(["require","exports","../../core/accessorSupport/ensureType"],function(k,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.opacityToTransparency=function(b){b=a.ensureInteger(100*(1-b));return Math.max(0,Math.min(b,100))};b.transparencyToOpacity=function(a){return Math.max(0,
Math.min(1-a/100,1))}})},"esri/layers/vectorTiles/renderers/support/AuthoringInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/kebabDictionary ../../core/lang ../../core/accessorSupport/decorators ./AuthoringInfoVisualVariable".split(" "),function(k,b,a,c,e,g,l,d,h){var m=g({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",
esriClassifyStandardDeviation:"standard-deviation"}),p=g({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size"});return function(b){function e(a){a=b.call(this)||this;a.lengthUnit=null;a.visualVariables=null;return a}a(e,b);g=e;Object.defineProperty(e.prototype,"classificationMethod",{get:function(){if("class-breaks-size"===this.type||"class-breaks-color"===this.type){var a=this._get("classificationMethod");return a?a:"manual"}return null},
set:function(a){this._set("classificationMethod",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fields",{get:function(){return"predominance"===this.type?this._get("fields"):null},set:function(a){this._set("fields",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"field1",{get:function(){return"relationship"===this.type?this._get("field1"):null},set:function(a){this._set("field1",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"field2",
{get:function(){return"relationship"===this.type?this._get("field2"):null},set:function(a){this._set("field2",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"focus",{get:function(){return"relationship"===this.type?this._get("focus"):null},set:function(a){this._set("focus",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"numClasses",{get:function(){return"relationship"===this.type?this._get("numClasses"):null},set:function(a){this._set("numClasses",a)},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"standardDeviationInterval",{get:function(){return"standard-deviation"===this.classificationMethod?this._get("standardDeviationInterval"):null},set:function(a){this._set("standardDeviationInterval",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"type",{get:function(){return this._get("type")},set:function(a){var b=a;"classed-size"===a?b="class-breaks-size":"classed-color"===a&&(b="class-breaks-color");this._set("type",
b)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new g({classificationMethod:this.classificationMethod,fields:this.fields&&this.fields.slice(0),field1:l.clone(this.field1),field2:l.clone(this.field2),focus:this.focus,numClasses:this.numClasses,lengthUnit:this.lengthUnit,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(a){return a.clone()})})};c([d.property({type:String,value:null,
dependsOn:["type"],json:{read:m.read,write:m.write}})],e.prototype,"classificationMethod",null);c([d.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"fields",null);c([d.property({value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"field1",null);c([d.property({value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"field2",null);c([d.property({type:String,value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"focus",null);c([d.property({type:Number,
value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"numClasses",null);c([d.property({type:String,json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],e.prototype,"lengthUnit",void 0);c([d.property({type:Number,value:null,dependsOn:["classificationMethod"],json:{write:!0}})],e.prototype,"standardDeviationInterval",null);c([d.property({type:String,value:null,json:{read:p.read,write:p.write}})],e.prototype,"type",null);c([d.property({type:[h],json:{write:!0}})],e.prototype,"visualVariables",
void 0);return e=g=c([d.subclass("esri.renderers.support.AuthoringInfo")],e);var g}(d.declared(e))})},"esri/layers/vectorTiles/renderers/support/AuthoringInfoVisualVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/kebabDictionary ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast".split(" "),function(k,b,a,c,e,g,l,d){var h=g({percentTotal:"percent-of-total"}),m=
g({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity"}),p={key:function(a){return"number"===typeof a?"number":"string"},typeMap:{number:Number,string:String},base:null};return function(b){function e(a){a=b.call(this)||this;a.endTime=null;a.field=null;a.maxSliderValue=null;a.minSliderValue=null;a.startTime=null;a.type=null;a.units=null;return a}a(e,b);g=e;e.prototype.castEndTime=function(a){return"string"===typeof a||"number"===typeof a?a:null};e.prototype.castStartTime=function(a){return"string"===
typeof a||"number"===typeof a?a:null};Object.defineProperty(e.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(a){this._set("style",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(a){this._set("theme",a)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new g({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,
minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})};c([l.property({types:p,json:{write:!0}})],e.prototype,"endTime",void 0);c([d.cast("endTime")],e.prototype,"castEndTime",null);c([l.property({type:String,json:{write:!0}})],e.prototype,"field",void 0);c([l.property({type:Number,json:{write:!0}})],e.prototype,"maxSliderValue",void 0);c([l.property({type:Number,json:{write:!0}})],e.prototype,"minSliderValue",void 0);c([l.property({types:p,
json:{write:!0}})],e.prototype,"startTime",void 0);c([d.cast("startTime")],e.prototype,"castStartTime",null);c([l.property({type:String,value:null,dependsOn:["type"],json:{read:h.read,write:h.write}})],e.prototype,"style",null);c([l.property({type:String,value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"theme",null);c([l.property({type:String,json:{read:m.read,write:m.write}})],e.prototype,"type",void 0);c([l.property({type:String,json:{write:!0}})],e.prototype,"units",void 0);return e=
g=c([l.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],e);var g}(l.declared(e))})},"esri/layers/vectorTiles/renderers/support/LegendOptions":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(k,b,a,c,e,g){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.title=null;return a}
a(d,b);e=d;d.prototype.clone=function(){return new e({title:this.title})};c([g.property({type:String,json:{write:!0}})],d.prototype,"title",void 0);return d=e=c([g.subclass("esri.renderers.support.LegendOptions")],d);var e}(g.declared(e));b.LegendOptions=k;b.default=k})},"esri/layers/vectorTiles/renderers/support/ClassBreakInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils ../../symbols/support/typeUtils".split(" "),
function(k,b,a,c,e,g,l,d){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function e(){var a=null!==b&&b.apply(this,arguments)||this;a.description=null;a.label=null;a.minValue=null;a.maxValue=0;a.symbol=null;return a}a(e,b);h=e;e.prototype.clone=function(){return new h({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})};c([g.property({type:String,json:{write:!0}})],e.prototype,"description",void 0);
c([g.property({type:String,json:{write:!0}})],e.prototype,"label",void 0);c([g.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],e.prototype,"minValue",void 0);c([g.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],e.prototype,"maxValue",void 0);c([g.property({types:d.rendererTypes,json:{origins:{"web-scene":{read:l.read,write:{target:{symbol:{types:d.rendererTypes3D}},writer:l.writeTarget}}},read:l.read,write:l.writeTarget}})],
e.prototype,"symbol",void 0);return e=h=c([g.subclass("esri.renderers.support.ClassBreakInfo")],e);var h}(g.declared(e));b.ClassBreakInfo=k;b.default=k})},"esri/layers/vectorTiles/renderers/HeatmapRenderer":function(){define(["require","exports","../core/tsSupport/declareExtendsHelper","./Renderer"],function(k,b,a,c){return function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.type="heatmap";return a}a(c,b);return c}(c)})},"esri/layers/vectorTiles/renderers/SimpleRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Renderer ../symbols/support/jsonUtils ../symbols/support/typeUtils".split(" "),
function(k,b,a,c,e,g,l,d,h){return function(b){function l(){var a=null!==b&&b.apply(this,arguments)||this;a.description=null;a.label=null;a.symbol=null;a.type="simple";return a}a(l,b);m=l;l.prototype.writeSymbolWebScene=function(a,b,c,e){d.writeTarget(a,b,c,e)};l.prototype.writeSymbol=function(a,b,c,e){d.writeTarget(a,b,c,e)};l.prototype.readSymbol=function(a,b,c){return d.read(a,b,c)};l.prototype.getSymbol=function(a,b){return this.symbol};l.prototype.getSymbols=function(){return this.symbol?[this.symbol]:
[]};l.prototype.clone=function(){return new m({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:e.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};c([g.property({type:String,json:{write:!0}})],l.prototype,"description",void 0);c([g.property({type:String,json:{write:!0}})],l.prototype,"label",void 0);c([g.property({types:h.rendererTypes})],l.prototype,"symbol",void 0);c([g.writer("web-scene","symbol",{symbol:{types:h.rendererTypes3D}})],
l.prototype,"writeSymbolWebScene",null);c([g.writer("symbol")],l.prototype,"writeSymbol",null);c([g.reader("symbol")],l.prototype,"readSymbol",null);return l=m=c([g.subclass("esri.renderers.SimpleRenderer")],l);var m}(g.declared(l))})},"esri/layers/vectorTiles/renderers/UniqueValueRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../symbols ../core/arrayUtils ../core/Error ../core/lang ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../portal/Portal ./Renderer ./support/diffUtils ./support/LegendOptions ./support/UniqueValueInfo ../support/arcadeUtils ../symbols/support/jsonUtils ../symbols/support/styleUtils ../symbols/support/typeUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z,f,n,r,B){var C=m.getLogger("esri.renderers.UniqueValueRenderer"),D=t.ensureType(z.default);return function(b){function m(a){a=b.call(this)||this;a._valueInfoMap={};a._isDefaultSymbolDerived=!1;a.type="unique-value";a.backgroundFillSymbol=null;a.field=null;a.field2=null;a.field3=null;a.valueExpression=null;a.valueExpressionTitle=null;a.legendOptions=null;a.defaultLabel=null;a.fieldDelimiter=null;a.portal=null;a.styleOrigin=null;a.diff={uniqueValueInfos:function(a,
b){if(a||b){if(!a||!b)return{type:"complete",oldValue:a,newValue:b};for(var c=!1,d={type:"collection",added:[],removed:[],changed:[],unchanged:[]},e=function(e){var f=l.find(a,function(a){return a.value===b[e].value});f?x.diff(f,b[e])?d.changed.push({type:"complete",oldValue:f,newValue:b[e]}):d.unchanged.push({oldValue:f,newValue:b[e]}):d.added.push(b[e]);c=!0},f=0;f<b.length;f++)e(f);e=function(e){l.find(b,function(b){return b.value===a[e].value})||(d.removed.push(a[e]),c=!0)};for(f=0;f<a.length;f++)e(f);
return c?d:void 0}}};a._set("uniqueValueInfos",[]);return a}a(m,b);k=m;m.prototype.writeType=function(a,b,c,d){b.type="uniqueValue"};m.prototype.writeBackgroundFillSymbolWebScene=function(a,b,c,d){n.writeTarget(a,b,c,d)};m.prototype.castField=function(a){return null==a?a:"function"===typeof a?a:t.ensureString(a)};m.prototype.writeField=function(a,b,c,e){"string"===typeof a?b[c]=a:e&&e.messages?e.messages.push(new d("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):
C.error(".field: cannot write field to JSON since it's not a string value")};Object.defineProperty(m.prototype,"compiledFunc",{get:function(){return f.createFunction(this.valueExpression)},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"defaultSymbol",{set:function(a){this._isDefaultSymbolDerived=!1;this._set("defaultSymbol",a)},enumerable:!0,configurable:!0});m.prototype.readDefaultSymbol=function(a,b,c){return n.read(a,b,c)};m.prototype.writeDefaultSymbolWebScene=function(a,b,
c,d){this._isDefaultSymbolDerived||n.writeTarget(a,b,c,d)};m.prototype.writeDefaultSymbol=function(a,b,c,d){this._isDefaultSymbolDerived||n.writeTarget(a,b,c,d)};m.prototype.readPortal=function(a,b,c){return c.portal||u.getDefault()};m.prototype.readStyleOrigin=function(a,b,c){if(b.styleName)return Object.freeze({styleName:b.styleName});if(b.styleUrl)return a=p.read(b.styleUrl,c),Object.freeze({styleUrl:a})};m.prototype.writeStyleOrigin=function(a,b,c,d){a.styleName?b.styleName=a.styleName:a.styleUrl&&
(b.styleUrl=p.write(a.styleUrl,d),p.isAbsolute(b.styleUrl)&&(b.styleUrl=p.normalize(b.styleUrl)))};Object.defineProperty(m.prototype,"uniqueValueInfos",{set:function(a){this.styleOrigin?C.error("#uniqueValueInfos\x3d","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",a),this._updateValueInfoMap())},enumerable:!0,configurable:!0});m.prototype.addUniqueValueInfo=function(a,b){this.styleOrigin?C.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):
(a="object"===typeof a?D(a):new z.default({value:a,symbol:b}),this.uniqueValueInfos.push(a),this._valueInfoMap[a.value]=a)};m.prototype.removeUniqueValueInfo=function(a){if(this.styleOrigin)C.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var b=0;b<this.uniqueValueInfos.length;b++)if(this.uniqueValueInfos[b].value===a+""){delete this._valueInfoMap[a];this.uniqueValueInfos.splice(b,1);break}};m.prototype.getUniqueValueInfo=
function(a,b){var c=this.field,d=a.attributes,e;this.valueExpression?e=f.executeFunction(this.compiledFunc,f.createExecContext(a,f.getViewInfo(b))):"function"!==typeof c&&this.field2?(a=this.field2,b=this.field3,e=[],c&&e.push(d[c]),a&&e.push(d[a]),b&&e.push(d[b]),e=e.join(this.fieldDelimiter||"")):"function"===typeof c?e=c(a):c&&(e=d[c]);return this._valueInfoMap[e+""]};m.prototype.getSymbol=function(a,b){return(a=this.getUniqueValueInfo(a,b))&&a.symbol||this.defaultSymbol};m.prototype.getSymbols=
function(){for(var a=[],b=0,c=this.uniqueValueInfos;b<c.length;b++){var d=c[b];d.symbol&&a.push(d.symbol)}this.defaultSymbol&&a.push(this.defaultSymbol);return a};m.prototype.clone=function(){var a=new k({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:h.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:h.clone(this.visualVariables),legendOptions:h.clone(this.legendOptions),
authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:h.clone(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(a._isDefaultSymbolDerived=!0);a._set("portal",this.portal);var b=h.clone(this.uniqueValueInfos);this.styleOrigin&&(a._set("styleOrigin",Object.freeze(h.clone(this.styleOrigin))),Object.freeze(b));a._set("uniqueValueInfos",b);a._updateValueInfoMap();return a};m.prototype.collectRequiredFields=function(a){this.inherited(arguments);[this.field,this.field2,
this.field3].forEach(function(b){b&&"string"===typeof b&&(a[b]=!0)});this.valueExpression&&f.extractFieldNames(this.valueExpression).forEach(function(b){a[b]=!0})};m.prototype.populateFromStyle=function(){var a=this;return r.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(b){var c=[];a._valueInfoMap={};b&&b.data&&Array.isArray(b.data.items)&&b.data.items.forEach(function(d){var e=new g.WebStyleSymbol({styleUrl:b.styleUrl,styleName:b.styleName,portal:a.portal,name:d.name});a.defaultSymbol||
d.name!==b.data.defaultItem||(a.defaultSymbol=e,a._isDefaultSymbolDerived=!0);e=new z.default({value:d.name,symbol:e});c.push(e);a._valueInfoMap[d.name]=e});a._set("uniqueValueInfos",Object.freeze(c));!a.defaultSymbol&&a.uniqueValueInfos.length&&(a.defaultSymbol=a.uniqueValueInfos[0].symbol,a._isDefaultSymbolDerived=!0);return a})};m.prototype._updateValueInfoMap=function(){var a=this;this._valueInfoMap={};this.uniqueValueInfos.forEach(function(b){return a._valueInfoMap[b.value+""]=b})};m.fromPortalStyle=
function(a,b){var c=new k(b&&b.properties);c._set("styleOrigin",Object.freeze({styleName:a}));c._set("portal",b&&b.portal||u.getDefault());b=c.populateFromStyle();b.catch(function(b){C.error("#fromPortalStyle('"+a+"'[, ...])","Failed to create unique value renderer from style name",b)});return b};m.fromStyleUrl=function(a,b){b=new k(b&&b.properties);b._set("styleOrigin",Object.freeze({styleUrl:a}));b=b.populateFromStyle();b.catch(function(b){C.error("#fromStyleUrl('"+a+"'[, ...])","Failed to create unique value renderer from style URL",
b)});return b};c([q.property()],m.prototype,"type",void 0);c([q.writer("type")],m.prototype,"writeType",null);c([q.property({types:{base:g.BaseSymbol,key:"type",typeMap:{"simple-fill":B.rendererTypes.typeMap["simple-fill"],"picture-fill":B.rendererTypes.typeMap["picture-fill"],"polygon-3d":B.rendererTypes.typeMap["polygon-3d"]}},json:{read:n.read,write:n.writeTarget}})],m.prototype,"backgroundFillSymbol",void 0);c([q.writer("web-scene","backgroundFillSymbol",{backgroundFillSymbol:{type:g.PolygonSymbol3D}})],
m.prototype,"writeBackgroundFillSymbolWebScene",null);c([q.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],m.prototype,"field",void 0);c([q.cast("field")],m.prototype,"castField",null);c([q.writer("field")],m.prototype,"writeField",null);c([q.property({type:String,json:{write:!0}})],m.prototype,"field2",void 0);c([q.property({type:String,json:{write:!0}})],m.prototype,"field3",void 0);c([q.property({type:String,json:{write:!0}})],m.prototype,"valueExpression",void 0);
c([q.property({type:String,json:{write:!0}})],m.prototype,"valueExpressionTitle",void 0);c([q.property({dependsOn:["valueExpression"]})],m.prototype,"compiledFunc",null);c([q.property({type:A.default,json:{write:!0}})],m.prototype,"legendOptions",void 0);c([q.property({type:String,json:{write:!0}})],m.prototype,"defaultLabel",void 0);c([q.property({types:B.rendererTypes})],m.prototype,"defaultSymbol",null);c([q.reader("defaultSymbol")],m.prototype,"readDefaultSymbol",null);c([q.writer("web-scene",
"defaultSymbol",{defaultSymbol:{types:B.rendererTypes3D}})],m.prototype,"writeDefaultSymbolWebScene",null);c([q.writer("defaultSymbol")],m.prototype,"writeDefaultSymbol",null);c([q.property({type:String,json:{write:!0}})],m.prototype,"fieldDelimiter",void 0);c([q.property({type:u,readOnly:!0})],m.prototype,"portal",void 0);c([q.reader("portal",["styleName"])],m.prototype,"readPortal",null);c([q.property({readOnly:!0})],m.prototype,"styleOrigin",void 0);c([q.reader("styleOrigin",["styleName","styleUrl"])],
m.prototype,"readStyleOrigin",null);c([q.writer("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],m.prototype,"writeStyleOrigin",null);c([q.property({type:[z.default],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],m.prototype,"uniqueValueInfos",null);c([q.property({dependsOn:["field","field2","field3","valueExpression"],readOnly:!0})],m.prototype,"requiredFields",void 0);c([e(1,q.cast(B.ensureType))],m.prototype,"addUniqueValueInfo",null);
return m=k=c([q.subclass("esri.renderers.UniqueValueRenderer")],m);var k}(q.declared(y))})},"esri/layers/vectorTiles/core/tsSupport/paramHelper":function(){define([],function(){return function(k,b){return function(a,c){b(a,c,k)}}})},"esri/layers/vectorTiles/core/arrayUtils":function(){define(["require","exports"],function(k,b){function a(a,b,c){for(var d=a.length,e=0;e<d;e++)if(b.call(c,a[e],e,a))return e;return-1}function c(a,b,c,d){void 0===c&&(c=a.length);d=d||m;for(var e=Math.max(0,d.last-10),
g=-1,h=e;h<c;++h)if(a[h]===b){g=h;break}if(-1===g){for(h=0;h<e;++h)if(a[h]===b){g=h;break}if(-1===g)return}a[g]=a[c-1];a.pop();d.last=g;return b}function e(a,b,d,e){void 0===d&&(d=a.length);var g=[];b.forEach(function(b){void 0!==c(a,b,d,e)&&(g.push(b),--d)});return g}function g(a,b){return-1===a.indexOf(b)}function l(a,b,c){return!a.some(b.bind(null,c))}function d(a){return a}Object.defineProperty(b,"__esModule",{value:!0});b.findIndex=a;b.find=function(a,b,c){for(var d=a.length,e=0;e<d;e++){var g=
a[e];if(b.call(c,g,e,a))return g}};b.unique=function(a){return a.filter(function(a,b,c){return c.indexOf(a)===b})};b.equals=function(a,b,c){if(!a&&!b)return!0;if(!a||!b||a.length!==b.length)return!1;if(c)for(var d=0;d<a.length;d++){if(!c(a[d],b[d]))return!1}else for(d=0;d<a.length;d++)if(a[d]!==b[d])return!1;return!0};b.difference=function(a,b,c){var d;c?(d=b.filter(l.bind(null,a,c)),a=a.filter(l.bind(null,b,c))):(d=b.filter(g.bind(null,a)),a=a.filter(g.bind(null,b)));return{added:d,removed:a}};b.intersect=
function(b,c,d){return b&&c?d?b.filter(function(b){return-1<a(c,function(a){return d(b,a)})}):b.filter(function(a){return-1<c.indexOf(a)}):[]};b.constant=function(a,b){for(var c=Array(a),d=0;d<a;d++)c[d]=b;return c};b.range=function(a,b){void 0===b&&(b=a,a=0);for(var c=Array(b-a),d=a;d<b;d++)c[d-a]=d;return c};b.binaryIndexOf=function(a,b,c){for(var d=a.length,e=0,g=d-1;e<g;){var h=e+Math.floor((g-e)/2);b>a[h]?e=h+1:g=h}g=a[e];return c?b>=a[d-1]?-1:g===b?e:e-1:g===b?e:-1};var h=function(){return function(){this.last=
0}}();b.RemoveHint=h;var m=new h;k=function(){return function(a){var b=this;this._array=a;this._hint=new h;this.remove=function(a){return c(b._array,a,b._array.length,b._hint)};this.removeMany=function(a){return e(b._array,a,b._array.length,b._hint)}}}();b.UnorderedRemover=k;b.removeUnordered=c;b.removeUnorderedMany=e;b.keysOfMap=function(a){var b=[];a.forEach(function(a,c){return b.push(c)});return b};b.keysOfSet=function(a,b){void 0===b&&(b=d);var c=[];a.forEach(function(a){return c.push(b(a))});
return c}})},"esri/layers/vectorTiles/portal/Portal":function(){define(["require","exports"],function(k,b){return function(){function a(){}a.getDefault=function(){return null};return a}()})},"esri/layers/vectorTiles/renderers/support/diffUtils":function(){define(["require","exports","../../core/Accessor","../../core/Collection","../../core/accessorSupport/utils"],function(k,b,a,c,e){function g(b){return b instanceof c?Object.keys(b.items):b instanceof a?e.getProperties(b).keys():b?Object.keys(b):
[]}function l(a,b){return a instanceof c?a.items[b]:a[b]}function d(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}function h(a){return a?a.declaredClass:null}function m(b,c){var e=b.diff;if(e&&"function"===typeof e)return e(b,c);var k=g(b),q=g(c);if(0!==k.length||0!==q.length){if(!k.length||!q.length||d(b,c))return{type:"complete",oldValue:b,newValue:c};var t=q.filter(function(a){return-1===k.indexOf(a)}),z=k.filter(function(a){return-1===q.indexOf(a)}),t=k.filter(function(a){return-1<
q.indexOf(a)&&l(b,a)!==l(c,a)}).concat(t,z).sort();if((z=h(b))&&-1<p.indexOf(z)&&t.length)return{type:"complete",oldValue:b,newValue:c};var f,z=b instanceof a&&c instanceof a,n;for(n in t){var r=t[n],B=l(b,r),C=l(c,r),D=void 0;(z||"function"!==typeof B&&"function"!==typeof C)&&B!==C&&(null!=B||null!=C)&&(D=e&&e[r]&&"function"===typeof e[r]?e[r](B,C):"object"===typeof B&&"object"===typeof C&&h(B)===h(C)?m(B,C):{type:"complete",oldValue:B,newValue:C})&&(f=f||{type:"partial",diff:{}},f.diff[r]=D)}return f}}
Object.defineProperty(b,"__esModule",{value:!0});var p=["esri.Color","esri.portal.Portal"];b.diff=function(a,b){if("function"!==typeof a&&"function"!==typeof b&&(a||b))return!a||!b||"object"===typeof a&&"object"===typeof b&&h(a)!==h(b)?{type:"complete",oldValue:a,newValue:b}:m(a,b)}})},"esri/layers/vectorTiles/core/Collection":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper dojo/aspect ./Accessor ./ArrayPool ./Evented ./lang ./ObjectPool ./scheduling ./accessorSupport/decorators ./accessorSupport/ensureType".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t){function u(a){return a?a.isInstanceOf&&a.isInstanceOf(F):!1}function y(a){return a?u(a)?a.toArray():a.length?Array.prototype.slice.apply(a):[]:[]}function x(a){if(a&&a.length)return a[0]}function A(a,b,c,d){b&&b.forEach(function(b,e,f){a.push(b);A(a,c.call(d,b,e,f),c,d)})}k=function(){function a(){this.target=null;this.defaultPrevented=this.cancellable=!1}a.prototype.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};a.prototype.reset=function(a){this.defaultPrevented=
!1;this.item=a};return a}();var z=function(){},f=new m(k,!0,function(a){a.item=null;a.target=null}),n=new Set,r=new Set,B=new Set,C=new Map,D=0,F=function(b){function d(a){a=b.call(this,a)||this;a._boundDispatch=a._dispatchColChange.bind(a);a._chgListeners=[];a._notifications=null;a._timer=null;a.length=0;a._items=[];Object.defineProperty(a,"uid",{value:D++});return a}a(d,b);g=d;d.ofType=function(a){if(!a)return g;if(C.has(a))return C.get(a);var b;if("function"===typeof a)b=a.prototype.declaredClass;
else if(a.base)b=a.base.prototype.declaredClass;else for(var c in a.typeMap){var d=a.typeMap[c].prototype.declaredClass;b=b?b+(" | "+d):d}b=g.createSubclass({declaredClass:"esri.core.Collection\x3c"+b+"\x3e"});c={Type:a,ensureType:"function"===typeof a?t.ensureType(a):t.ensureOneOfType(a)};Object.defineProperty(b.prototype,"itemType",{value:c});C.set(a,b);return b};d.prototype.normalizeCtorArgs=function(a){return a?Array.isArray(a)||u(a)?{items:a}:a:{}};Object.defineProperty(d.prototype,"items",{get:function(){return this._items},
set:function(a){this._emitBeforeChanges()||(this._splice.apply(this,[0,this.length].concat(y(a))),this._emitAfterChanges())},enumerable:!0,configurable:!0});d.prototype.on=function(a,b){var c;Array.isArray(a)?c=a:-1<a.indexOf(",")&&(c=a.split(/\s*,\s*/));if(c){var d=[];for(a=0;a<c.length;a++)d.push(this.on(c[a],b));d.remove=function(){for(var a=0;a<d.length;a++)d[a].remove()};return d}if("change"===a){var f=this._chgListeners,g={removed:!1,callback:b};f.push(g);this._notifications&&this._notifications.push({listeners:f.slice(),
items:this._items.slice(),changes:[]});return{remove:function(){this.remove=z;g.removed=!0;f.splice(f.indexOf(g),1)}}}return e.after(this,"on"+a,b,!0)};d.prototype.hasEventListener=function(a){return"change"===a?0<this._chgListeners.length:this.inherited(arguments)};d.prototype.add=function(a,b){if(this._emitBeforeChanges())return this;b=this.getNextIndex(b);this._splice(b,0,a);this._emitAfterChanges();return this};d.prototype.addMany=function(a,b){void 0===b&&(b=this._items.length);if(!a||!a.length||
this._emitBeforeChanges())return this;b=this.getNextIndex(b);this._splice.apply(this,[b,0].concat(y(a)));this._emitAfterChanges();return this};d.prototype.removeAll=function(){if(!this.length||this._emitBeforeChanges())return[];var a=this._splice(0,this.length)||[];this._emitAfterChanges();return a};d.prototype.clone=function(){return this._createNewInstance({items:this._items.map(h.clone)})};d.prototype.concat=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=a.map(y);return this._createNewInstance({items:(c=
this._items).concat.apply(c,a)});var c};d.prototype.drain=function(a,b){if(this.length&&!this._emitBeforeChanges()){for(var c=this._splice(0,this.length),d=c.length,e=0;e<d;e++)a.call(b,c[e],e,c);this._emitAfterChanges()}};d.prototype.every=function(a,b){return this._items.every(a,b)};d.prototype.filter=function(a,b){var c;c=2===arguments.length?this._items.filter(a,b):this._items.filter(a);return this._createNewInstance({items:c})};d.prototype.find=function(a,b){if("function"!==typeof a)throw new TypeError(a+
" is not a function");for(var c=this._items,d=c.length,e=0;e<d;e++){var f=c[e];if(a.call(b,f,e,c))return f}};d.prototype.findIndex=function(a,b){if("function"!==typeof a)throw new TypeError(a+" is not a function");for(var c=this._items,d=c.length,e=0;e<d;e++)if(a.call(b,c[e],e,c))return e;return-1};d.prototype.flatten=function(a,b){var c=[];A(c,this,a,b);return new g(c)};d.prototype.forEach=function(a,b){for(var c=this._items,d=c.length,e=0;e<d;e++)a.call(b,c[e],e,c)};d.prototype.getItemAt=function(a){return this._items[a]};
d.prototype.getNextIndex=function(a){var b=this.length;a=null==a?b:a;0>a?a=0:a>b&&(a=b);return a};d.prototype.includes=function(a,b){void 0===b&&(b=0);return arguments.length?-1!==this._items.indexOf(a,b):!1};d.prototype.indexOf=function(a,b){void 0===b&&(b=0);return this._items.indexOf(a,b)};d.prototype.join=function(a){void 0===a&&(a=",");return this._items.join(a)};d.prototype.lastIndexOf=function(a,b){void 0===b&&(b=this.length-1);return this._items.lastIndexOf(a,b)};d.prototype.map=function(a,
b){a=this._items.map(a,b);return new g({items:a})};d.prototype.reorder=function(a,b){void 0===b&&(b=this.length-1);var c=this.indexOf(a);if(-1!==c){0>b?b=0:b>=this.length&&(b=this.length-1);if(c!==b){if(this._emitBeforeChanges())return a;this._splice(c,1);this._splice(b,0,a);this._emitAfterChanges()}return a}};d.prototype.pop=function(){if(this.length&&!this._emitBeforeChanges()){var a=x(this._splice(this.length-1,1));this._emitAfterChanges();return a}};d.prototype.push=function(){for(var a=[],b=
0;b<arguments.length;b++)a[b]=arguments[b];if(this._emitBeforeChanges())return this.length;this._splice.apply(this,[this.length,0].concat(a));this._emitAfterChanges();return this.length};d.prototype.reduce=function(a,b){var c=this._items;return 2===arguments.length?c.reduce(a,b):c.reduce(a)};d.prototype.reduceRight=function(a,b){var c=this._items;return 2===arguments.length?c.reduceRight(a,b):c.reduceRight(a)};d.prototype.remove=function(a){return this.removeAt(this.indexOf(a))};d.prototype.removeAt=
function(a){if(!(0>a||a>=this.length||this._emitBeforeChanges()))return a=x(this._splice(a,1)),this._emitAfterChanges(),a};d.prototype.removeMany=function(a){if(!a||!a.length||this._emitBeforeChanges())return[];a=u(a)?a.toArray():a;for(var b=this._items,c=[],d=a.length,e=0;e<d;e++){var f=b.indexOf(a[e]);if(-1<f){for(var g=e+1,h=f+1,l=Math.min(a.length-g,b.length-h),m=0;m<l&&a[g+m]===b[h+m];)m++;g=1+m;(f=this._splice(f,g))&&0<f.length&&c.push.apply(c,f);e+=g-1}}this._emitAfterChanges();return c};d.prototype.reverse=
function(){if(this._emitBeforeChanges())return this;var a=this._splice(0,this.length);a&&(a.reverse(),this._splice.apply(this,[0,0].concat(a)));this._emitAfterChanges();return this};d.prototype.shift=function(){if(this.length&&!this._emitBeforeChanges()){var a=x(this._splice(0,1));this._emitAfterChanges();return a}};d.prototype.slice=function(a,b){void 0===a&&(a=0);void 0===b&&(b=this.length);return this._createNewInstance({items:this._items.slice(a,b)})};d.prototype.some=function(a,b){return this._items.some(a,
b)};d.prototype.sort=function(a){if(!this.length||this._emitBeforeChanges())return this;var b=this._splice(0,this.length);arguments.length?b.sort(a):b.sort();this._splice.apply(this,[0,0].concat(b));return this};d.prototype.splice=function(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];if(this._emitBeforeChanges())return[];c=this._splice.apply(this,[a,b].concat(c))||[];this._emitAfterChanges();return c};d.prototype.toArray=function(){return this._items.slice()};d.prototype.toJSON=
function(){return this.toArray()};d.prototype.toLocaleString=function(){return this._items.toLocaleString()};d.prototype.toString=function(){return this._items.toString()};d.prototype.unshift=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(this._emitBeforeChanges())return this.length;this._splice.apply(this,[0,0].concat(a));this._emitAfterChanges();return this.length};d.prototype._createNewInstance=function(a){return new this.constructor(a)};d.prototype._splice=function(a,
b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];var d=this._items,e=this.constructor.prototype.itemType,g,h;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=p.schedule(this._boundDispatch));if(b){h=d.splice(a,b);if(this.hasEventListener("before-remove")){var l=f.acquire();l.target=this;l.cancellable=!0;for(var m=0,k=h.length;m<k;m++)g=
h[m],l.reset(g),this.emit("before-remove",l),l.defaultPrevented&&(h.splice(m,1),d.splice(a,0,g),a+=1,--m,--k);f.release(l)}this.length=this._items.length;if(this.hasEventListener("after-remove")){g=f.acquire();g.target=this;g.cancellable=!1;k=h.length;for(m=0;m<k;m++)g.reset(h[m]),this.emit("after-remove",g);f.release(g)}}if(c&&c.length){if(e){m=[];for(k=0;k<c.length;k++)g=c[k],l=e.ensureType(g),null==l&&null!=g||m.push(l);c=m}e=this.hasEventListener("before-add");m=this.hasEventListener("after-add");
k=a===this.length;if(e||m){g=f.acquire();g.target=this;g.cancellable=!0;l=f.acquire();l.target=this;l.cancellable=!1;for(var n=0,q=c;n<q.length;n++){var r=q[n];e?(g.reset(r),this.emit("before-add",g),g.defaultPrevented||(k?d.push(r):d.splice(a++,0,r),this._set("length",d.length),m&&(l.reset(r),this.emit("after-add",l)))):(k?d.push(r):d.splice(a++,0,r),this._set("length",d.length),l.reset(r),this.emit("after-add",l))}f.release(g)}else k?d.push.apply(d,c):d.splice.apply(d,[a,0].concat(c)),this._set("length",
d.length)}(c&&c.length||h&&h.length)&&this._notifyChangeEvent(c,h);return h};d.prototype._emitBeforeChanges=function(){var a=!1;if(this.hasEventListener("before-changes")){var b=f.acquire();b.target=this;b.cancellable=!0;this.emit("before-changes",b);a=b.defaultPrevented;f.release(b)}return a};d.prototype._emitAfterChanges=function(){if(this.hasEventListener("after-changes")){var a=f.acquire();a.target=this;a.cancellable=!1;this.emit("after-changes",a);f.release(a)}};d.prototype._notifyChangeEvent=
function(a,b){this.hasEventListener("change")&&this._notifications[this._notifications.length-1].changes.push({added:a,removed:b})};d.prototype._dispatchColChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var a=this._notifications;this._notifications=null;for(var b=function(a){var b=a.changes;n.clear();r.clear();B.clear();for(var d=0;d<b.length;d++){var e=b[d],f=e.added,e=e.removed;if(f)if(0===B.size&&0===r.size)for(var g=0,h=f;g<h.length;g++)f=h[g],n.add(f);
else for(g=0,h=f;g<h.length;g++)f=h[g],r.has(f)?(B.add(f),r.delete(f)):B.has(f)||n.add(f);if(e)if(0===B.size&&0===n.size)for(g=0;g<e.length;g++)f=e[g],r.add(f);else for(g=0;g<e.length;g++)f=e[g],n.has(f)?n.delete(f):(B.delete(f),r.add(f))}var m=l.acquire();n.forEach(function(a){m.push(a)});var k=l.acquire();r.forEach(function(a){k.push(a)});var p=c._items,q=a.items,t=l.acquire();B.forEach(function(a){q.indexOf(a)!==p.indexOf(a)&&t.push(a)});if(a.listeners&&(m.length||k.length||t.length))for(b={target:c,
added:m,removed:k,moved:t},d=a.listeners.length,f=0;f<d;f++)e=a.listeners[f],e.removed||e.callback.call(c,b);l.release(m);l.release(k);l.release(t)},c=this,d=0;d<a.length;d++)b(a[d]);n.clear();r.clear();B.clear()}};d.isCollection=u;c([q.property()],d.prototype,"length",void 0);c([q.property()],d.prototype,"items",null);return d=g=c([q.subclass("esri.core.Collection")],d);var g}(q.declared(g,d));return F})},"esri/layers/vectorTiles/core/Evented":function(){define(["require","exports","dojo/aspect",
"dojo/on"],function(k,b,a,c){function e(a,b,c,h){var d;Array.isArray(b)?d=b:-1<b.indexOf(",")&&(d=b.split(/\s*,\s*/));if(d){var g=[];for(b=0;b<d.length;b++)g.push(e(a,d[b],c,h));g.remove=function(){for(var a=0;a<g.length;a++)g[a].remove()};return g}return h(a,b)}return function(){function b(){}b.prototype.emit=function(a,b){if(this.hasEventListener(a))return b=b||{},b.target||(b.target=this),c.emit(this,a,b)};b.prototype.on=function(b,c){return e(this,b,c,function(b,d){return a.after(b,"on"+d,c,!0)})};
b.prototype.hasEventListener=function(a){a="on"+a;return!(!this[a]||!this[a].after)};return b}()})},"esri/layers/vectorTiles/renderers/support/UniqueValueInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils ../../symbols/support/typeUtils".split(" "),function(k,b,a,c,e,g,l,d){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function e(){var a=
null!==b&&b.apply(this,arguments)||this;a.description=null;a.label=null;a.symbol=null;a.value=null;return a}a(e,b);h=e;e.prototype.clone=function(){return new h({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})};c([g.property({type:String,json:{write:!0}})],e.prototype,"description",void 0);c([g.property({type:String,json:{write:!0}})],e.prototype,"label",void 0);c([g.property({types:d.rendererTypes,json:{origins:{"web-scene":{read:l.read,
write:{target:{symbol:{types:d.rendererTypes3D}},writer:l.writeTarget}}},read:l.read,write:l.writeTarget}})],e.prototype,"symbol",void 0);c([g.property({type:String,json:{write:!0}})],e.prototype,"value",void 0);return e=h=c([g.subclass("esri.renderers.support.UniqueValueInfo")],e);var h}(g.declared(e));b.UniqueValueInfo=k;b.default=k})},"esri/layers/vectorTiles/symbols/support/styleUtils":function(){define(["require","exports","../../core/promiseUtils","../../core/Error"],function(k,b,a,c){Object.defineProperty(b,
"__esModule",{value:!0});b.fetchStyle=function(b,g){return a.reject(new c("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}})},"esri/layers/vectorTiles/renderers/support/jsonUtils":function(){define("require exports ../../core/Error ../../core/object ../../core/Warning ../ClassBreaksRenderer ../HeatmapRenderer ../SimpleRenderer ../UniqueValueRenderer".split(" "),function(k,b,a,c,e,g,l,d,h){function m(a,b,c){if(!a)return null;if(a&&(a.styleName||
a.styleUrl)&&"uniqueValue"!==a.type)return c&&c.messages&&c.messages.push(new e("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+a.type+"'",{definition:a,context:c})),null;b=a?q[a.type]||null:null;if(b)return b=new b,b.read(a,c),b;c&&c.messages&&a&&c.messages.push(new e("renderer:unsupported","Renderers of type '"+(a.type||"unknown")+"' are not supported",{definition:a,context:c}));return null}function p(b,c,d){return b?d&&"web-scene"===d.origin&&"heatmap"===
b.type?(d.messages&&d.messages.push(new a("renderer:unsupported","Renderer of type '"+b.declaredClass+"' are not supported in scenes.",{renderer:b,context:d})),null):b.write(c,d):null}Object.defineProperty(b,"__esModule",{value:!0});var q={simple:d,uniqueValue:h,classBreaks:g,heatmap:l};b.read=m;b.writeTarget=function(a,b,d,e){(a=p(a,{},e))&&c.setDeepValue(d,a,b)};b.write=p;b.fromJSON=function(a,b){return m(a,null,b)}})},"esri/layers/vectorTiles/core/executeAsync":function(){define("require exports dojo/has ./nextTick ./now ./promiseUtils".split(" "),
function(k,b,a,c,e,g){function l(){var a=0===d.length;if(!a){for(var b=e();!a&&6>e()-b;){var g=d[m];if(g){if(!0===g()){var k=h.get(g);d[m]=null;h.delete(g);k()}m=(m+1)%d.length}else d.splice(m,1),m=(a=0===d.length)?0:m%d.length}a||c(l)}}var d=[],h=new Map,m=0;return function(a){return a?g.create(function(b){d.push(a);h.set(a,b);1===d.length&&c(l)},function(){d[d.indexOf(a)]=null;h.delete(a)}):g.reject(new TypeError("callback is not a function"))}})},"esri/layers/vectorTiles/core/MapPool":function(){define(["require",
"exports","./ObjectPool"],function(k,b,a){k=function(){function b(b,c){void 0===b&&(b=50);void 0===c&&(c=50);this._pool=new a(Map,!1,function(a){return a.clear()},c,b)}b.prototype.acquire=function(){return this._pool.acquire()};b.prototype.release=function(a){this._pool.release(a)};b.acquire=function(){return c.acquire()};b.release=function(a){return c.release(a)};return b}();var c=new k(100);return k})},"esri/layers/vectorTiles/core/SetPool":function(){define(["require","exports","./ObjectPool"],
function(k,b,a){k=function(){function b(b,c){void 0===b&&(b=50);void 0===c&&(c=50);this._pool=new a(Set,!1,function(a){return a.clear()},c,b)}b.prototype.acquire=function(){return this._pool.acquire()};b.prototype.release=function(a){this._pool.release(a)};b.acquire=function(){return c.acquire()};b.release=function(a){return c.release(a)};return b}();var c=new k(100);return k})},"esri/layers/vectorTiles/views/2d/engine/webgl/rendererInfoUtils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Graphic ../../../../arcade/Feature ../../../../support/arcadeUtils ./enums ./visualVariablesUtils".split(" "),
function(k,b,a,c,e,g,l,d){function h(b,d,e){if(!b)return null;var h=0,l={};b=b.clone();var k=b.visualVariables,p=null;if("simple"!==b.type){var q=b.valueExpression;if(!b.field&&q){var f="$$fake"+h++,n=g.createFunction(q);l[f]=function(a,b){m.repurposeFromGraphicLikeObject(a.geometry,a.attributes,e);return g.executeFunction(n,{vars:{$feature:m,$view:g.getViewInfo(b)},spatialReference:d})};b.field=f;b.valueExpression=null;p=function(a,b){b.attributes[f]=l[f](b);return a.valueExpression?a.getSymbol(c.fromJSON(b)):
a.getSymbol(b)}}}k&&(b.visualVariables=k.map(function(b){if(b.normalizationField){var c=b.field,f=b.normalizationField,k="$$fake"+h++;l[k]=function(a,b){return a.attributes[c]/a.attributes[f]};b=a({},b);b.field=k;delete b.normalizationField;return b}if(b.valueExpression&&"$view.scale"!==b.valueExpression){var n=b.valueExpression,k="$$fake"+h++,p=g.createFunction(n);l[k]=function(a,b){m.repurposeFromGraphicLikeObject(a.geometry,a.attributes,e);return g.executeFunction(p,{vars:{$feature:m,$view:g.getViewInfo(b)},
spatialReference:d})};b=a({},b);b.field=k;delete b.valueExpression}return b}));return{renderer:b,normalizingFunctions:l,getSymbolFunction:p}}Object.defineProperty(b,"__esModule",{value:!0});var m=new e;b.createRendererInfo=function(a,b,c){var e=(b=h(a,b,c)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},b.normalizingFunctions),g=b&&b.getSymbolFunction;a=b&&b.renderer||a;b=d.convertVisualVariables(a.visualVariables);return{renderer:a,vvFields:b.vvFields,vvRanges:b.vvRanges,getValue:function(a,
b){var c=e[b];return c?c(a):a.attributes[b]},getSymbol:function(a){return g?g(this.renderer,a):this.renderer.getSymbol?this.renderer.getSymbol.call(this.renderer,a):null}}};b.getNormalizedRenderer=function(a,b,c){return(b=h(a,b,c)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},b.renderer)||a};b.getSymbol=function(a,b){return a.getSymbol(b)};b.isRendererWebGLCompatible=function(a){if(!a||-1===["simple","class-breaks","unique-value","heatmap"].indexOf(a.type))return!1;if(a.visualVariables){var b=
0;for(a=a.visualVariables;b<a.length;b++){var c=a[b];switch(c.type){case "color":case "opacity":if(c.stops&&8<c.stops.length)return!1;break;case "size":if(d.getTypeOfSizeVisualVariable(c)===l.WGLVVFlag.SIZE_FIELD_STOPS&&c.stops&&6<c.stops.length)return!1}}}return!0}})},"esri/layers/vectorTiles/views/2d/layers/features/tileRenderers/SymbolTileRenderer":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../renderers ../../../../../core/Accessor ../../../../../core/accessorSupport/decorators ../../../../../geometry/support/aaBoundingRect ../../../../../renderers/support/diffUtils ../../../engine/webgl/rendererInfoUtils ../../../engine/webgl/visualVariablesUtils ../../../engine/webgl/WGLFeatureView ../../../engine/webgl/WGLTile ./BaseTileRenderer".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u){function y(a){for(var b in a.diff){var c=a.diff[b];if("collection"===c.type){if(0!==c.changed.length||0!==c.added.length||0!==c.removed.length)return!0}else if("visualVariables"!==b&&"authoringInfo"!==b)return!0}return!1}Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function g(a){return b.call(this)||this}a(g,b);g.prototype.initialize=function(){};g.prototype.createTile=function(a){var b=d.create();this.tileInfoView.getTileBounds(b,a);return new t(a,
b)};g.prototype.disposeTile=function(a){this._featuresView.removeChild(a)};g.prototype.highlight=function(a){return this._featuresView.highlight(a)};g.prototype.hitTest=function(a,b){return this._featuresView.hitTest(a,b)};g.prototype.supportsRenderer=function(a){return null!=a&&m.isRendererWebGLCompatible(a)&&-1!==["simple","class-breaks","unique-value"].indexOf(a.type)};g.prototype.getProcessorConfiguration=function(){var a=this.layer;return{type:"symbol",renderer:a.renderer.toJSON(),devicePixelRatio:window.devicePixelRatio||
1,definitionExpression:a.definitionExpression,outFields:a.outFields.slice().sort(),gdbVersion:a.gdbVersion,historicMoment:a.historicMoment&&a.historicMoment.getTime(),labelingInfo:a.labelingInfo&&a.labelingInfo.map(function(a){return a.toJSON()})}};g.prototype.needsProcessorReconfiguration=function(a){var b=this.configuration;if(!b||b.definitionExpression!==a.definitionExpression||b.outFields.join()!==a.outFields.join())return!0;b=this.configuration&&e.fromJSON(this.configuration.renderer)||null;
a=a&&e.fromJSON(a.renderer)||null;b=h.diff(b,a);if(!b)return!1;switch(b.type){case "complete":return!0;case "partial":if(y(b))return!0;if(b.diff.visualVariables){var b=this._featuresView.visualVariablesInfo,c=this.tileInfoView.tileInfo.spatialReference,d={fields:this.layer.fields.map(function(a){return a.toJSON()})};a=m.getNormalizedRenderer(a,c,d);a=p.convertVisualVariables(a.visualVariables).vvFields;return h.diff(b.vvFields,a)?!0:!1}}};g.prototype.applyConfiguration=function(a,b){var c=e.fromJSON(a.renderer),
d={fields:this.layer.fields.map(function(a){return a.toJSON()})},c=m.getNormalizedRenderer(c,this.tileInfoView.tileInfo.spatialReference,d);this.configuration=a;this._featuresView.visualVariablesInfo=p.convertVisualVariables(c.visualVariables);b&&this._featuresView.disposeWebGLResources()};g.prototype.install=function(a){var b=new q.default({highlightOptions:this.highlightOptions,tileInfoView:this.tileInfoView,layer:this.layer,layerView:this.layerView});this._featuresView=b;b.install(a)};g.prototype.uninstall=
function(a){this._featuresView.uninstall(a)};g.prototype.onTileData=function(a){var b=this.tiles.get(a.tileKey);b&&(this._featuresView.onTileData(b,a.data),this.requestUpdate())};g.prototype.onTileDataUpdate=function(a){var b=this.tiles.get(a.tileId);b&&(this._featuresView.onTileDataUpdate(b,a.data),this.requestUpdate())};g.prototype.onTileError=function(a){if(a=this.tiles.get(a.tileKey))this._featuresView.onTileError(a),this.requestUpdate()};g.prototype.getMaterialItems=function(a){return this._featuresView.getMaterialItems(a)};
return g=c([l.subclass()],g)}(l.declared(g,u.default));b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix/mat2d ../../../../core/libs/gl-matrix/mat4 ../../../../core/libs/gl-matrix/vec2 ../DisplayObject ./definitions ./DirtyMap ./DisplayRecordStore ./enums ./number ./Utils ./WGLBuffers ./WGLDisplayList ./WGLDisplayObject ../../tiling/enums ../../tiling/TileKey".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A,z){function f(a,b){return a.sortKey-b.sortKey}return function(b){function l(a,d){var f=b.call(this)||this;f.status=A.TileStatus.INITIALIZED;f._data=null;f.hlDisplayList=null;f._wglBuffers=null;f._dirtyMap=new h.default;f.coords=[0,0];f.bounds=[0,0,0,0];f.tileTransform={transform:Float32Array[16],screenTransform:Float32Array[16],displayCoord:Float32Array[2],screenCoord:Float32Array[2]};f._hasVisualVariables=!1;f._labelIndex=null;f.tileTransform.screenTransform=
c.create();f.tileTransform.transform=e.create();f.tileTransform.displayCoord=g.create();f.tileTransform.screenCoord=g.create();f.key=z.pool.acquire(a);f.coords[0]=d[0];f.coords[1]=d[3];f.bounds=d;return f}a(l,b);Object.defineProperty(l.prototype,"iconGeometry",{get:function(){return this.getGeometry(p.WGLGeometryType.MARKER)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"textGeometry",{get:function(){return this.getGeometry(p.WGLGeometryType.TEXT)},enumerable:!0,configurable:!0});
Object.defineProperty(l.prototype,"fillGeometry",{get:function(){return this.getGeometry(p.WGLGeometryType.FILL)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"lineGeometry",{get:function(){return this.getGeometry(p.WGLGeometryType.LINE)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"labelGeometry",{get:function(){return this.getGeometry(p.WGLGeometryType.LABEL)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},
enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"canDisplay",{get:function(){return!!this.attached&&!!this._data},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"isDirty",{get:function(){return this.status===A.TileStatus.MODIFIED},set:function(a){a&&this.status===A.TileStatus.READY?this.setStatus(A.TileStatus.MODIFIED):a||this.status!==A.TileStatus.MODIFIED||this.setStatus(A.TileStatus.READY);this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,
"hasData",{get:function(){return this.status===A.TileStatus.MODIFIED||this.status===A.TileStatus.READY},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});l.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};l.prototype.getDisplayList=function(a){switch(a){case p.WGLDrawPhase.HIGHLIGHT:return this.hlDisplayList;default:return this._data&&
this._data.tileDisplayData.displayList}};Object.defineProperty(l.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});l.prototype.setData=function(a,b,c){this._hasVisualVariables=b;a&&a.tileDisplayData?(this._dispRecStore=m.default.fromTileData(a,this._dirtyMap),this._data=a,a.tileBufferData.geometries[4].indexBuffer.length?(this.setStatus(c?A.TileStatus.MODIFIED:A.TileStatus.READY),this._rebuildLabelIndex()):this.setStatus(A.TileStatus.READY),this._dirtyMap.markAllDirty()):
(this.clear(),this.setStatus(A.TileStatus.NO_DATA))};l.prototype.patchData=function(a,b){this._data||(this.setData(a.addOrUpdate,this._hasVisualVariables,b),a.addOrUpdate=null);this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=m.default.fromTileData(this._data,this._dirtyMap));a.addOrUpdate.tileBufferData.geometries[4].indexBuffer.length?(this.setStatus(b?A.TileStatus.MODIFIED:A.TileStatus.READY),this._rebuildLabelIndex()):this.setStatus(A.TileStatus.READY)};
l.prototype.commitChanges=function(a){this._data&&this.status===A.TileStatus.READY&&(this._wglBuffers||(this._wglBuffers=new u.default(a.context,this._hasVisualVariables)),this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._dirtyMap.markAllClean())};l.prototype.setVisibility=function(a,b){for(var c=this._data.tileBufferData.geometries.map(function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}}),d=0;d<a.length;d++)for(var e=a[d],f=0,g=this._data.tileDisplayData.displayObjectRegistry.get(e.id).displayRecords;f<
g.length;f++){var h=g[f];if(null==b||b===h.geometryType){var l=c[h.geometryType],m=l.geometry.vertexBuffer[t.C_VBO_VISIBILITY];if(m){l.vertexFrom=null==l.vertexFrom?h.vertexFrom:Math.min(l.vertexFrom,h.vertexFrom);l.vertexTo=null==l.vertexTo?h.vertexFrom+h.vertexCount:Math.max(l.vertexTo,h.vertexFrom+h.vertexCount);for(var l=h.vertexFrom*m.stride/4,h=h.vertexCount*m.stride/4,k=0;k<h;++k)m.data[l+k]=e.visibility?4294967295:0}}}b=!1;for(a=0;a<c.length;++a)l=c[a],null!=l.vertexFrom&&null!=l.vertexTo&&
(b=l.vertexTo?l.vertexTo-l.vertexFrom:0,this.setStatus(A.TileStatus.MODIFIED),this._dirtyMap.markDirtyVertices(a,t.C_VBO_VISIBILITY,l.vertexFrom,b),b=!0);b&&this.requestRender()};l.prototype.setVisibilityRange=function(a,b,c,d){c=q.i8888to32(c,d,c,d);var e=d=void 0,f=this._data.tileBufferData.geometries[p.WGLGeometryType.LABEL].vertexBuffer[t.C_VBO_VISIBILITY_RANGE];a=this._data.tileDisplayData.displayObjectRegistry.get(a);b=a.metrics[b];var g=b.range.from;for(b=g+b.range.count;g<b;++g){var h=a.displayRecords[g];
if(h.geometryType===p.WGLGeometryType.LABEL){d=null==d?h.vertexFrom:Math.min(d,h.vertexFrom);for(var e=null==e?h.vertexFrom+h.vertexCount:Math.max(e,h.vertexFrom+h.vertexCount),l=h.vertexFrom*f.stride/4,h=h.vertexCount*f.stride/4,m=0;m<h;++m)f.data[l+m]=c}}this._dirtyMap.markDirtyVertices(p.WGLGeometryType.LABEL,t.C_VBO_VISIBILITY_RANGE,d,e?e-d:0)};l.prototype.setStatus=function(a){this.status=a;if(a===A.TileStatus.READY||a===A.TileStatus.NO_DATA)this.attached=!0};l.prototype.clear=function(){this._data=
null;this.setStatus(A.TileStatus.INVALID);this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null);this.hlDisplayList&&(this.hlDisplayList=null)};l.prototype.dispose=function(){this.clear()};l.prototype.attach=function(a){return this.canDisplay};l.prototype.detach=function(a){b.prototype.detach.call(this,a)};l.prototype.doRender=function(a){var b=this;this.attached&&(this.commitChanges(a),a.context.setStencilFunction(514,this.stencilRef,255),a.painter.getBrushes(a.drawPhase).forEach(function(c){return c.draw(a,
b)}))};l.prototype.buildHLList=function(a){var b=this;this.hlDisplayList=new y;a.forEach(function(a){b._addToHLDisplayList(b.hlDisplayList,a)})};l.prototype._addToHLDisplayList=function(a,b){if(this._data){var c=this._data.tileDisplayData.displayObjectRegistry.get(b);if(c){b=[];for(var d=0,c=c.displayRecords;d<c.length;d++){var e=c[d].copy();e.meshData=null;e.symbolLevel=0;e.zOrder=0;b.push(e)}b.sort(f);a.addToList(b)}}};l.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();
for(var a=0,b=this.displayObjects;a<b.length;a++)this._insertIntoLabelIndex(b[a])};l.prototype._insertIntoLabelIndex=function(a){var b=a.anchor;-1!==a.xBucket&&b&&this.labelIndex[a.yBucket][a.xBucket].push(a)};l.prototype._initLabelIndex=function(){for(var a=[],b=0;b<d.TILE_SIZE/d.COLLISION_BUCKET_SIZE;b++){a.push([]);for(var c=0;c<d.TILE_SIZE/d.COLLISION_BUCKET_SIZE;c++)a[b].push([])}return a};l.prototype._patchData=function(a){for(var b=!0,c=0,d=a.remove||[];c<d.length;c++){var e=d[c],f=this._data.tileDisplayData.displayObjectRegistry.get(e);
if(f){this._data.tileDisplayData.displayList.removeFromList(f.displayRecords);for(var g=0,h=f.displayRecords;g<h.length;g++)this._dispRecStore.delete(h[g]);this._data.tileDisplayData.displayObjectRegistry.delete(e);f=this._data.tileDisplayData.displayObjects.indexOf(f);this._data.tileDisplayData.displayObjects.splice(f,1)}}c=0;for(d=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[];c<d.length;c++){e=d[c];if(f=this._data.tileDisplayData.displayObjectRegistry.get(e.id)){for(var l=
f.displayRecords.length,g=0;g<l;++g){var h=f.displayRecords[g],m=e.displayRecords[g];if(g>=e.displayRecords.length||h.geometryType!==m.geometryType||h.symbolLevel!==m.symbolLevel||h.zOrder!==m.zOrder||h.materialInfo.materialKey!==m.materialInfo.materialKey)this._dispRecStore.delete(f.displayRecords[g]),g<e.displayRecords.length&&(f.displayRecords[g]=void 0)}f.displayRecords.length=e.displayRecords.length}else f=new x(e.id),this._data.tileDisplayData.displayObjectRegistry.set(e.id,f),this._data.tileDisplayData.displayObjects.push(f);
l=e.displayRecords.length;for(g=0;g<l;++g){m=e.displayRecords[g];(h=f.displayRecords[g])?(h.meshData=m.meshData,h.materialInfo=m.materialInfo):(h=m.copy(),h.vertexFrom=void 0,h.indexFrom=void 0,f.displayRecords[g]=h);var k=a.addOrUpdate.tileBufferData.geometries[m.geometryType],b=this._dispRecStore.setMeshData(h,m,k.vertexBuffer,k.indexBuffer)&&b}}return b};return l}(l)})},"esri/layers/vectorTiles/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(k,b,a){function c(a,
b,c){a.allDirty||(null!=a.from&&null!=a.count?(a.from=Math.min(a.from,b),a.count=Math.max(a.from+a.count,b+c)-a.from):(a.from=b,a.count=c))}Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(){this._dirties=a.createGeometryData(void 0,function(a){return{indices:{from:null,count:null,allDirty:!1}}},function(a,b){return{vertices:{from:null,count:null,allDirty:!1}}})}b.prototype.markAllClean=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.from=null;
c.data.indices.count=null;c.data.indices.allDirty=!1;for(var e in c.buffers)c.buffers[e].data.vertices.from=null,c.buffers[e].data.vertices.count=null,c.buffers[e].data.vertices.allDirty=!1}};b.prototype.markAllDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var c=b[a];c.data.indices.allDirty=!0;for(var e in c.buffers)c.buffers[e].data.vertices.allDirty=!0}};b.prototype.forEach=function(a){for(var b=new Map,c=0;c<this._dirties.length;++c){var e=this._dirties[c],g=new Map,k;for(k in e.buffers){var q=
e.buffers[k].data.vertices;(q.allDirty||null!=q.from&&null!=q.count)&&g.set(k,q)}e=e.data.indices;q=void 0;q=e.allDirty||null!=e.from&&null!=e.count?{indices:e,vertices:g}:{indices:void 0,vertices:g};(q.indices||0<q.vertices.size)&&b.set(c,q)}b.forEach(function(b,c){a({indices:b.indices||null,vertices:0<b.vertices.size?b.vertices:null},c)})};b.prototype.markDirtyIndices=function(a,b,d){c(this._dirties[a].data.indices,b,d)};b.prototype.markDirtyVertices=function(a,b,d,e){c(this._dirties[a].buffers[b].data.vertices,
d,e)};return b}();b.default=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","dojo/has","./FreeList","./Utils"],function(k,b,a,c,e){function g(a){a=a.getStrides();var b={},c;for(c in a)b[l[c]]=a[c];return b}Object.defineProperty(b,"__esModule",{value:!0});var l=["FILL","LINE","MARKER","TEXT","LABEL"];k=function(){function b(a,b,d,e){this._strides=a;this._displayList=b;this._vertexAlignments={};this._freeListsAndStorage={};this._dirtyMap=
null;this._dirtyMap=d;for(var g in a){d=b=!1;this._freeListsAndStorage[g]={vtxFreeList:e?new c.FreeList(e):null,idxFreeList:e?new c.FreeList(e):null,vertexBuffers:{},indexBuffer:e?new Uint32Array(e):null};for(var h in a[g])this._freeListsAndStorage[g].vertexBuffers[h]={data:e?new Uint32Array(Math.floor(e*a[g][h]/4)):null,stride:a[g][h]},2===a[g][h]%4?b=!0:0!==a[g][h]%4&&(d=!0);this._vertexAlignments[g]=d?4:b?2:1}}b.fromTileData=function(a,d){var e=g(a),h=[0,0,0,0,0],m=[0,0,0,0,0],k=[];a.tileDisplayData.displayObjectRegistry.forEach(function(a){k.push(a)});
for(var y=0;y<k.length;y++)for(var x=0,A=k[y].displayRecords;x<A.length;x++){var z=A[x];h[z.geometryType]=Math.max(h[z.geometryType],z.vertexFrom+z.vertexCount);m[z.geometryType]=Math.max(m[z.geometryType],z.indexFrom+z.indexCount)}d=new b(e,a.tileDisplayData.displayList,d,null);for(e=0;e<a.tileBufferData.geometries.length;++e){var y=h[e],z=m[e],A=a.tileBufferData.geometries[e],x=d._storageFor(l[e]),f=a.tileBufferData.geometries[e].indexBuffer;x.indexBuffer=f;x.idxFreeList=new c.FreeList(f.length);
x.idxFreeList.allocate(z);var z=void 0,n;for(n in A.vertexBuffer)A=a.tileBufferData.geometries[e].vertexBuffer[n],x.vertexBuffers[n].data=A.data,x.vertexBuffers[n].stride=A.stride,z=4*A.data.length/A.stride;x.vtxFreeList=new c.FreeList(z);x.vtxFreeList.allocate(y)}return d};b.prototype.delete=function(a){var b=l[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};
b.prototype.setMeshData=function(a,b,c,d){var g=l[a.geometryType];a.meshData=null;var h=void 0,m=void 0;void 0===a.vertexFrom?(m=this._align(g,b.vertexCount),h=this._allocateVertices(g,m)):b.vertexCount>a.vertexCount?(this._freeVertices(g,a.vertexFrom,a.vertexCount),m=this._align(g,b.vertexCount),h=this._allocateVertices(g,m)):b.vertexCount===a.vertexCount?(h=a.vertexFrom,m=a.vertexCount):(this._freeVertices(g,a.vertexFrom+b.vertexCount,a.vertexCount-b.vertexCount),h=a.vertexFrom,m=b.vertexCount);
var k=!0,p=void 0,q=void 0;void 0===a.indexFrom?(q=b.indexCount,p=this._allocateIndices(g,q)):b.indexCount>a.indexCount?(this._displayList.removeFromList(a),this._freeIndices(g,a.indexFrom,a.indexCount),q=b.indexCount,p=this._allocateIndices(g,q)):b.indexCount===a.indexCount?(k=!1,p=a.indexFrom,q=a.indexCount):(this._displayList.removeFromList(a),this._freeIndices(g,a.indexFrom+b.indexCount,a.indexCount-b.indexCount),p=a.indexFrom,q=b.indexCount);if(-1!==h&&-1!==p){g=this._storageFor(g);e.copyMeshData(h,
p,g.vertexBuffers,g.indexBuffer,b,c,d);a.vertexFrom=h;a.indexFrom=p;a.vertexCount=b.vertexCount;a.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var f in c)this._dirtyMap.markDirtyVertices(a.geometryType,f,a.vertexFrom,a.vertexCount)}k&&this._displayList.addToList(a);return!0}-1!==h&&this._freeVertices(g,h,m);-1!==p&&this._freeIndices(g,p,q);a.setMeshDataFromBuffers(b,c,d);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;
a.indexCount=0;return!1};b.prototype._allocateVertices=function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};b.prototype._freeVertices=function(b,c,d){var e=this._storageFor(b);e.vtxFreeList.free(c,d);if(a("esri-feature-tiles-debug"))for(var g in e.vertexBuffers)for(var h=e.vertexBuffers[g].data,l=this._stridesFor(b,g),m=c*l/4,l=d*l/4,k=m;k<m+l;++k)h[k]=0};b.prototype._freeIndices=function(b,c,d){b=this._storageFor(b);b.idxFreeList.free(c,
d);if(a("esri-feature-tiles-debug")){b=b.indexBuffer;for(var e=c;e<c+d;++e)b[e]=0}};b.prototype._align=function(a,b){var c=b%this._vertexAlignments[a];return 0===c?b:b+(this._vertexAlignments[a]-c)};b.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:b};b.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};b.prototype._stridesFor=function(a,b){return this._strides[a][b]};return b}();b.default=
k})},"esri/layers/vectorTiles/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(k,b){Object.defineProperty(b,"__esModule",{value:!0});var a=function(){function a(a){this._largestRange=null;this._parent=a;this._updateLargestRange()}Object.defineProperty(a.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});a.prototype.rangeCreated=function(a){if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};
a.prototype.rangeResized=function(a,b,c){if(a===this._largestRange)a.count<c&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.findBestRange=function(a){for(var b=this._parent._freeHead,c=null;null!==b;)b.count>=a&&(!c||b.count-a<c.count-a)&&(c=b),b=b.next;return c};a.prototype.findAdjacentRanges=function(a,b){for(var c=!0,d=!1,e=null,g=this._parent._freeHead;c&&!d;){var k=null!==g?g.from:this._parent._size;a>=(null!==e?e.from+
e.count:0)&&a+b<=k?(c=!1,d=!0):null!==g?(e=g,g=g.next):c=!1}return[e,g]};a.prototype._updateLargestRange=function(){for(var a=null,b=this._parent._freeHead;null!==b;){if(!a||b.count>a.count)a=b;b=b.next}this._largestRange=a};return a}();k=function(){function b(b,c){this._allocated=0;this._size=b;this._freeHead=0<b?{from:0,count:b,prev:null,next:null}:null;this._bookKeeper=c||new a(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}b.prototype.allocate=function(a){var c=this._bookKeeper.findBestRange(a);
if(null===c)return-1;var e=c.from,d=c.count;c.from+=a;c.count-=a;this._bookKeeper.rangeResized(c,e,d);this._allocated+=a;0===c.count&&(a=null!==c.prev?this._freeHead:c.next,b._removeRange(c),this._freeHead=a);return e};b.prototype.free=function(a,c){var e=this._bookKeeper.findAdjacentRanges(a,c),d=e[0],e=e[1];a={from:a,count:c,prev:d,next:e};null!==d&&(d.next=a);null!==e&&(e.prev=a);this._bookKeeper.rangeCreated(a);this._allocated-=c;if(null!==e&&a.from+a.count===e.from){c=a.from;var g=a.count;b._fuse(a,
e);b._removeRange(e);this._bookKeeper.rangeResized(a,c,g);this._bookKeeper.rangeResized(e,void 0,0)}null!==d&&d.from+d.count===a.from&&(c=d.from,g=d.count,b._fuse(d,a),b._removeRange(a),this._bookKeeper.rangeResized(d,c,g),this._bookKeeper.rangeResized(a,void 0,0));this._freeHead=null!==a.prev?this._freeHead:a};Object.defineProperty(b.prototype,"fragmentation",{get:function(){var a=this._size-this._allocated;return 0===a?0:1-this._bookKeeper.largestRange.count/a},enumerable:!0,configurable:!0});b._removeRange=
function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};b._fuse=function(a,b){a.count+=b.count;a.next=b.next;b.from+=b.count;b.count=0;null!==b.next&&(b.next.prev=a)};return b}();b.FreeList=k})},"esri/layers/vectorTiles/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","./Utils","../../../webgl/BufferObject"],function(k,b,a,c){Object.defineProperty(b,"__esModule",{value:!0});k=function(){function b(b,
e){this.geometryMap=a.createGeometryData(e,function(a){return{indexBuffer:c.createIndex(b,35044),vao:null}},function(d,e){return{vertexBuffer:c.createVertex(b,a.C_VBO_INFO[e])}})}b.prototype.dispose=function(){for(var a in this.geometryMap){var b=this.geometryMap[a];b.data.vao&&b.data.vao.dispose(!1);b.data.indexBuffer&&b.data.indexBuffer.dispose();for(var c in b.buffers)b.buffers[c]&&b.buffers[c].data.vertexBuffer.dispose()}};b.prototype.get=function(a){var b=this.geometryMap[a];a={};for(var c in b.buffers)a[c]=
b.buffers[c].data.vertexBuffer;return{indexBuffer:b.data.indexBuffer,get vao(){return b.data.vao},set vao(a){b.data.vao=a},vertexBufferMap:a}};b.prototype.has=function(a){return null!=this.geometryMap[a]};b.prototype.upload=function(a,b){var c=this;b.forEach(function(b,d){b.indices&&(b.indices.allDirty?c._uploadIndices(a,d):null!=b.indices.from&&null!=b.indices.count&&c._uploadIndices(a,d,b.indices.from,b.indices.count));b.vertices&&b.vertices.forEach(function(b,e){b.allDirty?c._uploadVertices(a,
d,e):null!=b.from&&null!=b.count&&c._uploadVertices(a,d,e,b.from,b.count)})})};b.prototype._uploadVertices=function(a,b,c,e,k){var d=this.geometryMap[b];d&&(b=a.geometries[b].vertexBuffer[c])&&(a=b.stride,b=b.data.buffer,d.buffers[c]&&0<b.byteLength&&(null!=e&&null!=k?d.buffers[c].data.vertexBuffer.setSubData(b,e*a,e*a,(e+k)*a):d.buffers[c].data.vertexBuffer.setData(b)))};b.prototype._uploadIndices=function(a,b,c,e){var d=this.geometryMap[b];d&&(a=a.geometries[b].indexBuffer.buffer,d.data.indexBuffer&&
0<a.byteLength&&(null!=c&&null!=e?d.data.indexBuffer.setSubData(a,4*c,4*c,4*(c+e)):d.data.indexBuffer.setData(a)))};return b}();b.default=k})},"esri/layers/vectorTiles/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(k,b,a){return function(){function b(a,b,c,d){this.set(a,b,c,d)}b.from=function(a,c,l,d){return b.pool.acquire(a,c,l,d)};b.getId=function(a,b,c,d){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+b+"/"+c+"/"+d};
Object.defineProperty(b.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});b.prototype.equals=function(a){return this.level===a.level&&this.row===a.row&&this.col===a.col&&this.world===a.world};b.prototype.release=function(){this.world=this.col=this.row=this.level=0};b.prototype.set=function(a,b,c,d){null==a?this.world=this.col=this.row=this.level=0:"object"===typeof a?
(this.level=a.level||0,this.row=a.row||0,this.col=a.col||0,this.world=a.world||0):"string"===typeof a?(a=a.split("/"),b=a[1],c=a[2],d=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(b),this.col=parseFloat(c),this.world=parseFloat(d)):(this.level=+a,this.row=+b,this.col=+c,this.world=+d||0);return this};b.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};b.prototype.getChildKeys=function(){var a=this.level+1,c=this.row<<1,l=this.col<<1,d=this.world;return[b.pool.acquire(a,
c,l,d),b.pool.acquire(a,c,l+1,d),b.pool.acquire(a,c+1,l,d),b.pool.acquire(a,c+1,l+1,d)]};b.prototype._compare=function(a){return this.row<a.row?-1:this.row>a.row?1:this.col<a.col?-1:this.col>a.col?1:0};b.sort=function(a){return a.map(function(a){return b.from(a)}).sort(function(a,b){return a._compare(b)}).map(function(a){return a.id})};b.pool=new a(b,!0,null,25,50);return b}()})},"esri/layers/vectorTiles/views/2d/layers/features/tileRenderers/BaseTileRenderer":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Accessor ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators ../../../tiling/enums".split(" "),
function(k,b,a,c,e,g,l,d){Object.defineProperty(b,"__esModule",{value:!0});k=function(b){function e(a){a=b.call(this)||this;a.tiles=new Map;a.layer=null;return a}a(e,b);e.prototype.destroy=function(){this.tiles.clear();this.layer=this.layerView=this.tileInfoView=this.highlightOptions=this.configuration=this.tiles=null};Object.defineProperty(e.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0});e.prototype.acquireTile=function(a){var b=this,c=this.createTile(a);
c.once("attach",function(){return b.notifyChange("updating")});this.tiles.set(a.id,c);return c};e.prototype.forEachTile=function(a){this.tiles.forEach(a)};e.prototype.releaseTile=function(a){this.tiles.delete(a.key.id);this.disposeTile(a)};e.prototype.isUpdating=function(){var a=!0;this.tiles.forEach(function(b){a=a&&b.status!==d.TileStatus.INITIALIZED});return!a};e.prototype.requestUpdate=function(){this.layerView.requestUpdate()};c([l.property()],e.prototype,"configuration",void 0);c([l.property()],
e.prototype,"highlightOptions",void 0);c([l.property()],e.prototype,"layer",void 0);c([l.property()],e.prototype,"layerView",void 0);c([l.property()],e.prototype,"tileInfoView",void 0);c([l.property()],e.prototype,"updating",null);return e=c([l.subclass()],e)}(l.declared(e,g));b.default=k})},"esri/layers/vectorTiles/core/HandleOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./Handles ./accessorSupport/decorators".split(" "),
function(k,b,a,c,e,g,l){return function(b){function d(){var a=b.call(this)||this;a.handles=new g;return a}a(d,b);d.prototype.destroy=function(){this.handles.destroy()};c([l.property({readOnly:!0})],d.prototype,"handles",void 0);return d=c([l.subclass("esri.core.HandleOwner")],d)}(l.declared(e))})},"esri/layers/vectorTiles/core/Handles":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./Collection ./accessorSupport/decorators".split(" "),
function(k,b,a,c,e,g,l){return function(b){function d(a){a=b.call(this)||this;a._groups=new Map;return a}a(d,b);d.prototype.destroy=function(){this.removeAll()};Object.defineProperty(d.prototype,"size",{get:function(){var a=0;this._groups.forEach(function(b){a+=b.length});return a},enumerable:!0,configurable:!0});d.prototype.add=function(a,b){if(!this._isHandle(a)&&!Array.isArray(a)&&!g.isCollection(a))return this;var c=this._getOrCreateGroup(b);Array.isArray(a)||g.isCollection(a)?a.forEach(function(a){return c.push(a)}):
c.push(a);this.notifyChange("size");return this};d.prototype.has=function(a){return this._groups.has(this._ensureGroupKey(a))};d.prototype.remove=function(a){if(Array.isArray(a)||g.isCollection(a))return a.forEach(this.remove,this),this;if(!this.has(a))return this;for(var b=this._getGroup(a),c=0;c<b.length;c++)b[c].remove();this._deleteGroup(a);this.notifyChange("size");return this};d.prototype.removeAll=function(){this._groups.forEach(function(a){for(var b=0;b<a.length;b++)a[b].remove()});this._groups.clear();
this.notifyChange("size");return this};d.prototype._isHandle=function(a){return a&&!!a.remove};d.prototype._getOrCreateGroup=function(a){if(this.has(a))return this._getGroup(a);var b=[];this._groups.set(this._ensureGroupKey(a),b);return b};d.prototype._getGroup=function(a){return this._groups.get(this._ensureGroupKey(a))};d.prototype._deleteGroup=function(a){return this._groups.delete(this._ensureGroupKey(a))};d.prototype._ensureGroupKey=function(a){return a||"_default_"};c([l.property({readOnly:!0})],
d.prototype,"size",null);return d=c([l.subclass("esri.core.Handles")],d)}(l.declared(e))})},"esri/layers/vectorTiles/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(k,b,a,c,e,g,l){return function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.color=new e([0,255,255]);a.haloOpacity=
1;a.fillOpacity=.5;return a}a(d,b);c([l.property({type:e})],d.prototype,"color",void 0);c([l.property()],d.prototype,"haloOpacity",void 0);c([l.property()],d.prototype,"fillOpacity",void 0);return d=c([l.subclass("esri.views.2d.support.HighlightOptions")],d)}(l.declared(g))})},"esri/layers/vectorTiles/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/JSONSupport ../../core/kebabDictionary ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/scaleUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y){var x=d({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc"});return function(b){function d(a){a=b.call(this)||this;a.dpi=96;a.format=null;a.origin=null;a.minScale=0;a.maxScale=0;a.size=null;a.spatialReference=null;return a}c(d,b);f=d;d.create=function(a){void 0===a&&(a={size:256,spatialReference:g.SpatialReference.WebMercator});
var b=a.resolutionFactor||1,c=a.scales,d=a.size||256;a=a.spatialReference||g.SpatialReference.WebMercator;var e=t.getInfo(a),e=e?new g.Point(e.origin[0],e.origin[1],a):new g.Point(0,0,a),h=1/(39.37*q.getMetersPerUnitForSR(a)*96),l=[];if(c)for(var k=0;k<c.length;k++){var m=c[k],n=m*h;l.push({level:k,scale:m,resolution:n})}else for(m=t.isGeographic(a)?512/d*1.47748799285417E8:256/d*5.91657527591555E8,c=Math.ceil(24/b),l.push({level:0,scale:m,resolution:m*h}),k=1;k<c;k++)m/=Math.pow(2,b),n=m*h,l.push({level:k,
scale:m,resolution:n});return new f({dpi:96,lods:l,origin:e,size:d,spatialReference:a})};Object.defineProperty(d.prototype,"isWrappable",{get:function(){var a=this.spatialReference,b=this.origin;if(a&&b){var c=t.getInfo(a);return a.isWrappable&&Math.abs(c.origin[0]-b.x)<=c.dx}return!1},enumerable:!0,configurable:!0});d.prototype.readOrigin=function(b,c){return g.Point.fromJSON(a({spatialReference:c.spatialReference},b))};Object.defineProperty(d.prototype,"lods",{set:function(a){var b=this,c=0,d=0,
e=[];this._levelToLOD={};a&&(c=-Infinity,d=Infinity,a.forEach(function(a){e.push(a.scale);c=a.scale>c?a.scale:c;d=a.scale<d?a.scale:d;b._levelToLOD[a.level]=a}));this._set("scales",e);this._set("minScale",c);this._set("maxScale",d);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});d.prototype.readSize=function(a,b){return[b.cols,b.rows]};d.prototype.writeSize=function(a,b){b.cols=a[0];b.rows=a[0]};d.prototype.zoomToScale=function(a){var b=this.scales;if(0>=a)return b[0];
if(a>=b.length)return b[b.length-1];var c=Math.round(a);return b[c]+(c-a)*(b[Math.round(a-.5)]-b[c])};d.prototype.scaleToZoom=function(a){for(var b=this.scales,c=b.length-1,d=0;d<c;d++){var e=b[d],f=b[d+1];if(e<=a)break;if(f===a)return d+1;if(e>a&&f<a)return d+1-(a-f)/(e-f)}return d};d.prototype.snapScale=function(a,b){void 0===b&&(b=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=b?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))};d.prototype.tileAt=function(a,b,c,d){var e=this.lodAt(a);
if(!e)return null;var f;if("number"===typeof b)f=b,b=c;else{if(t.equals(b.spatialReference,this.spatialReference))f=b.x,b=b.y;else{d=u.project(b,this.spatialReference);if(!d)return null;f=d.x;b=d.y}d=c}c=e.resolution*this.size[0];e=e.resolution*this.size[1];d||(d={id:null,level:0,row:0,col:0,extent:p.create()});d.level=a;d.row=Math.floor((this.origin.y-b)/e+.001);d.col=Math.floor((f-this.origin.x)/c+.001);this.updateTileInfo(d);return d};d.prototype.updateTileInfo=function(a){var b=this.lodAt(a.level),
c=b.resolution*this.size[0],b=b.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=p.create());a.extent[0]=this.origin.x+a.col*c;a.extent[1]=this.origin.y-(a.row+1)*b;a.extent[2]=a.extent[0]+c;a.extent[3]=a.extent[1]+b};d.prototype.upsampleTile=function(a){var b=this._upsampleLevels[a.level];if(!b||-1===b.parentLevel)return!1;a.level=b.parentLevel;a.row=Math.floor(a.row/b.factor+.001);a.col=Math.floor(a.col/b.factor+.001);this.updateTileInfo(a);return!0};d.prototype.getTileBounds=
function(a,b){var c=this.lodAt(b.level).resolution,d=c*this.size[0],c=c*this.size[1];a[0]=this.origin.x+b.col*d;a[1]=this.origin.y-(b.row+1)*c;a[2]=a[0]+d;a[3]=a[1]+c;return a};d.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null};d.prototype.clone=function(){return f.fromJSON(this.write({}))};d.prototype._initializeUpsampleLevels=function(){var a=this.lods;this._upsampleLevels=[];for(var b=null,c=0;c<a.length;c++){var d=a[c];this._upsampleLevels[d.level]={parentLevel:b?
b.level:-1,factor:b?b.resolution/d.resolution:0};b=d}};e([h.property({type:Number,json:{write:!0}})],d.prototype,"compressionQuality",void 0);e([h.property({type:Number,json:{write:!0}})],d.prototype,"dpi",void 0);e([h.property({type:String,json:{read:x.read,write:x.write}})],d.prototype,"format",void 0);e([h.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],d.prototype,"isWrappable",null);e([h.property({type:g.Point,json:{write:!0}})],d.prototype,"origin",void 0);e([h.reader("origin")],
d.prototype,"readOrigin",null);e([h.property({type:[y],value:null,json:{write:!0}})],d.prototype,"lods",null);e([h.property({readOnly:!0})],d.prototype,"minScale",void 0);e([h.property({readOnly:!0})],d.prototype,"maxScale",void 0);e([h.property({readOnly:!0})],d.prototype,"scales",void 0);e([h.property({cast:function(a){return Array.isArray(a)?a:"number"===typeof a?[a,a]:[256,256]}})],d.prototype,"size",void 0);e([h.reader("size",["rows","cols"])],d.prototype,"readSize",null);e([h.writer("size",
{cols:{type:m.Integer},rows:{type:m.Integer}})],d.prototype,"writeSize",null);e([h.property({type:g.SpatialReference,json:{write:!0}})],d.prototype,"spatialReference",void 0);return d=f=e([h.subclass("esri.layers.support.TileInfo")],d);var f}(h.declared(l))})},"esri/layers/vectorTiles/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(k,b,a,c,e,g,l){return function(b){function d(a){a=b.call(this,a)||this;a.level=0;a.levelValue=null;a.resolution=0;a.scale=0;return a}a(d,b);e=d;d.prototype.clone=function(){return new e({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};c([g.property({type:l.Integer,json:{write:!0}})],d.prototype,"level",void 0);c([g.property({type:String,json:{write:!0}})],d.prototype,"levelValue",void 0);c([g.property({type:Number,json:{write:!0}})],d.prototype,
"resolution",void 0);c([g.property({type:Number,json:{write:!0}})],d.prototype,"scale",void 0);return d=e=c([g.subclass("esri.layers.support.LOD")],d);var e}(g.declared(e))})},"esri/layers/vectorTiles/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(k,b,a,c,e,g,l){var d=new g("0/0/0/0"),h=function(){function a(a,b,c,d,e,g,h,f){this.x=a;this.ymin=b;this.ymax=c;this.invM=
d;this.leftAdjust=e;this.rightAdjust=g;this.leftBound=h;this.rightBound=f}a.create=function(b,c){b[1]>c[1]&&(f=[c,b],b=f[0],c=f[1]);f=b[0];b=b[1];var d=c[0];c=c[1];var e=d-f,g=c-b,g=0!==g?e/g:0,h=(Math.ceil(b)-b)*g,l=(Math.floor(b)-b)*g;return new a(f,Math.floor(b),Math.ceil(c),g,0>e?h:l,0>e?l:h,0>e?d:f,0>e?f:d);var f};a.prototype.incrRow=function(){this.x+=this.invM};a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+
this.rightAdjust,this.rightBound)};return a}(),m=[[0,0],[0,0],[0,0],[0,0]];return function(){function b(a,b){var d=this;this.tileInfo=a;this.fullExtent=b;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=a.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var g=this._lodInfos=e.map(function(d){return c.create(a,d,b)});e.forEach(function(a,b){d._infoByLevel[a.level]=g[b];d._infoByScale[a.scale]=g[b];d.scales[b]=a.scale},this);this._wrap=a.isWrappable}b.prototype.getLODInfoAt=
function(a){return this._infoByLevel[a.level]};b.prototype.getTileBounds=function(a,b,c){void 0===c&&(c=!1);d.set(b);return(b=this._infoByLevel[d.level])?b.getTileBounds(a,d,c):a};b.prototype.getTileCoords=function(a,b,c){void 0===c&&(c=!1);d.set(b);return(b=this._infoByLevel[d.level])?b.getTileCoords(a,d,c):a};b.prototype.getTileCoverage=function(a,b,c){void 0===b&&(b=192);void 0===c&&(c="closest");c="closest"===c?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);var d=e.pool.acquire(c),
g=this._wrap,k;k=Infinity;var p=-Infinity,f,n,q=d.spans;m[0][0]=m[0][1]=m[1][1]=m[3][0]=-b;m[1][0]=m[2][0]=a.size[0]+b;m[2][1]=m[3][1]=a.size[1]+b;for(b=0;b<m.length;b++){var t=m[b];a.toMap(t,t);t[0]=c.getColumnForX(t[0]);t[1]=c.getRowForY(t[1])}a=[];t=3;for(b=0;4>b;b++){if(m[b][1]!==m[t][1]){var u=h.create(m[b],m[t]);k=Math.min(u.ymin,k);p=Math.max(u.ymax,p);void 0===a[u.ymin]&&(a[u.ymin]=[]);a[u.ymin].push(u)}t=b}if(null==k||null==p||100<p-k)return null;for(t=[];k<p;){null!=a[k]&&(t=t.concat(a[k]));
f=Infinity;n=-Infinity;for(b=t.length-1;0<=b;b--)u=t[b],f=Math.min(f,u.getLeftCol()),n=Math.max(n,u.getRightCol());f=Math.floor(f);n=Math.floor(n);if(k>=c.first[1]&&k<=c.last[1])if(g)if(c.size[0]<c.worldSize[0])for(u=Math.floor(n/c.worldSize[0]),b=Math.floor(f/c.worldSize[0]);b<=u;b++)q.push(new l(k,Math.max(c.getFirstColumnForWorld(b),f),Math.min(c.getLastColumnForWorld(b),n)));else q.push(new l(k,f,n));else f>c.last[0]||n<c.first[0]||(f=Math.max(f,c.first[0]),n=Math.min(n,c.last[0]),q.push(new l(k,
f,n)));k+=1;for(b=t.length-1;0<=b;b--)u=t[b],u.ymax>=k?u.incrRow():t.splice(b,1)}return d};b.prototype.getTileIdAtParent=function(a,b){b=g.pool.acquire(b);var c=this._infoByLevel[b.level];if(a.resolution<c.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+" is not a parent resolution of "+c.resolution);return a.resolution===c.resolution?b.id:g.getId(a.level,Math.floor(b.row*c.resolution/a.resolution+.01),Math.floor(b.col*c.resolution/a.resolution+.01),
b.world)};b.prototype.getTileParentId=function(a){a=g.pool.acquire(a);var b=this._lodInfos.indexOf(this._infoByLevel[a.level])-1;if(0>b)return g.pool.release(a),null;b=this.getTileIdAtParent(this._lodInfos[b],a);g.pool.release(a);return b};b.prototype.getTileResolution=function(a){return(a=this._infoByLevel[a.level])?a.resolution:-1};b.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};b.prototype.intersects=function(a,b){var c=g.pool.acquire(b);b=this._infoByLevel[c.level];
var d=a.lodInfo;if(d.resolution>b.resolution){var e=g.pool.acquire(this.getTileIdAtParent(d,c)),h=d.denormalizeCol(e.col,e.world);b=a.spans.some(function(a){return a.row===e.row&&a.colFrom<=h&&a.colTo>=h});g.pool.release(c);g.pool.release(e);return b}if(d.resolution<b.resolution){var l=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],b.row);a[1]=Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]);a=l[0];var f=l[1],k=l[2],
l=l[3],m=b.denormalizeCol(c.col,c.world),p=d.getColumnForX(b.getXForColumn(m)),q=d.getRowForY(b.getYForRow(c.row)),m=d.getColumnForX(b.getXForColumn(m+1))-1;b=d.getRowForY(b.getYForRow(c.row+1))-1;g.pool.release(c);return!(p>l||m<k||q>f||b<a)}var t=d.denormalizeCol(c.col,c.world);b=a.spans.some(function(a){return a.row===c.row&&a.colFrom<=t&&a.colTo>=t});g.pool.release(c);return b};b.prototype.normalizeBounds=function(b,c,d){b[0]=c[0];b[1]=c[1];b[2]=c[2];b[3]=c[3];this._wrap&&(c=a.getInfo(this.tileInfo.spatialReference),
d=-d*(c.valid[1]-c.valid[0]),b[0]+=d,b[2]+=d);return b};b.prototype.getSmallestInfoForScale=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a];if(a>b[0])return this._infoByScale[b[0]];for(var c=1;c<b.length-1;c++)if(a>b[c]+1E-6)return this._infoByScale[b[c-1]];return this._infoByScale[b[b.length-1]]};b.prototype.getClosestInfoForScale=function(a){var b=this.scales;this._infoByScale[a]||(a=b.reduce(function(b,c,d,e){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]));return this._infoByScale[a]};
return b}()})},"esri/layers/vectorTiles/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(k,b,a,c){function e(a,b,c){a[0]=b;a[1]=c;return a}var g=new c("0/0/0/0");return function(){function b(a,b,c,e,g,l,k,y,x,A,z,f){this.level=a;this.resolution=b;this.scale=c;this.origin=e;this.first=g;this.last=l;this.size=k;this.norm=y;this.worldStart=x;this.worldEnd=A;this.worldSize=z;this.wrap=f}b.create=function(c,g,l){var d=
a.getInfo(c.spatialReference),h=[c.origin.x,c.origin.y],k=[c.size[0]*g.resolution,c.size[1]*g.resolution],m=[-Infinity,-Infinity],y=[Infinity,Infinity],x=[Infinity,Infinity];l&&(e(m,Math.max(0,Math.floor((l.xmin-h[0])/k[0])),Math.max(0,Math.floor((h[1]-l.ymax)/k[1]))),e(y,Math.max(0,Math.floor((l.xmax-h[0])/k[0])),Math.max(0,Math.floor((h[1]-l.ymin)/k[1]))),e(x,y[0]-m[0]+1,y[1]-m[1]+1));var A;c.isWrappable?(c=[Math.ceil(Math.round(2*d.origin[1]/g.resolution)/c.size[0]),x[1]],d=[Math.floor((d.origin[0]-
h[0])/k[0]),m[1]],l=[c[0]+d[0]-1,y[1]],A=!0):(d=m,l=y,c=x,A=!1);return new b(g.level,g.resolution,g.scale,h,m,y,x,k,d,l,c,A)};b.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b};b.prototype.denormalizeCol=function(a,b){return this.wrap?this.worldSize[0]*b+a:a};b.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};b.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};
b.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};b.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};b.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};b.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};b.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};b.prototype.getTileBounds=function(a,b,c){void 0===c&&(c=!1);g.set(b);var d=c?g.col:this.denormalizeCol(g.col,
g.world),e=g.row;b=this.getXForColumn(d);c=this.getYForRow(e+1);d=this.getXForColumn(d+1);e=this.getYForRow(e);a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a};b.prototype.getTileCoords=function(a,b,c){void 0===c&&(c=!1);g.set(b);b=c?g.col:this.denormalizeCol(g.col,g.world);Array.isArray(a)?e(a,this.getXForColumn(b),this.getYForRow(g.row)):(a.x=this.getXForColumn(b),a.y=this.getYForRow(g.row));return a};return b}()})},"esri/layers/vectorTiles/views/2d/tiling/TileCoverage":function(){define(["require","exports",
"../../../core/ArrayPool","../../../core/ObjectPool","./TileSpan"],function(k,b,a,c,e){return function(){function b(b){this.lodInfo=b;this.spans=a.acquire()}b.prototype.release=function(){for(var b=0,c=this.spans;b<c.length;b++)e.pool.release(c[b]);a.release(this.spans)};b.prototype.forEach=function(a,b){var c=this.spans,d=this.lodInfo,e=d.level;if(0!==c.length)for(var g=0;g<c.length;g++)for(var l=c[g],k=l.row,y=l.colTo,l=l.colFrom;l<=y;l++)a.call(b,e,k,d.normalizeCol(l),d.getWorldForColumn(l))};
b.pool=new c(b,!0);return b}()})},"esri/layers/vectorTiles/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(k,b,a){return function(){function b(a,b,c){this.row=a;this.colFrom=b;this.colTo=c}b.pool=new a(b,!0);return b}()})},"esri/layers/OnDemandDrillMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred ../sniff ../kernel ../promiseList ./RenderMode ../geometry/Extent ../geometry/jsonUtils ../tasks/query ../tasks/FeatureSet ../tasks/support/pbfDeps ./vectorTiles/core/promiseUtils ./vectorTiles/core/SetPool ./vectorTiles/views/2d/tiling/TileQueue ./vectorTiles/views/2d/tiling/TileStrategy ./vectorTiles/views/2d/tiling/TileKey".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q,t,u,y,x,A){var z=q.pbfQueryUtils,f=q.optimizedFeatures;q=c("esri-featurelayer-webgl");k=k([l],{declaredClass:"esri.layers._OnDemandDrillMode",featureLayer:null,graphics:null,maxDrillLevel:q&&q.maxDrillLevel,maxRecordCountFactor:q&&q.maxRecordCountFactor,enablePBFQuery:q&&q.enablePBFQuery,_graphicsVal:null,_reEvalGraphics:!1,_featureMap:null,_quantizationFactor:1,_wglRenderer:null,_tileInfo:null,_tileInfoView:null,_tileFetchQueue:null,_tileStrategy:null,_tileRequests:null,
constructor:function(a){this._graphicsVal=[];this._featureMap={};this.featureLayer=a},initialize:function(a){this.inherited(arguments);this._tileRequests=new Map},startup:function(){if(!this._started||this._isSuspendedAtStartup){this.inherited(arguments);var a=this.featureLayer;this._wglRenderer=a._div;this._tileInfo=this._wglRenderer._tileInfo;this._tileInfoView=this._wglRenderer._tileInfoView;this._tileRenderer=this._wglRenderer._tileRenderer;this._tileFetchQueue=new y({tileInfoView:this._tileInfoView,
process:this._getFeatureSet.bind(this)});this._tileStrategy=new x({cachePolicy:"purge",buffer:0,acquireTile:this._acquireTile.bind(this),releaseTile:this._releaseTile.bind(this),tileInfoView:this._tileInfoView});this._isSuspendedAtStartup=a.suspended;this.start()}},propertyChangeHandler:function(a){this._init&&(2>a?this.start():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._tileFetchQueue&&
this._tileFetchQueue.clear();this._tileStrategy&&this._tileStrategy.destroy();this._tileRequests&&this._tileRequests.clear();this.inherited(arguments)},update:function(a){this._tileFetchQueue.pause();this._tileFetchQueue.state=a.state;a=this._tileStrategy.update(a);this._tileFetchQueue.resume();a?this.featureLayer._fireUpdateEnd():this.featureLayer._fireUpdateStart()},suspend:function(){this._init&&this.stop()},resume:function(){this._init&&this.start()},refresh:function(){this.start()},hasAllFeatures:function(){var a=
!1;this._getVisibleTileRequests().forEach(function(b){b.hasPartialFeatures&&(a=!0)});return!a},hasUpdateError:function(){var a=!1;this._getVisibleTileRequests().forEach(function(b){b.hasUpdateError&&(a=!0)});return a},start:function(){var a=this.featureLayer;!a.suspended&&a.isQueryable()&&(this._clearIIf(),this._tileFetchQueue.pause(),this._tileFetchQueue.clear(),this._tileStrategy.clear(),this._wglRenderer.start())},stop:function(){this._wglRenderer.stop()},_getVisibleTileRequests:function(){var a=
this._tileStrategy.tileIndex;if(!a)return[];var b=[];this._tileRequests.forEach(function(c,d){(d=a.get(d))&&d.visible&&b.push(c)});return b},_acquireTile:function(a){this.featureLayer._fireUpdateStart();var b=this._acquireRendererTile(a),c=b.key,d=c.id;a=this._tileInfo.lodAt(a.level);var e={id:d,key:c,bounds:this._tileInfo.getTileBounds([0,0,0,0],c),resolution:a.resolution,scale:a.scale},c=this._tileFetchQueue.push(c).then(function(a){return this._wglRenderer._symbolProcessor.getMeshData(e,a.featureSet).then(function(b){return{meshData:b.data,
featureSet:a.featureSet,errors:a.errors,hasPartialFeatures:a.hasPartialFeatures}})}.bind(this)).then(function(a){this._tileRenderer.onTileData({tileKey:d,data:a.meshData});this._addTile(d,a)}.bind(this)).otherwise(function(a){this._tileRenderer.onTileData({tileKey:d,data:null});this._tileError(d);return t.reject(a)}.bind(this));this._tileRequests.set(d,{tsTile:e,request:c,isFulfilled:!1,hasUpdateError:null,hasPartialFeatures:null,featureSet:null,graphics:[]});return b},_acquireRendererTile:function(a){a=
this._tileRenderer.acquireTile(a);a.once("attach",function(){this._wglRenderer._scheduleUpdate()}.bind(this));return a},_releaseTile:function(a){this.featureLayer._fireUpdateStart();this._tileRequests.get(a.key.id)&&(this._removeTile(a),this._wglRenderer._scheduleUpdate())},_addTile:function(a,b){this._reEvalGraphics=!0;var c=this._createGraphics(b.featureSet);this._registerGraphics(c);if(a=this._tileRequests.get(a))a.isFulfilled=!0,a.hasUpdateError=!!b.errors.length,a.hasPartialFeatures=b.hasPartialFeatures||
a.hasUpdateError,a.featureSet=b.featureSet,a.graphics=c},_tileError:function(a){if(a=this._tileRequests.get(a))a.isFulfilled=!0,a.hasUpdateError=!0,a.hasPartialFeatures=!0,a.graphics=[];this._wglRenderer._scheduleUpdate()},_removeTile:function(a){var b=a.key.id,c=this._tileRequests.get(b);c.request.isFulfilled()||c.request.cancel();this._tileRequests["delete"](b);this._wglRenderer._cancelRedraw(b);this._reEvalGraphics=!0;this._tileRenderer.releaseTile(a);this._unregisterGraphics(c.graphics)},_getFeatureSet:function(a){var b=
{hashes:new Set,drill:[],featureSet:{features:[],geometryType:this.featureLayer.geometryType,spatialReference:this.map.spatialReference.toJson(),transform:null},hasPartialFeatures:!1,errors:[]},c=this.featureLayer._task,d=this._getResolutionParams(a),e=this._tileInfoView.getTileBounds([0,0,0,0],a),e=this._expandTileBounds(e,d),f=u.acquire();return this._drillQuery(b,f,c,e,d,null,a).then(function(a){u.release(f);this._calculateCentroid(a);return a}.bind(this)).otherwise(function(a){u.release(f);throw a;
})},_getResolutionParams:function(a){this._tileInfo.updateTileInfo(a);var b=this._tileInfo.lodAt(a.level);return{mode:"view",originPosition:"upperLeft",tolerance:this._quantizationFactor*b.resolution,extent:new d(a.extent[0],a.extent[1],a.extent[2],a.extent[3],this.map.spatialReference)}},_expandTileBounds:function(a,b){var c=this.featureLayer.geometryType;b=("esriGeometryPoint"===c||"esriGeometryMultipoint"===c||this._wglRenderer._returnCentroid?20:0)*b.tolerance;a[0]-=b;a[1]-=b;a[2]+=b;a[3]+=b;
return a},_calculateCentroid:function(a){var b;if("esriGeometryPolygon"===a.featureSet.geometryType&&this._wglRenderer._returnCentroid){b=0;var c=a.featureSet.spatialReference,d=a.featureSet.transform,e={geometry:{x:null,y:null}},f=[e];a.featureSet.features.forEach(function(a){if(!a.centroid){var g=a.geometry;g&&(g=p.createPolygon(g,c,d),g=g.getCentroid())&&(e.geometry.x=g.x,e.geometry.y=g.y,h.quantize(f,"esriGeometryPoint",d),a.centroid={x:e.geometry.x,y:e.geometry.y},b++)}})}return b},_drillQuery:function(a,
b,c,d,e,h,l,k){k=null!=k?k:0;a.drill.push(d);return this._query(c,d,e,h,l,k).then(function(m){this.featureLayer.supportsFormatPBF&&this.enablePBFQuery&&(m=f.convertToFeatureSet(z.parsePBFFeatureQuery(m)));this._appendFeatures(a.featureSet.features,b,m.features);m.transform&&(a.featureSet.transform=m.transform);if(m.exceededTransferLimit){if(k<this.maxDrillLevel){k++;m=(d[2]-d[0])/2;var p=(d[3]-d[1])/2,n=[d[0]+m,d[1]+p,d[2],d[3]],q=[d[0],d[1],d[2]-m,d[3]-p],r=[d[0]+m,d[1],d[2],d[3]-p];return g([this._drillQuery(a,
b,c,[d[0],d[1]+p,d[2]-m,d[3]],e,h,l,k),this._drillQuery(a,b,c,n,e,h,l,k),this._drillQuery(a,b,c,q,e,h,l,k),this._drillQuery(a,b,c,r,e,h,l,k)]).then(function(){return a})}a.hasPartialFeatures=!0}return a}.bind(this)).otherwise(function(b){if(0<k)a.errors.push(b);else throw b;}.bind(this))},_appendFeatures:function(a,b,c){var d=a.length,e=c?c.length:0;a.length=d+e;var f=0,g,h,l,k=this.featureLayer.objectIdField;for(g=0;g<e;g++)h=c[g],l=h.attributes[k],b.has(l)||(a[d+f]=h,b.add(l),f++);a.length-=e-f},
_query:function(a,b,c,e,f,g){e=this.featureLayer;f=new m;var h=e.getOutFields();.75<=h.length/e.fields.length&&(h=["*"]);f.geometry=new d(b[0],b[1],b[2],b[3],this.map.spatialReference);f.outFields=h;f.where=e.getDefinitionExpression();f.returnGeometry=!0;f.returnCentroid=this._wglRenderer._returnCentroid;f.timeExtent=e._getOffsettedTE(e._mapTimeExtent);e._ts&&(f._ts=Date.now());f.orderByFields=e.supportsAdvancedQueries?e.getOrderByFields():null;f.multipatchOption=e.multipatchOption;f.maxAllowableOffset=
"esriGeometryPolyline"===e.geometryType?c.tolerance:null;f.quantizationParameters=c;(b=e.advancedQueryCapabilities)&&b.supportsQueryWithResultType&&(f.resultType="tile");f.returnExceededLimitFeatures=g===this.maxDrillLevel;b&&b.supportsMaxRecordCountFactor&&(f.maxRecordCountFactor=this.maxRecordCountFactor);return this._wrapInNewDeferred(a.rawExecute(f,e.supportsFormatPBF&&this.enablePBFQuery?{format:"pbf"}:null))},_wrapInNewDeferred:function(b){var c=new a(function(){b.isFulfilled()||b.cancel()});
b.then(function(a){c.resolve(a)}).otherwise(function(a){c.reject(a)});return c.promise},_collectGraphics:function(){var a=this._featureMap,b=[],c;for(c in a)b.push(a[c]);return b},_createGraphics:function(a){return p.createGraphics(a)},_registerGraphics:function(a){var b=this.featureLayer.objectIdField;a.forEach(function(a){var c=a.attributes&&a.attributes[b];this._registerFeature(c,a);this._incRefCount(c)}.bind(this))},_unregisterGraphics:function(a){var b=this.featureLayer.objectIdField;a.forEach(function(a){a=
a.attributes&&a.attributes[b];this._decRefCount(a);this._unregisterFeature(a)}.bind(this))}});Object.defineProperty(k.prototype,"graphics",{get:function(){this._reEvalGraphics&&(this._reEvalGraphics=!1,this._graphicsVal=this._collectGraphics());return this._graphicsVal}});c("extend-esri")&&b.setObject("layers._OnDemandDrillMode",k,e);return k})},"esri/layers/RenderMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","../sniff","../kernel"],function(k,b,a,c,e){var g=!!c("esri-pbf"),
l=!!c("esri-featurelayer-pbf");k=k(null,{declaredClass:"esri.layers._RenderMode",enablePBFQuery:g&&l,initialize:function(a){this.map=a;this._init=!0},startup:function(){this._started=!0},propertyChangeHandler:function(a){},destroy:function(){this._init=this._started=!1},drawFeature:function(a){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},hasUpdateError:function(){return!1},canFetchPBF:function(a){return!(!this.featureLayer._canFetchPBF()||!this.enablePBFQuery)},
_incRefCount:function(a){(a=this._featureMap[a])&&a._count++},_decRefCount:function(a){(a=this._featureMap[a])&&a._count--},_getFeature:function(a){return this._featureMap[a]},_addFeatureIIf:function(a,b){var c=this._featureMap,d=c[a],e=this.featureLayer;d||(c[a]=b,e._add(b),b._count=0);return d||b},_removeFeatureIIf:function(a){var b=this._featureMap[a],c=this.featureLayer;if(b){if(b._count)return;delete this._featureMap[a];c._remove(b)}return b},_registerFeature:function(a,b){var c=this._featureMap,
d=c[a];d?(d.attributes=b.attributes,d.geometry=b.geometry):(c[a]=b,b._count=0,b._layer=b._graphicsLayer=b._sourceLayer=this.featureLayer);return d||b},_unregisterFeature:function(a){var b=this._featureMap,c=b[a];c&&!c._count&&(delete b[a],c._graphicsLayer=null)},_clearIIf:function(){var a;a=this.featureLayer;var b=a.graphics,c=a._selectedFeatures,e=a.getSelectedFeatures().length,g=a.objectIdField;if(e)for(a=b.length-1;0<=a;a--){var e=b[a],l=e.attributes[g];l in c?e._count=1:(e._count=0,this._removeFeatureIIf(l))}else a.clear(),
this._featureMap={}},_cancelPendingRequest:function(a){if(a)try{a.cancel()}catch(h){}},_toggleVisibility:function(a){var b=this.featureLayer,c=b.graphics,d=a?"show":"hide",e,g=c.length;a=a&&b._ager;for(e=0;e<g;e++){var l=c[e];l[d]();a&&b._repaint(l)}},_applyTimeFilter:function(b){var c=this.featureLayer;if(c.timeInfo&&!c.suspended){b||c._fireUpdateStart();var d=c._trackManager;d&&d.clearTracks();var e=c.getTimeDefinition(),g=c._getOffsettedTE(c._mapTimeExtent);g?(g=c._getTimeOverlap(e,g))?(e=c._filterByTime(c.graphics,
g.startTime,g.endTime),d&&d.addFeatures(e.match),a.forEach(e.match,function(a){var b=a._shape;a.visible||(a.show(),(b=a._shape)&&b._moveToFront());c._ager&&b&&c._repaint(a)}),a.forEach(e.noMatch,function(a){a.visible&&a.hide()})):this._toggleVisibility(!1):(d&&d.addFeatures(c.graphics),this._toggleVisibility(!0));d&&(d.moveLatestToFront(),d.drawTracks());b||c._fireUpdateEnd()}}});c("extend-esri")&&b.setObject("layers._RenderMode",k,e);return k})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/Polygon ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),
function(k,b,a,c,e,g,l,d,h,m,p,q){k=k(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(c,e){if(c){b.mixin(this,c);var g=this.features=this.features||[],h=c.spatialReference,h=this.spatialReference=p.createInstance(d.simpleConstructor,h),k=p.getGeometryType(c.geometryType);this.geometryType=c.geometryType;c.fields&&(this.fields=c.fields);c=p.supportsLazyUnquantization(this.geometryType);var m=p.unquantizeFunction(this.geometryType,this.transform),f=!!(e&&c&&m),n=k&&(f?k.accessorConstructor:
k.simpleConstructor);a.forEach(g,function(a,b){var c=p.createInstance(l.simpleConstructor),e=a.geometry;if(k&&e){var r=c.geometry=p.createInstance(n,f?null:e);r.setSpatialReference(e.spatialReference?p.createInstance(d.simpleConstructor,e.spatialReference):h);f&&r.setupLazyUnquantization(m,e)}c.symbol=a.symbol?q.fromJson(a.symbol):null;c.attributes=a.attributes;g[b]=c});f||this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var b=
{};this.displayFieldName&&(b.displayFieldName=this.displayFieldName);this.fields&&(b.fields=this.fields);this.spatialReference?b.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(b.geometryType=p.getJsonType(this.features[0].geometry)),b.features=h._encodeGraphics(this.features,a));b.geometryType=b.geometryType||this.geometryType;b.exceededTransferLimit=
this.exceededTransferLimit;b.transform=this.transform;return g.fixJson(b)},_hydrate:function(){p.unquantize(this.features,this.geometryType,this.transform);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var b=a.translate[0],c=a.translate[1],d=a.scale[0],e=a.scale[1],g=this.features,f=function(a,b,c){var d,e,f,g,h,l,k=[];d=0;for(e=a.length;d<e;d++)if(f=a[d],0<d){if(l=b(f[0]),f=c(f[1]),l!==g||f!==h)k.push([l-g,f-h]),g=l,h=f}else g=b(f[0]),h=c(f[1]),k.push([g,
h]);return 0<k.length?k:null},h=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y);return a};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){var d,e,g,h,l;g=a.rings||a.paths;l=[];d=0;for(e=g.length;d<e;d++)h=g[d],(h=f(h,b,c))&&l.push(h);return 0<l.length?(a.rings?a.rings=l:a.paths=l,a):null};if("esriGeometryMultipoint"===a)return function(a){var d;d=f(a.points,b,c);return 0<d.length?(a.points=d,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,
function(a){return Math.round((a-b)/d)},function(a){return Math.round((c-a)/e)}),l,k;l=0;for(k=g.length;l<k;l++)g[l].geometry&&(h(g[l].geometry)||g[l].setGeometry(null));this.transform=a;return this}});k.createGraphics=function(b){var c=b.geometryType,e=p.createInstance(d.simpleConstructor,b.spatialReference),g=p.getGeometryType(c).accessorConstructor,h=p.unquantizeFunction(c,b.transform);return a.map(b.features,function(a,b){b=p.createInstance(l.simpleConstructor);var c=a.geometry;if(c){var d=b.geometry=
p.createInstance(g);d.setSpatialReference(e);d.setupLazyUnquantization(h,c)}b.attributes=a.attributes;return b})};k.createPolygon=function(a,b,c){var d;a&&(d=p.createInstance(m.accessorConstructor),d.setSpatialReference(b),b=p.unquantizeFunction("esriGeometryPolygon",c),d.setupLazyUnquantization(b,a));return d};c("extend-esri")&&b.setObject("tasks.FeatureSet",k,e);return k})},"esri/tasks/support/pbfDeps":function(){define(["../../layers/vectorTiles/tasks/operations/pbfQueryUtils","../../layers/vectorTiles/layers/graphics/optimizedFeatures"],
function(k,b){return{pbfQueryUtils:k,optimizedFeatures:b}})},"esri/layers/vectorTiles/tasks/operations/pbfQueryUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../core/pbf ../../layers/graphics/optimizedFeatures".split(" "),function(k,b,a,c,e,g){function l(b){if(b>=u.length){var c=new a("query:parsing-pbf","Error while parsing FeatureSet PBF payload. Unknown GeometryType");p.error(c)}return u[b]}function d(a){var b,c=b||(b={});c[c.STRING=1]="STRING";c[c.FLOAT=2]="FLOAT";
c[c.DOUBLE=3]="DOUBLE";c[c.SINT32=4]="SINT32";c[c.UINT32=5]="UINT32";c[c.INT64=6]="INT64";c[c.UINT64=7]="UINT64";c[c.SINT64=8]="SINT64";for(c[c.BOOL=9]="BOOL";a.next();)switch(a.tag()){case b.STRING:return a.getString();case b.FLOAT:return a.getFloat();case b.DOUBLE:return a.getDouble();case b.SINT32:return a.getSInt32();case b.UINT32:return a.getUInt32();case b.INT64:return a.getInt64();case b.UINT64:return a.getUInt64();case b.SINT64:return a.getSInt64();case b.BOOL:return a.getBool();default:return a.skip(),
null}return null}function h(a){var b,c=b||(b={});c[c.NAME=1]="NAME";c[c.TYPE=2]="TYPE";c[c.ALIAS=3]="ALIAS";c[c.SQL_TYPE=4]="SQL_TYPE";c[c.DOMAIN=5]="DOMAIN";c[c.DEFAULT_VALUE=6]="DEFAULT_VALUE";for(c={type:q[0]};a.next();)switch(a.tag()){case b.NAME:c.name=a.getString();break;case b.TYPE:c.type=q[a.getEnum()];break;case b.ALIAS:c.alias=a.getString();break;case b.SQL_TYPE:c.sqlType=t[a.getEnum()];break;case b.DOMAIN:a.skip();break;case b.DEFAULT_VALUE:a.skip();break;default:a.skip()}return c}function m(a,
b){var c,e=c||(c={});e[e.ATTRIBUTES=1]="ATTRIBUTES";e[e.GEOMETRY=2]="GEOMETRY";e[e.CENTROID=4]="CENTROID";for(var e=new g.OptimizedFeature,h=0;a.next();)switch(a.tag()){case c.ATTRIBUTES:var l=a.getMessage(),k=b[h++].name;e.attributes[k]=d(l);break;case c.GEOMETRY:var l=a.getMessage(),m=(k=void 0,k={});m[m.TYPE=1]="TYPE";m[m.LENGTHS=2]="LENGTHS";m[m.COORDS=3]="COORDS";for(var m=new g.OptimizedGeometry,p=m.coords,q=m.lengths;l.next();)switch(l.tag()){case k.LENGTHS:for(var t=l.getUInt32(),t=l.pos()+
t;l.pos()<t;)q.push(l.getUInt32());break;case k.COORDS:for(var t=l.getUInt32(),t=l.pos()+t,u=0;l.pos()<t;)p[u++]=l.getSInt64();break;default:l.skip()}e.geometry=m;break;case c.CENTROID:l=a.getMessage();m=(k=void 0,k={});m[m.TYPE=1]="TYPE";m[m.LENGTHS=2]="LENGTHS";m[m.COORDS=3]="COORDS";m=new g.OptimizedGeometry;for(p=m.coords;l.next();)switch(l.tag()){case k.COORDS:q=l.getUInt32();q=l.pos()+q;for(t=0;l.pos()<q;)p[t++]=l.getSInt64();break;default:l.skip()}e.centroid=m;break;default:a.skip()}return e}
Object.defineProperty(b,"__esModule",{value:!0});var p=c.getLogger("esri.tasks.operations.pbfQueryUtils"),q="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),t="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),
u=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],y=["upperLeft","lowerLeft"];b.parsePBFFeatureQuery=function(b){try{var c,d=c||(c={});d[d.QUERY_RESULT=2]="QUERY_RESULT";for(var f=new e(new Uint8Array(b),new DataView(b)),k;f.next();)switch(f.tag()){case c.QUERY_RESULT:var q=f.getMessage(),t=(b=void 0,b={});t[t.FEATURE_RESULT=1]="FEATURE_RESULT";for(d={};q.next();)switch(q.tag()){case b.FEATURE_RESULT:var u=q.getMessage(),x=void 0,F=x||(x={});F[F.OBJECT_ID_NAME=
1]="OBJECT_ID_NAME";F[F.UNIQUE_ID_NAME=2]="UNIQUE_ID_NAME";F[F.GLOBAL_ID_NAME=3]="GLOBAL_ID_NAME";F[F.GEOHASH_NAME=4]="GEOHASH_NAME";F[F.GEOMETRY_PROPERTIES=5]="GEOMETRY_PROPERTIES";F[F.SERVER_GENS=6]="SERVER_GENS";F[F.GEOMETRY_TYPE=7]="GEOMETRY_TYPE";F[F.SPATIAL_REFERENCE=8]="SPATIAL_REFERENCE";F[F.EXCEEDED_TRANSFER_LIMIT=9]="EXCEEDED_TRANSFER_LIMIT";F[F.HAS_Z=10]="HAS_Z";F[F.HAS_M=11]="HAS_M";F[F.TRANSFORM=12]="TRANSFORM";F[F.FIELDS=13]="FIELDS";F[F.FEATURES=15]="FEATURES";var H=new g.OptimizedFeatureSet;
for(H.geometryType=l(0);u.next();)switch(u.tag()){case x.OBJECT_ID_NAME:H.objectIdFieldName=u.getString();break;case x.GLOBAL_ID_NAME:H.globalIdFieldName=u.getString();break;case x.GEOHASH_NAME:H.geohashFieldName=u.getString();break;case x.GEOMETRY_PROPERTIES:var J=u.getMessage(),I=void 0,G=I||(I={});G[G.AREA_FIELD_NAME=1]="AREA_FIELD_NAME";G[G.LENGTH_FIELD_NAME=2]="LENGTH_FIELD_NAME";G[G.UNITS=3]="UNITS";for(var Q={};J.next();)switch(J.tag()){case I.AREA_FIELD_NAME:Q.shapeAreaFieldName=J.getString();
break;case I.LENGTH_FIELD_NAME:Q.shapeLengthFieldName=J.getString();break;case I.UNITS:Q.units=J.getString();break;default:J.skip()}H.geometryProperties=Q;break;case x.GEOMETRY_TYPE:H.geometryType=l(u.getEnum());break;case x.SPATIAL_REFERENCE:var W=u.getMessage(),K=(I=void 0,I={});K[K.WKID=1]="WKID";K[K.LASTEST_WKID=2]="LASTEST_WKID";K[K.VCS_WKID=3]="VCS_WKID";K[K.LATEST_VCS_WKID=4]="LATEST_VCS_WKID";K[K.WKT=5]="WKT";for(Q={};W.next();)switch(W.tag()){case I.WKID:Q.wkid=W.getUInt32();break;case I.WKT:Q.wkt=
W.getString();break;default:W.skip()}H.spatialReference=Q;break;case x.HAS_Z:H.hasZ=u.getBool();break;case x.HAS_M:H.hasM=u.getBool();break;case x.TRANSFORM:var aa=u.getMessage(),ba=(I=void 0,I={});ba[ba.ORIGIN_POSTION=1]="ORIGIN_POSTION";ba[ba.SCALE=2]="SCALE";ba[ba.TRANSLATE=3]="TRANSLATE";for(var ca=y[0],ea=Q=void 0;aa.next();)switch(aa.tag()){case I.ORIGIN_POSTION:ca=y[aa.getEnum()];break;case I.SCALE:var ha=aa.getMessage(),U=void 0,X=U||(U={});X[X.X=1]="X";X[X.Y=2]="Y";X[X.M=3]="M";X[X.Z=4]=
"Z";for(var Y=[0,0];ha.next();)switch(ha.tag()){case U.X:Y[0]=ha.getDouble();break;case U.Y:Y[1]=ha.getDouble();break;case U.M:Y.push(ha.getDouble());break;case U.Z:Y.push(ha.getDouble());break;default:ha.skip()}Q=Y;break;case I.TRANSLATE:var O=aa.getMessage(),M=(U=void 0,U={});M[M.X=1]="X";M[M.Y=2]="Y";M[M.M=3]="M";M[M.Z=4]="Z";for(Y=[0,0];O.next();)switch(O.tag()){case U.X:Y[0]=O.getDouble();break;case U.Y:Y[1]=O.getDouble();break;case U.M:Y.push(O.getDouble());break;case U.Z:Y.push(O.getDouble());
break;default:O.skip()}ea=Y;break;default:aa.skip()}H.transform={originPosition:ca,scale:Q,translate:ea};break;case x.EXCEEDED_TRANSFER_LIMIT:var N=u.getBool();H.exceededTransferLimit=N;break;case x.FIELDS:var P=u.getMessage();H.fields.push(h(P));break;case x.FEATURES:var R=u.getMessage();H.features.push(m(R,H.fields));break;default:u.skip()}d.featureResult=H;break;default:q.skip()}k=d;break;default:f.skip()}return k.featureResult}catch(Z){return c=new a("query:parsing-pbf","Error while parsing FeatureSet PBF payload",
{error:Z}),p.error(c),new g.OptimizedFeatureSet}}})},"esri/layers/vectorTiles/layers/graphics/optimizedFeatures":function(){define(["require","exports","../../core/Error","../../core/Logger"],function(k,b,a,c){function e(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function g(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function l(a,b){return b*a.scale[0]+a.translate[0]}function d(a,b){return a.translate[1]-b*a.scale[1]}function h(a){a=a.coords;return{x:a[0],y:a[1]}}function m(a){var b=
new ca;b.coords[0]=a.x;b.coords[1]=a.y;return b}function p(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function q(a){var b=new ca;b.coords[0]=a.x;b.coords[1]=a.y;b.coords[2]=a.z;return b}function t(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function u(a){var b=new ca;b.coords[0]=a.x;b.coords[1]=a.y;b.coords[2]=a.m;return b}function y(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function x(a){var b=new ca;b.coords[0]=a.x;b.coords[1]=a.y;b.coords[2]=a.z;b.coords[3]=a.m;return b}function A(a,b,c){for(var d=
b?c?4:3:c?3:2,e=[],f=0;f<a.coords.length;f+=d){for(var g=[],h=0;h<d;h++)g.push(a.coords[f+h]);e.push(g)}return b?c?{points:e,hasZ:b,hasM:c}:{points:e,hasZ:b}:c?{points:e,hasM:c}:{points:e}}function z(a,b,c){var d=b?c?4:3:c?3:2,e=a.coords,f=[],g=0,h=0;for(a=a.lengths;h<a.length;h++){for(var l=a[h],k=[],m=0;m<l;m++){for(var p=[],n=0;n<d;n++)p.push(e[g++]);k.push(p)}f.push(k)}return b?c?{paths:f,hasZ:b,hasM:c}:{paths:f,hasZ:b}:c?{paths:f,hasM:c}:{paths:f}}function f(a,b,c){var d=b?c?4:3:c?3:2,e=a.coords,
f=[],g=0,h=0;for(a=a.lengths;h<a.length;h++){for(var l=a[h],k=[],m=0;m<l;m++){for(var p=[],n=0;n<d;n++)p.push(e[g++]);k.push(p)}f.push(k)}return b?c?{rings:f,hasZ:b,hasM:c}:{rings:f,hasZ:b}:c?{rings:f,hasM:c}:{rings:f}}function n(b,c,d,e){if(!c)return[];switch(c){case "esriGeometryPoint":c=m;e&&d?c=x:e?c=q:d&&(c=u);d=[];for(e=0;e<b.length;e++){var f=b[e],g=f.geometry,f=f.attributes,g=g?c(g):void 0;d.push(new ea(g,f))}return d;case "esriGeometryMultipoint":c=d?e?4:3:e?3:2;d=[];for(e=0;e<b.length;e++){var g=
b[e],h=g.geometry,g=g.attributes,f=void 0;if(h){f=new ca;f.lengths[0]=h.points.length;for(var l=f.coords,k=0,p=0,h=h.points;p<h.length;p++)for(var n=h[p],r=0;r<c;r++)l[k++]=n[r]}d.push(new ea(f,g))}return d;case "esriGeometryPolyline":c=d?e?4:3:e?3:2;d=[];for(e=0;e<b.length;e++){g=b[e];n=g.geometry;g=g.attributes;f=void 0;if(n)for(f=new ca,l=f.lengths,k=f.coords,h=p=0,n=n.paths;h<n.length;h++){for(var r=n[h],t=0,y=r;t<y.length;t++)for(var z=y[t],A=0;A<c;A++)k[p++]=z[A];l.push(r.length)}d.push(new ea(f,
g))}return d;case "esriGeometryPolygon":c=d?e?4:3:e?3:2;d=[];for(e=0;e<b.length;e++){f=b[e];r=f.geometry;g=f.centroid;f=f.attributes;l=void 0;if(r)for(l=new ca,k=l.lengths,p=l.coords,n=h=0,r=r.rings;n<r.length;n++){t=r[n];y=0;for(z=t;y<z.length;y++)for(var A=z[y],B=0;B<c;B++)p[h++]=A[B];k.push(t.length)}g?d.push(new ea(l,f,m(g))):d.push(new ea(l,f))}return d;default:return G.error("convertToFeatureSet:unknown-geometry",new a("Unable to parse unknown geometry type "+c)),[]}}function r(a,b,c,d,f,h){f=
Q[f];var l=b.coords;b=b.lengths;var k=c?d?4:3:d?3:2;c=c?d?aa:K:d?K:W;a.lengths.length=0;a.coords.length=0;if(!l.length)return a;if(!b.length)return c(a.coords,l,0,0,e(h,l[0]),g(h,l[1])),a.lengths.length=0,a.coords.length=k,a;for(var m,p,n,q=0,r,t=0,u=0;u<b.length;u++){var y=b[u];if(!(y<f)){var x=0;r=t;p=d=e(h,l[q]);n=m=g(h,l[q+1]);c(a.coords,l,r,q,p,n);x++;q+=k;r+=k;for(var z=1;z<y;z++,q+=k)if(p=e(h,l[q]),n=g(h,l[q+1]),p!==d||n!==m)c(a.coords,l,r,q,p-d,n-m),r+=k,x++,d=p,m=n;x>=f&&(a.lengths.push(x),
t=r)}}a.coords.length=t;return a.coords.length?a:null}function B(a,b,c,e,f){var g=b.coords;b=b.lengths;var h=c?e?aa:K:e?K:W;c=c?e?4:3:e?3:2;if(!g.length)return a.lengths.length=0,a.coords.length=0,a;if(!b.length)return h(a.coords,g,0,0,l(f,g[0]),d(f,g[1])),a.lengths.length=0,a.coords.length=c,a;var k=f.scale;e=k[0];for(var k=k[1],m=0,p=0;p<b.length;p++){var n=b[p];a.lengths[p]=n;var q=l(f,g[m]),r=d(f,g[m+1]);h(a.coords,g,m,m,q,r);for(var m=m+c,t=1;t<n;t++,m+=c)q+=g[m]*e,r-=g[m+1]*k,h(a.coords,g,m,
m,q,r)}a.lengths.length=b.length;a.coords.length=g.length;return a}function C(a,b,c,d,e,f){f=e?f?4:3:f?3:2;var g=c,h=c+f,l=0,k=0,m=c=0,p=0,n=0;for(--d;n<d;n++,g+=f,h+=f){var q=b[g],r=b[g+1],t=b[g+2],u=b[h],y=b[h+1],x=b[h+2],z=q*y-u*r,m=m+z,l=l+(q+u)*z,k=k+(r+y)*z;e&&(z=q*x-u*t,c+=(t+x)*z,p+=z);q<a[0]&&(a[0]=q);q>a[1]&&(a[1]=q);r<a[2]&&(a[2]=r);r>a[3]&&(a[3]=r);e&&(t<a[4]&&(a[4]=t),t>a[5]&&(a[5]=t))}0<m&&(m*=-1);0<p&&(p*=-1);if(!m)return null;a=[l,k,.5*m];e&&(a[3]=c,a[4]=.5*p);return a}function D(a,
b,c,d,e){e=d?e?4:3:e?3:2;for(var f=b,g=b+e,h=0,l=0,k=0,m=0,p=0,n=c-1;p<n;p++,f+=e,g+=e){var q=a[f],r=a[f+1],t=a[f+2],u=a[g],y=a[g+1],x=a[g+2],z=d?H(q,r,t,u,y,x):F(q,r,u,y);z&&(h+=z,d?(q=I(q,r,t,u,y,x),l+=z*q[0],k+=z*q[1],m+=z*q[2]):(q=J(q,r,u,y),l+=z*q[0],k+=z*q[1]))}return 0<h?d?[l/h,k/h,m/h]:[l/h,k/h]:0<c?d?[a[b],a[b+1],a[b+2]]:[a[b],a[b+1]]:null}function F(a,b,c,d){a=c-a;b=d-b;return Math.sqrt(a*a+b*b)}function H(a,b,c,d,e,f){a=d-a;b=e-b;c=f-c;return Math.sqrt(a*a+b*b+c*c)}function J(a,b,c,d){return[a+
.5*(c-a),b+.5*(d-b)]}function I(a,b,c,d,e,f){return[a+.5*(d-a),b+.5*(e-b),c+.5*(f-c)]}Object.defineProperty(b,"__esModule",{value:!0});var G=c.getLogger("esri.tasks.support.optimizedFeatureSet"),Q={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},W=function(a,b,c,d,e,f){a[c]=e;a[c+1]=f},K=function(a,b,c,d,e,f){a[c]=e;a[c+1]=f;a[c+2]=b[d+2]},aa=function(a,b,c,d,e,f){a[c]=e;a[c+1]=f;a[c+2]=b[d+2];a[c+3]=b[d+3]};b.quantizeX=e;b.quantizeY=g;b.hydrateX=l;b.hydrateY=
d;var ba=function(){return function(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1}}();b.OptimizedFeatureSet=ba;var ca=function(){return function(a,b){void 0===a&&(a=[]);void 0===b&&(b=[]);this.lengths=a;this.coords=b}}();b.OptimizedGeometry=ca;var ea=function(){return function(a,b,c){void 0===a&&(a=null);
void 0===b&&(b={});this.geometry=a;this.attributes=b;c&&(this.centroid=c)}}();b.OptimizedFeature=ea;b.convertToPoint=function(a,b,c){return b?c?y(a):p(a):c?t(a):h(a)};b.convertToMultipoint=A;b.convertToPolyline=z;b.convertToPolygon=f;b.convertFromFeatures=n;b.convertToFeatureSet=function(b){var c=[],d=b.objectIdFieldName,e=b.spatialReference,g=b.transform,l=b.fields,k=b.hasM,m=b.hasZ,n=b.features,q=b.geometryType;b=b.exceededTransferLimit;switch(q){case "esriGeometryPoint":c=h;k&&m?c=y:k?c=p:m&&(c=
t);for(var r=[],u=0;u<n.length;u++){var x=n[u],B=x.geometry,x=x.attributes,B=B?c(B):null;r.push({attributes:x,geometry:B})}c=r;break;case "esriGeometryMultipoint":c=[];for(r=0;r<n.length;r++)B=n[r],u=B.geometry,B=B.attributes,x=void 0,u&&(x=A(u,m,k)),c.push({attributes:B,geometry:x});break;case "esriGeometryPolyline":c=[];for(r=0;r<n.length;r++)B=n[r],u=B.geometry,B=B.attributes,x=void 0,u&&(x=z(u,m,k)),c.push({attributes:B,geometry:x});break;case "esriGeometryPolygon":c=[];for(r=0;r<n.length;r++){var x=
n[r],B=x.geometry,u=x.attributes,C=x.centroid,x=void 0;B&&(x=f(B,m,k));C?(B=h(C),c.push({attributes:u,centroid:B,geometry:x})):c.push({attributes:u,geometry:x})}break;default:G.error("convertToFeatureSet:unknown-geometry",new a("Unable to parse unknown geometry type "+q))}d={features:c,fields:l,geometryType:q,objectIdFieldName:d,spatialReference:e};g&&(d.transform=g);b&&(d.exceededTransferLimit=b);k&&(d.hasM=k);m&&(d.hasZ=m);return d};b.convertFromFeatureSet=function(a){var b=new ba,c=a.hasM,d=a.hasZ,
e=a.features,f=a.objectIdFieldName,g=a.spatialReference,h=a.geometryType,l=a.exceededTransferLimit,k=a.transform;b.fields=a.fields;b.geometryType=h;b.objectIdFieldName=f;b.spatialReference=g;b.features=n(e,h,d,c);l&&(b.exceededTransferLimit=l);c&&(b.hasM=c);d&&(b.hasZ=d);k&&(b.transform=k);return b};b.hydrateOptimizedFeatureSet=function(a){var b=a.transform,c=a.hasM,d=a.hasZ;if(!b)return a;for(var e=0,f=a.features;e<f.length;e++){var g=f[e];B(g.geometry,g.geometry,c,d,b);g.centroid&&B(g.centroid,
g.centroid,c,d,b)}a.transform=null;return a};b.quantizeOptimizedFeatureSet=function(b,c){var d=c.geometryType,e=c.features,f=c.hasM,g=c.hasZ;if("esriGeometryEnvelope"===d)return G.error(new a("optimized-features:invalid-geometry-type",'FeatureSet with geometry type "'+d+'" is not supported')),c;if(!b)return c;for(var h=0;h<e.length;h++){var l=e[h],k=new ea(new ca,l.attributes);r(k.geometry,l.geometry,f,g,d,b);l.centroid&&(k.centroid=new ca,r(k.centroid,l.centroid,f,g,"esriGeometryPoint",b));e[h]=
k}c.transform=b;return c};b.quantizeOptimizedGeometry=r;b.quantizeOptimizedGeometryRemoveCollinear=function(a,b,c,d,f,h){f=Q[f];var l=b.coords;b=b.lengths;var k=c?d?4:3:d?3:2;c=c?d?aa:K:d?K:W;a.lengths.length=0;a.coords.length=0;if(!l.length)return a;if(!b.length)return c(a.coords,l,0,0,e(h,l[0]),g(h,l[1])),a.lengths.length=0,a.coords.length=k,a;for(var m,p,n,q=0,r,t=0,u=0;u<b.length;u++){var x=b[u];if(!(x<f)){var y=0;r=t;d=m=e(h,l[q]);n=p=g(h,l[q+1]);c(a.coords,l,r,q,d,n);y++;for(var q=q+k,z=!1,
A=0,B=0,C=1;C<x;C++,q+=k)if(d=e(h,l[q]),n=g(h,l[q+1]),d!==m||n!==p)m=d-m,p=n-p,z&&(0===A&&0===m||0===B&&0===p)?(A+=m,B+=p):(z=!0,A=m,B=p,r+=k,y++),c(a.coords,l,r,q,A,B),m=d,p=n;z&&(r+=k,c(a.coords,l,r,q,A,B));y>=f&&(a.lengths.push(y),t=r)}}a.coords.length=t;return a.coords.length?a:null};b.getBoundsOptimizedGeometry=function(a,b,c,d){c=c?d?4:3:d?3:2;b=b.coords;for(var e=d=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=0;h<b.length;h+=c){var l=b[h],k=b[h+1];d=Math.min(d,
l);f=Math.max(f,l);e=Math.min(e,k);g=Math.max(g,k)}a[0]=d;a[1]=e;a[2]=f;a[3]=g;return a};b.getQuantizedBoundsOptimizedGeometry=function(a,b,c,d){c=c?d?4:3:d?3:2;d=b.coords;var e=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,l=0,k=0;for(b=b.lengths;k<b.length;k++)for(var m=b[k],p=d[l],n=d[l+1],e=Math.min(p,e),f=Math.min(n,f),g=Math.max(p,g),h=Math.max(n,h),l=l+c,q=1;q<m;q++,l+=c){var r=d[l],t=d[l+1],p=p+r,n=n+t;0>r&&(e=Math.min(e,p));0<r&&
(g=Math.max(g,p));0>t?f=Math.min(f,n):0<t&&(h=Math.max(h,n))}a[0]=e;a[1]=f;a[2]=g;a[3]=h;return a};b.hydrateOptimizedGeometry=B;b.getCentroidOptimizedGeometry=function(a,b,c,d){if(!b||!b.lengths.length)return null;a.lengths.length=0;a.coords.length=0;for(var e=a.coords,f=[],g=c?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY],h=b.lengths,l=b.coords,k=c?d?4:3:d?3:2,m=0,p=0;p<h.length;p++){var n=h[p],q=C(g,l,m,n,c,d);q&&f.push(q);m+=n*k}f.sort(function(a,b){var d=a[2]-b[2];0===d&&c&&(d=a[4]-b[4]);return d});f.length&&(k=6*f[0][2],e[0]=f[0][0]/k,e[1]=f[0][1]/k,c&&(k=6*f[0][4],e[2]=0!==k?f[0][3]/k:0),e[0]<g[0]||e[0]>g[1]||e[1]<g[2]||e[1]>g[3]||c&&(e[2]<g[4]||e[2]>g[5]))&&(e.length=0);if(!e.length)if(b=b.lengths[0]?D(l,0,h[0],c,d):null)e[0]=b[0],e[1]=b[1],c&&2<b.length&&(e[2]=b[2]);else return null;
return a};b.lineCentroid=D;b.getLength2D=F;b.getLength3D=H;b.getMidpoint2D=J;b.getMidpoint3D=I})},"esri/layers/vectorTiles/views/2d/tiling/TileQueue":function(){define(["require","exports","../../../core/QueueProcessor","../libs/gl-matrix/vec2"],function(k,b,a,c){function e(a,b){a.length=0;b.forEach(function(b){return a.push(b)});return a}var g=new Set,l=[],d=new Map;return function(){function b(b){var c=this;this._keysToRequests=new Map;this.tileInfoView=null;var d=b.strategy&&"scale-first"!==b.strategy?
this._peekByCenterFirst.bind(this):this._peekByScaleFirst.bind(this);this.tileInfoView=b.tileInfoView;this._queues=b.tileServers&&0<b.tileServers.length?b.tileServers.map(function(e){return new a({concurrency:b.concurrency||6,process:function(a){a=c._keysToRequests.get(a);return b.process(a,e)},peeker:d})}):[new a({concurrency:b.concurrency||6,process:function(a){a=c._keysToRequests.get(a);return b.process(a)},peeker:d})]}Object.defineProperty(b.prototype,"length",{get:function(){return this._queues.reduce(function(a,
b){return a+b.length},0)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onGoingCount",{get:function(){return this._keysToRequests.size},enumerable:!0,configurable:!0});b.prototype.clear=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].clear();this._keysToRequests.clear()};b.prototype.find=function(a,b){var c=this;b=0;for(var d=this._queues;b<d.length;b++){var e=d[b].find(function(b){return a(c._keysToRequests.get(b).key)});if(e)return e}};b.prototype.get=function(a){a=
"string"===typeof a?a:a.id;for(var b=0,c=this._queues;b<c.length;b++){var d=c[b].get(a);if(d)return d}};b.prototype.getRequest=function(a){return this._keysToRequests.get("string"===typeof a?a:a.id)};b.prototype.has=function(a){return"string"===typeof a?this._keysToRequests.has(a):this._keysToRequests.has(a.id)};b.prototype.isOngoing=function(a){var b="string"===typeof a?a:a.id;return this.has(b)&&this._queues.some(function(a){return a.isOngoing(b)})};b.prototype.pause=function(){for(var a=0,b=this._queues;a<
b.length;a++)b[a].pause()};b.prototype.push=function(a){var b=this,c=a.key.id,d=this._queues[a.key.row%this._queues.length].push(c);this._keysToRequests.set(c,a);d.then(function(){b._keysToRequests.delete(c)});d.catch(function(){b._keysToRequests.delete(c)});return d};b.prototype.reset=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].reset()};b.prototype.resume=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].resume()};b.prototype._peekByScaleFirst=function(a){if(!this.state)return a[0];
for(var b=this.tileInfoView,c=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,k=0;k<a.length;k++){var m=this._keysToRequests.get(a[k]),x=this.tileInfoView.getTileScale(m.key);d.has(x)||(d.set(x,[]),c=Math.max(x,c),h=Math.min(x,h));d.get(x).push(m.key);g.add(x)}var A=this.state.scale;d.has(A)||(e(l,g),l.sort(),A=l.reduce(function(a,b,c,d){return Math.abs(b-A)<Math.abs(a-A)?b:a},l[0]));A=Math.min(A,c);A=Math.max(A,h);a=d.get(A);var z=b.getClosestInfoForScale(A),f=z.getColumnForX(this.state.center[0]),
n=z.getRowForY(this.state.center[1]);a.sort(function(a,b){var c=z.denormalizeCol(a.col,a.world),d=z.denormalizeCol(b.col,b.world);return Math.sqrt((f-c)*(f-c)+(n-a.row)*(n-a.row))-Math.sqrt((f-d)*(f-d)+(n-b.row)*(n-b.row))});g.clear();d.clear();return a[0].id};b.prototype._peekByCenterFirst=function(a){if(!this.state)return a[0];for(var b=this.tileInfoView,d=this.state.center,e=[0,0],g=Number.POSITIVE_INFINITY,h=null,l=0;l<a.length;l++){var k=this._keysToRequests.get(a[l]);b.getTileCoords(e,k.key);
var m=c.distance(e,d);m<g&&(g=m,h=k.key)}return h.id};return b}()})},"esri/layers/vectorTiles/core/QueueProcessor":function(){define(["require","exports","dojo/Deferred","./Queue","./scheduling"],function(k,b,a,c,e){return function(){function b(a){this._apiPromises=new Map;this._processingItems=new Map;this._isPaused=!1;this._scheduledNextHandle=null;this.concurrency=1;this.ordered=!1;a.concurrency&&(this.concurrency=a.concurrency);this.ordered=!!a.ordered;this._queue=new c(a.peeker?{peeker:a.peeker}:
void 0);this.process=a.process}Object.defineProperty(b.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0});b.prototype.clear=function(){this._queue.clear();var a=[];this._processingItems.forEach(function(b){return a.push(b.resultPromise)});this._processingItems.clear();a.forEach(function(a){return a.cancel()});a.length=0;this._apiPromises.forEach(function(b){return a.push(b)});this._apiPromises.clear();a.forEach(function(a){return a.cancel()});
this._cancelNext()};b.prototype.find=function(a,b){var c=this,d=void 0;this._apiPromises.forEach(function(e,g){a.call(b,g)&&(d=c._apiPromises.get(g).promise)});return d};b.prototype.get=function(a){return(a=this._apiPromises.get(a))&&a.promise||void 0};b.prototype.isOngoing=function(a){return this._processingItems.has(a)};b.prototype.has=function(a){return this._apiPromises.has(a)};b.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};b.prototype.push=function(b){var c=
this;if(this._apiPromises.has(b))return this._apiPromises.get(b).promise;var e=new a(function(a){var d=c._processingItems.get(b);d?d.resultPromise.cancel(a):(c._remove(b),c._scheduleNext())});this._add(b,e);this._scheduleNext();return e.promise};b.prototype.reset=function(){var a=[];this._processingItems.forEach(function(b){return a.push(b)});this._processingItems.clear();for(var b=0;b<a.length;b++){var c=a[b];c.resultPromise.isFulfilled()?this._processReset(c):(c.isReset=!0,c.resultPromise.cancel())}};
b.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};b.prototype._scheduleNext=function(){var a=this;this._isPaused||this._scheduledNextHandle||(this._scheduledNextHandle=e.schedule(function(){a._scheduledNextHandle=null;a._next()}))};b.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};b.prototype._processResult=function(a,b){this._remove(a.item);this._scheduleNext();a.dfd.resolve(b)};
b.prototype._processError=function(a,b){a.isReset?this._processReset(a):(this._remove(a.item),this._scheduleNext(),a.dfd.reject(b))};b.prototype._processReset=function(a){this._remove(a.item);this._add(a.item,a.dfd);this._scheduleNext()};b.prototype._processOrdered=function(a,b){var c=this,d=!1;if(a.isReset)this._processReset(a);else{a.result=b;this._itemsToProcess||(this._itemsToProcess=[]);this._processingItems.forEach(function(a){d||(a.result?c._itemsToProcess.push(a):d=!0)});a=0;for(b=this._itemsToProcess;a<
b.length;a++){var e=b[a];!1===e.result.ok?this._processError(e,e.result.error):this._processResult(e,e.result.value)}this._itemsToProcess.length=0}};b.prototype._process=function(a){var b=this;if(null!=a){var c=this._apiPromises.get(a),e=this.process(a);if(e&&"function"===typeof e.then){var g={item:a,resultPromise:e,result:null,dfd:c,isReset:!1};this._processingItems.set(a,g);this.ordered?e.then(function(a){return b._processOrdered(g,{ok:!0,value:a})},function(a){return b._processOrdered(g,{ok:!1,
error:a})}):e.then(function(a){return b._processResult(g,a)},function(a){return b._processError(g,a)})}else c.resolve(e),this._remove(a)}};b.prototype._add=function(a,b){this._apiPromises.set(a,b);this._queue.push(a)};b.prototype._remove=function(a){this._queue.remove(a);this._apiPromises.delete(a);this._processingItems.delete(a)};b.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)};return b}()})},"esri/layers/vectorTiles/core/Queue":function(){define(["require",
"exports"],function(k,b){return function(){function a(a){this._items=[];this._itemSet=new Set;this._peeker=function(a){return a[0]};this._length=0;a&&a.peeker&&(this._peeker=a.peeker)}Object.defineProperty(a.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0});a.prototype.clear=function(){this._itemSet.clear();this._length=this._items.length=0};a.prototype.peek=function(){if(0!==this._length)return this._peeker(this._items)};a.prototype.push=function(a){this.contains(a)||
this._add(a)};a.prototype.contains=function(a){return 0<this._length&&this._itemSet.has(a)};a.prototype.pop=function(){if(0!==this._length){var a=this.peek();this._remove(a);return a}};a.prototype.remove=function(a){this.contains(a)&&this._remove(a)};a.prototype._add=function(a){this._items.push(a);this._itemSet.add(a);this._length++};a.prototype._remove=function(a){this._itemSet.delete(a);this._items.splice(this._items.indexOf(a),1);this._length--};return a}()})},"esri/layers/vectorTiles/views/2d/tiling/TileStrategy":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./enums","./TileKey"],function(k,b,a,c,e){var g=new e(0,0,0,0),l=new Map,d=[],h=[];return function(){function a(a){this._previousResolution=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy="closest";this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);a.coveragePolicy&&(this.coveragePolicy=
a.coveragePolicy);null!=a.buffer&&(this.buffer=a.buffer)}a.prototype.destroy=function(){this.tileIndex.clear()};a.prototype.update=function(a){var b=this,e=this.tileIndex,k=this.tileInfoView.getTileCoverage(a.state,this.buffer,this.coveragePolicy);if(k){var m=k.spans,p=k.lodInfo,A=p.level,z=a.state.resolution,f=!a.stationary&&z>this._previousResolution;this._previousResolution=z;e.forEach(function(a){return a.visible=!0});this.tiles.length=0;l.clear();var n=0,r=0;if(0<m.length)for(var B=0;B<m.length;B++){a=
m[B];for(var C=a.row,D=a.colTo,F=a.colFrom;F<=D;F++)n++,a=g.set(A,C,p.normalizeCol(F),p.getWorldForColumn(F)).id,e.has(a)?(z=e.get(a),z.status!==c.TileStatus.INITIALIZED&&r++,z.attached?l.set(a,z):z.attached||f||this._addParentTile(a,l)):(z=this.acquireTile(g),this.tileIndex.set(a,z),f||this._addParentTile(a,l))}var H=r===n;h.length=0;d.length=0;e.forEach(function(a,e){g.set(e);if(!l.has(e)){var m=b.tileInfoView.intersects(k,g);!m||!f&&H?"purge"===b.cachePolicy&&a.status!==c.TileStatus.MODIFIED&&
a.status!==c.TileStatus.READY?d.push(e):(g.level>A||!m)&&d.push(e):a.attached?h.push(e):g.level>A&&d.push(e)}});for(m=0;m<h.length;m++)a=h[m],(z=e.get(a))&&z.attached&&l.set(a,z);for(m=0;m<d.length;m++)a=d[m],z=e.get(a),this.releaseTile(z),e["delete"](a);l.forEach(function(a){return b.tiles.push(a)});e.forEach(function(a){l.has(a.key.id)||(a.visible=!1)});h.length=0;d.length=0;l.clear();return H}};a.prototype.clear=function(){var a=this,b=this.tileIndex;b.forEach(function(b){a.releaseTile(b)});b.clear()};
a.prototype._addParentTile=function(a,b){for(var c=null;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)&&(c=this.tileIndex.get(a))&&c.attached){b.has(c.key.id)||b.set(c.key.id,c);break}}};return a}()})},"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/backgroundShaders.xml":'\x3csnippets\x3e\r\n  \x3csnippet name\x3d"backgroundVS"\x3e\r\n  \x3c![CDATA[\r\n    attribute vec2 a_pos;\r\n\r\n    uniform highp mat4 u_transformMatrix;\r\n    uniform mediump vec2 u_normalized_origin;\r\n    uniform mediump float u_coord_range;\r\n    uniform mediump float u_depth;\r\n\r\n    void main() {\r\n      gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"backgroundFS"\x3e\r\n  \x3c![CDATA[\r\n    uniform lowp vec4 u_color;\r\n    void main() {\r\n      gl_FragColor \x3d u_color;\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/bitblitShaders.xml":'\x3csnippets\x3e\r\n  \x3csnippet name\x3d"bitblitVS"\x3e\r\n  \x3c![CDATA[\r\n    attribute vec2 a_pos;\r\n    attribute vec2 a_tex;\r\n\r\n    varying mediump vec2 v_uv;\r\n\r\n    void main(void) {\r\n      gl_Position \x3d vec4(a_pos, 0.0, 1.0);\r\n      v_uv \x3d a_tex;\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"bitblitFS"\x3e\r\n  \x3c![CDATA[\r\n    \tuniform lowp sampler2D u_tex;\r\n      uniform lowp float u_opacity;\r\n\r\n      varying mediump vec2 v_uv;\r\n\r\n      void main() {\r\n        lowp vec4 color \x3d texture2D(u_tex, v_uv);\r\n\r\n        // Note: output in pre-multiplied alpha for correct alpha compositing\r\n        gl_FragColor \x3d color *  u_opacity;\r\n      }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/stencilShaders.xml":'\x3csnippets\x3e\r\n  \x3csnippet name\x3d"stencilVS"\x3e\r\n  \x3c![CDATA[\r\n    attribute vec2 a_pos;\r\n\r\n    void main() {\r\n      gl_Position \x3d vec4(a_pos, 0.0, 1.0);\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"stencilFS"\x3e\r\n  \x3c![CDATA[\r\n    void main() {\r\n      gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/tileInfo.xml":'\x3csnippets\x3e\r\n  \x3csnippet name\x3d"tileInfoVS"\x3e\r\n  \x3c![CDATA[\r\n    attribute vec2 a_pos;\r\n\r\n    uniform highp mat4 u_transformMatrix;\r\n    uniform mediump vec2 u_normalized_origin;\r\n    uniform mediump float u_depth;\r\n    uniform mediump float u_coord_ratio;\r\n    uniform mediump vec2 u_delta; // in tile coordinates\r\n    uniform mediump vec2 u_dimensions; // in tile coordinates\r\n\r\n    varying mediump vec2 v_tex;\r\n\r\n    void main() {\r\n      mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\r\n      gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\r\n\r\n      v_tex \x3d a_pos;\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"tileInfoFS"\x3e\r\n  \x3c![CDATA[\r\n    uniform mediump sampler2D u_texture;\r\n    varying mediump vec2 v_tex;\r\n\r\n    void main(void) {\r\n      lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n      gl_FragColor \x3d 0.75 * color;\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/fillShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  // YF TODO: (doc)\r\n--\x3e\r\n\x3csnippets\x3e\r\n  \x3csnippet name\x3d"fillVVUniformsVS"\x3e\r\n    \x3c![CDATA[\r\n  #if defined(VV_COLOR)|| defined(VV_OPACITY)\r\n    attribute vec4 a_vv;\r\n  #endif // VV_COLOR || VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    uniform float u_vvColorValues[8];\r\n    uniform vec4 u_vvColors[8];\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef VV_OPACITY\r\n    uniform float u_vvOpacityValues[8];\r\n    uniform float u_vvOpacities[8];\r\n  #endif // VV_OPACITY\r\n\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"fillVVFunctions"\x3e\r\n    \x3c![CDATA[\r\n    bool isNan(float val) {\r\n      return !( val \x3c 0.0 || 0.0 \x3c val || val \x3d\x3d 0.0 );\r\n    }\r\n    \r\n  #ifdef VV_OPACITY\r\n    const int VV_OPACITY_N \x3d 8;\r\n\r\n    float getVVOpacity(float opacityValue) {\r\n      if (isNan(opacityValue)) { \r\n        return 1.0;\r\n      }\r\n\r\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\r\n        return u_vvOpacities[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\r\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\r\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\r\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvOpacities[VV_OPACITY_N - 1];\r\n    }\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    const int VV_COLOR_N \x3d 8;\r\n\r\n    vec4 getVVColor(float colorValue, vec4 fallback) {\r\n      if (isNan(colorValue)) { \r\n        return fallback;\r\n      }\r\n      \r\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\r\n        return u_vvColors[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\r\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\r\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvColors[VV_COLOR_N - 1];\r\n    }\r\n  #endif // VV_COLOR\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"fillVS"\x3e\r\n    \x3c![CDATA[\r\n      precision mediump float;\r\n\r\n      attribute vec2 a_pos;\r\n      attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\r\n      attribute vec4 a_color;\r\n      attribute vec4 a_tlbr;\r\n      attribute vec4 a_aux;\r\n\r\n      uniform highp mat4 u_transformMatrix;\r\n      uniform highp vec2 u_normalized_origin;\r\n\r\n      varying lowp vec4 v_color;\r\n      varying lowp float v_opacity;\r\n\r\n      // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\r\n      $fillVVUniformsVS\r\n      $fillVVFunctions\r\n\r\n  #ifdef PATTERN\r\n    uniform mediump float u_zoomFactor;\r\n    uniform mediump vec2 u_mosaicSize;\r\n\r\n    varying mediump vec4 v_tlbr;\r\n    varying mediump vec2 v_tileTextureCoord;\r\n  #endif // PATTERN\r\n\r\n  #ifdef ID\r\n    varying highp vec4 v_id;\r\n  #endif // ID\r\n\r\n      void main()\r\n      {\r\n  #ifdef VV_OPACITY\r\n        v_opacity \x3d getVVOpacity(a_vv.y);\r\n  #else\r\n        v_opacity \x3d 1.0;\r\n  #endif\r\n\r\n  #ifdef VV_COLOR\r\n       v_color \x3d getVVColor(a_vv.x, a_color);\r\n  #else\r\n       v_color \x3d a_color;\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef ID\r\n      v_id \x3d a_id;\r\n  #endif // ID\r\n\r\n  #ifdef PATTERN\r\n       // calculate the pattern matrix\r\n       mat3 patternMatrix \x3d mat3(1.0, 0.0, 0.0,\r\n                                 0.0, 1.0, 0.0,\r\n                                 0.0, 0.0, 1.0);\r\n       patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux.x);\r\n       patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux.y);\r\n\r\n       // calculate the texture coordinates of the current vertex. It will of course get interpolated.\r\n       // The pattern matrix is a 3x3 scale matrix which \'tiles\' the texture inside the tile, translating from\r\n       // tile coordinates to texture coordinates.\r\n       v_tileTextureCoord \x3d (patternMatrix * vec3(a_pos, 1.0)).xy;\r\n       v_tlbr \x3d vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\r\n  #endif // PATTERN\r\n\r\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"fillFS"\x3e\r\n    \x3c![CDATA[\r\n      precision lowp float;\r\n      uniform lowp float u_opacity;\r\n\r\n  #ifdef PATTERN\r\n      uniform lowp sampler2D u_texture;\r\n\r\n      varying mediump vec4 v_tlbr;\r\n      varying mediump vec2 v_tileTextureCoord;\r\n  #endif // PATTERN\r\n\r\n  #ifdef ID\r\n    varying highp vec4 v_id;\r\n  #endif // ID\r\n\r\n      varying lowp vec4 v_color;\r\n      varying lowp float v_opacity;\r\n\r\n      void main()\r\n      {\r\n  #ifdef PATTERN\r\n         // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\r\n         mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\r\n         // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\r\n         // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\r\n         // we need to only sample from area that has our sprite in the mosaic.\r\n         mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\r\n         // sample the sprite mosaic\r\n         lowp vec4 color \x3d texture2D(u_texture, samplePos);\r\n         gl_FragColor \x3d u_opacity * v_opacity * v_color * color;\r\n  #else\r\n        gl_FragColor \x3d u_opacity * v_opacity * v_color;\r\n  #endif // PATTERN\r\n\r\n  #ifdef HIGHLIGHT\r\n        gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\r\n  #endif // HIGHLIGHT\r\n\r\n  #ifdef ID\r\n      //if (gl_FragColor.a \x3c 1.0 / 255.0) {\r\n      //  discard;\r\n      //}\r\n      gl_FragColor \x3d v_id;\r\n  #endif // ID\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/iconShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Add your GLSL snippets to this file. You should start from\r\n  importing your old GLSL files. For instance, if you have a\r\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\r\n  and then copy and paste the GLSL source as the content. You will then convert your\r\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\r\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\r\n--\x3e\r\n\x3csnippets\x3e\r\n\r\n  \x3csnippet name\x3d"rgba2float"\x3e\x3c![CDATA[\r\n    // TODO consider moving this snippet into a util.xml file\r\n\r\n    // Factors to convert rgba back to float\r\n    const vec4 rgba2float_factors \x3d vec4(\r\n        255.0 / (256.0),\r\n        255.0 / (256.0 * 256.0),\r\n        255.0 / (256.0 * 256.0 * 256.0),\r\n        255.0 / (256.0 * 256.0 * 256.0 * 256.0)\r\n      );\r\n\r\n    float rgba2float(vec4 rgba) {\r\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\r\n      // add the components together with their corresponding\r\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\r\n      return dot(rgba, rgba2float_factors);\r\n    }\r\n  ]]\x3e\x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"iconVVUniformsVS"\x3e\r\n    \x3c![CDATA[\r\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\r\n    attribute vec4 a_vv;\r\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\r\n\r\n  #ifdef VV_COLOR\r\n    uniform float u_vvColorValues[8];\r\n    uniform vec4 u_vvColors[8];\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    uniform vec4 u_vvSizeMinMaxValue;\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n    uniform float u_vvSizeScaleStopsValue;\r\n  #endif // VV_SIZE_SCALE_STOPS\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    uniform float u_vvSizeFieldStopsValues[6];\r\n    uniform float u_vvSizeFieldStopsSizes[6];\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    uniform float u_vvOpacityValues[8];\r\n    uniform float u_vvOpacities[8];\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_ROTATION\r\n    uniform lowp float u_vvRotationType;\r\n  #endif // VV_ROTATION\r\n\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"iconVVFunctions"\x3e\r\n    \x3c![CDATA[\r\n    bool isNan(float val) {\r\n      return !( val \x3c 0.0 || 0.0 \x3c val || val \x3d\x3d 0.0 );\r\n    }\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    float getVVMinMaxSize(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      // we need to multiply by 8 in order to translate to tile coordinates\r\n      float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\r\n      interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\r\n      return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\r\n    }\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    const int VV_SIZE_N \x3d 6;\r\n    float getVVStopsSize(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\r\n        return u_vvSizeFieldStopsSizes[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\r\n        if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\r\n          float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\r\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\r\n    }\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    float getVVUnitValue(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\r\n    }\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    const int VV_OPACITY_N \x3d 8;\r\n    float getVVOpacity(float opacityValue) {\r\n      if (isNan(opacityValue)) {\r\n        return 1.0;\r\n      }\r\n\r\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\r\n        return u_vvOpacities[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\r\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\r\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\r\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvOpacities[VV_OPACITY_N - 1];\r\n    }\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_ROTATION\r\n    mat4 getVVRotation(float rotationValue) {\r\n      // YF TODO: if the symbol has rotation we need to combine the symbo\'s rotation with the VV one\r\n      if (isNan(rotationValue)) {\r\n        return mat4(1, 0, 0, 0,\r\n                    0, 1, 0, 0,\r\n                    0, 0, 1, 0,\r\n                    0, 0, 0, 1);\r\n      }\r\n\r\n      float rotation \x3d rotationValue;\r\n      if (u_vvRotationType \x3d\x3d 1.0) {\r\n        rotation \x3d 90.0 - rotation;\r\n      }\r\n\r\n      float angle \x3d C_DEG_TO_RAD * rotation;\r\n\r\n      float sinA \x3d sin(angle);\r\n      float cosA \x3d cos(angle);\r\n\r\n      return mat4(cosA, sinA, 0, 0,\r\n                  -sinA,  cosA, 0, 0,\r\n                  0,     0, 1, 0,\r\n                  0,     0, 0, 1);\r\n    }\r\n  #endif // VV_ROTATION\r\n\r\n  #ifdef VV_COLOR\r\n    const int VV_COLOR_N \x3d 8;\r\n\r\n    vec4 getVVColor(float colorValue, vec4 fallback) {\r\n      if (isNan(colorValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\r\n        return u_vvColors[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\r\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\r\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvColors[VV_COLOR_N - 1];\r\n    }\r\n  #endif // VV_COLOR\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n\r\n  \x3csnippet name\x3d"iconVS"\x3e\r\n  \x3c![CDATA[\r\n    precision mediump float;\r\n\r\n    //const float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\r\n    const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\r\n\r\n    // per quad (instance) attributes (20 bytes \x3d\x3d\x3e equivalent of 5 bytes per vertex)\r\n    attribute vec2 a_pos;\r\n    attribute vec2 a_vertexOffset;\r\n    attribute vec4 a_vertexTex;\r\n\r\n    attribute vec4 a_id; // since we need to render the Id as a color we need to break it into RGBA components. so just like a color, the Id is normalized.\r\n    attribute vec4 a_color;\r\n    attribute vec4 a_outlineColor;\r\n    attribute vec4 a_sizeAndOutlineWidth;\r\n\r\n    // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n    // relative to the tile\'s upper left corner\r\n    // the extrusion vector.\r\n    uniform highp mat4 u_transformMatrix;\r\n    // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\r\n    uniform highp mat4 u_extrudeMatrix;\r\n    // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\r\n    uniform highp vec2 u_normalized_origin;\r\n\r\n    // the size of the mosaic given in pixels\r\n    uniform vec2 u_mosaicSize;\r\n\r\n    // the opacity of the layer given by the painter\r\n    uniform mediump float u_opacity;\r\n\r\n    // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\n    varying mediump vec2 v_tex;\r\n    // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n    // opacity of the layer given by the painter\r\n    varying lowp float v_transparency;\r\n    // the of the icon given in pixels\r\n    varying mediump vec2 v_size;\r\n\r\n    // icon color. If is a picture-marker it is used to tint the texture color\r\n    varying lowp vec4 v_color;\r\n\r\n #ifdef SDF\r\n    varying lowp vec4 v_outlineColor;\r\n    varying mediump float v_outlineWidth;\r\n #endif // SDF\r\n\r\n #ifdef ID\r\n    varying highp vec4 v_id;\r\n #endif // ID\r\n\r\n #ifdef HEATMAP\r\n    attribute float a_heatmapWeight;\r\n    varying mediump float v_heatmapWeight;\r\n #endif // HEATMAP\r\n\r\n    // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\r\n    $iconVVUniformsVS\r\n    $iconVVFunctions\r\n\r\n    void main()\r\n    {\r\n      vec2 a_offset \x3d a_vertexOffset;\r\n      vec2 a_tex \x3d a_vertexTex.xy;\r\n      vec2 a_size \x3d a_sizeAndOutlineWidth.xy;\r\n\r\n      // default values (we need them for the variations to come)\r\n      float a_angle \x3d 0.0;\r\n      float delta_z \x3d 0.0;\r\n      float depth \x3d 0.0;\r\n      v_transparency \x3d 1.0;\r\n\r\n  #if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n      // vv size override the original symbol\'s size\r\n      float h \x3d getVVMinMaxSize(a_vv.x, a_size.y);\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n      float h \x3d u_vvSizeScaleStopsValue;\r\n  #endif // VV_SIZE_SCALE_STOPS\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n      float h \x3d getVVStopsSize(a_vv.x, a_size.y);\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n      float h \x3d getVVUnitValue(a_vv.x, a_size.y);\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n      // make sure to preserve the aspect ratio of the symbol\r\n      vec2 size \x3d vec2(h * a_size.x / a_size.y, h);\r\n      vec2 offset \x3d a_offset * size / a_size;\r\n      v_size \x3d size;\r\n  #else\r\n  #ifdef HEATMAP\r\n      // reconstruct the kernel size\r\n      a_size \x3d 9.0 * a_size + 1.0;\r\n  #endif // HEATMAP\r\n\r\n      vec2 offset \x3d a_offset;\r\n      v_size \x3d a_size;\r\n  #endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n  #ifdef SDF\r\n    offset *\x3d 2.0;\r\n  #endif // SDF\r\n\r\n  #ifdef VV_ROTATION\r\n      gl_Position \x3d vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * getVVRotation(a_vv.w) * vec4(offset, delta_z, 0.0);\r\n  #else\r\n      gl_Position \x3d vec4(u_normalized_origin, depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offset, delta_z, 0.0);\r\n  #endif // VV_ROTATION\r\n\r\n  #ifdef VV_OPACITY\r\n      v_transparency \x3d getVVOpacity(a_vv.z);\r\n  #else\r\n      v_transparency \x3d u_opacity;\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n      v_color \x3d getVVColor(a_vv.y, a_color);\r\n  #else\r\n      v_color \x3d a_color;\r\n  #endif // VV_COLOR\r\n\r\n      // output the texture coordinates and the transparency\r\n      v_tex \x3d a_tex / u_mosaicSize;\r\n\r\n #ifdef SDF\r\n      v_outlineColor \x3d a_outlineColor;\r\n      v_outlineWidth \x3d a_sizeAndOutlineWidth.z;\r\n #endif // SDF\r\n\r\n #ifdef ID\r\n      v_id \x3d a_id;\r\n #endif // ID\r\n\r\n #ifdef HEATMAP\r\n    v_heatmapWeight \x3d a_heatmapWeight;\r\n #endif // HEATMAP\r\n    }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"iconFS"\x3e\r\n   \x3c![CDATA[\r\n    precision mediump float;\r\n\r\n    uniform lowp sampler2D u_texture;\r\n\r\n    varying lowp vec2 v_tex;\r\n    varying lowp float v_transparency;\r\n    varying mediump vec2 v_size;\r\n    varying lowp vec4 v_color;\r\n\r\n #ifdef SDF\r\n    varying lowp vec4 v_outlineColor;\r\n    varying mediump float v_outlineWidth;\r\n\r\n    // we need the conversion function from RGBA to float\r\n    $rgba2float\r\n #endif // SDF\r\n\r\n #ifdef ID\r\n    varying highp vec4 v_id;\r\n #endif // ID\r\n\r\n #ifdef HEATMAP\r\n    varying mediump float v_heatmapWeight;\r\n #endif // HEATMAP\r\n\r\n    const float softEdgeRatio \x3d 1.0; // use blur here if needed\r\n\r\n    void main()\r\n    {\r\n #ifdef SDF\r\n      lowp vec4 fillPixelColor \x3d v_color;\r\n\r\n      // calculate the distance from the edge [-0.5, 0.5]\r\n      float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\r\n\r\n      // the soft edge ratio is about 1.5 pixels allocated for the soft edge.\r\n      float size \x3d max(v_size.x, v_size.y);\r\n      float dist \x3d d * size * softEdgeRatio;\r\n\r\n      // set the fragment\'s transparency according to the distance from the edge\r\n      fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\r\n\r\n      // count for the outline\r\n      // therefore tint the entire icon area.\r\n      if (v_outlineWidth \x3e 0.25) {\r\n        lowp vec4 outlinePixelColor \x3d v_outlineColor;\r\n\r\n        // outlines can\'t be larger than the size of the symbol\r\n        float clampedOutlineSize \x3d min(v_outlineWidth, size);\r\n\r\n        outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\r\n\r\n        // finally combine the outline and the fill colors (outline draws on top of fill)\r\n        gl_FragColor \x3d v_transparency * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\r\n      }\r\n      else {\r\n        gl_FragColor \x3d v_transparency * fillPixelColor;\r\n      }\r\n #else // not an SDF\r\n      lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\r\n\r\n #ifdef HEATMAP\r\n      texColor.r *\x3d v_heatmapWeight;\r\n #endif // HEATMAP\r\n\r\n      gl_FragColor \x3d v_transparency * texColor;\r\n #endif // SDF\r\n\r\n #ifdef HIGHLIGHT\r\n      gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\r\n #endif // HIGHLIGHT\r\n\r\n #ifdef ID\r\n      if (gl_FragColor.a \x3c 1.0 / 255.0) {\r\n        discard;\r\n      }\r\n      gl_FragColor \x3d v_id;\r\n #endif // ID\r\n    }\r\n   ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/labelShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Add your GLSL snippets to this file. You should start from\r\n  importing your old GLSL files. For instance, if you have a\r\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\r\n  and then copy and paste the GLSL source as the content. You will then convert your\r\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\r\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\r\n--\x3e\r\n\x3csnippets\x3e\r\n\r\n  \x3csnippet name\x3d"labelVS"\x3e\r\n  \x3c![CDATA[\r\n    precision mediump float;\r\n\r\n      attribute vec2 a_pos;                  // 2 * 2 (2 x signed 16)\r\n      attribute vec4 a_color;                // 4 (4 x unsigned byte)\r\n      attribute vec2 a_vertexOffset;         // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\r\n      attribute vec4 a_texAndSize;          // 4 (4 x unsigned byte) texture coordinatesm and font size. w is for the halo size\r\n      attribute vec4 a_refSymbolAndPlacementOffset; // 4 (4 x unsigned byte) the offset of the reference symbol of the feature (x,y) and the placement offset (z, w) all given in pixels\r\n\r\n      attribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\r\n\r\n      attribute mediump vec2 a_visibilityRange; // 2 x unsigned byte;\r\n\r\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n      // relative to the tile\'s upper left corner\r\n      // the extrusion vector.\r\n      uniform highp mat4 u_transformMatrix;\r\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\r\n      uniform highp mat4 u_extrudeMatrix;\r\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\r\n      uniform highp vec2 u_normalized_origin;\r\n      // the size of the mosaic given in pixels\r\n      uniform vec2 u_mosaicSize;\r\n      uniform float u_pixelRatio;\r\n\r\n      // the opacity of the layer\r\n      uniform mediump float u_opacity;\r\n\r\n      // the curent zoom\r\n      uniform mediump float u_zoomLevel; // the current zoom level X 10\r\n      uniform lowp float u_mapRotation;\r\n      uniform lowp float u_mapAligned;\r\n\r\n      varying mediump float v_antialiasingWidth;\r\n      varying mediump float v_edgeDistanceOffset;\r\n\r\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\n      varying mediump vec2 v_tex;\r\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n      // opacity of the layer given by the painter\r\n      varying lowp float v_transparency;\r\n\r\n    #ifdef ID\r\n       uniform mediump float u_fadeStep;\r\n       varying mediump float v_fadeStep;\r\n    #else\r\n       varying mediump vec4 v_color;\r\n    #endif // ID\r\n\r\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n      // by 16 and then at the shader devide by the same number\r\n      const float offsetPrecision \x3d 1.0 / 8.0;\r\n      const float outlineScale \x3d 1.0 / 10.0;\r\n      const float sdfFontSize \x3d 24.0;\r\n\r\n      // maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\r\n      // 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\r\n      const float maxSdfDistance \x3d 8.0;\r\n\r\n      const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\r\n\r\n      void main()\r\n      {\r\n        // make sure to clip the vertices in case that given record is marked as invisible\r\n        float z \x3d 2.0 * (1.0 - a_visible);\r\n\r\n        // clip the vertex if we are beyond the visibility range of the vertex\r\n        // please note: min value of 0 is regarded infinity. max value of 255 is regarded infinity\r\n        z +\x3d 1.0 + sign(a_visibilityRange.x - u_zoomLevel);\r\n        z +\x3d 1.0 + sign(u_zoomLevel - a_visibilityRange.y);\r\n\r\n        // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\r\n        mediump float halo \x3d mod(a_pos, 2.0).x;\r\n\r\n        float fontSize \x3d a_texAndSize.z;\r\n\r\n        float fontScale \x3d fontSize / sdfFontSize;\r\n        // we need to scale the extrude matrix by the font-scale in order to get the right text size\r\n        mat4 extrudeMatrix \x3d fontScale * u_extrudeMatrix;\r\n\r\n        float mapRotation \x3d u_mapAligned * C_DEG_TO_RAD * -u_mapRotation;\r\n        float sinA \x3d sin(mapRotation);\r\n        float cosA \x3d cos(mapRotation);\r\n\r\n        mat4 mapRotationMat \x3d mat4(cosA, sinA, 0.0, 0.0,\r\n                                  -sinA, cosA, 0.0, 0.0,\r\n                                    0.0,  0.0, 1.0, 0.0,\r\n                                    0.0,  0.0, 0.0, 1.0);\r\n\r\n        vec4 refSymbolOffset \x3d mapRotationMat *  vec4(a_refSymbolAndPlacementOffset.xy, 0.0, 0.0);\r\n\r\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) +\r\n                      u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) +\r\n                      u_extrudeMatrix * vec4(refSymbolOffset.xy + a_refSymbolAndPlacementOffset.zw, 0.0, 0.0) +\r\n                      extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\r\n\r\n        v_tex \x3d a_texAndSize.xy / u_mosaicSize;\r\n        v_antialiasingWidth \x3d 0.106 * sdfFontSize / fontSize / u_pixelRatio;\r\n        // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\r\n        v_edgeDistanceOffset \x3d halo * outlineScale * a_texAndSize.w / fontScale / maxSdfDistance;\r\n\r\n        v_transparency \x3d u_opacity;\r\n\r\n      #ifdef ID\r\n        v_fadeStep \x3d u_fadeStep;\r\n      #else\r\n        v_color \x3d a_color;\r\n      #endif // ID\r\n      }\r\n  ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"labelFS"\x3e\r\n   \x3c![CDATA[\r\n      precision lowp float;\r\n\r\n      uniform mediump sampler2D u_referenceTex;\r\n      uniform mediump vec2 u_screenSize;\r\n      uniform mediump float u_pixelRatio;\r\n\r\n      varying mediump float v_antialiasingWidth;\r\n      varying mediump float v_edgeDistanceOffset;\r\n      varying mediump vec2 v_tex;\r\n      varying lowp float v_transparency;\r\n\r\n    #ifdef ID\r\n      varying mediump float v_fadeStep;\r\n    #else\r\n      uniform lowp sampler2D u_texture;\r\n      varying mediump vec4 v_color;\r\n    #endif // ID\r\n\r\n    const vec3 epsilon \x3d vec3(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\r\n\r\n      void main()\r\n      {\r\n        mediump vec2 refTextPos \x3d gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\r\n        mediump vec4 referenceFragment \x3d texture2D(u_referenceTex, refTextPos);\r\n    #ifdef ID\r\n        mediump float alpha \x3d clamp(referenceFragment.a + v_fadeStep, 0.0, 1.0);\r\n        // fill the whole quad\r\n        gl_FragColor \x3d vec4(alpha);\r\n    #else\r\n        // read the fade alpha\r\n        lowp float fadeAlpha \x3d referenceFragment.a;\r\n\r\n        // read the distance from the SDF texture\r\n        lowp float dist \x3d texture2D(u_texture, v_tex).a;\r\n\r\n        // the edge distance if a factor of the outline width\r\n        float glyphEdgeDistance \x3d 0.75 - v_edgeDistanceOffset;\r\n\r\n        // use a smooth-step in order to calculate the geometry of the shape given by the distance field\r\n        lowp float sdfAlpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\r\n\r\n        gl_FragColor \x3d fadeAlpha * sdfAlpha * v_transparency * v_color;\r\n    #endif\r\n      }\r\n   ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/lineShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  // YF TODO: (doc)\r\n--\x3e\r\n\x3csnippets\x3e\r\n  \x3csnippet name\x3d"thinLineParams"\x3e\r\n     \x3c![CDATA[\r\n    float thinLineHalfWidth \x3d 1.0; // meaning that a 2 pixels line width is considered a thin line\r\n    float thinLineWidthFactor \x3d 1.1;\r\n     ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"lineVVUniformsVS"\x3e\r\n    \x3c![CDATA[\r\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY)\r\n    attribute vec3 a_vv;\r\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    uniform float u_vvColorValues[8];\r\n    uniform vec4 u_vvColors[8];\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    uniform vec4 u_vvSizeMinMaxValue;\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n    uniform float u_vvSizeScaleStopsValue;\r\n  #endif\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    uniform float u_vvSizeFieldStopsValues[6];\r\n    uniform float u_vvSizeFieldStopsSizes[6];\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    uniform float u_vvOpacityValues[8];\r\n    uniform float u_vvOpacities[8];\r\n  #endif // VV_OPACITY\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"lineVVFunctions"\x3e\r\n    \x3c![CDATA[\r\n    bool isNan(float val) {\r\n      return !( val \x3c 0.0 || 0.0 \x3c val || val \x3d\x3d 0.0 );\r\n    }\r\n    \r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    float getVVMinMaxSize(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) { \r\n        return fallback;\r\n      }\r\n\r\n      float f \x3d (sizeValue - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\r\n      return clamp(mix(u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w, f), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\r\n    }\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    const int VV_SIZE_N \x3d 6;\r\n    float getVVStopsSize(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) { \r\n        return fallback;\r\n      }\r\n\r\n      if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\r\n        return u_vvSizeFieldStopsSizes[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\r\n        if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\r\n          float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\r\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\r\n    }\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    float getVVUnitValue(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) { \r\n        return fallback;\r\n      }\r\n\r\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\r\n    }\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    const int VV_OPACITY_N \x3d 8;\r\n    float getVVOpacity(float opacityValue) {\r\n      if (isNan(opacityValue)) { \r\n        return 1.0;\r\n      }\r\n\r\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\r\n        return u_vvOpacities[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\r\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\r\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\r\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvOpacities[VV_OPACITY_N - 1];\r\n    }\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_COLOR\r\n    const int VV_COLOR_N \x3d 8;\r\n\r\n    vec4 getVVColor(float colorValue, vec4 fallback) {\r\n      if (isNan(colorValue)) { \r\n        return fallback;\r\n      }\r\n\r\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\r\n        return u_vvColors[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\r\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\r\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvColors[VV_COLOR_N - 1];\r\n    }\r\n  #endif // VV_COLOR\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"lineVS"\x3e\r\n    \x3c![CDATA[\r\n     precision mediump float;\r\n\r\n     attribute vec2 a_pos;\r\n     attribute vec4 a_id;\r\n     attribute vec4 a_color;\r\n     attribute vec4 a_offsetAndNormal;\r\n     attribute vec2 a_accumulatedDistanceAndHalfWidth;\r\n     attribute vec4 a_tlbr;\r\n     attribute vec4 a_segmentDirection;\r\n\r\n     // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n     // relative to the tile\'s upper left corner\r\n     // the extrusion vector.\r\n     uniform highp mat4 u_transformMatrix;\r\n     // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\r\n     uniform highp mat4 u_extrudeMatrix;\r\n     // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\r\n     uniform highp vec2 u_normalized_origin;\r\n     uniform lowp float u_opacity; // the layer\'s opacity\r\n     uniform mediump float u_zoomFactor;\r\n     uniform mediump float u_antialiasing;\r\n\r\n     // the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\r\n     varying mediump vec2 v_normal;\r\n     varying mediump float v_lineHalfWidth;\r\n     varying lowp vec4 v_color;\r\n     varying lowp float v_transparency;\r\n\r\n     const float scale \x3d 1.0 / 31.0;\r\n#ifdef SDF\r\n     const float widthFactor \x3d 2.0;\r\n#else\r\n     const float widthFactor \x3d 1.0;\r\n#endif\r\n\r\n\r\n#ifdef PATTERN\r\n     uniform mediump vec2 u_mosaicSize;\r\n\r\n     varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\r\n     varying mediump vec2 v_patternSize;\r\n#endif // PATTERN\r\n\r\n// we need to accumulated distance only if it is a pattern or an SDF line\r\n#if defined(PATTERN) || defined(SDF)\r\n     varying highp float v_accumulatedDistance;\r\n#endif // PATTERN SDF\r\n\r\n#ifdef ID\r\n     varying highp vec4 v_id;\r\n#endif // ID\r\n\r\n     // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\r\n     $lineVVUniformsVS\r\n     $lineVVFunctions\r\n\r\n     void main()\r\n     {\r\n     // size VV block\r\n#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n#ifdef VV_SIZE_MIN_MAX_VALUE\r\n       mediump float lineHalfWidth \x3d 0.5 * getVVMinMaxSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\r\n#endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n#ifdef VV_SIZE_SCALE_STOPS\r\n       mediump float lineHalfWidth \x3d 0.5 * u_vvSizeScaleStopsValue;\r\n#endif // VV_SIZE_SCALE_STOPS\r\n\r\n#ifdef VV_SIZE_FIELD_STOPS\r\n       mediump float lineHalfWidth \x3d 0.5 * getVVStopsSize(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\r\n#endif // VV_SIZE_FIELD_STOPS\r\n\r\n#ifdef VV_SIZE_UNIT_VALUE\r\n       mediump float lineHalfWidth \x3d 0.5 * getVVUnitValue(a_vv.x, 2.0 * a_accumulatedDistanceAndHalfWidth.y * scale);\r\n#endif // VV_SIZE_UNIT_VALUE\r\n\r\n#else // no VV\r\n       mediump float lineHalfWidth \x3d a_accumulatedDistanceAndHalfWidth.y * scale;\r\n#endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n#ifdef VV_OPACITY\r\n      v_transparency \x3d u_opacity * getVVOpacity(a_vv.z);\r\n#else\r\n      v_transparency \x3d u_opacity;\r\n#endif // VV_OPACITY\r\n\r\n#ifdef VV_COLOR\r\n      v_color \x3d getVVColor(a_vv.y, a_color);\r\n#else\r\n      v_color \x3d a_color;\r\n#endif // VV_COLOR\r\n\r\n       // make sure to clip the vertices in case that the width of the line is 0 (or negative)\r\n       float z \x3d 2.0 * step(lineHalfWidth, 0.0);\r\n\r\n       // add an antialiasing distance. We use 0.2 rather than 0.5 in order to match the SVG renderer\r\n       // also limit the total line width to 1.3 pixels. Below this value lines don\'t look good compared to the SVG renderer\r\n       lineHalfWidth \x3d max(lineHalfWidth, 0.45) + 0.2 * u_antialiasing;\r\n\r\n       // include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\r\n       $thinLineParams\r\n       // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\r\n       // in practice, a thin line is a line who\'s half width vary from 0.45px to the value of thinLineHalfWidth, as the value\r\n       // is claped in line 221 above\r\n       mediump float thinLineFactor \x3d max(thinLineWidthFactor * step(lineHalfWidth, thinLineHalfWidth), 1.0);\r\n\r\n       v_lineHalfWidth \x3d lineHalfWidth;\r\n\r\n       // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n       // sake of using less attribute memory, we need to scale it back to the original range of ~ [0, 1])\r\n       // in a case of a thin line we move each vertex twice as far\r\n       mediump vec2 dist \x3d thinLineFactor * widthFactor * lineHalfWidth * a_offsetAndNormal.xy * scale;\r\n\r\n       // transform the vertex\r\n       gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(a_pos, z, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n       v_normal \x3d a_offsetAndNormal.zw * scale;\r\n\r\n#if defined(PATTERN) || defined(SDF)\r\n       v_accumulatedDistance \x3d a_accumulatedDistanceAndHalfWidth.x + dot(scale * a_segmentDirection.xy, dist / u_zoomFactor);\r\n#endif // PATTERN || SDF\r\n\r\n#ifdef PATTERN\r\n      v_tlbr \x3d vec4(a_tlbr.x / u_mosaicSize.x, a_tlbr.y / u_mosaicSize.y, a_tlbr.z / u_mosaicSize.x, a_tlbr.w / u_mosaicSize.y);\r\n      v_patternSize \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\r\n#endif // PATTERN\r\n\r\n#ifdef ID\r\n      v_id \x3d a_id;\r\n#endif // ID\r\n     }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"lineFS"\x3e\r\n    \x3c![CDATA[\r\n       precision lowp float;\r\n\r\n       uniform lowp float u_blur;\r\n       uniform mediump float u_antialiasing;\r\n\r\n       varying mediump vec2 v_normal;\r\n       varying mediump float v_lineHalfWidth;\r\n       varying lowp vec4 v_color;\r\n       varying lowp float v_transparency;\r\n\r\n#if defined(PATTERN) || defined(SDF)\r\n      uniform sampler2D u_texture;\r\n      uniform mediump float u_zoomFactor;\r\n\r\n      varying mediump vec4 v_tlbr; // normalized pattern coordinates [0, 1]\r\n      varying mediump vec2 v_patternSize;\r\n      varying highp float v_accumulatedDistance;\r\n#endif // PATTERN SDF\r\n\r\n#ifdef SDF\r\n      const float sdfPatternHalfWidth \x3d 15.5; // YF: assumed that the width will be set to 31\r\n     const float widthFactor \x3d 2.0;\r\n\r\n    // Factors to convert rgba back to float\r\n    const vec4 rgba2float_factors \x3d vec4(\r\n        255.0 / (256.0),\r\n        255.0 / (256.0 * 256.0),\r\n        255.0 / (256.0 * 256.0 * 256.0),\r\n        255.0 / (256.0 * 256.0 * 256.0 * 256.0)\r\n      );\r\n\r\n    float rgba2float(vec4 rgba) {\r\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\r\n      // add the components together with their corresponding\r\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\r\n      return dot(rgba, rgba2float_factors);\r\n    }\r\n#endif // SDF\r\n\r\n#ifdef ID\r\n     varying highp vec4 v_id;\r\n#endif // ID\r\n\r\n       void main()\r\n       {\r\n         // include the thin line parameters (thinLineHalfWidth and thinLineWidthFactor)\r\n         $thinLineParams\r\n\r\n         // for now assume that a thin line is a line which is under 2 pixels (1 pixels on either sides of the centerline)\r\n         mediump float thinLineFactor \x3d max(thinLineWidthFactor * step(v_lineHalfWidth, thinLineHalfWidth), 1.0);\r\n\r\n         // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n         // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n         // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n         mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\r\n\r\n         // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n         // when it is a thin line then use a slightly shallower slope in order to add more feathering\r\n         lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\r\n\r\n#if defined(SDF)\r\n         mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\r\n         mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\r\n         mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\r\n         mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\r\n\r\n          // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\r\n         mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\r\n\r\n         // calculate the distance from the edge [-0.5, 0.5]\r\n         mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\r\n\r\n         // the distance is a proportional to the line width\r\n         float dist \x3d d * lineHalfWidth;\r\n\r\n         lowp vec4 fillPixelColor \x3d v_transparency * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\r\n        gl_FragColor \x3d fillPixelColor;\r\n#elif defined(PATTERN)\r\n         // we need to calculate the relative portion of the line texture along the line given the accumulated distance along the line\r\n         // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\r\n         mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\r\n\r\n         // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\r\n         // which range from -1.0 to 1.0. On the line\'s centerline, the value of the interpolated normal is 0.0, however the relative\r\n         // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\r\n         // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\r\n         //              | -\x3e line-width / 2\r\n         //      - - - - - - - - - - - - - -\r\n         //              | -\x3e line-width / 2\r\n         //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\r\n\r\n         mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\r\n\r\n         // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\r\n         mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\r\n\r\n         // get the color from the texture\r\n         lowp vec4 color \x3d texture2D(u_texture, texCoord);\r\n\r\n         gl_FragColor \x3d v_transparency * alpha * v_color * color;\r\n#else // solid line (no texture, no pattern)\r\n         // output the fragment color\r\n         gl_FragColor \x3d v_transparency * alpha * v_color;\r\n#endif // SDF\r\n\r\n#ifdef HIGHLIGHT\r\n         gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\r\n#endif // HIGHLIGHT\r\n\r\n #ifdef ID\r\n         if (gl_FragColor.a \x3c 1.0 / 255.0) {\r\n           discard;\r\n         }\r\n         gl_FragColor \x3d v_id;\r\n #endif // ID\r\n       }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n\x3c/snippets\x3e\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/textShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Add your GLSL snippets to this file. You should start from\r\n  importing your old GLSL files. For instance, if you have a\r\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\r\n  and then copy and paste the GLSL source as the content. You will then convert your\r\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\r\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\r\n--\x3e\r\n\x3csnippets\x3e\r\n\r\n\x3csnippet name\x3d"textVVUniformsVS"\x3e\r\n    \x3c![CDATA[\r\n  #if defined(VV_COLOR) || defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE) || defined(VV_OPACITY) || defined(VV_ROTATION)\r\n    attribute vec4 a_vv;\r\n  #endif // VV_COLOR || VV_SIZE_MIN_MAX_VALUE || VV_SIZE_SCALE_STOPS || VV_SIZE_FIELD_STOPS || VV_SIZE_UNIT_VALUE || VV_OPACITY || VV_ROTATION\r\n\r\n  #ifdef VV_COLOR\r\n    uniform float u_vvColorValues[8];\r\n    uniform vec4 u_vvColors[8];\r\n  #endif // VV_COLOR\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    uniform vec4 u_vvSizeMinMaxValue;\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n    uniform float u_vvSizeScaleStopsValue;\r\n  #endif // VV_SIZE_SCALE_STOPS\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    uniform float u_vvSizeFieldStopsValues[6];\r\n    uniform float u_vvSizeFieldStopsSizes[6];\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    uniform float u_vvSizeUnitValueWorldToPixelsRatio;\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    uniform float u_vvOpacityValues[8];\r\n    uniform float u_vvOpacities[8];\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_ROTATION\r\n    uniform lowp float u_vvRotationType;\r\n  #endif // VV_ROTATION\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"textVVFunctions"\x3e\r\n    \x3c![CDATA[\r\n    bool isNan(float val) {\r\n      return !( val \x3c 0.0 || 0.0 \x3c val || val \x3d\x3d 0.0 );\r\n    }\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n    float getVVMinMaxSize(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      // we need to multiply by 8 in order to translate to tile coordinates\r\n      float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\r\n      return clamp(u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z), u_vvSizeMinMaxValue.z, u_vvSizeMinMaxValue.w);\r\n    }\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n    const int VV_SIZE_N \x3d 6;\r\n    float getVVStopsSize(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\r\n        return u_vvSizeFieldStopsSizes[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\r\n        if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\r\n          float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\r\n          return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\r\n    }\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n    float getVVUnitValue(float sizeValue, float fallback) {\r\n      if (isNan(sizeValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\r\n    }\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n  #ifdef VV_OPACITY\r\n    const int VV_OPACITY_N \x3d 8;\r\n    float getVVOpacity(float opacityValue) {\r\n      if (isNan(opacityValue)) {\r\n        return 1.0;\r\n      }\r\n\r\n      if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\r\n        return u_vvOpacities[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\r\n        if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\r\n          float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\r\n          return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvOpacities[VV_OPACITY_N - 1];\r\n    }\r\n  #endif // VV_OPACITY\r\n\r\n  #ifdef VV_ROTATION\r\n    mat4 getVVRotation(float rotationValue) {\r\n      // YF TODO: if the symbol has rotation we need to combine the symbo\'s rotation with the VV one\r\n      if (isNan(rotationValue)) {\r\n        return mat4(1, 0, 0, 0,\r\n                    0, 1, 0, 0,\r\n                    0, 0, 1, 0,\r\n                    0, 0, 0, 1);\r\n      }\r\n\r\n      float rotation \x3d rotationValue;\r\n      if (u_vvRotationType \x3d\x3d 1.0) {\r\n        rotation \x3d 90.0 - rotation;\r\n      }\r\n\r\n      float angle \x3d C_DEG_TO_RAD * rotation;\r\n\r\n      float sinA \x3d sin(angle);\r\n      float cosA \x3d cos(angle);\r\n\r\n      return mat4(cosA, sinA, 0, 0,\r\n                  -sinA,  cosA, 0, 0,\r\n                  0,     0, 1, 0,\r\n                  0,     0, 0, 1);\r\n    }\r\n  #endif // VV_ROTATION\r\n\r\n  #ifdef VV_COLOR\r\n    const int VV_COLOR_N \x3d 8;\r\n\r\n    vec4 getVVColor(float colorValue, vec4 fallback) {\r\n      if (isNan(colorValue)) {\r\n        return fallback;\r\n      }\r\n\r\n      if (colorValue \x3c\x3d u_vvColorValues[0]) {\r\n        return u_vvColors[0];\r\n      }\r\n\r\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\r\n        if (u_vvColorValues[i] \x3e\x3d colorValue) {\r\n          float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\r\n          return mix(u_vvColors[i-1], u_vvColors[i], f);\r\n        }\r\n      }\r\n\r\n      return u_vvColors[VV_COLOR_N - 1];\r\n    }\r\n  #endif // VV_COLOR\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"textVS"\x3e\r\n    \x3c![CDATA[\r\n      precision mediump float;\r\n\r\n      const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\r\n\r\n      attribute vec2 a_pos;           // 2 * 2 (2 x signed 16)\r\n      attribute vec4 a_id;            // 4 (4 x unsigned byte)\r\n      attribute vec4 a_color;         // 4 (4 x unsigned byte)\r\n      attribute vec2 a_vertexOffset; // 2 * 2 // (2 x signed 16) offset from the anchor point of the string\r\n      attribute vec4 a_texFontSize; // 4 (4 x unsigned byte) texture coordinatesm and font size\r\n\r\n      attribute lowp float  a_visible; // a one byte controlling the visibility of the vertex (a separate visibility buffer), values are 0 or 1 (visible)\r\n\r\n      // the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n      // relative to the tile\'s upper left corner\r\n      // the extrusion vector.\r\n      uniform highp mat4 u_transformMatrix;\r\n      // the extrude matrix which is responsible for the \'anti-zoom\' as well as the rotation\r\n      uniform highp mat4 u_extrudeMatrix;\r\n      // u_normalized_origin is the tile\'s upper left corner given in normalized coordinates\r\n      uniform highp vec2 u_normalized_origin;\r\n      // the size of the mosaic given in pixels\r\n      uniform vec2 u_mosaicSize;\r\n      uniform float u_pixelRatio;\r\n\r\n      // the opacity of the layer\r\n      uniform mediump float u_opacity;\r\n\r\n      varying mediump vec4 v_color;\r\n      varying mediump float v_antialiasingWidth;\r\n      varying mediump float v_edgeDistanceOffset;\r\n\r\n      // the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\n      varying mediump vec2 v_tex;\r\n      // the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n      // opacity of the layer given by the painter\r\n      varying lowp float v_transparency;\r\n\r\n      // the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n      // by 16 and then at the shader devide by the same number\r\n      const float offsetPrecision \x3d 1.0 / 8.0;\r\n      const float outlineScale \x3d 1.0 / 10.0;\r\n      const float sdfFontSize \x3d 24.0;\r\n\r\n      // maximum SDF distance of 8 pixels represent the distance values that range from -2 inside the geometry to 6 on the outside.\r\n      // 6 is actually the maximum distance outside the glyph, therefore it is the limitation of the halo which is 1/4 of the geometry size.\r\n      const float maxSdfDistance \x3d 8.0;\r\n\r\n  #ifdef ID\r\n    varying highp vec4 v_id;\r\n  #endif // ID\r\n\r\n      // import the VV inputs and functions (they are #ifdefed, so if the proper #define is not set it will end-up being a no-op)\r\n      $textVVUniformsVS\r\n      $textVVFunctions\r\n\r\n      void main()\r\n      {\r\n        // make sure to clip the vertices in case that given record is marked as invisible\r\n        float z \x3d 2.0 * (1.0 - a_visible);\r\n\r\n        // we use the list significant bit of the position in order to store the indication whethe the vertex is of a halow of a glyph\r\n        mediump float halo \x3d mod(a_pos, 2.0).x;\r\n\r\n  #if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n  #ifdef VV_SIZE_MIN_MAX_VALUE\r\n        // vv size override the original symbol\'s size\r\n        vec2 size \x3d vec2(getVVMinMaxSize(a_vv.x, a_texFontSize.z));\r\n  #endif // VV_SIZE_MIN_MAX_VALUE\r\n\r\n  #ifdef VV_SIZE_SCALE_STOPS\r\n        vec2 size \x3d vec2(u_vvSizeScaleStopsValue);\r\n  #endif // VV_SIZE_SCALE_STOPS\r\n\r\n  #ifdef VV_SIZE_FIELD_STOPS\r\n        vec2 size \x3d vec2(getVVStopsSize(a_vv.x, a_texFontSize.z));\r\n  #endif // VV_SIZE_FIELD_STOPS\r\n\r\n  #ifdef VV_SIZE_UNIT_VALUE\r\n        vec2 size \x3d vec2(getVVUnitValue(a_vv.x, a_texFontSize.z));\r\n  #endif // VV_SIZE_UNIT_VALUE\r\n\r\n        float fontSize \x3d size.x;\r\n  #else // this generic case, no VV\r\n        float fontSize \x3d a_texFontSize.z;\r\n  #endif // defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\r\n\r\n        float fontScale \x3d fontSize / sdfFontSize;\r\n        // we need to scale the extrude matrix by the font-scale in order to get the right text size\r\n        mat4 extrudeMatrix \x3d fontScale * u_extrudeMatrix;\r\n\r\n        // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n        //gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\r\n\r\n    #ifdef VV_ROTATION\r\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * getVVRotation(a_vv.w) * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\r\n    #else\r\n        gl_Position \x3d vec4(u_normalized_origin, 0.0, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), z, 1.0) + extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, 0.0, 0.0);\r\n    #endif // VV_ROTATION\r\n\r\n        v_tex \x3d a_texFontSize.xy / u_mosaicSize;\r\n        v_antialiasingWidth \x3d 0.105 * sdfFontSize / fontSize / u_pixelRatio;\r\n        // if halo.x is zero (not a halo) v_edgeDistanceOffset will end up being zero as well.\r\n        v_edgeDistanceOffset \x3d halo * outlineScale * a_texFontSize.w / fontScale / maxSdfDistance;\r\n\r\n    #ifdef VV_OPACITY\r\n        v_transparency \x3d getVVOpacity(a_vv.z);\r\n    #else\r\n        v_transparency \x3d u_opacity;\r\n    #endif // VV_OPACITY\r\n\r\n    #ifdef VV_COLOR\r\n       // we don\'t want to override the halo color\r\n       v_color \x3d halo * a_color + (1.0 - halo) * getVVColor(a_vv.y, a_color);\r\n    #else\r\n        v_color \x3d a_color;\r\n    #endif // VV_COLOR\r\n\r\n  #ifdef ID\r\n        v_id \x3d a_id;\r\n  #endif // ID\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3csnippet name\x3d"textFS"\x3e\r\n    \x3c![CDATA[\r\n      precision lowp float;\r\n\r\n      uniform lowp sampler2D u_texture;\r\n\r\n      varying mediump vec4 v_color;\r\n      varying mediump float v_antialiasingWidth;\r\n      varying mediump float v_edgeDistanceOffset;\r\n      varying mediump vec2 v_tex;\r\n      varying lowp float v_transparency;\r\n\r\n  #ifdef ID\r\n      varying highp vec4 v_id;\r\n  #endif // ID\r\n\r\n      void main()\r\n      {\r\n        // read the distance from the SDF texture\r\n        lowp float dist \x3d texture2D(u_texture, v_tex).a;\r\n\r\n        // the edge distance if a factor of the outline width\r\n        float glyphEdgeDistance \x3d 0.75 - v_edgeDistanceOffset;\r\n\r\n        // use a smooth-step in order to calculate the geometry of the shape given by the distance field\r\n        lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_transparency;\r\n\r\n        gl_FragColor \x3d alpha * v_color;\r\n\r\n  #ifdef ID\r\n        if (gl_FragColor.a \x3c 1.0 / 255.0) {\r\n          discard;\r\n        }\r\n        gl_FragColor \x3d v_id;\r\n  #endif // ID\r\n      }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/shaders/hlShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\r\n\x3c!--\r\n  Highlight generation and rendering shaders.\r\n\r\n  These shader sources are loaded by hlShaderSnippets.ts which in turn\r\n  is used by HighlightRenderer to instantiate the programs needed for\r\n  generating and rendering the highlights.\r\n\r\n  These shaders are intended to be used with full screen quads.\r\n--\x3e\r\n\x3csnippets\x3e\r\n  \x3c!--\r\n    Vertex shader: texturedVS\r\n\r\n    Identity vertex shader that outputs an untransformed 2-D vertex\r\n    and passes its texture coordinates unchanged to the interpolator.\r\n  --\x3e\r\n  \x3csnippet name\x3d"texturedVS"\x3e\r\n    \x3c![CDATA[\r\n    // Vertex position.\r\n    attribute mediump vec2 a_position;\r\n\r\n    // Texture coordinates.\r\n    attribute mediump vec2 a_texcoord;\r\n\r\n    // Texture coordinates to be interpolated.\r\n    varying mediump vec2 v_texcoord;\r\n\r\n    void main(void) {\r\n      // Pass the position unchanged.\r\n      gl_Position \x3d vec4(a_position, 0.0, 1.0);\r\n\r\n      // Pass the texture coordinates unchanged.\r\n      v_texcoord \x3d a_texcoord;\r\n    }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3c!--\r\n    Fragment shader: blurFS\r\n\r\n    A gaussian blur shader. It blurs the alpha channel of its input\r\n    according to 4 different sigma and stores the results into the\r\n    four channel of the target framebuffer.\r\n\r\n    It is intended to be called twice; the first time to perform an\r\n    horizontal blur, and a second time to perform a vertical blur.\r\n\r\n    This shader is used to turn the highlight mask into a highlight\r\n    map. The highlight map is an approximation of the signed distance\r\n    field of the mask.\r\n  --\x3e\r\n  \x3csnippet name\x3d"blurFS"\x3e\r\n    \x3c![CDATA[\r\n    // Interpolated texture coordinates.\r\n    varying mediump vec2 v_texcoord;\r\n\r\n    // Blur direction information. There are two possible\r\n    // configurations that the host code can use.\r\n    //  - [1, 0, 1/WIDTH, 0] Used when blurring horizontally. In this\r\n    //    case u_direction[0] \x3d 1 is expressed in pixel and is fed to\r\n    //    the gauss function to produce the value of the gaussian weight\r\n    //    for that pixel, while u_direction[2] \x3d 1/WIDTH is in texel units\r\n    //    and is used to sample the right texel from the texture map.\r\n    //  - [0, 1, 0, 1/HEIGHT] Used when blurring vertically. In this\r\n    //    case u_direction[1] \x3d 1 is expressed in pixel and is fed to\r\n    //    the gauss function to produce the value of the gaussian weight\r\n    //    for that pixel, while u_direction[3] \x3d 1/HEIGHT is in texel units\r\n    //    and is used to sample the right texel from the texture map.\r\n    uniform mediump vec4 u_direction;\r\n\r\n    // Source to destination channel selection matrix.\r\n    uniform mediump mat4 u_channelSelector;\r\n\r\n    // The highlight map is obtained by blurring the alpha channel of the highlight\r\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\r\n    uniform mediump vec4 u_sigmas;\r\n\r\n    // This is the highlight mask if we have not blurred horizontally yet, otherwise\r\n    // it is the horizontally blurred highlight map and blurring it one more time\r\n    // vertically will complete the process.\r\n    uniform sampler2D u_texture;\r\n\r\n    // The gaussian kernel. Note that it lacks the normalization constant, because\r\n    // we want to store it unnormalized in the highlight map (i.e. having a peak\r\n    // value of 1). Note also that we are using the SIMD (single instruction, multiple\r\n    // data) capabilities of the GPU to compute four different gaussian kernels, one\r\n    // for each sigma.\r\n    mediump vec4 gauss(mediump vec2 dir) {\r\n      return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\r\n    }\r\n\r\n    mediump vec4 selectChannel(mediump vec4 sample) {\r\n      return u_channelSelector * sample;\r\n    }\r\n\r\n    // Sample the input texture and accumulated its gaussian weighted value and the\r\n    // total weight.\r\n    void accumGauss(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\r\n      // Computes the gaussian weights, one for each sigma.\r\n      // Note that u_direction.xy is [1, 0] when blurring horizontally and [0, 1] when blurring vertically.\r\n      mediump vec4 w \x3d gauss(i * u_direction.xy);\r\n\r\n      // Accumumates the values.\r\n      // Note that u_direction.xy is [1/WIDTH, 0] when blurring horizontally and [0, 1/HEIGHT] when blurring vertically.\r\n      tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\r\n\r\n      // Accumulates the weights.\r\n      weight +\x3d w;\r\n    }\r\n\r\n    void main(void) {\r\n      // Initialize accumulated values and weights to zero.\r\n      mediump vec4 tot \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n      mediump vec4 weight \x3d vec4(0.0, 0.0, 0.0, 0.0);\r\n\r\n      // Accumulates enough samples. These will be taken\r\n      // horizontally or vertically depending on the value\r\n      // of u_direction.\r\n      accumGauss(-5.0, tot, weight);\r\n      accumGauss(-4.0, tot, weight);\r\n      accumGauss(-3.0, tot, weight);\r\n      accumGauss(-2.0, tot, weight);\r\n      accumGauss(-1.0, tot, weight);\r\n      accumGauss(0.0, tot, weight);\r\n      accumGauss(1.0, tot, weight);\r\n      accumGauss(2.0, tot, weight);\r\n      accumGauss(3.0, tot, weight);\r\n      accumGauss(4.0, tot, weight);\r\n      accumGauss(5.0, tot, weight);\r\n\r\n      // Compute blurred values.\r\n      mediump vec4 rgba \x3d tot / weight;\r\n\r\n      // Return the values. Note that each channel will contain\r\n      // the result of a different blur operation, one for each\r\n      // of the four chosen sigma.\r\n      gl_FragColor \x3d vec4(rgba);\r\n    }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\r\n  \x3c!--\r\n    Fragment shader: highlightFS\r\n\r\n    Takes as input the highlight map, estimated the signed distance field,\r\n    and shades the fragments according to their estimated distance from the\r\n    edge of the highlighted feature.\r\n\r\n    A shade texture is used to turn distance values into colors; the shade\r\n    texture is basically a color gradient and is recomputed on the host\r\n    every time that the user alters the highlight options.\r\n  --\x3e\r\n  \x3csnippet name\x3d"highlightFS"\x3e\r\n    \x3c![CDATA[\r\n    // Interpolated texture coordinates.\r\n    varying mediump vec2 v_texcoord;\r\n\r\n    // The highlight map. Each channel is a blurred\r\n    // version of the alpha channel of the highlight mask.\r\n    //  - Channel 0 (red) corresponds to a gaussian blur with sigma \x3d u_sigmas[0];\r\n    //  - Channel 1 (green) corresponds to a gaussian blur with sigma \x3d u_sigmas[1];\r\n    //  - Channel 2 (blue) corresponds to a gaussian blur with sigma \x3d u_sigmas[2];\r\n    //  - Channel 3 (alpha) corresponds to a gaussian blur with sigma \x3d u_sigmas[3];\r\n    // As of today, only channel 3 is used for distance estimation.\r\n    // But the availability of different amounts of blur leaves the\r\n    // door open to multi-scale approaches.\r\n    uniform sampler2D u_texture;\r\n\r\n    // The highlight map was obtained by blurring the alpha channel of the highlight\r\n    // mask accroding to these 4 values of the gaussian\'s sigma parameter.\r\n    uniform mediump vec4 u_sigmas;\r\n\r\n    // A 1-D texture used to shade the highlight.\r\n    uniform sampler2D u_shade;\r\n\r\n    // The 1-D shade texture is spreaded between u_minMaxDistance[0] and u_minMaxDistance[1].\r\n    uniform mediump vec2 u_minMaxDistance;\r\n\r\n    // Signed distance estimation.\r\n    mediump float estimateDistance() {\r\n      // Use the largest sigma and the corresponding distance value stored in the\r\n      // last channel of the highlight map.\r\n      mediump float sigma \x3d u_sigmas[3];\r\n      mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\r\n\r\n      // Estimates the distance by linearization and local inversion around\r\n      // the inflection point. The inflection point is in x \x3d 0.\r\n      const mediump float y0 \x3d 0.5;                           // Value of the convolution at the inflection point.\r\n      mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);  // Slope of the convolution at the inflection point.\r\n      mediump float d \x3d (y - y0) / m0;                        // Inversion of a local linearization.\r\n\r\n      // Return the estimated distance.\r\n      return d;\r\n    }\r\n\r\n    // Shading based on estimated distance.\r\n    mediump vec4 shade(mediump float d) {\r\n      // Maps the sampled distance from the [A, D] range (see HighlightRenderer::setHighlightOptions) to [0, 1].\r\n      mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\r\n\r\n      // Force to [0, 1]; it should not be necessary because the shade texture uses the CLAMP address mode, so\r\n      // this should happen anyway internally to the sampler, but in practice it is needed to avoid weird\r\n      // banding artifacts.\r\n      // We don\'t really know if we need this or not.\r\n      mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\r\n\r\n      // Sample the 1-D shade texture on its center line (i.e. on t\x3d0.5).\r\n      return texture2D(u_shade, vec2(mappedDistance, 0.5));\r\n    }\r\n\r\n    void main(void) {\r\n      // Estimate the distance.\r\n      mediump float d \x3d estimateDistance();\r\n\r\n      // Shade the distance.\r\n      gl_FragColor \x3d shade(d);\r\n    }\r\n    ]]\x3e\r\n  \x3c/snippet\x3e\r\n\x3c/snippets\x3e\r\n',
"*now":function(k){k(['dojo/i18n!*preload*esri/layers/support/nls/webglDeps*["ar","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});define("esri/layers/support/webglDeps",["./WebGLRenderer","../OnDemandDrillMode"],function(k,b){return{WebGLRenderer:k,OnDemandDrillMode:b}});