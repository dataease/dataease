// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/round/_RoundChartSeriesCalculator","../../ThemeCalculator ../../ChartTypes ../../ChartSorting ../../ChartLineStyles ../../../../supportClasses/conditionalStyling/ConditionalStyleUtil ../../../../sections/dynamicSettings/supportClasses/FilterUtil ../utils/ChartDataUtil ../utils/TooltipInfoBuilder esri/dijit/geoenrichment/utils/ColorUtil".split(" "),function(A,r,t,x,y,B,u,C,z){var D={calcLineStyle:function(a,f){return{color:z.getColorWithAlpha(f.outlineColor||
a,f.outlineOpacity),width:f.outlineThickness||0,style:x.toGFXValue(f.outlineStyle||x.SOLID)}}};return{calcSeries:function(a){var f=a.seriesItems,h=a.chartType,k=a.themeSettings,l=a.visualProperties,m=a.sorting;if(!f.length)return[];var n=f[0],p=[],q={name:"data",data:[]};p.push(q);if(!n.points.length)return p;var b=this._calcStats(a);n.points.forEach(function(a,d){if(!a.hidden){var e=b.values[d],g=e.value,m=g||0,c;r.isConditionalStylingSupported(h)&&l.conditionalStyling&&(c=(c=y.getConditionalStyle(e.isBenchmarked?
e.ownValue:m,l.conditionalStyling))&&c.backgroundColor);c=c||A.calcColorForPoint({point:a,seriesItem:n,pointIndex:d,seriesIndex:0,numSeries:f.length,chartType:h,themeSettings:k});var w=D.calcLineStyle(c,l);c=1>l.fillOpacity?z.getColorWithAlpha(c,l.fillOpacity):c;d={originalValue:g,x:1,y:r.supportsNegativeValues(h)?m:Math.max(1E-4,m),isUnavailableData:isNaN(g),valueProp:"y",unsortedIndex:d,name:a.label,point:a,fill:c,valuesSumsInSeries:b.absValuesSum,seriesIndex:0,stroke:{color:w.color,width:w.width,
style:w.style},isBenchmarked:e.isBenchmarked,unbenchmarkedValue:e.ownValue,unbenchmarkedValuesSumsInSeries:b.unbenchmarkedAbsValuesSum};a=C.getTooltipInfo({yValue:g,pointLabel:a.label,seriesLabel:null,minInSeriesValue:b.minValue,maxInSeriesValue:b.maxValue,sumInSeriesValue:b.valuesSum,absSumInSeriesValue:b.absValuesSum,avgInSeriesValue:b.avgValue,visualProperties:l,chartType:h,conditionalStyling:l.conditionalStyling,fieldInfo:a.fieldInfo,decimals:a.value&&a.value.decimals,fill:d.fill,stroke:0<d.stroke.width?
d.stroke.color:void 0,isBenchmarked:e.isBenchmarked,unbenchmarkedValue:e.ownValue});d.tooltip=a;q.data.push(d)}});r.isSortingSupported(h)&&m&&m!==t.NONE&&q.data.sort(function(a,d){return(a.y-d.y)*(m===t.DESC?-1:1)});return p},_calcStats:function(a){var f=a.chartType,h=a.viewModel,k=a.visualProperties,l=a.currentFeatureIndex,m=[],n=0,p=0,q=0,b=1E6,v=-1E6;a=a.seriesItems[0].points;var d,e=k.filter&&k.filter.ranges&&B.getRangeStatistics(k.filter.ranges),g=r.isConditionalStylingSupported(f)&&k.conditionalStyling&&
y.getStatistics(k.conditionalStyling);if(e||g)d=u.getChartData({filterRangesStats:e,conditionalStats:g,numPoints:a.length,visualProperties:k});var t=0;a.forEach(function(a,e){var c=function(){if(a.hidden)return{value:void 0};var c=u.getPointValue({point:a,index:e,seriesIndex:0,maxValue:!1,chartType:f,visualProperties:k,viewModel:h,currentFeatureIndex:l,chartData:d}),b=h.getBenchmarkController&&h.getBenchmarkController();return r.isBenchmarkSupported(f)&&b&&0<=b.getAreaIndex()&&b.getAreaIndex()!==
l?(b=u.getPointValue({point:a,index:e,seriesIndex:0,maxValue:!1,chartType:f,visualProperties:k,viewModel:h,currentFeatureIndex:b.getAreaIndex(),chartData:d}),{value:c-b,isBenchmarked:!0,ownValue:c}):{value:c}}();m[e]=c;var g=c.value||0;a.hidden||(t++,n+=g,p+=Math.abs(g),q+=Math.abs(c.ownValue||0),b=Math.min(b,g),v=Math.max(v,g))});return{values:m,valuesSum:n,absValuesSum:p,unbenchmarkedAbsValuesSum:q,minValue:b,maxValue:v,avgValue:n/t}}}});