// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/templates/SingleFilter.html":'\x3cdiv class\x3d"esriSingleFilterForm singleFilter" id\x3d"${id}.singleFilter"\x3e\r\n  \x3cdiv\x3e\r\n    \x3ctable id\x3d"${id}.exprTable" class\x3d"rowTable" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column1"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column2"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column3"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column4"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column5"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column6"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column7"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3ca id\x3d"${id}.deleteExpression" href\x3d"JavaScript:void(0);" style\x3d"margin:0 5px;display:none;" class\x3d"esriAGOFilterRemoveIcon" title\x3d"${i18n.deleteExpression}"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_interactiveFilterRow"\x3e\r\n          \x3ctd colspan\x3d"8"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"interactiveFilter"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3cinput dojoAttachPoint\x3d"interactiveCheck" type\x3d"checkbox" class\x3d"promptCheckBox" title\x3d"${i18n.promptMsg}"/\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3clabel class\x3d"labels" for\x3d"promptCheckBox"\x3e\r\n                              \x26nbsp;\x26nbsp;${i18n.askForValues}\r\n                            \x3c/label\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cspan dojoAttachPoint\x3d"interactiveArrow" style\x3d"color:#cbcbcb;cursor:pointer;" class\x3d"showHidePromptDiv"\x3e\x26nbsp;\x26#9660;\x3c/span\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr dojoAttachPoint\x3d"interactiveSpace" style\x3d"display:none"\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.prompt}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"promptText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.hint}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"hintText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"promptDiv" style\x3d"display:none;padding:10px 0px;"\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtPrompt"\x3e\r\n      ${i18n.prompt}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtPrompt" type\x3d"text"/\x3e\r\n    \x3cbr/\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtHint"\x3e\r\n      ${i18n.hint}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtHint" type\x3d"text" /\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("esri/dijit/SingleFilter","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/has dojo/json dojo/string dojo/number dojo/dom dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/_base/event dojo/Evented dojo/data/ItemFileWriteStore dojo/date/locale dojo/parser dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/TextBox dijit/form/FilteringSelect dijit/form/RadioButton dijit/form/DateTextBox dijit/form/NumberTextBox ../kernel ../lang ../tasks/GenerateRendererTask ../tasks/UniqueValueDefinition ../tasks/GenerateRendererParameters ../layers/FeatureLayer ../layers/GeoRSSLayer ./analysis/ItemTypes dojo/i18n!../nls/jsapi dojo/text!./templates/SingleFilter.html".split(" "),
function(z,D,l,p,h,U,E,V,F,v,k,q,W,m,A,X,Y,G,u,t,H,I,J,K,L,M,e,N,w,Z,B,C,x,r,y,O,P,Q,R,aa,S,T){z=D([I,J,K,L,M,G],{declaredClass:"esri.dijit.SingleFilter",widgetsInTemplate:!0,templateString:T,valueHandlers:[],onFieldChangeEnabled:!0,onOperatorChangeEnabled:!0,onPromptChangeHandler:null,onHintChangeHandler:null,fieldDomains:{},fieldsStore:null,fieldsInfo:{stringFieldsCount:0,numberFieldsCount:0,dateFieldsCount:0},stringOperatorStore:null,dateOperatorStore:null,numberOperatorStore:null,uniqueValuesStore:null,
isEnableInteractiveFilter:!0,uniqueValuesResults:{},partsObj:null,dayInMS:86399E3,allowAllDateTypes:!1,showUnique:!0,postMixInProperties:function(){this.inherited(arguments);this.i18n={};this.i18n=l.mixin(this.i18n,S.filterDlg)},parseExpressionTemplate:function(){var a=function(a,f){k.byId(f).className="attributeValueContainer";"field_dropdown"===a?k.byId(f).innerHTML=b:"operator_dropdown"===a?k.byId(f).innerHTML=c:"values_input"===a?k.byId(f).innerHTML=d+g:console.error("problem with expressionTemplate from localization file")},
b='\x3cselect id\x3d"'+this.id+'.fieldsList" class\x3d"attributeField" data-dojo-type\x3d"dijit/form/FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"true"\x3e\x3c/select\x3e',c='\x3cselect id\x3d"'+this.id+'.operatorList" class\x3d"operator" data-dojo-type\x3d"dijit/form/FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\x3c/select\x3e',d='\x3cdiv id\x3d"'+this.id+'.attributeValueContainer"\x3e\x3c/div\x3e',g='\x3cdiv class\x3d"attributeValueOptions"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e  \x3ctbody\x3e    \x3ctr\x3e      \x3ctd nowrap\x3d"nowrap"\x3e        \x3cinput id\x3d"'+
this.id+'.radioValue" class\x3d"radioValue attributeValueRadio" checked\x3d"checked" name\x3d"'+this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+this.i18n.valueTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.valueTooltip+'"\x3e'+this.i18n.value+'        \x3c/label\x3e      \x3c/td\x3e      \x3ctd nowrap\x3d"nowrap" class\x3d"esriLeadingPadding05"\x3e        \x3cinput id\x3d"'+this.id+'.radioFields" class\x3d"radioFields attributeValueRadio" name\x3d"'+
this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+this.i18n.fieldTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.fieldTooltip+'"\x3e'+this.i18n.field+'        \x3c/label\x3e      \x3c/td\x3e      \x3ctd id\x3d"'+this.id+'.radioUniqueColumn" nowrap\x3d"nowrap" class\x3d"esriLeadingPadding05"\x3e        \x3cinput id\x3d"'+this.id+'.radioUnique" class\x3d"radioUnique attributeValueRadio" name\x3d"'+this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+
this.i18n.uniqueValueTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.uniqueValueTooltip+'"\x3e'+this.i18n.uniqueValues+"        \x3c/label\x3e      \x3c/td\x3e    \x3c/tr\x3e  \x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",e=this.i18n.expressionTemplate,f=e.indexOf("${"),n=e.substring(0,f).trim();k.byId(this.id+".column1").innerHTML=n.length?"\x3cdiv class\x3d'attributeText'\x3e"+n+"\x3c/div\x3e":"";var n=e.indexOf("}",f+1),h=e.substring(f+2,n);a(h,this.id+".column2");f=e.indexOf("${",
f+1);n=e.substring(n+1,f).trim();k.byId(this.id+".column3").innerHTML=n.length?"\x3cdiv class\x3d'attributeText'\x3e"+n+"\x3c/div\x3e":"";n=e.indexOf("}",f+1);h=e.substring(f+2,n);a(h,this.id+".column4");f=e.indexOf("${",f+1);n=e.substring(n+1,f).trim();k.byId(this.id+".column5").innerHTML=n.length?"\x3cdiv class\x3d'attributeText'\x3e"+n+"\x3c/div\x3e":"";n=e.indexOf("}",f+1);h=e.substring(f+2,n);a(h,this.id+".column6");n=e.substring(n+1,e.length).trim();k.byId(this.id+".column7").innerHTML=n.length?
"\x3cdiv class\x3d'attributeText'\x3e"+n+"\x3c/div\x3e":""},postCreate:function(){this.inherited(arguments);this.parseExpressionTemplate();this.createOperatorStores();this.createFieldsStore(this.fields);this.readCodedValues();H.parse(k.byId(this.id+".exprTable")).then(l.hitch(this,function(a){h.connect(this.getFieldsList(),"onChange",this,"onChangeField");h.connect(this.getOperatorList(),"onChange",this,"onChangeOperator");h.connect(e.byId(this.id+".radioValue"),"onClick",this,"showValueInput");h.connect(e.byId(this.id+
".radioFields"),"onClick",this,"showFields");h.connect(e.byId(this.id+".radioUnique"),"onClick",this,"showUniqueList");this.version&&10.1>this.version&&this.mapLayer.url&&this.showUnique&&q.set(k.byId(this.id+".radioUniqueColumn"),"display","none");h.connect(k.byId(this.id+".deleteExpression"),"onclick",this,"onClickDeleteExpression");h.connect(this.interactiveCheck,"onclick",this,"onInteractiveClick");h.connect(this.interactiveArrow,"onclick",this,"onClickShowHideInteractive");this.enableInteractiveHandlers();
this.isEnableInteractiveFilter||q.set(this._interactiveFilterRow,"display","none");q.set(k.byId(this.id+".radioUniqueColumn"),"display",this.showUnique?"block":"none");this.own(this.watch("showUnique",l.hitch(this,function(a,c,d){q.set(k.byId(this.id+".radioUniqueColumn"),"display",d?"block":"none")})))}))},constructor:function(a,b){this.id=a.id||"";this.owner=a.owner;this.version=a.version;this.part=a.part;this.fields=a.fields;this.mapLayer=a.mapLayer;!1===a.enableEvents&&(this.onOperatorChangeEnabled=
this.onFieldChangeEnabled=!1)},init:function(a){if(!a.part||this.mapLayer&&a.mapLayer&&this.mapLayer.id!==a.mapLayer.id)this.clearAttributeValueDijits(),this.mapLayer=a.mapLayer,this.version=a.version,this.fields=a.fields,this.createOperatorStores(),this.createFieldsStore(this.fields),this.readCodedValues(),this.fillFieldsList(this.fieldsStore),this.onChangeField();a.part&&(this.part=a.part,this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!1,this.buildEditUIField(this.part,this))},destroy:function(){this.onOperatorChangeEnabled=
this.onFieldChangeEnabled=!1;this.clearAttributeValueDijits();p.forEach(e.findWidgets(k.byId(this.id)),function(a){a.destroyRecursive()});this.inherited(arguments)},toJson:function(){var a=null;this.isInteractiveChecked()&&(a={prompt:this.promptText.attr("value"),hint:this.hintText.attr("value")});return{fieldObj:this.getField(),operator:this.getOperator(),valueObj:this.getValue(),interactiveObj:a}},buildFriendlyTextExpr:function(a){var b=this.i18n.expressionTemplate,c=function(a,c,d){return F.substitute(b,
{field_dropdown:a,operator_dropdown:c,values_input:d})};if(!1===a.valueObj.isValid)return"\x26lt;expression is missing value\x26gt;";var d="";if("string"===a.fieldObj.shortType)a.operator===this.i18n.stringOperatorIsBlank||a.operator===this.i18n.stringOperatorIsNotBlank?d=c(a.fieldObj.label,a.operator,""):"field"===a.valueObj.type?d=c(a.fieldObj.label,a.operator,a.valueObj.label):(d=this.getDecodedValue(a.interactiveObj?a.interactiveObj.value:a.valueObj.value,a.fieldObj.name),d=c(a.fieldObj.label,
a.operator,"'"+d+"'"));else if("number"===a.fieldObj.shortType)if(a.operator===this.i18n.numberOperatorIsBetween||a.operator===this.i18n.numberOperatorIsNotBetween)d=a.interactiveObj?a.interactiveObj.value2:a.valueObj.value2,d=c(a.fieldObj.label,a.operator,v.format(a.interactiveObj?a.interactiveObj.value1:a.valueObj.value1,{pattern:"#####0.##########"})+" "+this.i18n.andBetweenValues+" "+v.format(d,{pattern:"#####0.##########"}));else if(a.operator===this.i18n.numberOperatorIsBlank||a.operator===
this.i18n.numberOperatorIsNotBlank)d=c(a.fieldObj.label,a.operator,"");else if("field"===a.valueObj.type)d=c(a.fieldObj.label,a.operator,a.valueObj.label);else var d=a.interactiveObj?a.interactiveObj.value:a.valueObj.value,g=this.getDecodedValue(d,a.fieldObj.name),d=c(a.fieldObj.label,a.operator,d!==g?"'"+g+"'":v.format(d,{pattern:"#####0.##########"}));else r.isDefined(a.valueObj.value)&&"field"!==a.valueObj.type&&"string"===typeof a.valueObj.value&&(a.valueObj.value=new Date(a.valueObj.value)),
d=a.operator===this.i18n.dateOperatorIsBetween||a.operator===this.i18n.dateOperatorIsNotBetween?c(a.fieldObj.label,a.operator,(a.interactiveObj?this.formatFriendlyDate(a.interactiveObj.value1):this.formatFriendlyDate(a.valueObj.value1))+" "+this.i18n.andBetweenValues+" "+(a.interactiveObj?this.formatFriendlyDate(a.interactiveObj.value2):this.formatFriendlyDate(this.addDay(a.valueObj.value2)))):a.operator===this.i18n.dateOperatorIsBlank||a.operator===this.i18n.dateOperatorIsNotBlank?c(a.fieldObj.label,
a.operator,""):"field"===a.valueObj.type?c(a.fieldObj.label,a.operator,a.valueObj.label):c(a.fieldObj.label,a.operator,a.interactiveObj?this.formatFriendlyDate(a.interactiveObj.value):this.formatFriendlyDate(a.valueObj.value));return d},builtSingleFilterString:function(a,b){if(r.isDefined(a.valueObj.isValid)&&!a.valueObj.isValid)return{whereClause:null};var c=a.valueObj.value,d=a.valueObj.value1,g=a.valueObj.value2,e=!1;if(a.interactiveObj){if(!a.interactiveObj.prompt||!a.interactiveObj.hint)return{whereClause:null};
r.isDefined(b)&&(e=!0,r.isDefined(a.valueObj.value)&&(c="{"+b+"}"),r.isDefined(a.valueObj.value1)&&(d="{"+b+"}"),r.isDefined(a.valueObj.value2)&&(g="{"+(b+1)+"}"))}var f="";if("string"===a.fieldObj.shortType)switch(b="",c&&"field"!==a.valueObj.type&&this.isHostedService(this.mapLayer.url)&&this.containsNonLatinCharacter(c)&&(b="N"),a.operator){case this.i18n.stringOperatorIs:f="field"===a.valueObj.type?a.fieldObj.name+" \x3d "+c:a.fieldObj.name+" \x3d "+b+"'"+c.replace(/\'/g,"''")+"'";break;case this.i18n.stringOperatorIsNot:f=
"field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3e "+c:a.fieldObj.name+" \x3c\x3e "+b+"'"+c.replace(/\'/g,"''")+"'";break;case this.i18n.stringOperatorStartsWith:f=a.fieldObj.name+" LIKE "+b+"'"+c.replace(/\'/g,"''")+"%'";break;case this.i18n.stringOperatorEndsWith:f=a.fieldObj.name+" LIKE "+b+"'%"+c.replace(/\'/g,"''")+"'";break;case this.i18n.stringOperatorContains:f=a.fieldObj.name+" LIKE "+b+"'%"+c.replace(/\'/g,"''")+"%'";break;case this.i18n.stringOperatorDoesNotContain:f=a.fieldObj.name+
" NOT LIKE "+b+"'%"+c.replace(/\'/g,"''")+"%'";break;case this.i18n.stringOperatorIsBlank:f=a.fieldObj.name+" IS NULL";break;case this.i18n.stringOperatorIsNotBlank:f=a.fieldObj.name+" IS NOT NULL"}else if("number"===a.fieldObj.shortType)switch(a.operator){case this.i18n.numberOperatorIs:f=a.fieldObj.name+" \x3d "+c;break;case this.i18n.numberOperatorIsNot:f=a.fieldObj.name+" \x3c\x3e "+c;break;case this.i18n.numberOperatorIsAtLeast:f=a.fieldObj.name+" \x3e\x3d "+c;break;case this.i18n.numberOperatorIsLessThan:f=
a.fieldObj.name+" \x3c "+c;break;case this.i18n.numberOperatorIsAtMost:f=a.fieldObj.name+" \x3c\x3d "+c;break;case this.i18n.numberOperatorIsGreaterThan:f=a.fieldObj.name+" \x3e "+c;break;case this.i18n.numberOperatorIsBetween:f=a.fieldObj.name+" BETWEEN "+d+" AND "+g;break;case this.i18n.numberOperatorIsNotBetween:f=a.fieldObj.name+" NOT BETWEEN "+d+" AND "+g;break;case this.i18n.numberOperatorIsBlank:f=a.fieldObj.name+" IS NULL";break;case this.i18n.numberOperatorIsNotBlank:f=a.fieldObj.name+" IS NOT NULL"}else switch(r.isDefined(c)&&
"field"!==a.valueObj.type&&"string"===typeof c&&(c=this.parseFriendlyDate(c)),a.operator){case this.i18n.dateOperatorIsOn:f="field"===a.valueObj.type?a.fieldObj.name+" \x3d "+c:e?a.fieldObj.name+" BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+b+"}' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+(b+1)+"}'":a.fieldObj.name+" BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(c)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(c))+
"'";break;case this.i18n.dateOperatorIsNotOn:f="field"===a.valueObj.type?a.fieldObj.name+" \x3c\x3e "+c:e?a.fieldObj.name+" NOT BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+b+"}' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+(b+1)+"}'":a.fieldObj.name+" NOT BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(c)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.i18n.dateOperatorIsBefore:f=
"field"===a.valueObj.type?a.fieldObj.name+" \x3c "+c:a.fieldObj.name+" \x3c "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(c)+"'";break;case this.i18n.dateOperatorIsAfter:f="field"===a.valueObj.type?a.fieldObj.name+" \x3e "+c:a.fieldObj.name+" \x3e "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.i18n.dateOperatorIsBetween:f=e?a.fieldObj.name+" BETWEEN '"+d+"' AND '"+g+"'":a.fieldObj.name+" BETWEEN "+(this.supportsStandardizedQuery?
"timestamp ":"")+"'"+this.formatDate(d)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(g))+"'";break;case this.i18n.dateOperatorIsNotBetween:f=e?a.fieldObj.name+" NOT BETWEEN '"+d+"' AND '"+g+"'":a.fieldObj.name+" NOT BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(d)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(g))+"'";break;case this.i18n.dateOperatorIsBlank:f=a.fieldObj.name+" IS NULL";
break;case this.i18n.dateOperatorIsNotBlank:f=a.fieldObj.name+" IS NOT NULL"}return{whereClause:f}},showDeleteIcon:function(){q.set(k.byId(this.id+".deleteExpression"),"display","block")},hideDeleteIcon:function(){q.set(k.byId(this.id+".deleteExpression"),"display","none")},createFieldsStore:function(a){if(a&&a.length){a=l.clone(a);a=a.sort(function(a,b){a.label=a.alias||a.name;b.label=b.alias||b.name;return a.label<b.label?-1:a.label>b.label?1:0});var b=this.isHostedService(this.mapLayer.url);this.supportsStandardizedQuery=
10.2<=this.mapLayer.version&&(this.mapLayer.useStandardizedQueries||this.isBigDataLayer(this.mapLayer));a=p.filter(a,function(a,d){return"esriFieldTypeString"===a.type||"esriFieldTypeDouble"===a.type||"esriFieldTypeSingle"===a.type||"esriFieldTypeInteger"===a.type||"esriFieldTypeSmallInteger"===a.type||"esriFieldTypeDate"===a.type&&(this.allowAllDateTypes||b||this.supportsStandardizedQuery)?!0:!1},this);a=p.map(a,function(a,b){var c;switch(a.type){case "esriFieldTypeString":c="string";this.fieldsInfo.stringFieldsCount++;
break;case "esriFieldTypeDate":c="date";this.fieldsInfo.dateFieldsCount++;break;default:c="number",this.fieldsInfo.numberFieldsCount++}return{id:b,label:a.label,shortType:c,alias:a.alias,editable:a.editable,name:a.name,nullable:a.nullable,type:a.type}},this);a.length&&(this.fieldsStore=new u({data:{identifier:"id",label:"label",items:a}}))}},createOperatorStores:function(){var a=[];a.push({name:this.i18n.stringOperatorIs,name_:this.i18n.stringOperatorIs,id:0});a.push({name:this.i18n.stringOperatorIsNot,
name_:this.i18n.stringOperatorIsNot,id:1});a.push({name:this.i18n.stringOperatorStartsWith,name_:this.i18n.stringOperatorStartsWith,id:2});a.push({name:this.i18n.stringOperatorEndsWith,name_:this.i18n.stringOperatorEndsWith,id:3});a.push({name:this.i18n.stringOperatorContains,name_:this.i18n.stringOperatorContains,id:4});a.push({name:this.i18n.stringOperatorDoesNotContain,name_:this.i18n.stringOperatorDoesNotContain,id:5});a.push({name:this.i18n.stringOperatorIsBlank,name_:this.i18n.stringOperatorIsBlank,
id:6});a.push({name:this.i18n.stringOperatorIsNotBlank,name_:this.i18n.stringOperatorIsNotBlank,id:7});this.stringOperatorStore=new u({data:{label:"name",identifier:"id",items:a}});a=[];a.push({name:this.i18n.dateOperatorIsOn,id:0});a.push({name:this.i18n.dateOperatorIsNotOn,id:1});a.push({name:this.i18n.dateOperatorIsBefore,id:2});a.push({name:this.i18n.dateOperatorIsAfter,id:3});a.push({name:this.i18n.dateOperatorIsBetween,id:6});a.push({name:this.i18n.dateOperatorIsNotBetween,id:7});a.push({name:this.i18n.dateOperatorIsBlank,
id:8});a.push({name:this.i18n.dateOperatorIsNotBlank,id:9});this.dateOperatorStore=new u({data:{label:"name",identifier:"id",items:a}});a=[];a.push({name:this.i18n.numberOperatorIs,name_:this.i18n.numberOperatorIs,id:0});a.push({name:this.i18n.numberOperatorIsNot,name_:this.i18n.numberOperatorIsNot,id:1});a.push({name:this.i18n.numberOperatorIsAtLeast,name_:this.i18n.numberOperatorIsAtLeast,id:2});a.push({name:this.i18n.numberOperatorIsLessThan,name_:this.i18n.numberOperatorIsLessThan,id:3});a.push({name:this.i18n.numberOperatorIsAtMost,
name_:this.i18n.numberOperatorIsAtMost,id:4});a.push({name:this.i18n.numberOperatorIsGreaterThan,name_:this.i18n.numberOperatorIsGreaterThan,id:5});a.push({name:this.i18n.numberOperatorIsBetween,name_:this.i18n.numberOperatorIsBetween,id:6});a.push({name:this.i18n.numberOperatorIsNotBetween,name_:this.i18n.numberOperatorIsNotBetween,id:7});a.push({name:this.i18n.numberOperatorIsBlank,name_:this.i18n.numberOperatorIsBlank,id:8});a.push({name:this.i18n.numberOperatorIsNotBlank,name_:this.i18n.numberOperatorIsNotBlank,
id:9});this.numberOperatorStore=new u({data:{label:"name",identifier:"id",items:a}})},readCodedValues:function(){p.forEach(this.mapLayer.fields,function(a){a.domain&&a.domain.codedValues&&(this.fieldDomains[a.name]=a.domain.codedValues)},this)},getDecodedValue:function(a,b){b=this.getCodedValues(b);var c,d;if(b)for(c=0;c<b.length;c+=1)if(d=b[c],d.code===a)return d.name;return a},getCodedValues:function(a){return this.fieldDomains[a]},getFieldsList:function(){return e.byId(this.id+".fieldsList")},
getOperatorList:function(){return e.byId(this.id+".operatorList")},getValueFieldsList:function(){return e.byId(this.id+".valueFields")},getAttrValContNode:function(){return k.byId(this.id+".attributeValueContainer")},getField:function(){var a=this.getFieldsList();return{name:a.store.getValue(a.item,"name"),label:a.store.getValue(a.item,"label"),shortType:a.store.getValue(a.item,"shortType"),type:a.store.getValue(a.item,"type")}},getOperator:function(){var a=this.getOperatorList();return a.item?a.store.getValue(a.item,
"name"):""},getValue:function(){return{}},isInteractiveChecked:function(){return this.interactiveCheck.checked},setInteractiveSection:function(a,b,c){this.disableInteractiveHandlers();this.interactiveCheck.checked=a;this.promptText.attr("value",b);this.hintText.attr("value",c);q.set(this.interactiveSpace,"display","block");this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;";this.enableInteractiveHandlers()},enableInteractiveHandlers:function(){this.onPromptChangeHandler=h.connect(this.promptText,
"onChange",this,"onChangeInteractive");this.onHintchangeHandler=h.connect(this.hintText,"onChange",this,"onChangeInteractive")},disableInteractiveHandlers:function(){h.disconnect(this.onPromptChangeHandler);h.disconnect(this.onHintChangeHandler)},fillFieldsList:function(a){var b=this.getFieldsList();b.set("labelAttr","label");b.set("searchAttr","label");b.set("store",a);b.set("value",0)},fillOperatorList:function(a,b,c){var d=this.getOperatorList();d.set("labelAttr","name");d.set("searchAttr","name");
d.set("query",c?c:{});d.set("store",a);if(b){var g=!1;for(c=0;20>c&&(a.fetchItemByIdentity({identity:c,onItem:l.hitch(this,function(a){a&&a.name[0]===b&&(d.set("value",a.id[0]),g=!0)})}),!g);c++);}else d.set("value",0)},createValueString:function(a){var b=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(b);if(a){var b=new w({id:this.id+".value","class":"attributeValue",maxHeight:150,sortByLabel:!0},m.create("div",{},b)),c=this.buildCodedValuesStore(a);b.set("store",c);b.set("value",
0)}else b=new N({id:this.id+".value","class":"attributeValue",required:!0,placeHolder:"",intermediateChanges:!0},m.create("div",{},b));this.valueHandlers.push(h.connect(b,"onChange",this,"onValueChange"));this.checkDefaultOption();this.getValue=function(){var b=e.byId(this.id+".value"),c=!0;a?b.item?b=b.item.code[0]:(b="",c=!1):c=b=b.get("value");return{value:b,isValid:c}}},createValueDate:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(a);a=new B({id:this.id+".value",
"class":"attributeValue",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},m.create("div",{},a));this.checkDefaultOption();this.valueHandlers.push(h.connect(a,"onChange",this,"onValueChange"));this.getValue=function(){var a=e.byId(this.id+".value").get("value");return{value:a,isValid:r.isDefined(a)}}},createValueNumber:function(a){var b=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(b);if(a){var b=new w({id:this.id+".value","class":"attributeValue",maxHeight:150,
sortByLabel:!0},m.create("div",{},b)),c=this.buildCodedValuesStore(a);b.set("store",c);b.set("value",0)}else b=new C({id:this.id+".value","class":"attributeValue",required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},m.create("div",{},b));this.valueHandlers.push(h.connect(b,"onChange",this,"onValueChange"));this.checkDefaultOption();this.getValue=function(){var b=e.byId(this.id+".value"),c=!0;a?b.item?b=b.item.code[0]:(b="",c=!1):(b=b.get("value"),c=r.isDefined(b)&&
!isNaN(b));return{value:b,isValid:c}}},createValueBetweenDate:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(a);var b=new B({id:this.id+".value1","class":"attributeValue1",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},m.create("div",{},a));m.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},a);a=new B({id:this.id+".value2","class":"attributeValue2",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},
m.create("div",{},a));this.checkDefaultOption();this.valueHandlers.push(h.connect(b,"onChange",this,"onValueChange"));this.valueHandlers.push(h.connect(a,"onChange",this,"onValueChange"));this.getValue=function(){var a=e.byId(this.id+".value1").get("value"),b=e.byId(this.id+".value2").get("value");return{value1:a,value2:b,isValid:r.isDefined(a)&&r.isDefined(b)}}},createValueBetweenNumber:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(a);var b=new C({id:this.id+
".value1","class":"attributeValue1",required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},m.create("div",{},a));m.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},a);a=new C({id:this.id+".value2","class":"attributeValue2",required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},m.create("div",{},a));this.checkDefaultOption();this.valueHandlers.push(h.connect(b,"onChange",this,"onValueChange"));
this.valueHandlers.push(h.connect(a,"onChange",this,"onValueChange"));this.getValue=function(){var a=e.byId(this.id+".value1").get("value"),b=e.byId(this.id+".value2").get("value");return{value1:a,value2:b,isValid:r.isDefined(a)&&r.isDefined(b)&&!isNaN(a)&&!isNaN(b)&&a<=b}}},createValueInTheLastDate:function(){},createValueIsBlank:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(a);a.innerHTML="\x3cinput id\x3d'"+this.id+".value' class\x3d'attributeValue' type\x3d'text' disabled\x3d'true'/\x3e";
this.checkDefaultOption();this.getValue=function(){return{value:null,isValid:!0}}},createValueFields:function(a,b,c){var d=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(d);var g=new w({id:this.id+".valueFields","class":"attributeValue",maxHeight:150,labelAttr:"label",searchAttr:"label",store:a,query:b},m.create("div",{},d));if(c)for(var k=!1,d=0;100>d&&(a.fetchItemByIdentity({identity:d,onItem:l.hitch(this,function(a){a&&a.shortType[0]===b.shortType&&a.name[0]!==c&&(g.set("value",
a.id),k=!0)})}),!k);d++);this.valueHandlers.push(h.connect(g,"onChange",this,"onValueChange"));this.getValue=function(){var a=e.byId(this.id+".valueFields");return{value:a.store.getValue(a.item,"name"),label:a.store.getValue(a.item,"label"),type:"field",isValid:!0}}},createValueUnique:function(a){var b=this.getAttrValContNode();this.clearAttributeValueDijits();m.empty(b);a=new w({id:this.id+".valueUnique","class":"attributeValue",maxHeight:150,store:a},m.create("div",{},b));a.set("value",0);this.valueHandlers.push(h.connect(a,
"onChange",this,"onValueChange"));this.getValue=function(){var a=e.byId(this.id+".valueUnique");return{value:a.store.getValue(a.item,"value"),isValid:!0}}},setValue:function(a,b){if(b)for(var c=0;c<b.length;c++){if(a===b[c].code){e.byId(this.id+".value").set("value",c);break}}else"date"===this.part.fieldObj.shortType?e.byId(this.id+".value").set("value",new Date(a)):("number"===this.part.fieldObj.shortType&&(a=Number(a)),e.byId(this.id+".value").set("value",a))},setValue1:function(a){"date"===this.part.fieldObj.shortType?
a=new Date(a):"number"===this.part.fieldObj.shortType&&(a=Number(a));e.byId(this.id+".value1").set("value",a)},setValue2:function(a){"date"===this.part.fieldObj.shortType?a=new Date(a):"number"===this.part.fieldObj.shortType&&(a=Number(a));e.byId(this.id+".value2").set("value",a)},setValueFieldById:function(a){this.getValueFieldsList().set("value",a)},enableOnFieldChange:function(){this.onFieldChangeEnabled=!0},enableOnOperatorChange:function(){this.onOperatorChangeEnabled=!0},onChangeField:function(a){this.onFieldChangeEnabled&&
this._onChangeField(this.getFieldsList(),this)},onChangeOperator:function(a){this.onOperatorChangeEnabled&&this._onChangeOperator(this.getOperatorList(),this)},onClickDeleteExpression:function(a){this._deleteExpression(this)},_onChangeField:function(a,b,c){var d=!!this.mapLayer&&this.isPortalHostedService(this.mapLayer.url);this.isBigDataLayer(this.mapLayer)||d&&"esriFieldTypeDate"===this.fieldsStore.getValue(a.item,"type")?q.set(k.byId(this.id+".radioUniqueColumn"),"display","none"):q.set(k.byId(this.id+
".radioUniqueColumn"),"display","");d=b.getOperatorList();switch(this.fieldsStore.getValue(a.item,"type")){case "esriFieldTypeString":var g=null;a=this.fieldsStore.getValue(a.item,"name");this.getCodedValues(a)&&(g=this.i18n.stringOperatorStartsWith,g+="|"+this.i18n.stringOperatorEndsWith,g+="|"+this.i18n.stringOperatorContains,g+="|"+this.i18n.stringOperatorDoesNotContain,g={name_:new RegExp("^(?!("+g+")$)")});d.attr("value")===this.i18n.stringOperatorIs?(b.fillOperatorList(this.stringOperatorStore,
this.i18n.stringOperatorIs,g),this.onChangeOperator(d,b,c)):b.fillOperatorList(this.stringOperatorStore,this.i18n.stringOperatorIs,g);b.createValueString(this.getCodedValues(a));break;case "esriFieldTypeDate":b.fillOperatorList(this.dateOperatorStore,this.i18n.dateOperatorIsOn);b.createValueDate();break;default:g=null,a=this.fieldsStore.getValue(a.item,"name"),this.getCodedValues(a)&&(g=this.i18n.numberOperatorIsBetween,g+="|"+this.i18n.numberOperatorIsNotBetween,g+="|"+this.i18n.numberOperatorIsAtLeast,
g+="|"+this.i18n.numberOperatorIsLessThan,g+="|"+this.i18n.numberOperatorIsAtMost,g+="|"+this.i18n.numberOperatorIsGreaterThan,g={name_:new RegExp("^(?!("+g+")$)")}),d.attr("value")===this.i18n.numberOperatorIs?(b.fillOperatorList(this.numberOperatorStore,this.i18n.numberOperatorIs,g),this.onChangeOperator(d,b,c)):b.fillOperatorList(this.numberOperatorStore,this.i18n.numberOperatorIs,g),b.createValueNumber(this.getCodedValues(a))}"date"===this.fieldsStore.getValue(b.getFieldsList().item,"shortType")?
b.disableInteractiveCheck():b.enableInteractiveCheck();h.publish("filter-expression-change",this)},_onChangeOperator:function(a,b,c){a=a.item?a.item.name[0]:a.value;c=this.fieldsStore.getValue(b.getFieldsList().item,"shortType");var d=this.fieldsStore.getValue(b.getFieldsList().item,"name");b.enableOptions();if("date"!==c&&"number"!==c||a!==this.i18n.dateOperatorIsBetween&&a!==this.i18n.numberOperatorIsBetween&&a!==this.i18n.dateOperatorIsNotBetween&&a!==this.i18n.numberOperatorIsNotBetween)if("date"!==
c||a!==this.i18n.dateOperatorInTheLast&&a!==this.i18n.dateOperatorNotInTheLast)if(a===this.i18n.stringOperatorIsBlank||a===this.i18n.dateOperatorIsBlank||a===this.i18n.numberOperatorIsBlank||a===this.i18n.stringOperatorIsNotBlank||a===this.i18n.dateOperatorIsNotBlank||a===this.i18n.numberOperatorIsNotBlank)b.createValueIsBlank(),b.disableOptions();else switch(c){case "string":b.createValueString(this.getCodedValues(d));break;case "date":b.createValueDate();break;default:b.createValueNumber(this.getCodedValues(d))}else b.disableOptions(),
b.createValueInTheLastDate();else b.disableOptions(),"date"===c?b.createValueBetweenDate():b.createValueBetweenNumber();h.publish("filter-expression-change",this)},onInteractiveClick:function(a){this.isInteractiveChecked()?(q.set(this.interactiveSpace,"display","block"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;"):(q.set(this.interactiveSpace,"display","none"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9660;");h.publish("filter-expression-change",this)},onClickShowHideInteractive:function(a){this.interactiveCheck.disabled||
("none"===q.set(this.interactiveSpace,"display")?(q.set(this.interactiveSpace,"display","block"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;"):(q.set(this.interactiveSpace,"display","none"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9660;"))},onChangeInteractive:function(){h.publish("filter-expression-change",this)},showValueInput:function(a){this._showValueInput(e.byNode(a.target),this)},showFields:function(a){this._showFields(e.byNode(a.target),this)},showUniqueList:function(a){this._showUniqueList(e.byNode(a.target),
this)},onValueChange:function(){this.onValueChangeHandler&&clearTimeout(this.onValueChangeHandler);this.onValueChangeHandler=setTimeout(l.hitch(this,function(){this.onValueChangeHandler=null;h.publish("filter-expression-change",this)}),800)},_showValueInput:function(a,b,c){b.onChangeOperator(a,b,c);b.enableInteractiveCheck()},_showFields:function(a,b,c){c=b.getFieldsList().item;a=this.fieldsStore.getValue(c,"shortType");c=this.fieldsStore.getValue(c,"name");b.createValueFields(this.fieldsStore,{shortType:a,
name:new RegExp("^(?!"+c+"$)")},c);b.disableInteractiveCheck()},_showUniqueList:function(a,b,c){this.uniqueValuesStore&&delete this.uniqueValuesStore;c=this.fieldsStore.getValue(b.getFieldsList().item,"name");if(10.1<=this.version||!this.mapLayer.url){var d=null;this.mapLayer.queryServiceUrl?d=this.mapLayer.queryServiceUrl:this.mapLayer.itemLayers&&p.forEach(this.mapLayer.itemLayers,function(a){a.id===this.layerInfo.id&&a.layerUrl&&(d=a.layerUrl)},this);d||(d=this.mapLayer.url);if(this.uniqueValuesResults[this.mapLayer.id+
"_"+c])this.onGenerateRendererResults(b,a,this.uniqueValuesResults[this.mapLayer.id+"_"+c]);else this.generateRendererUniqueValues(c,d,l.hitch(this,"onGenerateRendererResults",b,a),l.hitch(this,function(){this.showValueInput(a,b)}))}else a&&this.showValueInput(a,b)},onGenerateRendererResults:function(a,b,c){var d=this.fieldsStore.getValue(a.getFieldsList().item,"name"),e=this.fieldsStore.getValue(a.getFieldsList().item,"shortType"),h=this.fieldsStore.getValue(a.getFieldsList().item,"type");this.uniqueValuesResults[this.mapLayer.id+
"_"+d]=c;var f=null;p.forEach(this.mapLayer.fields,function(a){a.name===d&&a.domain&&(f=a.domain)});c=p.filter(c,function(a,b){return"string"===e?"\x3cNull\x3e"!==a&&""!==a.trim():"\x3cNull\x3e"!==a&&""!==a});c.length?("date"===e?(c=p.map(c,function(a){return new Date(a)}),c=c.sort(function(a,b){a=a.getTime();b=b.getTime();return a<b?-1:a>b?1:0}),c=p.map(c,function(a){return this.formatFriendlyDate(a)},this)):"number"===e?(c=p.map(c,function(a){return"esriFieldTypeDouble"===h||"esriFieldTypeSingle"===
h?parseFloat(a):parseInt(a,10)}),c=c.sort(function(a,b){return a<b?-1:a>b?1:0})):c=c.sort(function(a,b){return a<b?-1:a>b?1:0}),b=p.map(c,function(a,b){var c=a;"string"===e&&(c=""===a?"\x3c"+this.i18n.emptyString+"\x3e":a);if(f&&f.codedValues){for(var d=0;d<f.codedValues.length;d++){var g=f.codedValues[d];if(a===g.code)return{id:b,name:g.name||c,value:a}}return{id:b,name:""+c,value:a}}if("esriFieldTypeDouble"===h||"esriFieldTypeSingle"===h)c=v.format(a,{pattern:"#####0.##########"});return{id:b,name:""+
c,value:a}},this),this.uniqueValuesStore=new u({data:{label:"name",identifier:"id",items:b}}),a.createValueUnique(this.uniqueValuesStore)):this.showValueInput(b,a)},generateRendererUniqueValues:function(a,b,c,d){a instanceof Array&&(a=a.toString());var e=new O;e.attributeField=a;a=new P;a.classificationDefinition=e;this.mapLayer instanceof R?b=new y(this.mapLayer):this.mapLayer instanceof Q&&!this.mapLayer.url?b=new y(this.mapLayer):this.hasDynamicLayers(this.mapLayer)?(e=this.mapLayer.layerDefinitions&&
this.mapLayer.layerDefinitions[this.mapLayer.id]?this.mapLayer.layerDefinitions[this.mapLayer.id]:null,a.where=e?e:null,b=new y(this.mapLayer.url+"/dynamicLayer",{source:this.layerInfo.source})):(e=this.mapLayer.getDefinitionExpression(),a.where=e?e:null,b=new y(b));x.config.defaults.io.timeout=1E4;b.execute(a,function(a){x.config.defaults.io.timeout=6E4;a=p.map(a.infos,function(a){return a.value});c(a)},l.hitch(this,function(a){x.config.defaults.io.timeout=6E4;d()}))},hasDynamicLayers:function(a){return a&&
a.supportsDynamicLayers?!0:!1},formatDate:function(a){return t.format(a,{datePattern:"yyyy-MM-dd",selector:"date"})+" "+t.format(a,{selector:"time",timePattern:"HH:mm:ss"})},formatFriendlyDate:function(a){return t.format(a,{formatLength:"short",selector:"date"})},parseFriendlyDate:function(a){return t.parse(a,{formatLength:"short",selector:"date"})},parseDate:function(a){var b=t.parse(a,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});b||(b=t.parse(a.replace(" ",", "),{datePattern:"yyyy-MM-dd",
timePattern:"HH:mm:ss"}))||(b=t.parse(a.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return b},addDay:function(a){return new Date(a.getTime()+this.dayInMS)},subtractDay:function(a){return new Date(a.getTime()-this.dayInMS)},containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},buildCodedValuesStore:function(a){a=p.map(a,function(a,c){return{name:a.name,code:a.code,id:c}});return new u({data:{label:"name",identifier:"id",
items:a}})},clearAttributeValueDijits:function(){this.valueHandlers&&0!==this.valueHandlers.length&&(p.forEach(this.valueHandlers,l.hitch(this,function(a){h.disconnect(a);a=null})),this.valueHandlers=[],e.byId(this.id+".value")?e.byId(this.id+".value").destroy():k.byId(this.id+".value")&&this.getAttrValContNode().removeChild(k.byId(this.id+".value")),e.byId(this.id+".value1")?e.byId(this.id+".value1").destroy():k.byId(this.id+".value1")&&this.getAttrValContNode().removeChild(k.byId(this.id+".value1")),
e.byId(this.id+".value2")?e.byId(this.id+".value2").destroy():k.byId(this.id+".value2")&&this.getAttrValContNode().removeChild(k.byId(this.id+".value2")),e.byId(this.id+".valueFields")&&e.byId(this.id+".valueFields").destroy(),e.byId(this.id+".valueUnique")&&e.byId(this.id+".valueUnique").destroy())},checkDefaultOption:function(){A(".attributeValueOptions .attributeValueRadio",this.domNode).forEach(function(a){e.byNode(a).set("checked",-1<a.className.indexOf("radioValue"))})},disableOptions:function(){A(".attributeValueOptions .attributeValueRadio",
this.domNode).forEach(function(a){e.byNode(a).set("disabled",!0)})},enableOptions:function(){A(".attributeValueOptions .attributeValueRadio",this.domNode).forEach(function(a){e.byNode(a).set("disabled",!1)})},checkFieldOption:function(){e.byId(this.id+".radioFields").set("checked",!0)},disableFieldOption:function(){e.byId(this.id+".radioFields").set("disabled",!0)},disableUniqueOption:function(){e.byId(this.id+".radioUnique").set("disabled",!0)},enableInteractiveCheck:function(){this.interactiveCheck.disabled=
!1},disableInteractiveCheck:function(){this.interactiveCheck.checked=!1;this.interactiveCheck.disabled=!0},isBigDataLayer:function(a){return!!a.url&&-1!==a.url.indexOf("BigDataCatalogServer")&&("featureClass"===a.type||"table"===a.type)},isPortalHostedService:function(a){return a?-1!==a.toLowerCase().indexOf("/hosted/"):!1},isHostedService:function(a){if(!a)return!1;var b=-1!==a.indexOf(".arcgis.com/");a=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||-1!==a.indexOf("//features");return b&&
a},buildEditUIField:function(a,b,c){this.getFieldItemByName({name:a.fieldObj.name},l.hitch(this,function(d){b.getFieldsList().set("value",d.id[0],!1);this.buildEditUIOperator(a,b,c)}),l.hitch(this,function(){b.getFieldsList().set("value",0);this.buildEditUIOperator(a,b,c)}))},buildEditUIOperator:function(a,b,c){switch(a.fieldObj.shortType){case "string":b.fillOperatorList(this.stringOperatorStore,a.operator);break;case "date":b.fillOperatorList(this.dateOperatorStore,a.operator);break;default:b.fillOperatorList(this.numberOperatorStore,
a.operator)}setTimeout(l.hitch(this,function(){this.getOperatorItemByName(b.getOperatorList().store,{name:a.operator},l.hitch(this,function(d){b.getOperatorList().set("value",d.id[0],!1);this.buildEditUIValue(a,b,c)}),l.hitch(this,function(){b.getOperatorList().set("value",0);this.buildEditUIValue(a,b,c)}))}),100)},buildEditUIValue:function(a,b,c){this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!0;var d=a.operator;this.onChangeOperator(b.getOperatorList(),b);b.enableOptions();setTimeout(l.hitch(this,
function(){d===this.i18n.stringOperatorIsBlank||d===this.i18n.dateOperatorIsBlank||d===this.i18n.numberOperatorIsBlank||d===this.i18n.stringOperatorIsNotBlank||d===this.i18n.dateOperatorIsNotBlank||d===this.i18n.numberOperatorIsNotBlank?(b.createValueIsBlank(),b.disableOptions()):"field"===a.valueObj.type?(b.createValueFields(this.fieldsStore,{shortType:a.fieldObj.shortType,name:new RegExp("^(?!"+a.fieldObj.name+"$)")}),b.checkFieldOption(),this.getFieldItemByName({name:a.valueObj.value},l.hitch(this,
function(a){b.setValueFieldById(a.id[0])}),l.hitch(this,function(){b.setValueFieldById(0)}))):r.isDefined(a.valueObj.value1)?(b.setValue1(a.valueObj.value1),b.setValue2(a.valueObj.value2)):b.setValue(a.valueObj.value,this.getCodedValues(a.fieldObj.name))}),100)},getFieldItemByName:function(a,b,c){this.fieldsStore.fetch({query:a,onComplete:l.hitch(this,function(a){a&&a.length?b(a[0]):c()})})},getOperatorItemByName:function(a,b,c,d){a.fetch({query:b,onComplete:l.hitch(this,function(a){a&&a.length?c(a[0]):
d()})})}});E("extend-esri")&&l.setObject("dijit.SingleFilter",z,x);return z});