//>>built
define("dgrid/selector","dojo/_base/kernel dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/_base/sniff put-selector/put".split(" "),function(v,w,m,y,q,x,n){m.getObject("dgrid.selector",!0);return dgrid.selector=function(b,e){function r(d){return!a.allowSelect(a.row(d))}function p(d){return function(c){var h=c.rows,g=h.length;c="false";var f;for(f=0;f<g;f++){var e=a.cell(h[f],b.id).element;e&&(e=(e.contents||e).input)&&!e.disabled&&(e.checked=d,e.setAttribute("aria-checked",d))}if("checkbox"==
k.type){h=a.selection;g=!1;for(f in h)if(h[f]!=a.allSelected){g=!0;break}k.indeterminate=g;k.checked=a.allSelected;g?c="mixed":a.allSelected&&(c="true");k.setAttribute("aria-checked",c)}}}function m(d){if("click"==d.type||32==d.keyCode||!x("opera")&&13==d.keyCode||0===d.keyCode){var c=a.row(d);a._selectionTriggerEvent=d;if(c){if(a.allowSelect(c)){var b=a._lastSelected&&a.row(a._lastSelected);"radio"==e?b&&b.id==c.id||(a.clearSelection(),a.select(c,null,!0),a._lastSelected=c.element):c&&(d.shiftKey?
p(!0)({rows:[c]}):b=null,b=d.shiftKey?b:null,a.select(b||c,c,b?void 0:null),a._lastSelected=c.element)}}else n(this,(a.allSelected?"!":".")+"dgrid-select-all"),a[a.allSelected?"clearSelection":"selectAll"]();a._selectionTriggerEvent=null}}function t(){a._hasSelectorInputListener=!0;l.push(a.on(".dgrid-selector:click,.dgrid-selector:keydown",m));var d=a._handleSelect;a._handleSelect=function(a){this.cell(a).column!=b&&d.apply(this,arguments)};if("function"==typeof b.disabled){var c=a.allowSelect,e=
b.disabled;a.allowSelect=function(a){var d=c.call(this,a);return e===r?d:d&&!e.call(b,a.data)}}b.disabled=r;l.push(a.on("dgrid-select",p(!0)));l.push(a.on("dgrid-deselect",p(!1)))}var l=[],a,k;b||(b={});b.type&&(b.selectorType=b.type,v.deprecated("columndef.type","use columndef.selectorType instead","dgrid 0.4"));b.selectorType=e=e||b.selectorType||"checkbox";b.sortable=!1;var u="function"==typeof e?e:function(d,c,h){var g=c.parentNode,f;a._hasSelectorInputListener||t();f=b.disabled;n(g&&g.contents?
g:c,".dgrid-selector");c=c.input||(c.input=n(c,"input[type\x3d"+e+"]",{tabIndex:isNaN(b.tabIndex)?-1:b.tabIndex,disabled:f&&("function"==typeof f?f.call(b,h):f),checked:d}));c.setAttribute("aria-checked",!!d);return c};q.after(b,"init",function(){a=b.grid});q.after(b,"destroy",function(){w.forEach(l,function(a){a.remove()});a._hasSelectorInputListener=!1});b.renderCell=function(b,c,e,g,f){c=(c=b&&a.row(b))&&a.selection[c.id];u(c,e,b)};b.renderHeaderCell=function(d){var c="label"in b?b.label:b.field||
"";"radio"!=e&&a.allowSelectAll?u(!1,d,{}):(d.appendChild(document.createTextNode(c)),a._hasSelectorInputListener||t());k=d.lastChild};return b}});