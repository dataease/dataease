/*
	Copyright (c) 2004-2016, The JS Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

//>>built
define("dojo/on",["./has!dom-addeventlistener?:./aspect","./_base/kernel","./sniff"],function(y,z,f){function A(a,b,c,d,e){if(d=b.match(/(.*):(.*)/))return b=d[2],d=d[1],g.selector(d,b).call(e,a,c);f("touch")&&(B.test(b)&&(c=n(c)),f("event-orientationchange")||"orientationchange"!=b||(b="resize",a=window,c=n(c)));p&&(c=p(c));if(a.addEventListener){var k=b in q,m=k?q[b]:b;a.addEventListener(m,c,k);return{remove:function(){a.removeEventListener(m,c,k)}}}if(r&&a.attachEvent)return r(a,"on"+b,c);throw Error("Target must be an event emitter");
}function C(){this.cancelable=!1;this.defaultPrevented=!0}function D(){this.bubbles=!1}var t=window.ScriptEngineMajorVersion;f.add("jscript",t&&t()+ScriptEngineMinorVersion()/10);f.add("event-orientationchange",f("touch")&&!f("android"));f.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);f.add("event-focusin",function(a,b,c){return"onfocusin"in c});f("touch")&&f.add("touch-can-modify-event-delegate",function(){var a=function(){};
a.prototype=document.createEvent("MouseEvents");try{var b=new a;b.target=null;return null===b.target}catch(c){return!1}});var g=function(a,b,c,d){return"function"!=typeof a.on||"function"==typeof b||a.nodeType?g.parse(a,b,c,A,d,this):a.on(b,c)};g.pausable=function(a,b,c,d){var e;a=g(a,b,function(){if(!e)return c.apply(this,arguments)},d);a.pause=function(){e=!0};a.resume=function(){e=!1};return a};g.once=function(a,b,c,d){var e=g(a,b,function(){e.remove();return c.apply(this,arguments)});return e};
g.parse=function(a,b,c,d,e,k){var f;if(b.call)return b.call(k,a,c);b instanceof Array?f=b:-1<b.indexOf(",")&&(f=b.split(/\s*,\s*/));if(f){var h=[];b=0;for(var u;u=f[b++];)h.push(g.parse(a,u,c,d,e,k));h.remove=function(){for(var a=0;a<h.length;a++)h[a].remove()};return h}return d(a,b,c,e,k)};var B=/^touch/;g.matches=function(a,b,c,d,e){e=e&&"function"==typeof e.matches?e:z.query;d=!1!==d;1!=a.nodeType&&(a=a.parentNode);for(;!e.matches(a,b,c);)if(a==c||!1===d||!(a=a.parentNode)||1!=a.nodeType)return!1;
return a};g.selector=function(a,b,c){return function(d,e){function f(b){return g.matches(b,a,d,c,m)}var m="function"==typeof a?{matches:a}:this,h=b.bubble;return h?g(d,h(f),e):g(d,b,function(a){var b=f(a.target);if(b)return a.selectorTarget=b,e.call(b,a)})}};var E=[].slice,F=g.emit=function(a,b,c){var d=E.call(arguments,2),e="on"+b;if("parentNode"in a){var f=d[0]={},g;for(g in c)f[g]=c[g];f.preventDefault=C;f.stopPropagation=D;f.target=a;f.type=b;c=f}do a[e]&&a[e].apply(a,d);while(c&&c.bubbles&&(a=
a.parentNode));return c&&c.cancelable&&c},q=f("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!f("event-stopimmediatepropagation"))var G=function(){this.modified=this.immediatelyStopped=!0},p=function(a){return function(b){if(!b.immediatelyStopped)return b.stopImmediatePropagation=G,a.apply(this,arguments)}};if(f("dom-addeventlistener"))g.emit=function(a,b,c){if(a.dispatchEvent&&document.createEvent){var d=(a.ownerDocument||document).createEvent("HTMLEvents");d.initEvent(b,!!c.bubbles,!!c.cancelable);
for(var e in c)e in d||(d[e]=c[e]);return a.dispatchEvent(d)&&d}return F.apply(g,arguments)};else{g._fixEvent=function(a,b){a||(a=(b&&(b.ownerDocument||b.document||b).parentWindow||window).event);if(!a)return a;try{l&&a.type==l.type&&a.srcElement==l.target&&(a=l)}catch(c){}if(!a.target)switch(a.target=a.srcElement,a.currentTarget=b||a.srcElement,"mouseover"==a.type&&(a.relatedTarget=a.fromElement),"mouseout"==a.type&&(a.relatedTarget=a.toElement),a.stopPropagation||(a.stopPropagation=H,a.preventDefault=
I),a.type){case "keypress":b="charCode"in a?a.charCode:a.keyCode,10==b?(b=0,a.keyCode=13):13==b||27==b?b=0:3==b&&(b=99),a.charCode=b,b=a,b.keyChar=b.charCode?String.fromCharCode(b.charCode):"",b.charOrCode=b.keyChar||b.keyCode}return a};var l,v=function(a){this.handle=a};v.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};var J=function(a){return function(b){b=g._fixEvent(b,this);var c=a.call(this,b);b.modified&&(l||setTimeout(function(){l=null}),l=b);return c}},r=function(a,b,c){c=
J(c);if(((a.ownerDocument?a.ownerDocument.parentWindow:a.parentWindow||a.window||window)!=top||5.8>f("jscript"))&&!f("config-_allow_leaks")){"undefined"==typeof _dojoIEListeners_&&(_dojoIEListeners_=[]);var d=a[b];if(!d||!d.listeners){var e=d,d=Function("event","var callee \x3d arguments.callee; for(var i \x3d 0; i\x3ccallee.listeners.length; i++){var listener \x3d _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}");d.listeners=[];a[b]=d;d.global=this;e&&d.listeners.push(_dojoIEListeners_.push(e)-
1)}d.listeners.push(a=d.global._dojoIEListeners_.push(c)-1);return new v(a)}return y.after(a,b,c,!0)},H=function(){this.cancelBubble=!0},I=g._preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey)try{this.keyCode=0}catch(a){}this.defaultPrevented=!0;this.returnValue=!1;this.modified=!0}}if(f("touch"))var w=function(){},x=window.orientation,n=function(a){return function(b){var c=b.corrected;if(!c){var d=b.type;try{delete b.type}catch(m){}if(b.type){if(f("touch-can-modify-event-delegate"))w.prototype=
b,c=new w;else{var c={},e;for(e in b)c[e]=b[e]}c.preventDefault=function(){b.preventDefault()};c.stopPropagation=function(){b.stopPropagation()}}else c=b,c.type=d;b.corrected=c;if("resize"==d){if(x==window.orientation)return null;x=window.orientation;c.type="orientationchange";return a.call(this,c)}"rotation"in c||(c.rotation=0,c.scale=1);if(window.TouchEvent&&b instanceof TouchEvent){var d=c.changedTouches[0],g;for(g in d)delete c[g],c[g]=d[g]}}return a.call(this,c)}};return g});