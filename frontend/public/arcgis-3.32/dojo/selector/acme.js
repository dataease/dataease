/*
	Copyright (c) 2004-2016, The JS Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

//>>built
define("dojo/selector/acme",["../dom","../sniff","../_base/array","../_base/lang","../_base/window"],function(O,m,F,G,y){var P=G.trim,L=F.forEach,Q="BackCompat"==y.doc.compatMode,u=!1,z=function(){return!0},M=function(a){a=0<="\x3e~+".indexOf(a.slice(-1))?a+" * ":a+" ";for(var b=function(b,c){return P(a.slice(b,c))},c=[],d=-1,e=-1,f=-1,h=-1,l=-1,r=-1,A=-1,H,B="",n="",m,k=0,t=a.length,g=null,p=null,q=function(){0<=r&&(g.id=b(r,k).replace(/\\/g,""),r=-1);if(0<=A){var a=A==k?null:b(A,k);g[0>"\x3e~+".indexOf(a)?
"tag":"oper"]=a;A=-1}0<=l&&(g.classes.push(b(l+1,k).replace(/\\/g,"")),l=-1)};B=n,n=a.charAt(k),k<t;k++)"\\"!=B&&(g||(m=k,g={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return u?this.otag:this.tag}},A=k),H?n==H&&(H=null):"'"==n||'"'==n?H=n:0<=d?"]"==n?(p.attr?p.matchFor=b(f||d+1,k):p.attr=b(d+1,k),!(d=p.matchFor)||'"'!=d.charAt(0)&&"'"!=d.charAt(0)||(p.matchFor=d.slice(1,-1)),p.matchFor&&(p.matchFor=p.matchFor.replace(/\\/g,"")),g.attrs.push(p),p=null,d=
f=-1):"\x3d"==n&&(f=0<="|~^$*".indexOf(B)?B:"",p.type=f+n,p.attr=b(d+1,k-f.length),f=k+1):0<=e?")"==n&&(0<=h&&(p.value=b(e+1,k)),h=e=-1):"#"==n?(q(),r=k+1):"."==n?(q(),l=k):":"==n?(q(),h=k):"["==n?(q(),d=k,p={}):"("==n?(0<=h&&(p={name:b(h+1,k),value:null},g.pseudos.push(p)),e=k):" "==n&&B!=n&&(q(),0<=h&&g.pseudos.push({name:b(h+1,k)}),g.loops=g.pseudos.length||g.attrs.length||g.classes.length,g.oquery=g.query=b(m,k),g.otag=g.tag=g.oper?null:g.tag||"*",g.tag&&(g.tag=g.tag.toUpperCase()),c.length&&
c[c.length-1].oper&&(g.infixOper=c.pop(),g.query=g.infixOper.query+" "+g.query),c.push(g),g=null));return c},v=function(a,b){return a?b?function(){return a.apply(window,arguments)&&b.apply(window,arguments)}:a:b},C=function(a,b){b=b||[];a&&b.push(a);return b},I=function(a){return 1==a.nodeType},w=function(a,b){return a?"class"==b?a.className||"":"for"==b?a.htmlFor||"":"style"==b?a.style.cssText||"":(u?a.getAttribute(b):a.getAttribute(b,2))||"":""},R={"*\x3d":function(a,b){return function(c){return 0<=
w(c,a).indexOf(b)}},"^\x3d":function(a,b){return function(c){return 0==w(c,a).indexOf(b)}},"$\x3d":function(a,b){return function(c){c=" "+w(c,a);var d=c.lastIndexOf(b);return-1<d&&d==c.length-b.length}},"~\x3d":function(a,b){var c=" "+b+" ";return function(b){return 0<=(" "+w(b,a)+" ").indexOf(c)}},"|\x3d":function(a,b){var c=b+"-";return function(d){d=w(d,a);return d==b||0==d.indexOf(c)}},"\x3d":function(a,b){return function(c){return w(c,a)==b}}};G=y.doc.documentElement;var J=!(G.nextElementSibling||
"nextElementSibling"in G),D=J?"nextSibling":"nextElementSibling",ea=J?"previousSibling":"previousElementSibling",E=J?I:z,S=function(a){for(;a=a[ea];)if(E(a))return!1;return!0},T=function(a){for(;a=a[D];)if(E(a))return!1;return!0},K=function(a){var b=a.parentNode,b=7!=b.nodeType?b:b.nextSibling,c=0,d=b.children||b.childNodes,e=a._i||a.getAttribute("_i")||-1,f=b._l||("undefined"!==typeof b.getAttribute?b.getAttribute("_l"):-1);if(!d)return-1;d=d.length;if(f==d&&0<=e&&0<=f)return e;m("ie")&&"undefined"!==
typeof b.setAttribute?b.setAttribute("_l",d):b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[D])E(b)&&(m("ie")?b.setAttribute("_i",++c):b._i=++c,a===b&&(e=c));return e},fa=function(a){return!(K(a)%2)},ga=function(a){return K(a)%2},U={checked:function(a,b){return function(a){return!("checked"in a?!a.checked:!a.selected)}},disabled:function(a,b){return function(a){return a.disabled}},enabled:function(a,b){return function(a){return!a.disabled}},"first-child":function(){return S},"last-child":function(){return T},
"only-child":function(a,b){return function(a){return S(a)&&T(a)}},empty:function(a,b){return function(a){var b=a.childNodes;for(a=a.childNodes.length-1;0<=a;a--){var c=b[a].nodeType;if(1===c||3==c)return!1}return!0}},contains:function(a,b){a=b.charAt(0);if('"'==a||"'"==a)b=b.slice(1,-1);return function(a){return 0<=a.innerHTML.indexOf(b)}},not:function(a,b){a=M(b)[0];b={el:1};"*"!=a.tag&&(b.tag=1);a.classes.length||(b.classes=1);var c=t(a,b);return function(a){return!c(a)}},"nth-child":function(a,
b){a=parseInt;if("odd"==b)return ga;if("even"==b)return fa;if(-1!=b.indexOf("n")){b=b.split("n",2);var c=b[0]?"-"==b[0]?-1:a(b[0]):1,d=b[1]?a(b[1]):0,e=0,f=-1;0<c?0>d?d=d%c&&c+d%c:0<d&&(d>=c&&(e=d-d%c),d%=c):0>c&&(c*=-1,0<d&&(f=d,d%=c));if(0<c)return function(a){a=K(a);return a>=e&&(0>f||a<=f)&&a%c==d};b=d}var h=a(b);return function(a){return K(a)==h}}},ha=9>m("ie")||9==m("ie")&&m("quirks")?function(a){var b=a.toLowerCase();"class"==b&&(a="className");return function(c){return u?c.getAttribute(a):
c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}},t=function(a,b){if(!a)return z;b=b||{};var c=null;"el"in b||(c=v(c,I));"tag"in b||"*"!=a.tag&&(c=v(c,function(b){return b&&(u?b.tagName:b.tagName.toUpperCase())==a.getTag()}));"classes"in b||L(a.classes,function(a,b,f){var d=new RegExp("(?:^|\\s)"+a+"(?:\\s|$)");c=v(c,function(a){return d.test(a.className)});c.count=b});"pseudos"in b||L(a.pseudos,function(a){var b=a.name;U[b]&&(c=v(c,U[b](b,a.value)))});"attrs"in
b||L(a.attrs,function(a){var b,d=a.attr;a.type&&R[a.type]?b=R[a.type](d,a.matchFor):d.length&&(b=ha(d));b&&(c=v(c,b))});"id"in b||a.id&&(c=v(c,function(b){return!!b&&b.id==a.id}));c||"default"in b||(c=z);return c},ia=function(a){return function(b,c,d){for(;b=b[D];)if(!J||I(b)){d&&!x(b,d)||!a(b)||c.push(b);break}return c}},ja=function(a){return function(b,c,d){for(b=b[D];b;){if(E(b)){if(d&&!x(b,d))break;a(b)&&c.push(b)}b=b[D]}return c}},V=function(a,b){var c=function(a){var b=[];try{b=Array.prototype.slice.call(a)}catch(l){for(var c=
0,d=a.length;c<d;c++)b.push(a[c])}return b};a=a||z;return function(d,e,f){var h=0,l=[],l=c(d.children||d.childNodes);for(b&&F.forEach(l,function(a){1===a.nodeType&&(l=l.concat(c(a.getElementsByTagName("*"))))});d=l[h++];)E(d)&&(!f||x(d,f))&&a(d,h)&&e.push(d);return e}},W=function(a,b){for(a=a.parentNode;a&&a!=b;)a=a.parentNode;return!!a},X={},Y=function(a){var b=X[a.query];if(b)return b;var c=a.infixOper,c=c?c.oper:"",d=t(a,{el:1}),e="*"==a.tag,f=y.doc.getElementsByClassName;if(c)f={el:1},e&&(f.tag=
1),d=t(a,f),"+"==c?b=ia(d):"~"==c?b=ja(d):"\x3e"==c&&(b=V(d));else if(a.id)d=!a.loops&&e?z:t(a,{el:1,id:1}),b=function(b,c){var e=O.byId(a.id,b.ownerDocument||b);b.ownerDocument&&!W(b,b.ownerDocument)&&F.some(11===b.nodeType?b.childNodes:[b],function(b){b=V(function(b){return b.id===a.id},!0)(b,[]);if(b.length)return e=b[0],!1});if(e&&d(e)&&(9==b.nodeType||W(e,b)))return C(e,c)};else if(f&&/\{\s*\[native code\]\s*\}/.test(String(f))&&a.classes.length&&!Q)var d=t(a,{el:1,classes:1,id:1}),h=a.classes.join(" "),
b=function(a,b,c){b=C(0,b);for(var e,f=0,l=a.getElementsByClassName(h);e=l[f++];)d(e,a)&&x(e,c)&&b.push(e);return b};else e||a.loops?(d=t(a,{el:1,tag:1,id:1}),b=function(b,c,e){c=C(0,c);for(var f,l=0,h=(f=a.getTag())?b.getElementsByTagName(f):[];f=h[l++];)d(f,b)&&x(f,e)&&c.push(f);return c}):b=function(b,c,d){c=C(0,c);for(var e=0,f=a.getTag(),f=f?b.getElementsByTagName(f):[];b=f[e++];)x(b,d)&&c.push(b);return c};return X[a.query]=b},Z={},aa={},ba=function(a){var b=M(P(a));if(1==b.length){var c=Y(b[0]);
return function(a){if(a=c(a,[]))a.nozip=!0;return a}}return function(a){a=C(a);for(var c,d,h=b.length,l,r,m=0;m<h;m++){r=[];c=b[m];d=a.length-1;0<d&&(l={},r.nozip=!0);d=Y(c);for(var q=0;c=a[q];q++)d(c,r,l);if(!r.length)break;a=r}return r}},ka=m("ie")?"commentStrip":"nozip",ca=!!y.doc.querySelectorAll,la=/\\[>~+]|n\+\d|([^ \\])?([>~+])([^ =])?/g,ma=function(a,b,c,d){return c?(b?b+" ":"")+c+(d?" "+d:""):a},na=/([^[]*)([^\]]*])?/g,oa=function(a,b,c){return b.replace(la,ma)+(c||"")},da=function(a,b){a=
a.replace(na,oa);if(ca){var c=aa[a];if(c&&!b)return c}if(c=Z[a])return c;var c=a.charAt(0),d=-1==a.indexOf(" ");0<=a.indexOf("#")&&d&&(b=!0);if(!ca||b||-1!="\x3e~+".indexOf(c)||m("ie")&&-1!=a.indexOf(":")||Q&&0<=a.indexOf(".")||-1!=a.indexOf(":contains")||-1!=a.indexOf(":checked")||-1!=a.indexOf("|\x3d")){var e=a.match(/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g);return Z[a]=2>e.length?ba(a):function(a){for(var b=0,c=[],d;d=e[b++];)c=c.concat(ba(d)(a));return c}}var f=0<="\x3e~+".indexOf(a.charAt(a.length-
1))?a+" *":a;return aa[a]=function(b){if(9==b.nodeType||d)try{var c=b.querySelectorAll(f);c[ka]=!0;return c}catch(r){}return da(a,!0)(b)}},q=0,pa=m("ie")?function(a){return u?a.getAttribute("_uid")||a.setAttribute("_uid",++q)||q:a.uniqueID}:function(a){return a._uid||(a._uid=++q)},x=function(a,b){if(!b)return 1;a=pa(a);return b[a]?0:b[a]=1},qa=function(a){if(a&&a.nozip)return a;if(!a||!a.length)return[];if(2>a.length)return[a[0]];var b=[];q++;var c,d;if(m("ie")&&u){var e=q+"";for(c=0;c<a.length;c++)(d=
a[c])&&d.getAttribute("_zipIdx")!=e&&(b.push(d),d.setAttribute("_zipIdx",e))}else if(m("ie")&&a.commentStrip)try{for(c=0;c<a.length;c++)(d=a[c])&&I(d)&&b.push(d)}catch(f){}else for(c=0;c<a.length;c++)(d=a[c])&&d._zipIdx!=q&&(b.push(d),d._zipIdx=q);return b},N=function(a,b){b=b||y.doc;u="div"===(b.ownerDocument||b).createElement("div").tagName;return(a=da(a)(b))&&a.nozip?a:qa(a)};N.filter=function(a,b,c){for(var d=[],e=M(b),e=1!=e.length||/[^\w#\.]/.test(b)?function(a){return-1!=F.indexOf(N(b,O.byId(c)),
a)}:t(e[0]),f=0,h;h=a[f];f++)e(h)&&d.push(h);return d};return N});